exports.id=818,exports.ids=[818],exports.modules={7042:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(11253),l=r(19366);n.registerBackgroundTabDetection=function(){l.WINDOW.document?l.WINDOW.document.addEventListener("visibilitychange",()=>{let t=i.getActiveTransaction();if(l.WINDOW.document.hidden&&t){let n="cancelled",{op:r,status:l}=i.spanToJSON(t);a.DEBUG_BUILD&&o.logger.log(`[Tracing] Transaction: ${n} -> since tab moved to the background, op: ${r}`),l||t.setStatus(n),t.setTag("visibilitychange","document.hidden"),t.end()}}):a.DEBUG_BUILD&&o.logger.warn("[Tracing] Could not set up background tab detection due to lack of global document")}},79179:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(11253),l=r(7042),c=r(61241),g=r(20268),d=r(53760),u=r(19366),I="BrowserTracing",p={...i.TRACING_DEFAULTS,instrumentNavigation:!0,instrumentPageLoad:!0,markBackgroundSpan:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...d.defaultRequestInstrumentationOptions};function startBrowserTracingPageLoadSpan(t,n){if(!t.emit)return;t.emit("startPageLoadSpan",n);let r=i.getActiveSpan(),o=r&&i.spanToJSON(r).op;return"pageload"===o?r:void 0}function startBrowserTracingNavigationSpan(t,n){if(!t.emit)return;t.emit("startNavigationSpan",n);let r=i.getActiveSpan(),o=r&&i.spanToJSON(r).op;return"navigation"===o?r:void 0}function getMetaContent(t){let n=o.getDomElement(`meta[name=${t}]`);return n?n.getAttribute("content"):void 0}n.BROWSER_TRACING_INTEGRATION_ID=I,n.browserTracingIntegration=(t={})=>{let n=!!a.DEBUG_BUILD&&!!(t.tracePropagationTargets||t.tracingOrigins);i.addTracingExtensions(),!t.tracePropagationTargets&&t.tracingOrigins&&(t.tracePropagationTargets=t.tracingOrigins);let r={...p,...t},m=g.startTrackingWebVitals(),h={};r.enableInp&&g.startTrackingINP(h,r.interactionsSampleRate),r.enableLongTask&&g.startTrackingLongTasks(),r._experiments.enableInteractions&&g.startTrackingInteractions();let C={name:void 0,context:void 0};function _createRouteTransaction(t){let n;let l=i.getCurrentHub(),{beforeStartSpan:c,idleTimeout:d,finalTimeout:I,heartbeatInterval:p}=r,h="pageload"===t.op;if(h){let r=h?getMetaContent("sentry-trace"):"",i=h?getMetaContent("baggage"):void 0,{traceId:a,dsc:l,parentSpanId:c,sampled:g}=o.propagationContextFromHeaders(r,i);n={traceId:a,parentSpanId:c,parentSampled:g,...t,metadata:{...t.metadata,dynamicSamplingContext:l},trimEnd:!0}}else n={trimEnd:!0,...t};let b=c?c(n):n;b.metadata=b.name!==n.name?{...b.metadata,source:"custom"}:b.metadata,C.name=b.name,C.context=b,!1===b.sampled&&a.DEBUG_BUILD&&o.logger.log(`[Tracing] Will not send ${b.op} transaction because of beforeNavigate.`),a.DEBUG_BUILD&&o.logger.log(`[Tracing] Starting ${b.op} transaction on scope`);let{location:y}=u.WINDOW,G=i.startIdleTransaction(l,b,d,I,!0,{location:y},p,h);return h&&u.WINDOW.document&&(u.WINDOW.document.addEventListener("readystatechange",()=>{["interactive","complete"].includes(u.WINDOW.document.readyState)&&G.sendAutoFinishSignal()}),["interactive","complete"].includes(u.WINDOW.document.readyState)&&G.sendAutoFinishSignal()),G.registerBeforeFinishCallback(t=>{m(),g.addPerformanceEntries(t)}),G}return{name:I,setupOnce:()=>{},afterAllSetup(t){let g;let I=t.getOptions(),{markBackgroundSpan:p,traceFetch:m,traceXHR:b,shouldCreateSpanForRequest:y,enableHTTPTimings:G,_experiments:A}=r,B=I&&I.tracePropagationTargets,Z=B||r.tracePropagationTargets;a.DEBUG_BUILD&&n&&B&&o.logger.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used.");let f=u.WINDOW.location&&u.WINDOW.location.href;if(t.on&&(t.on("startNavigationSpan",t=>{g&&(a.DEBUG_BUILD&&o.logger.log(`[Tracing] Finishing current transaction with op: ${i.spanToJSON(g).op}`),g.end()),g=_createRouteTransaction({op:"navigation",...t})}),t.on("startPageLoadSpan",t=>{g&&(a.DEBUG_BUILD&&o.logger.log(`[Tracing] Finishing current transaction with op: ${i.spanToJSON(g).op}`),g.end()),g=_createRouteTransaction({op:"pageload",...t})})),r.instrumentPageLoad&&t.emit&&u.WINDOW.location){let n={name:u.WINDOW.location.pathname,startTimestamp:o.browserPerformanceTimeOrigin?o.browserPerformanceTimeOrigin/1e3:void 0,origin:"auto.pageload.browser",attributes:{[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"url"}};startBrowserTracingPageLoadSpan(t,n)}r.instrumentNavigation&&t.emit&&u.WINDOW.location&&o.addHistoryInstrumentationHandler(({to:n,from:r})=>{if(void 0===r&&f&&-1!==f.indexOf(n)){f=void 0;return}if(r!==n){f=void 0;let n={name:u.WINDOW.location.pathname,origin:"auto.navigation.browser",attributes:{[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"url"}};startBrowserTracingNavigationSpan(t,n)}}),p&&l.registerBackgroundTabDetection(),A.enableInteractions&&function(t,n){let r;let registerInteractionTransaction=()=>{let{idleTimeout:l,finalTimeout:c,heartbeatInterval:g}=t,d="ui.action.click",I=i.getActiveTransaction();if(I&&I.op&&["navigation","pageload"].includes(I.op)){a.DEBUG_BUILD&&o.logger.warn(`[Tracing] Did not create ${d} transaction because a pageload or navigation transaction is in progress.`);return}if(r&&(r.setFinishReason("interactionInterrupted"),r.end(),r=void 0),!n.name){a.DEBUG_BUILD&&o.logger.warn(`[Tracing] Did not create ${d} transaction because _latestRouteName is missing.`);return}let{location:p}=u.WINDOW,m={name:n.name,op:d,trimEnd:!0,data:{[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:n.context?function(t){let n=t.attributes&&t.attributes[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],r=t.data&&t.data[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],o=t.metadata&&t.metadata.source;return n||r||o}(n.context):"url"}};r=i.startIdleTransaction(i.getCurrentHub(),m,l,c,!0,{location:p},g)};["click"].forEach(t=>{u.WINDOW.document&&addEventListener(t,registerInteractionTransaction,{once:!1,capture:!0})})}(r,C),r.enableInp&&function(t,n){let handleEntries=({entries:r})=>{let o=i.getClient(),a=void 0!==o&&void 0!==o.getIntegrationByName?o.getIntegrationByName("Replay"):void 0,l=void 0!==a?a.getReplayId():void 0,c=i.getActiveTransaction(),g=i.getCurrentScope(),d=void 0!==g?g.getUser():void 0;r.forEach(r=>{if("duration"in r){let i=r.interactionId;if(void 0===i)return;let o=t[i],a=r.duration,g=r.startTime,u=Object.keys(t),I=u.length>0?u.reduce((n,r)=>t[n].duration<t[r].duration?n:r):void 0;if("first-input"===r.entryType){let n=u.map(n=>t[n]).some(t=>t.duration===a&&t.startTime===g);if(n)return}if(i){if(o)o.duration=Math.max(o.duration,a);else if(u.length<10||void 0===I||a>t[I].duration){let r=n.name,o=n.context;r&&o&&(I&&Object.keys(t).length>=10&&delete t[I],t[i]={routeName:r,duration:a,parentContext:o,user:d,activeTransaction:c,replayId:l,startTime:g})}}}})};c.addPerformanceInstrumentationHandler("event",handleEntries),c.addPerformanceInstrumentationHandler("first-input",handleEntries)}(h,C),d.instrumentOutgoingRequests({traceFetch:m,traceXHR:b,tracePropagationTargets:Z,shouldCreateSpanForRequest:y,enableHTTPTimings:G})},options:r}},n.getMetaContent=getMetaContent,n.startBrowserTracingNavigationSpan=startBrowserTracingNavigationSpan,n.startBrowserTracingPageLoadSpan=startBrowserTracingPageLoadSpan},50032:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(11253),l=r(7042),c=r(61241),g=r(20268),d=r(53760),u=r(15393),I=r(19366),p="BrowserTracing",m={...i.TRACING_DEFAULTS,markBackgroundTransactions:!0,routingInstrumentation:u.instrumentRoutingWithDefaults,startTransactionOnLocationChange:!0,startTransactionOnPageLoad:!0,enableLongTask:!0,enableInp:!1,interactionsSampleRate:1,_experiments:{},...d.defaultRequestInstrumentationOptions};function getMetaContent(t){let n=o.getDomElement(`meta[name=${t}]`);return n?n.getAttribute("content"):void 0}n.BROWSER_TRACING_INTEGRATION_ID=p,n.BrowserTracing=class{constructor(t){this.name=p,this._hasSetTracePropagationTargets=!1,i.addTracingExtensions(),a.DEBUG_BUILD&&(this._hasSetTracePropagationTargets=!!(t&&(t.tracePropagationTargets||t.tracingOrigins))),this.options={...m,...t},void 0!==this.options._experiments.enableLongTask&&(this.options.enableLongTask=this.options._experiments.enableLongTask),t&&!t.tracePropagationTargets&&t.tracingOrigins&&(this.options.tracePropagationTargets=t.tracingOrigins),this._collectWebVitals=g.startTrackingWebVitals(),this._interactionIdToRouteNameMapping={},this.options.enableInp&&g.startTrackingINP(this._interactionIdToRouteNameMapping,this.options.interactionsSampleRate),this.options.enableLongTask&&g.startTrackingLongTasks(),this.options._experiments.enableInteractions&&g.startTrackingInteractions(),this._latestRoute={name:void 0,context:void 0}}setupOnce(t,n){this._getCurrentHub=n;let r=n(),i=r.getClient(),c=i&&i.getOptions(),{routingInstrumentation:g,startTransactionOnLocationChange:u,startTransactionOnPageLoad:I,markBackgroundTransactions:p,traceFetch:m,traceXHR:h,shouldCreateSpanForRequest:C,enableHTTPTimings:b,_experiments:y}=this.options,G=c&&c.tracePropagationTargets,A=G||this.options.tracePropagationTargets;a.DEBUG_BUILD&&this._hasSetTracePropagationTargets&&G&&o.logger.warn("[Tracing] The `tracePropagationTargets` option was set in the BrowserTracing integration and top level `Sentry.init`. The top level `Sentry.init` value is being used."),g(t=>{let r=this._createRouteTransaction(t);return this.options._experiments.onStartRouteTransaction&&this.options._experiments.onStartRouteTransaction(r,t,n),r},I,u),p&&l.registerBackgroundTabDetection(),y.enableInteractions&&this._registerInteractionListener(),this.options.enableInp&&this._registerInpInteractionListener(),d.instrumentOutgoingRequests({traceFetch:m,traceXHR:h,tracePropagationTargets:A,shouldCreateSpanForRequest:C,enableHTTPTimings:b})}_createRouteTransaction(t){let n;if(!this._getCurrentHub){a.DEBUG_BUILD&&o.logger.warn(`[Tracing] Did not create ${t.op} transaction because _getCurrentHub is invalid.`);return}let r=this._getCurrentHub(),{beforeNavigate:l,idleTimeout:c,finalTimeout:d,heartbeatInterval:u}=this.options,p="pageload"===t.op;if(p){let r=p?getMetaContent("sentry-trace"):"",i=p?getMetaContent("baggage"):void 0,{traceId:a,dsc:l,parentSpanId:c,sampled:g}=o.propagationContextFromHeaders(r,i);n={traceId:a,parentSpanId:c,parentSampled:g,...t,metadata:{...t.metadata,dynamicSamplingContext:l},trimEnd:!0}}else n={trimEnd:!0,...t};let m="function"==typeof l?l(n):n,h=void 0===m?{...n,sampled:!1}:m;h.metadata=h.name!==n.name?{...h.metadata,source:"custom"}:h.metadata,this._latestRoute.name=h.name,this._latestRoute.context=h,!1===h.sampled&&a.DEBUG_BUILD&&o.logger.log(`[Tracing] Will not send ${h.op} transaction because of beforeNavigate.`),a.DEBUG_BUILD&&o.logger.log(`[Tracing] Starting ${h.op} transaction on scope`);let{location:C}=I.WINDOW,b=i.startIdleTransaction(r,h,c,d,!0,{location:C},u,p);return p&&I.WINDOW.document&&(I.WINDOW.document.addEventListener("readystatechange",()=>{["interactive","complete"].includes(I.WINDOW.document.readyState)&&b.sendAutoFinishSignal()}),["interactive","complete"].includes(I.WINDOW.document.readyState)&&b.sendAutoFinishSignal()),b.registerBeforeFinishCallback(t=>{this._collectWebVitals(),g.addPerformanceEntries(t)}),b}_registerInteractionListener(){let t;let registerInteractionTransaction=()=>{let{idleTimeout:n,finalTimeout:r,heartbeatInterval:l}=this.options,c="ui.action.click",g=i.getActiveTransaction();if(g&&g.op&&["navigation","pageload"].includes(g.op)){a.DEBUG_BUILD&&o.logger.warn(`[Tracing] Did not create ${c} transaction because a pageload or navigation transaction is in progress.`);return}if(t&&(t.setFinishReason("interactionInterrupted"),t.end(),t=void 0),!this._getCurrentHub){a.DEBUG_BUILD&&o.logger.warn(`[Tracing] Did not create ${c} transaction because _getCurrentHub is invalid.`);return}if(!this._latestRoute.name){a.DEBUG_BUILD&&o.logger.warn(`[Tracing] Did not create ${c} transaction because _latestRouteName is missing.`);return}let d=this._getCurrentHub(),{location:u}=I.WINDOW,p={name:this._latestRoute.name,op:c,trimEnd:!0,data:{[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:this._latestRoute.context?function(t){let n=t.attributes&&t.attributes[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],r=t.data&&t.data[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE],o=t.metadata&&t.metadata.source;return n||r||o}(this._latestRoute.context):"url"}};t=i.startIdleTransaction(d,p,n,r,!0,{location:u},l)};["click"].forEach(t=>{I.WINDOW.document&&addEventListener(t,registerInteractionTransaction,{once:!1,capture:!0})})}_registerInpInteractionListener(){let handleEntries=({entries:t})=>{let n=i.getClient(),r=void 0!==n&&void 0!==n.getIntegrationByName?n.getIntegrationByName("Replay"):void 0,o=void 0!==r?r.getReplayId():void 0,a=i.getActiveTransaction(),l=i.getCurrentScope(),c=void 0!==l?l.getUser():void 0;t.forEach(t=>{if("duration"in t){let n=t.interactionId;if(void 0===n)return;let r=this._interactionIdToRouteNameMapping[n],i=t.duration,l=t.startTime,g=Object.keys(this._interactionIdToRouteNameMapping),d=g.length>0?g.reduce((t,n)=>this._interactionIdToRouteNameMapping[t].duration<this._interactionIdToRouteNameMapping[n].duration?t:n):void 0;if("first-input"===t.entryType){let t=g.map(t=>this._interactionIdToRouteNameMapping[t]).some(t=>t.duration===i&&t.startTime===l);if(t)return}if(n){if(r)r.duration=Math.max(r.duration,i);else if(g.length<10||void 0===d||i>this._interactionIdToRouteNameMapping[d].duration){let t=this._latestRoute.name,r=this._latestRoute.context;t&&r&&(d&&Object.keys(this._interactionIdToRouteNameMapping).length>=10&&delete this._interactionIdToRouteNameMapping[d],this._interactionIdToRouteNameMapping[n]={routeName:t,duration:i,parentContext:r,user:c,activeTransaction:a,replayId:o,startTime:l})}}}})};c.addPerformanceInstrumentationHandler("event",handleEntries),c.addPerformanceInstrumentationHandler("first-input",handleEntries)}},n.getMetaContent=getMetaContent},61241:(t,n,r)=>{let i,o,a,l,c;Object.defineProperty(n,"__esModule",{value:!0});let g=r(81277),d=r(11253),u=r(34411),I=r(88094),p=r(35755),m=r(50811),h=r(14615),C=r(55592),b={},y={};function triggerHandlers(t,n){let r=b[t];if(r&&r.length)for(let i of r)try{i(n)}catch(n){d.DEBUG_BUILD&&g.logger.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${g.getFunctionName(i)}
Error:`,n)}}function instrumentCls(){return u.onCLS(t=>{triggerHandlers("cls",{metric:t}),i=t},{reportAllChanges:!0})}function instrumentFid(){return I.onFID(t=>{triggerHandlers("fid",{metric:t}),o=t})}function instrumentLcp(){return m.onLCP(t=>{triggerHandlers("lcp",{metric:t}),a=t})}function instrumentTtfb(){return C.onTTFB(t=>{triggerHandlers("ttfb",{metric:t}),l=t})}function instrumentInp(){return p.onINP(t=>{triggerHandlers("inp",{metric:t}),c=t})}function addMetricObserver(t,n,r,i,o=!1){let a;return addHandler(t,n),y[t]||(a=r(),y[t]=!0),i&&n({metric:i}),getCleanupCallback(t,n,o?a:void 0)}function addHandler(t,n){b[t]=b[t]||[],b[t].push(n)}function getCleanupCallback(t,n,r){return()=>{r&&r();let i=b[t];if(!i)return;let o=i.indexOf(n);-1!==o&&i.splice(o,1)}}n.addClsInstrumentationHandler=function(t,n=!1){return addMetricObserver("cls",t,instrumentCls,i,n)},n.addFidInstrumentationHandler=function(t){return addMetricObserver("fid",t,instrumentFid,o)},n.addInpInstrumentationHandler=function(t){return addMetricObserver("inp",t,instrumentInp,c)},n.addLcpInstrumentationHandler=function(t,n=!1){return addMetricObserver("lcp",t,instrumentLcp,a,n)},n.addPerformanceInstrumentationHandler=function(t,n){return addHandler(t,n),y[t]||(function(t){let n={};"event"===t&&(n.durationThreshold=0),h.observe(t,n=>{triggerHandlers(t,{entries:n})},n)}(t),y[t]=!0),getCleanupCallback(t,n)},n.addTtfbInstrumentationHandler=function(t){return addMetricObserver("ttfb",t,instrumentTtfb,l)}},20268:(t,n,r)=>{let i,o;Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(11253),g=r(61241),d=r(19366),u=r(7351),I=r(72135),p=r(60506);function msToSec(t){return t/1e3}function getBrowserPerformanceAPI(){return d.WINDOW&&d.WINDOW.addEventListener&&d.WINDOW.performance}let m=0,h={},C={click:"click",pointerdown:"click",pointerup:"click",mousedown:"click",mouseup:"click",touchstart:"click",touchend:"click",mouseover:"hover",mouseout:"hover",mouseenter:"hover",mouseleave:"hover",pointerover:"hover",pointerout:"hover",pointerenter:"hover",pointerleave:"hover",dragstart:"drag",dragend:"drag",drag:"drag",dragenter:"drag",dragleave:"drag",dragover:"drag",drop:"drag",keydown:"press",keyup:"press",keypress:"press",input:"press"};function _addMeasureSpans(t,n,r,i,o){let a=o+r;return I._startChild(t,{description:n.name,endTimestamp:a+i,op:n.entryType,origin:"auto.resource.browser.metrics",startTimestamp:a}),a}function _addPerformanceNavigationTiming(t,n,r,i,o,a){let l=a?n[a]:n[`${r}End`],c=n[`${r}Start`];c&&l&&I._startChild(t,{op:"browser",origin:"auto.browser.browser.metrics",description:o||r,startTimestamp:i+msToSec(c),endTimestamp:i+msToSec(l)})}function _addResourceSpans(t,n,r,i,o,a){if("xmlhttprequest"===n.initiatorType||"fetch"===n.initiatorType)return;let c=l.parseUrl(r),g={};setResourceEntrySizeData(g,n,"transferSize","http.response_transfer_size"),setResourceEntrySizeData(g,n,"encodedBodySize","http.response_content_length"),setResourceEntrySizeData(g,n,"decodedBodySize","http.decoded_response_content_length"),"renderBlockingStatus"in n&&(g["resource.render_blocking_status"]=n.renderBlockingStatus),c.protocol&&(g["url.scheme"]=c.protocol.split(":").pop()),c.host&&(g["server.address"]=c.host),g["url.same_origin"]=r.includes(d.WINDOW.location.origin);let u=a+i,p=u+o;I._startChild(t,{description:r.replace(d.WINDOW.location.origin,""),endTimestamp:p,op:n.initiatorType?`resource.${n.initiatorType}`:"resource.other",origin:"auto.resource.browser.metrics",startTimestamp:u,data:g})}function setResourceEntrySizeData(t,n,r,i){let o=n[r];null!=o&&o<2147483647&&(t[i]=o)}n._addMeasureSpans=_addMeasureSpans,n._addResourceSpans=_addResourceSpans,n.addPerformanceEntries=function(t){let n=getBrowserPerformanceAPI();if(!n||!d.WINDOW.performance.getEntries||!l.browserPerformanceTimeOrigin)return;c.DEBUG_BUILD&&l.logger.log("[Tracing] Adding & adjusting spans using Performance API");let r=msToSec(l.browserPerformanceTimeOrigin),g=n.getEntries(),{op:C,start_timestamp:b}=a.spanToJSON(t);if(g.slice(m).forEach(n=>{let i=msToSec(n.startTime),o=msToSec(n.duration);if("navigation"!==t.op||!b||!(r+i<b))switch(n.entryType){case"navigation":["unloadEvent","redirect","domContentLoadedEvent","loadEvent","connect"].forEach(i=>{_addPerformanceNavigationTiming(t,n,i,r)}),_addPerformanceNavigationTiming(t,n,"secureConnection",r,"TLS/SSL","connectEnd"),_addPerformanceNavigationTiming(t,n,"fetch",r,"cache","domainLookupStart"),_addPerformanceNavigationTiming(t,n,"domainLookup",r,"DNS"),n.responseEnd&&(I._startChild(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"request",startTimestamp:r+msToSec(n.requestStart),endTimestamp:r+msToSec(n.responseEnd)}),I._startChild(t,{op:"browser",origin:"auto.browser.browser.metrics",description:"response",startTimestamp:r+msToSec(n.responseStart),endTimestamp:r+msToSec(n.responseEnd)}));break;case"mark":case"paint":case"measure":{_addMeasureSpans(t,n,i,o,r);let a=u.getVisibilityWatcher(),g=n.startTime<a.firstHiddenTime;"first-paint"===n.name&&g&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding FP"),h.fp={value:n.startTime,unit:"millisecond"}),"first-contentful-paint"===n.name&&g&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding FCP"),h.fcp={value:n.startTime,unit:"millisecond"});break}case"resource":_addResourceSpans(t,n,n.name,i,o,r)}}),m=Math.max(g.length-1,0),function(t){let n=d.WINDOW.navigator;if(!n)return;let r=n.connection;r&&(r.effectiveType&&t.setTag("effectiveConnectionType",r.effectiveType),r.type&&t.setTag("connectionType",r.type),I.isMeasurementValue(r.rtt)&&(h["connection.rtt"]={value:r.rtt,unit:"millisecond"})),I.isMeasurementValue(n.deviceMemory)&&t.setTag("deviceMemory",`${n.deviceMemory} GB`),I.isMeasurementValue(n.hardwareConcurrency)&&t.setTag("hardwareConcurrency",String(n.hardwareConcurrency))}(t),"pageload"===C){(function(t){let n=p.getNavigationEntry();if(!n)return;let{responseStart:r,requestStart:i}=n;i<=r&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding TTFB Request Time"),t["ttfb.requestTime"]={value:r-i,unit:"millisecond"})})(h),["fcp","fp","lcp"].forEach(t=>{if(!h[t]||!b||r>=b)return;let n=h[t].value,i=r+msToSec(n),o=Math.abs((i-b)*1e3),a=o-n;c.DEBUG_BUILD&&l.logger.log(`[Measurements] Normalized ${t} from ${n} to ${o} (${a})`),h[t].value=o});let n=h["mark.fid"];n&&h.fid&&(I._startChild(t,{description:"first input delay",endTimestamp:n.value+msToSec(h.fid.value),op:"ui.action",origin:"auto.ui.browser.metrics",startTimestamp:n.value}),delete h["mark.fid"]),"fcp"in h||delete h.cls,Object.keys(h).forEach(t=>{a.setMeasurement(t,h[t].value,h[t].unit)}),i&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding LCP Data"),i.element&&t.setTag("lcp.element",l.htmlTreeAsString(i.element)),i.id&&t.setTag("lcp.id",i.id),i.url&&t.setTag("lcp.url",i.url.trim().slice(0,200)),t.setTag("lcp.size",i.size)),o&&o.sources&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding CLS Data"),o.sources.forEach((n,r)=>t.setTag(`cls.source.${r+1}`,l.htmlTreeAsString(n.node))))}i=void 0,o=void 0,h={}},n.startTrackingINP=function(t,n){let r=getBrowserPerformanceAPI();if(r&&l.browserPerformanceTimeOrigin){let r=g.addInpInstrumentationHandler(({metric:r})=>{let i;if(void 0===r.value)return;let o=r.entries.find(t=>t.duration===r.value&&void 0!==C[t.name]),g=a.getClient();if(!o||!g)return;let u=C[o.name],I=g.getOptions(),p=msToSec(l.browserPerformanceTimeOrigin+o.startTime),m=msToSec(r.value),h=void 0!==o.interactionId?t[o.interactionId]:void 0;if(void 0===h)return;let{routeName:b,parentContext:y,activeTransaction:G,user:A,replayId:B}=h,Z=void 0!==A?A.email||A.id||A.ip_address:void 0,f=void 0!==G?G.getProfileId():void 0,v=new a.Span({startTimestamp:p,endTimestamp:p+m,op:`ui.interaction.${u}`,name:l.htmlTreeAsString(o.target),attributes:{release:I.release,environment:I.environment,transaction:b,...void 0!==Z&&""!==Z?{user:Z}:{},...void 0!==f?{profile_id:f}:{},...void 0!==B?{replay_id:B}:{}},exclusiveTime:r.value,measurements:{inp:{value:r.value,unit:"millisecond"}}}),W=!!a.hasTracingEnabled(I)&&((i=void 0!==y&&"function"==typeof I.tracesSampler?I.tracesSampler({transactionContext:y,name:y.name,parentSampled:y.parentSampled,attributes:{...y.data,...y.attributes},location:d.WINDOW.location}):void 0!==y&&void 0!==y.sampled?y.sampled:void 0!==I.tracesSampleRate?I.tracesSampleRate:1,a.isValidSampleRate(i))?!0===i?n:!1===i?0:i*n:(c.DEBUG_BUILD&&l.logger.warn("[Tracing] Discarding interaction span because of invalid sample rate."),!1));if(W&&Math.random()<W){let t=v?a.createSpanEnvelope([v],g.getDsn()):void 0,n=g&&g.getTransport();n&&t&&n.send(t).then(null,t=>{c.DEBUG_BUILD&&l.logger.error("Error while sending interaction:",t)});return}});return()=>{r()}}return()=>void 0},n.startTrackingInteractions=function(){g.addPerformanceInstrumentationHandler("event",({entries:t})=>{for(let n of t){let t=a.getActiveTransaction();if(!t)return;if("click"===n.name){let r=msToSec(l.browserPerformanceTimeOrigin+n.startTime),i=msToSec(n.duration),o={description:l.htmlTreeAsString(n.target),op:`ui.interaction.${n.name}`,origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i},a=l.getComponentName(n.target);a&&(o.attributes={"ui.component_name":a}),t.startChild(o)}}})},n.startTrackingLongTasks=function(){g.addPerformanceInstrumentationHandler("longtask",({entries:t})=>{for(let n of t){let t=a.getActiveTransaction();if(!t)return;let r=msToSec(l.browserPerformanceTimeOrigin+n.startTime),i=msToSec(n.duration);t.startChild({description:"Main UI thread blocked",op:"ui.long-task",origin:"auto.ui.browser.metrics",startTimestamp:r,endTimestamp:r+i})}})},n.startTrackingWebVitals=function(){let t=getBrowserPerformanceAPI();if(t&&l.browserPerformanceTimeOrigin){t.mark&&d.WINDOW.performance.mark("sentry-tracing-init");let n=g.addFidInstrumentationHandler(({metric:t})=>{let n=t.entries[t.entries.length-1];if(!n)return;let r=msToSec(l.browserPerformanceTimeOrigin),i=msToSec(n.startTime);c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding FID"),h.fid={value:t.value,unit:"millisecond"},h["mark.fid"]={value:r+i,unit:"second"}}),r=g.addClsInstrumentationHandler(({metric:t})=>{let n=t.entries[t.entries.length-1];n&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding CLS"),h.cls={value:t.value,unit:""},o=n)},!0),a=g.addLcpInstrumentationHandler(({metric:t})=>{let n=t.entries[t.entries.length-1];n&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding LCP"),h.lcp={value:t.value,unit:"millisecond"},i=n)},!0),u=g.addTtfbInstrumentationHandler(({metric:t})=>{let n=t.entries[t.entries.length-1];n&&(c.DEBUG_BUILD&&l.logger.log("[Measurements] Adding TTFB"),h.ttfb={value:t.value,unit:"millisecond"})});return()=>{n(),r(),a(),u()}}return()=>void 0}},72135:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n._startChild=function(t,{startTimestamp:n,...r}){return n&&t.startTimestamp>n&&(t.startTimestamp=n),t.startChild({startTimestamp:n,...r})},n.isMeasurementValue=function(t){return"number"==typeof t&&isFinite(t)}},53760:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(23763),l=r(61241),c=r(19366),g=["localhost",/^\/(?!\/)/],d={traceFetch:!0,traceXHR:!0,enableHTTPTimings:!0,tracingOrigins:g,tracePropagationTargets:g};function addHTTPTimings(t){let{url:n}=i.spanToJSON(t).data||{};if(!n||"string"!=typeof n)return;let r=l.addPerformanceInstrumentationHandler("resource",({entries:i})=>{i.forEach(i=>{if("resource"===i.entryType&&"initiatorType"in i&&"string"==typeof i.nextHopProtocol&&("fetch"===i.initiatorType||"xmlhttprequest"===i.initiatorType)&&i.name.endsWith(n)){let n=function(t){let{name:n,version:r}=extractNetworkProtocol(t.nextHopProtocol),i=[];return(i.push(["network.protocol.version",r],["network.protocol.name",n]),o.browserPerformanceTimeOrigin)?[...i,["http.request.redirect_start",getAbsoluteTime(t.redirectStart)],["http.request.fetch_start",getAbsoluteTime(t.fetchStart)],["http.request.domain_lookup_start",getAbsoluteTime(t.domainLookupStart)],["http.request.domain_lookup_end",getAbsoluteTime(t.domainLookupEnd)],["http.request.connect_start",getAbsoluteTime(t.connectStart)],["http.request.secure_connection_start",getAbsoluteTime(t.secureConnectionStart)],["http.request.connection_end",getAbsoluteTime(t.connectEnd)],["http.request.request_start",getAbsoluteTime(t.requestStart)],["http.request.response_start",getAbsoluteTime(t.responseStart)],["http.request.response_end",getAbsoluteTime(t.responseEnd)]]:i}(i);n.forEach(n=>t.setAttribute(...n)),setTimeout(r)}})})}function extractNetworkProtocol(t){let n="unknown",r="unknown",i="";for(let o of t){if("/"===o){[n,r]=t.split("/");break}if(!isNaN(Number(o))){n="h"===i?"http":i,r=t.split(i)[1];break}i+=o}return i===t&&(n=i),{name:n,version:r}}function getAbsoluteTime(t=0){return((o.browserPerformanceTimeOrigin||performance.timeOrigin)+t)/1e3}function shouldAttachHeaders(t,n){return o.stringMatchesSomePattern(t,n||g)}function xhrCallback(t,n,r,a){let l=t.xhr,c=l&&l[o.SENTRY_XHR_DATA_KEY];if(!i.hasTracingEnabled()||!l||l.__sentry_own_request__||!c)return;let g=n(c.url);if(t.endTimestamp&&g){let t=l.__sentry_xhr_span_id__;if(!t)return;let n=a[t];n&&void 0!==c.status_code&&(i.setHttpStatus(n,c.status_code),n.end(),delete a[t]);return}let d=i.getCurrentScope(),u=i.getIsolationScope(),I=getFullURL(c.url),p=I?o.parseUrl(I).host:void 0,m=g?i.startInactiveSpan({name:`${c.method} ${c.url}`,onlyIfParent:!0,attributes:{type:"xhr","http.method":c.method,"http.url":I,url:c.url,"server.address":p,[i.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.http.browser"},op:"http.client"}):void 0;m&&(l.__sentry_xhr_span_id__=m.spanContext().spanId,a[l.__sentry_xhr_span_id__]=m);let h=i.getClient();if(l.setRequestHeader&&r(c.url)&&h){let{traceId:t,spanId:n,sampled:r,dsc:a}={...u.getPropagationContext(),...d.getPropagationContext()},c=m?i.spanToTraceHeader(m):o.generateSentryTraceHeader(t,n,r),g=o.dynamicSamplingContextToSentryBaggageHeader(a||(m?i.getDynamicSamplingContextFromSpan(m):i.getDynamicSamplingContextFromClient(t,h,d)));(function(t,n,r){try{t.setRequestHeader("sentry-trace",n),r&&t.setRequestHeader(o.BAGGAGE_HEADER_NAME,r)}catch(t){}})(l,c,g)}return m}function getFullURL(t){try{let n=new URL(t,c.WINDOW.location.origin);return n.href}catch(t){return}}n.DEFAULT_TRACE_PROPAGATION_TARGETS=g,n.defaultRequestInstrumentationOptions=d,n.extractNetworkProtocol=extractNetworkProtocol,n.instrumentOutgoingRequests=function(t){let{traceFetch:n,traceXHR:r,tracePropagationTargets:i,tracingOrigins:l,shouldCreateSpanForRequest:c,enableHTTPTimings:g}={traceFetch:d.traceFetch,traceXHR:d.traceXHR,...t},u="function"==typeof c?c:t=>!0,shouldAttachHeadersWithTargets=t=>shouldAttachHeaders(t,i||l),I={};n&&o.addFetchInstrumentationHandler(t=>{let n=a.instrumentFetchRequest(t,u,shouldAttachHeadersWithTargets,I);if(n){let r=getFullURL(t.fetchData.url),i=r?o.parseUrl(r).host:void 0;n.setAttributes({"http.url":r,"server.address":i})}g&&n&&addHTTPTimings(n)}),r&&o.addXhrInstrumentationHandler(t=>{let n=xhrCallback(t,u,shouldAttachHeadersWithTargets,I);g&&n&&addHTTPTimings(n)})},n.shouldAttachHeaders=shouldAttachHeaders,n.xhrCallback=xhrCallback},15393:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(11253),a=r(19366);n.instrumentRoutingWithDefaults=function(t,n=!0,r=!0){let l;if(!a.WINDOW||!a.WINDOW.location){o.DEBUG_BUILD&&i.logger.warn("Could not initialize routing instrumentation due to invalid location");return}let c=a.WINDOW.location.href;n&&(l=t({name:a.WINDOW.location.pathname,startTimestamp:i.browserPerformanceTimeOrigin?i.browserPerformanceTimeOrigin/1e3:void 0,op:"pageload",origin:"auto.pageload.browser",metadata:{source:"url"}})),r&&i.addHistoryInstrumentationHandler(({to:n,from:r})=>{if(void 0===r&&c&&-1!==c.indexOf(n)){c=void 0;return}r!==n&&(c=void 0,l&&(o.DEBUG_BUILD&&i.logger.log(`[Tracing] Finishing current transaction with op: ${l.op}`),l.end()),l=t({name:a.WINDOW.location.pathname,op:"navigation",origin:"auto.navigation.browser",metadata:{source:"url"}}))})}},19366:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=i.GLOBAL_OBJ;n.WINDOW=o},34411:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(37931),o=r(72246),a=r(14615),l=r(24967);n.onCLS=(t,n={})=>{let r;let c=o.initMetric("CLS",0),g=0,d=[],handleEntries=t=>{t.forEach(t=>{if(!t.hadRecentInput){let n=d[0],i=d[d.length-1];g&&0!==d.length&&t.startTime-i.startTime<1e3&&t.startTime-n.startTime<5e3?(g+=t.value,d.push(t)):(g=t.value,d=[t]),g>c.value&&(c.value=g,c.entries=d,r&&r())}})},u=a.observe("layout-shift",handleEntries);if(u){r=i.bindReporter(t,c,n.reportAllChanges);let stopListening=()=>{handleEntries(u.takeRecords()),r(!0)};return l.onHidden(stopListening),stopListening}}},88094:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(37931),o=r(7351),a=r(72246),l=r(14615),c=r(24967);n.onFID=t=>{let n;let r=o.getVisibilityWatcher(),g=a.initMetric("FID"),handleEntry=t=>{t.startTime<r.firstHiddenTime&&(g.value=t.processingStart-t.startTime,g.entries.push(t),n(!0))},handleEntries=t=>{t.forEach(handleEntry)},d=l.observe("first-input",handleEntries);n=i.bindReporter(t,g),d&&c.onHidden(()=>{handleEntries(d.takeRecords()),d.disconnect()},!0)}},35755:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(37931),o=r(72246),a=r(14615),l=r(24967),c=r(36823),getInteractionCountForNavigation=()=>c.getInteractionCount(),g=[],d={},processEntry=t=>{let n=g[g.length-1],r=d[t.interactionId];if(r||g.length<10||t.duration>n.latency){if(r)r.entries.push(t),r.latency=Math.max(r.latency,t.duration);else{let n={id:t.interactionId,latency:t.duration,entries:[t]};d[n.id]=n,g.push(n)}g.sort((t,n)=>n.latency-t.latency),g.splice(10).forEach(t=>{delete d[t.id]})}},estimateP98LongestInteraction=()=>{let t=Math.min(g.length-1,Math.floor(getInteractionCountForNavigation()/50));return g[t]};n.onINP=(t,n)=>{let r;n=n||{},c.initInteractionCountPolyfill();let d=o.initMetric("INP"),handleEntries=t=>{t.forEach(t=>{if(t.interactionId&&processEntry(t),"first-input"===t.entryType){let n=!g.some(n=>n.entries.some(n=>t.duration===n.duration&&t.startTime===n.startTime));n&&processEntry(t)}});let n=estimateP98LongestInteraction();n&&n.latency!==d.value&&(d.value=n.latency,d.entries=n.entries,r())},u=a.observe("event",handleEntries,{durationThreshold:n.durationThreshold||40});r=i.bindReporter(t,d,n.reportAllChanges),u&&(u.observe({type:"first-input",buffered:!0}),l.onHidden(()=>{handleEntries(u.takeRecords()),d.value<0&&getInteractionCountForNavigation()>0&&(d.value=0,d.entries=[]),r(!0)}))}},50811:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(19366),o=r(37931),a=r(54216),l=r(7351),c=r(72246),g=r(14615),d=r(24967),u={};n.onLCP=t=>{let n;let r=l.getVisibilityWatcher(),I=c.initMetric("LCP"),handleEntries=t=>{let i=t[t.length-1];if(i){let t=Math.max(i.startTime-a.getActivationStart(),0);t<r.firstHiddenTime&&(I.value=t,I.entries=[i],n())}},p=g.observe("largest-contentful-paint",handleEntries);if(p){n=o.bindReporter(t,I);let stopListening=()=>{u[I.id]||(handleEntries(p.takeRecords()),p.disconnect(),u[I.id]=!0,n(!0))};return["keydown","click"].forEach(t=>{i.WINDOW.document&&addEventListener(t,stopListening,{once:!0,capture:!0})}),d.onHidden(stopListening,!0),stopListening}}},37931:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.bindReporter=(t,n,r)=>{let i,o;return a=>{n.value>=0&&(a||r)&&((o=n.value-(i||0))||void 0===i)&&(i=n.value,n.delta=o,t(n))}}},64561:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.generateUniqueID=()=>`v3-${Date.now()}-${Math.floor(Math.random()*(9e12-1))+1e12}`},54216:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(60506);n.getActivationStart=()=>{let t=i.getNavigationEntry();return t&&t.activationStart||0}},60506:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(19366),getNavigationEntryFromPerformanceTiming=()=>{let t=i.WINDOW.performance.timing,n=i.WINDOW.performance.navigation.type,r={entryType:"navigation",startTime:0,type:2==n?"back_forward":1===n?"reload":"navigate"};for(let n in t)"navigationStart"!==n&&"toJSON"!==n&&(r[n]=Math.max(t[n]-t.navigationStart,0));return r};n.getNavigationEntry=()=>i.WINDOW.__WEB_VITALS_POLYFILL__?i.WINDOW.performance&&(performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]||getNavigationEntryFromPerformanceTiming()):i.WINDOW.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0]},7351:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(19366),o=r(24967),a=-1,initHiddenTime=()=>{i.WINDOW.document&&i.WINDOW.document.visibilityState&&(a="hidden"!==i.WINDOW.document.visibilityState||i.WINDOW.document.prerendering?1/0:0)},trackChanges=()=>{o.onHidden(({timeStamp:t})=>{a=t},!0)};n.getVisibilityWatcher=()=>(a<0&&(initHiddenTime(),trackChanges()),{get firstHiddenTime(){return a}})},72246:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(19366),o=r(64561),a=r(54216),l=r(60506);n.initMetric=(t,n)=>{let r=l.getNavigationEntry(),c="navigate";return r&&(c=i.WINDOW.document&&i.WINDOW.document.prerendering||a.getActivationStart()>0?"prerender":r.type.replace(/_/g,"-")),{name:t,value:void 0===n?-1:n,rating:"good",delta:0,entries:[],id:o.generateUniqueID(),navigationType:c}}},14615:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.observe=(t,n,r)=>{try{if(PerformanceObserver.supportedEntryTypes.includes(t)){let i=new PerformanceObserver(t=>{n(t.getEntries())});return i.observe(Object.assign({type:t,buffered:!0},r||{})),i}}catch(t){}}},24967:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(19366);n.onHidden=(t,n)=>{let onHiddenOrPageHide=r=>{("pagehide"===r.type||"hidden"===i.WINDOW.document.visibilityState)&&(t(r),n&&(removeEventListener("visibilitychange",onHiddenOrPageHide,!0),removeEventListener("pagehide",onHiddenOrPageHide,!0)))};i.WINDOW.document&&(addEventListener("visibilitychange",onHiddenOrPageHide,!0),addEventListener("pagehide",onHiddenOrPageHide,!0))}},36823:(t,n,r)=>{let i;Object.defineProperty(n,"__esModule",{value:!0});let o=r(14615),a=0,l=1/0,c=0,updateEstimate=t=>{t.forEach(t=>{t.interactionId&&(l=Math.min(l,t.interactionId),a=(c=Math.max(c,t.interactionId))?(c-l)/7+1:0)})};n.getInteractionCount=()=>i?a:performance.interactionCount||0,n.initInteractionCountPolyfill=()=>{"interactionCount"in performance||i||(i=o.observe("event",updateEstimate,{type:"event",buffered:!0,durationThreshold:0}))}},55592:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(19366),o=r(37931),a=r(54216),l=r(60506),c=r(72246),whenReady=t=>{i.WINDOW.document&&(i.WINDOW.document.prerendering?addEventListener("prerenderingchange",()=>whenReady(t),!0):"complete"!==i.WINDOW.document.readyState?addEventListener("load",()=>whenReady(t),!0):setTimeout(t,0))};n.onTTFB=(t,n)=>{n=n||{};let r=c.initMetric("TTFB"),i=o.bindReporter(t,r,n.reportAllChanges);whenReady(()=>{let t=l.getNavigationEntry();if(t){if(r.value=Math.max(t.responseStart-a.getActivationStart(),0),r.value<0||r.value>performance.now())return;r.entries=[t],i(!0)}})}},11253:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;n.DEBUG_BUILD=r},23763:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277);function addTracingHeadersToFetchRequest(t,n,r,a,l){let c=l||r.getSpan(),g=i.getIsolationScope(),{traceId:d,spanId:u,sampled:I,dsc:p}={...g.getPropagationContext(),...r.getPropagationContext()},m=c?i.spanToTraceHeader(c):o.generateSentryTraceHeader(d,u,I),h=o.dynamicSamplingContextToSentryBaggageHeader(p||(c?i.getDynamicSamplingContextFromSpan(c):i.getDynamicSamplingContextFromClient(d,n,r))),C=a.headers||("undefined"!=typeof Request&&o.isInstanceOf(t,Request)?t.headers:void 0);if(!C)return{"sentry-trace":m,baggage:h};if("undefined"!=typeof Headers&&o.isInstanceOf(C,Headers)){let t=new Headers(C);return t.append("sentry-trace",m),h&&t.append(o.BAGGAGE_HEADER_NAME,h),t}if(Array.isArray(C)){let t=[...C,["sentry-trace",m]];return h&&t.push([o.BAGGAGE_HEADER_NAME,h]),t}{let t="baggage"in C?C.baggage:void 0,n=[];return Array.isArray(t)?n.push(...t):t&&n.push(t),h&&n.push(h),{...C,"sentry-trace":m,baggage:n.length>0?n.join(","):void 0}}}n.addTracingHeadersToFetchRequest=addTracingHeadersToFetchRequest,n.instrumentFetchRequest=function(t,n,r,a,l="auto.http.browser"){if(!i.hasTracingEnabled()||!t.fetchData)return;let c=n(t.fetchData.url);if(t.endTimestamp&&c){let n=t.fetchData.__span;if(!n)return;let r=a[n];r&&(function(t,n){if(n.response){i.setHttpStatus(t,n.response.status);let r=n.response&&n.response.headers&&n.response.headers.get("content-length");if(r){let n=parseInt(r);n>0&&t.setAttribute("http.response_content_length",n)}}else n.error&&t.setStatus("internal_error");t.end()}(r,t),delete a[n]);return}let g=i.getCurrentScope(),d=i.getClient(),{method:u,url:I}=t.fetchData,p=function(t){try{let n=new URL(t);return n.href}catch(t){return}}(I),m=p?o.parseUrl(p).host:void 0,h=c?i.startInactiveSpan({name:`${u} ${I}`,onlyIfParent:!0,attributes:{url:I,type:"fetch","http.method":u,"http.url":p,"server.address":m,[i.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:l},op:"http.client"}):void 0;if(h&&(t.fetchData.__span=h.spanContext().spanId,a[h.spanContext().spanId]=h),r(t.fetchData.url)&&d){let n=t.args[0];t.args[1]=t.args[1]||{};let r=t.args[1];r.headers=addTracingHeadersToFetchRequest(n,d,g,r,h)}return h}},98734:(t,n,r)=>{t=r.nmd(t),Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277);n.addExtensionMethods=function(){i.addTracingExtensions(),o.isNodeEnv()&&function(){let n=i.getMainCarrier();if(!n.__SENTRY__)return;let r={mongodb(){let n=o.dynamicRequire(t,"./node/integrations/mongo");return new n.Mongo},mongoose(){let n=o.dynamicRequire(t,"./node/integrations/mongo");return new n.Mongo},mysql(){let n=o.dynamicRequire(t,"./node/integrations/mysql");return new n.Mysql},pg(){let n=o.dynamicRequire(t,"./node/integrations/postgres");return new n.Postgres}},a=Object.keys(r).filter(t=>!!o.loadModule(t)).map(t=>{try{return r[t]()}catch(t){return}}).filter(t=>t);a.length>0&&(n.__SENTRY__.integrations=[...n.__SENTRY__.integrations||[],...a])}()}},32798:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(13331),l=r(30347),c=r(37026),g=r(54647),d=r(75398),u=r(87984),I=r(42146),p=r(80624),m=r(50032),h=r(79179),C=r(53760),b=r(61241),y=r(23763),G=r(98734);n.IdleTransaction=i.IdleTransaction,n.Span=i.Span,n.SpanStatus=i.SpanStatus,n.Transaction=i.Transaction,n.extractTraceparentData=i.extractTraceparentData,n.getActiveTransaction=i.getActiveTransaction,n.hasTracingEnabled=i.hasTracingEnabled,n.spanStatusfromHttpCode=i.spanStatusfromHttpCode,n.startIdleTransaction=i.startIdleTransaction,n.TRACEPARENT_REGEXP=o.TRACEPARENT_REGEXP,n.stripUrlQueryAndFragment=o.stripUrlQueryAndFragment,n.Express=a.Express,n.Postgres=l.Postgres,n.Mysql=c.Mysql,n.Mongo=g.Mongo,n.Prisma=d.Prisma,n.GraphQL=u.GraphQL,n.Apollo=I.Apollo,n.lazyLoadedNodePerformanceMonitoringIntegrations=p.lazyLoadedNodePerformanceMonitoringIntegrations,n.BROWSER_TRACING_INTEGRATION_ID=m.BROWSER_TRACING_INTEGRATION_ID,n.BrowserTracing=m.BrowserTracing,n.browserTracingIntegration=h.browserTracingIntegration,n.startBrowserTracingNavigationSpan=h.startBrowserTracingNavigationSpan,n.startBrowserTracingPageLoadSpan=h.startBrowserTracingPageLoadSpan,n.defaultRequestInstrumentationOptions=C.defaultRequestInstrumentationOptions,n.instrumentOutgoingRequests=C.instrumentOutgoingRequests,n.addClsInstrumentationHandler=b.addClsInstrumentationHandler,n.addFidInstrumentationHandler=b.addFidInstrumentationHandler,n.addLcpInstrumentationHandler=b.addLcpInstrumentationHandler,n.addPerformanceInstrumentationHandler=b.addPerformanceInstrumentationHandler,n.addTracingHeadersToFetchRequest=y.addTracingHeadersToFetchRequest,n.instrumentFetchRequest=y.instrumentFetchRequest,n.addExtensionMethods=G.addExtensionMethods},42146:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277),a=r(11253),l=r(88591);let Apollo=class Apollo{static __initStatic(){this.id="Apollo"}constructor(t={useNestjs:!1}){this.name=Apollo.id,this._useNest=!!t.useNestjs}loadDependency(){return this._useNest?this._module=this._module||o.loadModule("@nestjs/graphql"):this._module=this._module||o.loadModule("apollo-server-core"),this._module}setupOnce(t,n){if(l.shouldDisableAutoInstrumentation(n)){a.DEBUG_BUILD&&o.logger.log("Apollo Integration is skipped because of instrumenter configuration.");return}if(this._useNest){let t=this.loadDependency();if(!t){a.DEBUG_BUILD&&o.logger.error("Apollo-NestJS Integration was unable to require @nestjs/graphql package.");return}o.fill(t.GraphQLFactory.prototype,"mergeWithSchema",function(t){return function(...r){return o.fill(this.resolversExplorerService,"explore",function(t){return function(){let r=o.arrayify(t.call(this)),i=instrumentResolvers(r,n);return i}}),t.call(this,...r)}})}else{let t=this.loadDependency();if(!t){a.DEBUG_BUILD&&o.logger.error("Apollo Integration was unable to require apollo-server-core package.");return}o.fill(t.ApolloServerBase.prototype,"constructSchema",function(t){return function(){if(!this.config.resolvers)return a.DEBUG_BUILD&&(this.config.schema?(o.logger.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `schema` property.If you are using NestJS with Apollo, please use `Sentry.Integrations.Apollo({ useNestjs: true })` instead."),o.logger.warn()):this.config.modules&&o.logger.warn("Apollo integration is not able to trace `ApolloServer` instances constructed via `modules` property."),o.logger.error("Skipping tracing as no resolvers found on the `ApolloServer` instance.")),t.call(this);let r=o.arrayify(this.config.resolvers);return this.config.resolvers=instrumentResolvers(r,n),t.call(this)}})}}};function instrumentResolvers(t,n){return t.map(t=>(Object.keys(t).forEach(r=>{Object.keys(t[r]).forEach(a=>{if("function"==typeof t[r][a])o.fill(t[r],a,function(t){return function(...l){let c=n().getScope(),g=c.getSpan(),d=i([g,"optionalAccess",t=>t.startChild,"call",t=>t({description:`${r}.${a}`,op:"graphql.resolve",origin:"auto.graphql.apollo"})]),u=t.call(this,...l);return o.isThenable(u)?u.then(t=>(i([d,"optionalAccess",t=>t.end,"call",t=>t()]),t)):(i([d,"optionalAccess",t=>t.end,"call",t=>t()]),u)}})})}),t))}Apollo.__initStatic(),n.Apollo=Apollo},13331:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(11253),c=r(88591);let Express=class Express{static __initStatic(){this.id="Express"}constructor(t={}){this.name=Express.id,this._router=t.router||t.app,this._methods=(Array.isArray(t.methods)?t.methods:[]).concat("use")}setupOnce(t,n){if(!this._router){l.DEBUG_BUILD&&a.logger.error("ExpressIntegration is missing an Express instance");return}if(c.shouldDisableAutoInstrumentation(n)){l.DEBUG_BUILD&&a.logger.log("Express Integration is skipped because of instrumenter configuration.");return}(function(t,n=[]){n.forEach(n=>(function(t,n){let r=t[n];return t[n]=function(...t){return r.call(this,...t.map(t=>"function"==typeof t?wrap(t,n):Array.isArray(t)?t.map(t=>"function"==typeof t?wrap(t,n):t):t))},t})(t,n))})(this._router,this._methods),function(t){let n="settings"in t;n&&void 0===t._router&&t.lazyrouter&&t.lazyrouter();let r=n?t._router:t;if(!r){l.DEBUG_BUILD&&a.logger.debug("Cannot instrument router for URL Parameterization (did not find a valid router)."),l.DEBUG_BUILD&&a.logger.debug("Routing instrumentation is currently only supported in Express 4.");return}let c=Object.getPrototypeOf(r),g=c.process_params;c.process_params=function(t,n,r,l,c){let d;r._reconstructedRoute||(r._reconstructedRoute="");let{layerRoutePath:u,isRegex:I,isArray:p,numExtraSegments:m}=function(t){var n;let r=i([t,"access",t=>t.route,"optionalAccess",t=>t.path]),o=a.isRegExp(r),l=Array.isArray(r);if(!r){let[n]=a.GLOBAL_OBJ.process.versions.node.split(".").map(Number);n>=16&&(r=extractOriginalRoute(t.path,t.regexp,t.keys))}if(!r)return{isRegex:o,isArray:l,numExtraSegments:0};let c=l?Math.max(r.reduce((t,n)=>t+a.getNumberOfUrlSegments(n.toString()),0)-a.getNumberOfUrlSegments(t.path||""),0):0,g=(n=r,l?n.map(t=>t.toString()).join(","):n&&n.toString());return{layerRoutePath:g,isRegex:o,isArray:l,numExtraSegments:c}}(t);(u||I||p)&&(r._hasParameters=!0),d=u||preventDuplicateSegments(r.originalUrl,r._reconstructedRoute,t.path)||"";let h=d.split("/").filter(t=>t.length>0&&(I||p||!t.includes("*"))).join("/");h&&h.length>0&&(r._reconstructedRoute+=`/${h}${I?"/":""}`);let C=a.getNumberOfUrlSegments(a.stripUrlQueryAndFragment(r.originalUrl||""))+m,b=a.getNumberOfUrlSegments(r._reconstructedRoute);if(C===b){r._hasParameters||r._reconstructedRoute===r.originalUrl||(r._reconstructedRoute=r.originalUrl?a.stripUrlQueryAndFragment(r.originalUrl):r.originalUrl);let t=l.__sentry_transaction,n=t&&o.spanToJSON(t).data||{};if(t&&"custom"!==n[o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]){let n=r._reconstructedRoute||"/",[i,l]=a.extractPathForTransaction(r,{path:!0,method:!0,customRoute:n});t.updateName(i),t.setAttribute(o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,l)}}return g.call(this,t,n,r,l,c)}}(this._router)}};function wrap(t,n){let r=t.length;switch(r){case 2:return function(r,i){let o=i.__sentry_transaction;if(o){let r=o.startChild({description:t.name,op:`middleware.express.${n}`,origin:"auto.middleware.express"});i.once("finish",()=>{r.end()})}return t.call(this,r,i)};case 3:return function(r,o,a){let l=o.__sentry_transaction,c=i([l,"optionalAccess",t=>t.startChild,"call",r=>r({description:t.name,op:`middleware.express.${n}`,origin:"auto.middleware.express"})]);t.call(this,r,o,function(...t){i([c,"optionalAccess",t=>t.end,"call",t=>t()]),a.call(this,...t)})};case 4:return function(r,o,a,l){let c=a.__sentry_transaction,g=i([c,"optionalAccess",t=>t.startChild,"call",r=>r({description:t.name,op:`middleware.express.${n}`,origin:"auto.middleware.express"})]);t.call(this,r,o,a,function(...t){i([g,"optionalAccess",t=>t.end,"call",t=>t()]),l.call(this,...t)})};default:throw Error(`Express middleware takes 2-4 arguments. Got: ${r}`)}}Express.__initStatic();let extractOriginalRoute=(t,n,r)=>{if(!t||!n||!r||0===Object.keys(r).length||void 0===i([r,"access",t=>t[0],"optionalAccess",t=>t.offset])||null===i([r,"access",t=>t[0],"optionalAccess",t=>t.offset]))return;let o=r.sort((t,n)=>t.offset-n.offset),a=RegExp(n,`${n.flags}d`),l=a.exec(t);if(!l||!l.indices)return;let[,...c]=l.indices;if(c.length!==o.length)return;let g=t,d=0;return c.forEach((t,n)=>{if(t){let[r,i]=t,a=g.substring(0,r-d),l=`:${o[n].name}`,c=g.substring(i-d);g=a+l+c,d+=i-r-l.length}}),g};function preventDuplicateSegments(t,n,r){let o=a.stripUrlQueryAndFragment(t||""),l=i([o,"optionalAccess",t=>t.split,"call",t=>t("/"),"access",t=>t.filter,"call",t=>t(t=>!!t)]),c=0,g=i([n,"optionalAccess",t=>t.split,"call",t=>t("/"),"access",t=>t.filter,"call",t=>t(t=>!!t),"access",t=>t.length])||0,d=i([r,"optionalAccess",t=>t.split,"call",t=>t("/"),"access",t=>t.filter,"call",t=>t(t=>i([l,"optionalAccess",t=>t[g+c]])===t&&(c+=1,!0)),"access",t=>t.join,"call",t=>t("/")]);return d}n.Express=Express,n.extractOriginalRoute=extractOriginalRoute,n.preventDuplicateSegments=preventDuplicateSegments},87984:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277),a=r(11253),l=r(88591);let GraphQL=class GraphQL{static __initStatic(){this.id="GraphQL"}constructor(){this.name=GraphQL.id}loadDependency(){return this._module=this._module||o.loadModule("graphql/execution/execute.js")}setupOnce(t,n){if(l.shouldDisableAutoInstrumentation(n)){a.DEBUG_BUILD&&o.logger.log("GraphQL Integration is skipped because of instrumenter configuration.");return}let r=this.loadDependency();if(!r){a.DEBUG_BUILD&&o.logger.error("GraphQL Integration was unable to require graphql/execution package.");return}o.fill(r,"execute",function(t){return function(...r){let a=n().getScope(),l=a.getSpan(),c=i([l,"optionalAccess",t=>t.startChild,"call",t=>t({description:"execute",op:"graphql.execute",origin:"auto.graphql.graphql"})]);i([a,"optionalAccess",t=>t.setSpan,"call",t=>t(c)]);let g=t.call(this,...r);return o.isThenable(g)?g.then(t=>(i([c,"optionalAccess",t=>t.end,"call",t=>t()]),i([a,"optionalAccess",t=>t.setSpan,"call",t=>t(l)]),t)):(i([c,"optionalAccess",t=>t.end,"call",t=>t()]),i([a,"optionalAccess",t=>t.setSpan,"call",t=>t(l)]),g)}})}};GraphQL.__initStatic(),n.GraphQL=GraphQL},80624:(t,n,r)=>{t=r.nmd(t),Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=[()=>{let n=i.dynamicRequire(t,"./apollo");return new n.Apollo},()=>{let n=i.dynamicRequire(t,"./apollo");return new n.Apollo({useNestjs:!0})},()=>{let n=i.dynamicRequire(t,"./graphql");return new n.GraphQL},()=>{let n=i.dynamicRequire(t,"./mongo");return new n.Mongo},()=>{let n=i.dynamicRequire(t,"./mongo");return new n.Mongo({mongoose:!0})},()=>{let n=i.dynamicRequire(t,"./mysql");return new n.Mysql},()=>{let n=i.dynamicRequire(t,"./postgres");return new n.Postgres}];n.lazyLoadedNodePerformanceMonitoringIntegrations=o},54647:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277),a=r(11253),l=r(88591),c=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],g={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};let Mongo=class Mongo{static __initStatic(){this.id="Mongo"}constructor(t={}){this.name=Mongo.id,this._operations=Array.isArray(t.operations)?t.operations:c,this._describeOperations=!("describeOperations"in t)||t.describeOperations,this._useMongoose=!!t.useMongoose}loadDependency(){let t=this._useMongoose?"mongoose":"mongodb";return this._module=this._module||o.loadModule(t)}setupOnce(t,n){if(l.shouldDisableAutoInstrumentation(n)){a.DEBUG_BUILD&&o.logger.log("Mongo Integration is skipped because of instrumenter configuration.");return}let r=this.loadDependency();if(!r){let t=this._useMongoose?"mongoose":"mongodb";a.DEBUG_BUILD&&o.logger.error(`Mongo Integration was unable to require \`${t}\` package.`);return}this._instrumentOperations(r.Collection,this._operations,n)}_instrumentOperations(t,n,r){n.forEach(n=>this._patchOperation(t,n,r))}_patchOperation(t,n,r){if(!(n in t.prototype))return;let a=this._getSpanContextFromOperationArguments.bind(this);o.fill(t.prototype,n,function(t){return function(...l){let c=l[l.length-1],g=r(),d=g.getScope(),u=g.getClient(),I=d.getSpan(),p=i([u,"optionalAccess",t=>t.getOptions,"call",t=>t(),"access",t=>t.sendDefaultPii]);if("function"!=typeof c||"mapReduce"===n&&2===l.length){let r=i([I,"optionalAccess",t=>t.startChild,"call",t=>t(a(this,n,l,p))]),c=t.call(this,...l);if(o.isThenable(c))return c.then(t=>(i([r,"optionalAccess",t=>t.end,"call",t=>t()]),t));if(!c||"object"!=typeof c||!c.once||"function"!=typeof c.once)return i([r,"optionalAccess",t=>t.end,"call",t=>t()]),c;try{c.once("close",()=>{i([r,"optionalAccess",t=>t.end,"call",t=>t()])})}catch(t){i([r,"optionalAccess",t=>t.end,"call",t=>t()])}return c}let m=i([I,"optionalAccess",t=>t.startChild,"call",t=>t(a(this,n,l.slice(0,-1)))]);return t.call(this,...l.slice(0,-1),function(t,n){i([m,"optionalAccess",t=>t.end,"call",t=>t()]),c(t,n)})}})}_getSpanContextFromOperationArguments(t,n,r,i=!1){let o={"db.system":"mongodb","db.name":t.dbName,"db.operation":n,"db.mongodb.collection":t.collectionName},a={op:"db",origin:"auto.db.mongo",description:n,data:o},l=g[n],c=Array.isArray(this._describeOperations)?this._describeOperations.includes(n):this._describeOperations;if(!l||!c||!i)return a;try{if("mapReduce"===n){let[t,n]=r;o[l[0]]="string"==typeof t?t:t.name||"<anonymous>",o[l[1]]="string"==typeof n?n:n.name||"<anonymous>"}else for(let t=0;t<l.length;t++)o[`db.mongodb.${l[t]}`]=JSON.stringify(r[t])}catch(t){}return a}};Mongo.__initStatic(),n.Mongo=Mongo},37026:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277),a=r(11253),l=r(88591);let Mysql=class Mysql{static __initStatic(){this.id="Mysql"}constructor(){this.name=Mysql.id}loadDependency(){return this._module=this._module||o.loadModule("mysql/lib/Connection.js")}setupOnce(t,n){let r;if(l.shouldDisableAutoInstrumentation(n)){a.DEBUG_BUILD&&o.logger.log("Mysql Integration is skipped because of instrumenter configuration.");return}let c=this.loadDependency();if(!c){a.DEBUG_BUILD&&o.logger.error("Mysql Integration was unable to require `mysql` package.");return}try{c.prototype.connect=new Proxy(c.prototype.connect,{apply:(t,n,i)=>(r||(r=n.config),t.apply(n,i))})}catch(t){a.DEBUG_BUILD&&o.logger.error("Mysql Integration was unable to instrument `mysql` config.")}function finishSpan(t){if(!t)return;let n=r?{"server.address":r.host,"server.port":r.port,"db.user":r.user}:{};Object.keys(n).forEach(r=>{t.setAttribute(r,n[r])}),t.end()}o.fill(c,"createQuery",function(t){return function(r,o,a){let l=n().getScope(),c=l.getSpan(),g=i([c,"optionalAccess",t=>t.startChild,"call",t=>t({description:"string"==typeof r?r:r.sql,op:"db",origin:"auto.db.mysql",data:{"db.system":"mysql"}})]);if("function"==typeof a)return t.call(this,r,o,function(t,n,r){finishSpan(g),a(t,n,r)});if("function"==typeof o)return t.call(this,r,function(t,n,r){finishSpan(g),o(t,n,r)});let d=t.call(this,r,o);return d.on("end",()=>{finishSpan(g)}),d}})}};Mysql.__initStatic(),n.Mysql=Mysql},30347:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277),a=r(11253),l=r(88591);let Postgres=class Postgres{static __initStatic(){this.id="Postgres"}constructor(t={}){this.name=Postgres.id,this._usePgNative=!!t.usePgNative,this._module=t.module}loadDependency(){return this._module=this._module||o.loadModule("pg")}setupOnce(t,n){if(l.shouldDisableAutoInstrumentation(n)){a.DEBUG_BUILD&&o.logger.log("Postgres Integration is skipped because of instrumenter configuration.");return}let r=this.loadDependency();if(!r){a.DEBUG_BUILD&&o.logger.error("Postgres Integration was unable to require `pg` package.");return}let c=this._usePgNative?i([r,"access",t=>t.native,"optionalAccess",t=>t.Client]):r.Client;if(!c){a.DEBUG_BUILD&&o.logger.error("Postgres Integration was unable to access 'pg-native' bindings.");return}o.fill(c.prototype,"query",function(t){return function(r,a,l){let c=n().getScope(),g=c.getSpan(),d={"db.system":"postgresql"};try{this.database&&(d["db.name"]=this.database),this.host&&(d["server.address"]=this.host),this.port&&(d["server.port"]=this.port),this.user&&(d["db.user"]=this.user)}catch(t){}let u=i([g,"optionalAccess",t=>t.startChild,"call",t=>t({description:"string"==typeof r?r:r.text,op:"db",origin:"auto.db.postgres",data:d})]);if("function"==typeof l)return t.call(this,r,a,function(t,n){i([u,"optionalAccess",t=>t.end,"call",t=>t()]),l(t,n)});if("function"==typeof a)return t.call(this,r,function(t,n){i([u,"optionalAccess",t=>t.end,"call",t=>t()]),a(t,n)});let I=void 0!==a?t.call(this,r,a):t.call(this,r);return o.isThenable(I)?I.then(t=>(i([u,"optionalAccess",t=>t.end,"call",t=>t()]),t)):(i([u,"optionalAccess",t=>t.end,"call",t=>t()]),I)}})}};Postgres.__initStatic(),n.Postgres=Postgres},75398:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(11253),l=r(88591);let Prisma=class Prisma{static __initStatic(){this.id="Prisma"}constructor(t={}){if(this.name=Prisma.id,function(t){return!!t&&!!t.$use}(t.client)&&!t.client._sentryInstrumented){o.addNonEnumerableProperty(t.client,"_sentryInstrumented",!0);let n={};try{let r=t.client._engineConfig;if(r){let{activeProvider:t,clientVersion:i}=r;t&&(n["db.system"]=t),i&&(n["db.prisma.version"]=i)}}catch(t){}t.client.$use((t,r)=>{if(l.shouldDisableAutoInstrumentation(i.getCurrentHub))return r(t);let o=t.action,a=t.model;return i.startSpan({name:a?`${a} ${o}`:o,onlyIfParent:!0,op:"db.prisma",attributes:{[i.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.db.prisma"},data:{...n,"db.operation":o}},()=>r(t))})}else a.DEBUG_BUILD&&o.logger.warn("Unsupported Prisma client provided to PrismaIntegration. Provided client:",t.client)}setupOnce(){}};Prisma.__initStatic(),n.Prisma=Prisma},88591:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0}),n.shouldDisableAutoInstrumentation=function(t){let n=i([t,"call",t=>t(),"access",t=>t.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]),r=i([n,"optionalAccess",t=>t.instrumenter])||"sentry";return"sentry"!==r}},75931:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);function getBaseApiEndpoint(t){let n=t.protocol?`${t.protocol}:`:"",r=t.port?`:${t.port}`:"";return`${n}//${t.host}${r}${t.path?`/${t.path}`:""}/api/`}n.getEnvelopeEndpointWithUrlEncodedAuth=function(t,n={}){let r="string"==typeof n?n:n.tunnel,o="string"!=typeof n&&n._metadata?n._metadata.sdk:void 0;return r||`${getBaseApiEndpoint(t)}${t.projectId}/envelope/?${i.urlEncode({sentry_key:t.publicKey,sentry_version:"7",...o&&{sentry_client:`${o.name}/${o.version}`}})}`},n.getReportDialogEndpoint=function(t,n){let r=i.makeDsn(t);if(!r)return"";let o=`${getBaseApiEndpoint(r)}embed/error-page/`,a=`dsn=${i.dsnToString(r)}`;for(let t in n)if("dsn"!==t&&"onClose"!==t){if("user"===t){let t=n.user;if(!t)continue;t.name&&(a+=`&name=${encodeURIComponent(t.name)}`),t.email&&(a+=`&email=${encodeURIComponent(t.email)}`)}else a+=`&${encodeURIComponent(t)}=${encodeURIComponent(n[t])}`}return`${o}?${a}`}},44893:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(75931),a=r(92548),l=r(20031),c=r(14455),g=r(63634),d=r(48323),u=r(6675),I=r(26231),p=r(58913),m=r(69e3),h="Not capturing exception because it's already been captured.";function isErrorEvent(t){return void 0===t.type}function isTransactionEvent(t){return"transaction"===t.type}n.BaseClient=class{constructor(t){if(this._options=t,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],t.dsn?this._dsn=i.makeDsn(t.dsn):a.DEBUG_BUILD&&i.logger.warn("No DSN provided, client will not send events."),this._dsn){let n=o.getEnvelopeEndpointWithUrlEncodedAuth(this._dsn,t);this._transport=t.transport({tunnel:this._options.tunnel,recordDroppedEvent:this.recordDroppedEvent.bind(this),...t.transportOptions,url:n})}}captureException(t,n,r){if(i.checkOrSetAlreadyCaught(t)){a.DEBUG_BUILD&&i.logger.log(h);return}let o=n&&n.event_id;return this._process(this.eventFromException(t,n).then(t=>this._captureEvent(t,n,r)).then(t=>{o=t})),o}captureMessage(t,n,r,o){let a=r&&r.event_id,l=i.isParameterizedString(t)?t:String(t),c=i.isPrimitive(t)?this.eventFromMessage(l,n,r):this.eventFromException(t,r);return this._process(c.then(t=>this._captureEvent(t,r,o)).then(t=>{a=t})),a}captureEvent(t,n,r){if(n&&n.originalException&&i.checkOrSetAlreadyCaught(n.originalException)){a.DEBUG_BUILD&&i.logger.log(h);return}let o=n&&n.event_id,l=t.sdkProcessingMetadata||{},c=l.capturedSpanScope;return this._process(this._captureEvent(t,n,c||r).then(t=>{o=t})),o}captureSession(t){"string"!=typeof t.release?a.DEBUG_BUILD&&i.logger.warn("Discarded session because of missing or non-string release"):(this.sendSession(t),I.updateSession(t,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(t){let n=this._transport;return n?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(t).then(r=>n.flush(t).then(t=>r&&t))):i.resolvedSyncPromise(!0)}close(t){return this.flush(t).then(t=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),t))}getEventProcessors(){return this._eventProcessors}addEventProcessor(t){this._eventProcessors.push(t)}setupIntegrations(t){(t&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(t){return this.getIntegrationByName(t)}getIntegrationByName(t){return this._integrations[t]}getIntegration(t){try{return this._integrations[t.id]||null}catch(n){return a.DEBUG_BUILD&&i.logger.warn(`Cannot retrieve integration ${t.id} from the current Client`),null}}addIntegration(t){let n=this._integrations[t.name];d.setupIntegration(this,t,this._integrations),n||d.afterSetupIntegrations(this,[t])}sendEvent(t,n={}){this.emit("beforeSendEvent",t,n);let r=l.createEventEnvelope(t,this._dsn,this._options._metadata,this._options.tunnel);for(let t of n.attachments||[])r=i.addItemToEnvelope(r,i.createAttachmentEnvelopeItem(t,this._options.transportOptions&&this._options.transportOptions.textEncoder));let o=this._sendEnvelope(r);o&&o.then(n=>this.emit("afterSendEvent",t,n),null)}sendSession(t){let n=l.createSessionEnvelope(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}recordDroppedEvent(t,n,r){if(this._options.sendClientReports){let o="number"==typeof r?r:1,l=`${t}:${n}`;a.DEBUG_BUILD&&i.logger.log(`Recording outcome: "${l}"${o>1?` (${o} times)`:""}`),this._outcomes[l]=(this._outcomes[l]||0)+o}}captureAggregateMetrics(t){a.DEBUG_BUILD&&i.logger.log(`Flushing aggregated metrics, number of metrics: ${t.length}`);let n=u.createMetricEnvelope(t,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(n)}on(t,n){this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(n)}emit(t,...n){this._hooks[t]&&this._hooks[t].forEach(t=>t(...n))}_setupIntegrations(){let{integrations:t}=this._options;this._integrations=d.setupIntegrations(this,t),d.afterSetupIntegrations(this,t),this._integrationsInitialized=!0}_updateSessionFromEvent(t,n){let r=!1,i=!1,o=n.exception&&n.exception.values;if(o)for(let t of(i=!0,o)){let n=t.mechanism;if(n&&!1===n.handled){r=!0;break}}let a="ok"===t.status,l=a&&0===t.errors||a&&r;l&&(I.updateSession(t,{...r&&{status:"crashed"},errors:t.errors||Number(i||r)}),this.captureSession(t))}_isClientDoneProcessing(t){return new i.SyncPromise(n=>{let r=0,i=setInterval(()=>{0==this._numProcessing?(clearInterval(i),n(!0)):(r+=1,t&&r>=t&&(clearInterval(i),n(!1)))},1)})}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(t,n,r,i=g.getIsolationScope()){let o=this.getOptions(),a=Object.keys(this._integrations);return!n.integrations&&a.length>0&&(n.integrations=a),this.emit("preprocessEvent",t,n),m.prepareEvent(o,t,n,r,this,i).then(t=>{if(null===t)return t;let n={...i.getPropagationContext(),...r?r.getPropagationContext():void 0},o=t.contexts&&t.contexts.trace;if(!o&&n){let{traceId:i,spanId:o,parentSpanId:a,dsc:l}=n;t.contexts={trace:{trace_id:i,span_id:o,parent_span_id:a},...t.contexts};let c=l||p.getDynamicSamplingContextFromClient(i,this,r);t.sdkProcessingMetadata={dynamicSamplingContext:c,...t.sdkProcessingMetadata}}return t})}_captureEvent(t,n={},r){return this._processEvent(t,n,r).then(t=>t.event_id,t=>{a.DEBUG_BUILD&&("log"===t.logLevel?i.logger.log(t.message):i.logger.warn(t))})}_processEvent(t,n,r){let o=this.getOptions(),{sampleRate:a}=o,l=isTransactionEvent(t),c=isErrorEvent(t),g=t.type||"error",d=`before send for type \`${g}\``;if(c&&"number"==typeof a&&Math.random()>a)return this.recordDroppedEvent("sample_rate","error",t),i.rejectedSyncPromise(new i.SentryError(`Discarding event because it's not included in the random sample (sampling rate = ${a})`,"log"));let u="replay_event"===g?"replay":g,I=t.sdkProcessingMetadata||{},p=I.capturedSpanIsolationScope;return this._prepareEvent(t,n,r,p).then(r=>{if(null===r)throw this.recordDroppedEvent("event_processor",u,t),new i.SentryError("An event processor returned `null`, will not send event.","log");let a=n.data&&!0===n.data.__sentry__;if(a)return r;let l=function(t,n,r){let{beforeSend:i,beforeSendTransaction:o}=t;if(isErrorEvent(n)&&i)return i(n,r);if(isTransactionEvent(n)&&o){if(n.spans){let t=n.spans.length;n.sdkProcessingMetadata={...n.sdkProcessingMetadata,spanCountBeforeProcessing:t}}return o(n,r)}return n}(o,r,n);return function(t,n){let r=`${n} must return \`null\` or a valid event.`;if(i.isThenable(t))return t.then(t=>{if(!i.isPlainObject(t)&&null!==t)throw new i.SentryError(r);return t},t=>{throw new i.SentryError(`${n} rejected with ${t}`)});if(!i.isPlainObject(t)&&null!==t)throw new i.SentryError(r);return t}(l,d)}).then(o=>{if(null===o){if(this.recordDroppedEvent("before_send",u,t),l){let n=t.spans||[],r=1+n.length;this.recordDroppedEvent("before_send","span",r)}throw new i.SentryError(`${d} returned \`null\`, will not send event.`,"log")}let a=r&&r.getSession();if(!l&&a&&this._updateSessionFromEvent(a,o),l){let t=o.sdkProcessingMetadata&&o.sdkProcessingMetadata.spanCountBeforeProcessing||0,n=o.spans?o.spans.length:0,r=t-n;r>0&&this.recordDroppedEvent("before_send","span",r)}let c=o.transaction_info;return l&&c&&o.transaction!==t.transaction&&(o.transaction_info={...c,source:"custom"}),this.sendEvent(o,n),o}).then(null,t=>{if(t instanceof i.SentryError)throw t;throw this.captureException(t,{data:{__sentry__:!0},originalException:t}),new i.SentryError(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${t}`)})}_process(t){this._numProcessing++,t.then(t=>(this._numProcessing--,t),t=>(this._numProcessing--,t))}_sendEnvelope(t){if(this.emit("beforeEnvelope",t),this._isEnabled()&&this._transport)return this._transport.send(t).then(null,t=>{a.DEBUG_BUILD&&i.logger.error("Error while sending event:",t)});a.DEBUG_BUILD&&i.logger.error("Transport disabled")}_clearOutcomes(){let t=this._outcomes;return this._outcomes={},Object.keys(t).map(n=>{let[r,i]=n.split(":");return{reason:r,category:i,quantity:t[n]}})}},n.addEventProcessor=function(t){let n=c.getClient();n&&n.addEventProcessor&&n.addEventProcessor(t)}},15773:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);n.createCheckInEnvelope=function(t,n,r,o,a){let l={sent_at:new Date().toISOString()};r&&r.sdk&&(l.sdk={name:r.sdk.name,version:r.sdk.version}),o&&a&&(l.dsn=i.dsnToString(a)),n&&(l.trace=i.dropUndefinedKeys(n));let c=[{type:"check_in"},t];return i.createEnvelope(l,[c])}},68799:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_ENVIRONMENT="production"},92548:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;n.DEBUG_BUILD=r},20031:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);n.createEventEnvelope=function(t,n,r,o){var a;let l=i.getSdkMetadataForEnvelopeHeader(r),c=t.type&&"replay_event"!==t.type?t.type:"event";(a=r&&r.sdk)&&(t.sdk=t.sdk||{},t.sdk.name=t.sdk.name||a.name,t.sdk.version=t.sdk.version||a.version,t.sdk.integrations=[...t.sdk.integrations||[],...a.integrations||[]],t.sdk.packages=[...t.sdk.packages||[],...a.packages||[]]);let g=i.createEventEnvelopeHeaders(t,l,o,n);delete t.sdkProcessingMetadata;let d=[{type:c},t];return i.createEnvelope(g,[d])},n.createSessionEnvelope=function(t,n,r,o){let a=i.getSdkMetadataForEnvelopeHeader(r),l={sent_at:new Date().toISOString(),...a&&{sdk:a},...!!o&&n&&{dsn:i.dsnToString(n)}},c="aggregates"in t?[{type:"sessions"},t]:[{type:"session"},t.toJSON()];return i.createEnvelope(l,[c])}},68804:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548);function getGlobalEventProcessors(){return i.getGlobalSingleton("globalEventProcessors",()=>[])}n.addGlobalEventProcessor=function(t){getGlobalEventProcessors().push(t)},n.getGlobalEventProcessors=getGlobalEventProcessors,n.notifyEventProcessors=function notifyEventProcessors(t,n,r,a=0){return new i.SyncPromise((l,c)=>{let g=t[a];if(null===n||"function"!=typeof g)l(n);else{let d=g({...n},r);o.DEBUG_BUILD&&g.id&&null===d&&i.logger.log(`Event processor "${g.id}" dropped event`),i.isThenable(d)?d.then(n=>notifyEventProcessors(t,n,r,a+1).then(l)).then(null,c):notifyEventProcessors(t,d,r,a+1).then(l).then(null,c)}})}},14455:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(68799),a=r(92548),l=r(63634),c=r(26231),g=r(69e3);function withScope(...t){let n=l.getCurrentHub();if(2===t.length){let[r,i]=t;return r?n.withScope(()=>(n.getStackTop().scope=r,i(r))):n.withScope(i)}return n.withScope(t[0])}function captureCheckIn(t,n){let r=getCurrentScope(),o=getClient();if(o){if(o.captureCheckIn)return o.captureCheckIn(t,n,r);a.DEBUG_BUILD&&i.logger.warn("Cannot capture check-in. Client does not support sending check-ins.")}else a.DEBUG_BUILD&&i.logger.warn("Cannot capture check-in. No client defined.");return i.uuid4()}async function flush(t){let n=getClient();return n?n.flush(t):(a.DEBUG_BUILD&&i.logger.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}async function close(t){let n=getClient();return n?n.close(t):(a.DEBUG_BUILD&&i.logger.warn("Cannot flush events and disable SDK. No client defined."),Promise.resolve(!1))}function getClient(){return l.getCurrentHub().getClient()}function getCurrentScope(){return l.getCurrentHub().getScope()}function endSession(){let t=l.getIsolationScope(),n=getCurrentScope(),r=n.getSession()||t.getSession();r&&c.closeSession(r),_sendSessionUpdate(),t.setSession(),n.setSession()}function _sendSessionUpdate(){let t=l.getIsolationScope(),n=getCurrentScope(),r=getClient(),i=n.getSession()||t.getSession();i&&r&&r.captureSession&&r.captureSession(i)}n.addBreadcrumb=function(t,n){l.getCurrentHub().addBreadcrumb(t,n)},n.captureCheckIn=captureCheckIn,n.captureEvent=function(t,n){return l.getCurrentHub().captureEvent(t,n)},n.captureException=function(t,n){return l.getCurrentHub().captureException(t,g.parseEventHintOrCaptureContext(n))},n.captureMessage=function(t,n){let r="string"==typeof n?n:void 0,i="string"!=typeof n?{captureContext:n}:void 0;return l.getCurrentHub().captureMessage(t,r,i)},n.captureSession=function(t=!1){if(t){endSession();return}_sendSessionUpdate()},n.close=close,n.configureScope=function(t){l.getCurrentHub().configureScope(t)},n.endSession=endSession,n.flush=flush,n.getClient=getClient,n.getCurrentScope=getCurrentScope,n.isInitialized=function(){return!!getClient()},n.lastEventId=function(){return l.getCurrentHub().lastEventId()},n.setContext=function(t,n){l.getCurrentHub().setContext(t,n)},n.setExtra=function(t,n){l.getCurrentHub().setExtra(t,n)},n.setExtras=function(t){l.getCurrentHub().setExtras(t)},n.setTag=function(t,n){l.getCurrentHub().setTag(t,n)},n.setTags=function(t){l.getCurrentHub().setTags(t)},n.setUser=function(t){l.getCurrentHub().setUser(t)},n.startSession=function(t){let n=getClient(),r=l.getIsolationScope(),a=getCurrentScope(),{release:g,environment:d=o.DEFAULT_ENVIRONMENT}=n&&n.getOptions()||{},{userAgent:u}=i.GLOBAL_OBJ.navigator||{},I=c.makeSession({release:g,environment:d,user:a.getUser()||r.getUser(),...u&&{userAgent:u},...t}),p=r.getSession();return p&&"ok"===p.status&&c.updateSession(p,{status:"exited"}),endSession(),r.setSession(I),a.setSession(I),I},n.startTransaction=function(t,n){return l.getCurrentHub().startTransaction({...t},n)},n.withActiveSpan=function(t,n){return withScope(r=>(r.setSpan(t),n(r)))},n.withIsolationScope=function(t){return l.runWithAsyncContext(()=>t(l.getIsolationScope()))},n.withMonitor=function(t,n,r){let o;let a=captureCheckIn({monitorSlug:t,status:"in_progress"},r),l=i.timestampInSeconds();function finishCheckIn(n){captureCheckIn({monitorSlug:t,status:n,checkInId:a,duration:i.timestampInSeconds()-l})}try{o=n()}catch(t){throw finishCheckIn("error"),t}return i.isThenable(o)?Promise.resolve(o).then(()=>{finishCheckIn("ok")},()=>{finishCheckIn("error")}):finishCheckIn("ok"),o},n.withScope=withScope},63634:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(68799),a=r(92548),l=r(88954),c=r(26231),g=r(41277),d=parseFloat(g.SDK_VERSION);let Hub=class Hub{constructor(t,n,r,i=d){let o,a;this._version=i,n?o=n:(o=new l.Scope).setClient(t),r?a=r:(a=new l.Scope).setClient(t),this._stack=[{scope:o}],t&&this.bindClient(t),this._isolationScope=a}isOlderThan(t){return this._version<t}bindClient(t){let n=this.getStackTop();n.client=t,n.scope.setClient(t),t&&t.setupIntegrations&&t.setupIntegrations()}pushScope(){let t=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:t}),t}popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}withScope(t){let n;let r=this.pushScope();try{n=t(r)}catch(t){throw this.popScope(),t}return i.isThenable(n)?n.then(t=>(this.popScope(),t),t=>{throw this.popScope(),t}):(this.popScope(),n)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(t,n){let r=this._lastEventId=n&&n.event_id?n.event_id:i.uuid4(),o=Error("Sentry syntheticException");return this.getScope().captureException(t,{originalException:t,syntheticException:o,...n,event_id:r}),r}captureMessage(t,n,r){let o=this._lastEventId=r&&r.event_id?r.event_id:i.uuid4(),a=Error(t);return this.getScope().captureMessage(t,n,{originalException:t,syntheticException:a,...r,event_id:o}),o}captureEvent(t,n){let r=n&&n.event_id?n.event_id:i.uuid4();return t.type||(this._lastEventId=r),this.getScope().captureEvent(t,{...n,event_id:r}),r}lastEventId(){return this._lastEventId}addBreadcrumb(t,n){let{scope:r,client:o}=this.getStackTop();if(!o)return;let{beforeBreadcrumb:a=null,maxBreadcrumbs:l=100}=o.getOptions&&o.getOptions()||{};if(l<=0)return;let c=i.dateTimestampInSeconds(),g={timestamp:c,...t},d=a?i.consoleSandbox(()=>a(g,n)):g;null!==d&&(o.emit&&o.emit("beforeAddBreadcrumb",d,n),r.addBreadcrumb(d,l))}setUser(t){this.getScope().setUser(t),this.getIsolationScope().setUser(t)}setTags(t){this.getScope().setTags(t),this.getIsolationScope().setTags(t)}setExtras(t){this.getScope().setExtras(t),this.getIsolationScope().setExtras(t)}setTag(t,n){this.getScope().setTag(t,n),this.getIsolationScope().setTag(t,n)}setExtra(t,n){this.getScope().setExtra(t,n),this.getIsolationScope().setExtra(t,n)}setContext(t,n){this.getScope().setContext(t,n),this.getIsolationScope().setContext(t,n)}configureScope(t){let{scope:n,client:r}=this.getStackTop();r&&t(n)}run(t){let n=makeMain(this);try{t(this)}finally{makeMain(n)}}getIntegration(t){let n=this.getClient();if(!n)return null;try{return n.getIntegration(t)}catch(n){return a.DEBUG_BUILD&&i.logger.warn(`Cannot retrieve integration ${t.id} from the current Hub`),null}}startTransaction(t,n){let r=this._callExtensionMethod("startTransaction",t,n);if(a.DEBUG_BUILD&&!r){let t=this.getClient();t?i.logger.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):i.logger.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")}return r}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(t=!1){if(t)return this.endSession();this._sendSessionUpdate()}endSession(){let t=this.getStackTop(),n=t.scope,r=n.getSession();r&&c.closeSession(r),this._sendSessionUpdate(),n.setSession()}startSession(t){let{scope:n,client:r}=this.getStackTop(),{release:a,environment:l=o.DEFAULT_ENVIRONMENT}=r&&r.getOptions()||{},{userAgent:g}=i.GLOBAL_OBJ.navigator||{},d=c.makeSession({release:a,environment:l,user:n.getUser(),...g&&{userAgent:g},...t}),u=n.getSession&&n.getSession();return u&&"ok"===u.status&&c.updateSession(u,{status:"exited"}),this.endSession(),n.setSession(d),d}shouldSendDefaultPii(){let t=this.getClient(),n=t&&t.getOptions();return!!(n&&n.sendDefaultPii)}_sendSessionUpdate(){let{scope:t,client:n}=this.getStackTop(),r=t.getSession();r&&n&&n.captureSession&&n.captureSession(r)}_callExtensionMethod(t,...n){let r=getMainCarrier(),o=r.__SENTRY__;if(o&&o.extensions&&"function"==typeof o.extensions[t])return o.extensions[t].apply(this,n);a.DEBUG_BUILD&&i.logger.warn(`Extension method ${t} couldn't be found, doing nothing.`)}};function getMainCarrier(){return i.GLOBAL_OBJ.__SENTRY__=i.GLOBAL_OBJ.__SENTRY__||{extensions:{},hub:void 0},i.GLOBAL_OBJ}function makeMain(t){let n=getMainCarrier(),r=getHubFromCarrier(n);return setHubOnCarrier(n,t),r}function getCurrentHub(){let t=getMainCarrier();if(t.__SENTRY__&&t.__SENTRY__.acs){let n=t.__SENTRY__.acs.getCurrentHub();if(n)return n}return getGlobalHub(t)}function getGlobalHub(t=getMainCarrier()){return(!hasHubOnCarrier(t)||getHubFromCarrier(t).isOlderThan(d))&&setHubOnCarrier(t,new Hub),getHubFromCarrier(t)}function hasHubOnCarrier(t){return!!(t&&t.__SENTRY__&&t.__SENTRY__.hub)}function getHubFromCarrier(t){return i.getGlobalSingleton("hub",()=>new Hub,t)}function setHubOnCarrier(t,n){if(!t)return!1;let r=t.__SENTRY__=t.__SENTRY__||{};return r.hub=n,!0}n.API_VERSION=d,n.Hub=Hub,n.ensureHubOnCarrier=function(t,n=getGlobalHub()){if(!hasHubOnCarrier(t)||getHubFromCarrier(t).isOlderThan(d)){let r=n.getClient(),i=n.getScope(),o=n.getIsolationScope();setHubOnCarrier(t,new Hub(r,i.clone(),o.clone()))}},n.getCurrentHub=getCurrentHub,n.getHubFromCarrier=getHubFromCarrier,n.getIsolationScope=function(){return getCurrentHub().getIsolationScope()},n.getMainCarrier=getMainCarrier,n.makeMain=makeMain,n.runWithAsyncContext=function(t,n={}){let r=getMainCarrier();return r.__SENTRY__&&r.__SENTRY__.acs?r.__SENTRY__.acs.runWithAsyncContext(t,n):t()},n.setAsyncContextStrategy=function(t){let n=getMainCarrier();n.__SENTRY__=n.__SENTRY__||{},n.__SENTRY__.acs=t},n.setHubOnCarrier=setHubOnCarrier},17961:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(39316),o=r(94982),a=r(83269),l=r(38534),c=r(35507),g=r(54703),d=r(62559),u=r(58913),I=r(42401),p=r(78047),m=r(70872),h=r(20031),C=r(14455),b=r(63634),y=r(26231),G=r(34429),A=r(88954),B=r(68804),Z=r(75931),f=r(44893),v=r(79426),W=r(70503),S=r(50253),R=r(79850),V=r(86021),H=r(41277),N=r(48323),Y=r(37924),X=r(69e3),E=r(15773),T=r(42416),_=r(52679),w=r(94192),F=r(88533),K=r(1265),x=r(87177),k=r(82288),U=r(67663),J=r(68799),L=r(64434),z=r(67674),P=r(9867),M=r(94184),O=r(606),j=r(68370),D=r(24515);n.addTracingExtensions=i.addTracingExtensions,n.startIdleTransaction=i.startIdleTransaction,n.IdleTransaction=o.IdleTransaction,n.TRACING_DEFAULTS=o.TRACING_DEFAULTS,n.Span=a.Span,n.Transaction=l.Transaction,n.extractTraceparentData=c.extractTraceparentData,n.getActiveTransaction=c.getActiveTransaction,Object.defineProperty(n,"SpanStatus",{enumerable:!0,get:()=>g.SpanStatus}),n.getSpanStatusFromHttpCode=g.getSpanStatusFromHttpCode,n.setHttpStatus=g.setHttpStatus,n.spanStatusfromHttpCode=g.spanStatusfromHttpCode,n.continueTrace=d.continueTrace,n.getActiveSpan=d.getActiveSpan,n.startActiveSpan=d.startActiveSpan,n.startInactiveSpan=d.startInactiveSpan,n.startSpan=d.startSpan,n.startSpanManual=d.startSpanManual,n.trace=d.trace,n.getDynamicSamplingContextFromClient=u.getDynamicSamplingContextFromClient,n.getDynamicSamplingContextFromSpan=u.getDynamicSamplingContextFromSpan,n.setMeasurement=I.setMeasurement,n.isValidSampleRate=p.isValidSampleRate,n.SEMANTIC_ATTRIBUTE_PROFILE_ID=m.SEMANTIC_ATTRIBUTE_PROFILE_ID,n.SEMANTIC_ATTRIBUTE_SENTRY_OP=m.SEMANTIC_ATTRIBUTE_SENTRY_OP,n.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=m.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN,n.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=m.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,n.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=m.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,n.createEventEnvelope=h.createEventEnvelope,n.createSessionEnvelope=h.createSessionEnvelope,n.addBreadcrumb=C.addBreadcrumb,n.captureCheckIn=C.captureCheckIn,n.captureEvent=C.captureEvent,n.captureException=C.captureException,n.captureMessage=C.captureMessage,n.captureSession=C.captureSession,n.close=C.close,n.configureScope=C.configureScope,n.endSession=C.endSession,n.flush=C.flush,n.getClient=C.getClient,n.getCurrentScope=C.getCurrentScope,n.isInitialized=C.isInitialized,n.lastEventId=C.lastEventId,n.setContext=C.setContext,n.setExtra=C.setExtra,n.setExtras=C.setExtras,n.setTag=C.setTag,n.setTags=C.setTags,n.setUser=C.setUser,n.startSession=C.startSession,n.startTransaction=C.startTransaction,n.withActiveSpan=C.withActiveSpan,n.withIsolationScope=C.withIsolationScope,n.withMonitor=C.withMonitor,n.withScope=C.withScope,n.Hub=b.Hub,n.ensureHubOnCarrier=b.ensureHubOnCarrier,n.getCurrentHub=b.getCurrentHub,n.getHubFromCarrier=b.getHubFromCarrier,n.getIsolationScope=b.getIsolationScope,n.getMainCarrier=b.getMainCarrier,n.makeMain=b.makeMain,n.runWithAsyncContext=b.runWithAsyncContext,n.setAsyncContextStrategy=b.setAsyncContextStrategy,n.setHubOnCarrier=b.setHubOnCarrier,n.closeSession=y.closeSession,n.makeSession=y.makeSession,n.updateSession=y.updateSession,n.SessionFlusher=G.SessionFlusher,n.Scope=A.Scope,n.getGlobalScope=A.getGlobalScope,n.setGlobalScope=A.setGlobalScope,n.addGlobalEventProcessor=B.addGlobalEventProcessor,n.notifyEventProcessors=B.notifyEventProcessors,n.getEnvelopeEndpointWithUrlEncodedAuth=Z.getEnvelopeEndpointWithUrlEncodedAuth,n.getReportDialogEndpoint=Z.getReportDialogEndpoint,n.BaseClient=f.BaseClient,n.addEventProcessor=f.addEventProcessor,n.ServerRuntimeClient=v.ServerRuntimeClient,n.initAndBind=W.initAndBind,n.setCurrentClient=W.setCurrentClient,n.createTransport=S.createTransport,n.makeOfflineTransport=R.makeOfflineTransport,n.makeMultiplexedTransport=V.makeMultiplexedTransport,n.SDK_VERSION=H.SDK_VERSION,n.addIntegration=N.addIntegration,n.convertIntegrationFnToClass=N.convertIntegrationFnToClass,n.defineIntegration=N.defineIntegration,n.getIntegrationsToSetup=N.getIntegrationsToSetup,n.applyScopeDataToEvent=Y.applyScopeDataToEvent,n.mergeScopeData=Y.mergeScopeData,n.prepareEvent=X.prepareEvent,n.createCheckInEnvelope=E.createCheckInEnvelope,n.createSpanEnvelope=T.createSpanEnvelope,n.hasTracingEnabled=_.hasTracingEnabled,n.isSentryRequestUrl=w.isSentryRequestUrl,n.handleCallbackErrors=F.handleCallbackErrors,n.parameterize=K.parameterize,n.spanIsSampled=x.spanIsSampled,n.spanToJSON=x.spanToJSON,n.spanToTraceContext=x.spanToTraceContext,n.spanToTraceHeader=x.spanToTraceHeader,n.getRootSpan=k.getRootSpan,n.applySdkMetadata=U.applySdkMetadata,n.DEFAULT_ENVIRONMENT=J.DEFAULT_ENVIRONMENT,n.ModuleMetadata=L.ModuleMetadata,n.moduleMetadataIntegration=L.moduleMetadataIntegration,n.RequestData=z.RequestData,n.requestDataIntegration=z.requestDataIntegration,n.InboundFilters=P.InboundFilters,n.inboundFiltersIntegration=P.inboundFiltersIntegration,n.FunctionToString=M.FunctionToString,n.functionToStringIntegration=M.functionToStringIntegration,n.LinkedErrors=O.LinkedErrors,n.linkedErrorsIntegration=O.linkedErrorsIntegration,n.metrics=D.metrics,n.Integrations=j},48323:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(68804),l=r(14455),c=r(63634),g=[];function setupIntegration(t,n,r){if(r[n.name]){o.DEBUG_BUILD&&i.logger.log(`Integration skipped because it was already installed: ${n.name}`);return}if(r[n.name]=n,-1===g.indexOf(n.name)&&(n.setupOnce(a.addGlobalEventProcessor,c.getCurrentHub),g.push(n.name)),n.setup&&"function"==typeof n.setup&&n.setup(t),t.on&&"function"==typeof n.preprocessEvent){let r=n.preprocessEvent.bind(n);t.on("preprocessEvent",(n,i)=>r(n,i,t))}if(t.addEventProcessor&&"function"==typeof n.processEvent){let r=n.processEvent.bind(n),i=Object.assign((n,i)=>r(n,i,t),{id:n.name});t.addEventProcessor(i)}o.DEBUG_BUILD&&i.logger.log(`Integration installed: ${n.name}`)}n.addIntegration=function(t){let n=l.getClient();if(!n||!n.addIntegration){o.DEBUG_BUILD&&i.logger.warn(`Cannot add integration "${t.name}" because no SDK Client is available.`);return}n.addIntegration(t)},n.afterSetupIntegrations=function(t,n){for(let r of n)r&&r.afterAllSetup&&r.afterAllSetup(t)},n.convertIntegrationFnToClass=function(t,n){return Object.assign(function(...t){return n(...t)},{id:t})},n.defineIntegration=function(t){return t},n.getIntegrationsToSetup=function(t){let n;let r=t.defaultIntegrations||[],o=t.integrations;r.forEach(t=>{t.isDefaultInstance=!0}),n=Array.isArray(o)?[...r,...o]:"function"==typeof o?i.arrayify(o(r)):r;let a=function(t){let n={};return t.forEach(t=>{let{name:r}=t,i=n[r];i&&!i.isDefaultInstance&&t.isDefaultInstance||(n[r]=t)}),Object.keys(n).map(t=>n[t])}(n),l=function(t,n){for(let r=0;r<t.length;r++)if(!0===n(t[r]))return r;return -1}(a,t=>"Debug"===t.name);if(-1!==l){let[t]=a.splice(l,1);a.push(t)}return a},n.installedIntegrations=g,n.setupIntegration=setupIntegration,n.setupIntegrations=function(t,n){let r={};return n.forEach(n=>{n&&setupIntegration(t,n,r)}),r}},94184:(t,n,r)=>{let i;Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277),a=r(14455),l=r(48323),c="FunctionToString",g=new WeakMap,d=l.defineIntegration(()=>({name:c,setupOnce(){i=Function.prototype.toString;try{Function.prototype.toString=function(...t){let n=o.getOriginalFunction(this),r=g.has(a.getClient())&&void 0!==n?n:this;return i.apply(r,t)}}catch(t){}},setup(t){g.set(t,!0)}})),u=l.convertIntegrationFnToClass(c,d);n.FunctionToString=u,n.functionToStringIntegration=d},9867:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(48323),l=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/,/^ResizeObserver loop completed with undelivered notifications.$/,/^Cannot redefine property: googletag$/],c=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],g="InboundFilters",d=a.defineIntegration((t={})=>({name:g,setupOnce(){},processEvent(n,r,a){var g;let d=a.getOptions(),u=function(t={},n={}){return{allowUrls:[...t.allowUrls||[],...n.allowUrls||[]],denyUrls:[...t.denyUrls||[],...n.denyUrls||[]],ignoreErrors:[...t.ignoreErrors||[],...n.ignoreErrors||[],...t.disableErrorDefaults?[]:l],ignoreTransactions:[...t.ignoreTransactions||[],...n.ignoreTransactions||[],...t.disableTransactionDefaults?[]:c],ignoreInternal:void 0===t.ignoreInternal||t.ignoreInternal}}(t,d);return(u.ignoreInternal&&function(t){try{return"SentryError"===t.exception.values[0].type}catch(t){}return!1}(n)?(o.DEBUG_BUILD&&i.logger.warn(`Event dropped due to being internal Sentry Error.
Event: ${i.getEventDescription(n)}`),0):(g=u.ignoreErrors,!n.type&&g&&g.length&&(function(t){let n;let r=[];t.message&&r.push(t.message);try{n=t.exception.values[t.exception.values.length-1]}catch(t){}return n&&n.value&&(r.push(n.value),n.type&&r.push(`${n.type}: ${n.value}`)),o.DEBUG_BUILD&&0===r.length&&i.logger.error(`Could not extract message for event ${i.getEventDescription(t)}`),r})(n).some(t=>i.stringMatchesSomePattern(t,g)))?(o.DEBUG_BUILD&&i.logger.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${i.getEventDescription(n)}`),0):!function(t,n){if("transaction"!==t.type||!n||!n.length)return!1;let r=t.transaction;return!!r&&i.stringMatchesSomePattern(r,n)}(n,u.ignoreTransactions)?!function(t,n){if(!n||!n.length)return!1;let r=_getEventFilterUrl(t);return!!r&&i.stringMatchesSomePattern(r,n)}(n,u.denyUrls)?function(t,n){if(!n||!n.length)return!0;let r=_getEventFilterUrl(t);return!r||i.stringMatchesSomePattern(r,n)}(n,u.allowUrls)||(o.DEBUG_BUILD&&i.logger.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${i.getEventDescription(n)}.
Url: ${_getEventFilterUrl(n)}`),0):(o.DEBUG_BUILD&&i.logger.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${i.getEventDescription(n)}.
Url: ${_getEventFilterUrl(n)}`),0):(o.DEBUG_BUILD&&i.logger.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${i.getEventDescription(n)}`),0))?n:null}})),u=a.convertIntegrationFnToClass(g,d);function _getEventFilterUrl(t){try{let n;try{n=t.exception.values[0].stacktrace.frames}catch(t){}return n?function(t=[]){for(let n=t.length-1;n>=0;n--){let r=t[n];if(r&&"<anonymous>"!==r.filename&&"[native code]"!==r.filename)return r.filename||null}return null}(n):null}catch(n){return o.DEBUG_BUILD&&i.logger.error(`Cannot extract url for event ${i.getEventDescription(t)}`),null}}n.InboundFilters=u,n.inboundFiltersIntegration=d},68370:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(94184),o=r(9867),a=r(606);n.FunctionToString=i.FunctionToString,n.InboundFilters=o.InboundFilters,n.LinkedErrors=a.LinkedErrors},606:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(48323),a="LinkedErrors",l=o.defineIntegration((t={})=>{let n=t.limit||5,r=t.key||"cause";return{name:a,setupOnce(){},preprocessEvent(t,o,a){let l=a.getOptions();i.applyAggregateErrorsToEvent(i.exceptionFromError,l.stackParser,l.maxValueLength,r,n,t,o)}}}),c=o.convertIntegrationFnToClass(a,l);n.LinkedErrors=c,n.linkedErrorsIntegration=l},64434:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(48323),a=r(69060),l="ModuleMetadata",c=o.defineIntegration(()=>({name:l,setupOnce(){},setup(t){"function"==typeof t.on&&t.on("beforeEnvelope",t=>{i.forEachEnvelopeItem(t,(t,n)=>{if("event"===n){let n=Array.isArray(t)?t[1]:void 0;n&&(a.stripMetadataFromStackFrames(n),t[1]=n)}})})},processEvent(t,n,r){let i=r.getOptions().stackParser;return a.addMetadataToStackFrames(i,t),t}})),g=o.convertIntegrationFnToClass(l,c);n.ModuleMetadata=g,n.moduleMetadataIntegration=c},67674:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(48323),a=r(87177),l={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},c="RequestData",g=o.defineIntegration((t={})=>{let n=i.addRequestDataToEvent,r={...l,...t,include:{method:!0,...l.include,...t.include,user:t.include&&"boolean"==typeof t.include.user?t.include.user:{...l.include.user,...(t.include||{}).user}}};return{name:c,setupOnce(){},processEvent(t,o,l){let{transactionNamingScheme:c}=r,{sdkProcessingMetadata:g={}}=t,d=g.request;if(!d)return t;let u=g.requestDataOptionsFromExpressHandler||g.requestDataOptionsFromGCPWrapper||function(t){let n;let{transactionNamingScheme:r,include:{ip:i,user:o,...a}}=t,l=[];for(let[t,n]of Object.entries(a))n&&l.push(t);if(void 0===o)n=!0;else if("boolean"==typeof o)n=o;else{let t=[];for(let[n,r]of Object.entries(o))r&&t.push(n);n=t}return{include:{ip:i,user:n,request:0!==l.length?l:void 0,transaction:r}}}(r),I=n(t,d,u);if("transaction"===t.type||"handler"===c)return I;let p=d._sentryTransaction;if(p){let t=a.spanToJSON(p).description||"",n="sentry.javascript.nextjs"===function(t){try{return t.getOptions()._metadata.sdk.name}catch(t){return}}(l)?t.startsWith("/api"):"path"!==c,[r]=i.extractPathForTransaction(d,{path:!0,method:n,customRoute:t});I.transaction=r}return I}}}),d=o.convertIntegrationFnToClass(c,g);n.RequestData=d,n.requestDataIntegration=g},69060:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=new Map,a=new Set;function getMetadataForUrl(t,n){return function(t){if(i.GLOBAL_OBJ._sentryModuleMetadata)for(let n of Object.keys(i.GLOBAL_OBJ._sentryModuleMetadata)){let r=i.GLOBAL_OBJ._sentryModuleMetadata[n];if(a.has(n))continue;a.add(n);let l=t(n);for(let t of l.reverse())if(t.filename){o.set(t.filename,r);break}}}(t),o.get(n)}n.addMetadataToStackFrames=function(t,n){try{n.exception.values.forEach(n=>{if(n.stacktrace)for(let r of n.stacktrace.frames||[]){if(!r.filename)continue;let n=getMetadataForUrl(t,r.filename);n&&(r.module_metadata=n)}})}catch(t){}},n.getMetadataForUrl=getMetadataForUrl,n.stripMetadataFromStackFrames=function(t){try{t.exception.values.forEach(t=>{if(t.stacktrace)for(let n of t.stacktrace.frames||[])delete n.module_metadata})}catch(t){}}},83068:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(650),a=r(2030),l=r(30982),c=r(28933);n.MetricsAggregator=class{constructor(t){this._client=t,this._buckets=new Map,this._bucketsTotalWeight=0,this._interval=setInterval(()=>this._flush(),o.DEFAULT_FLUSH_INTERVAL),this._interval.unref&&this._interval.unref(),this._flushShift=Math.floor(Math.random()*o.DEFAULT_FLUSH_INTERVAL/1e3),this._forceFlush=!1}add(t,n,r,g="none",d={},u=i.timestampInSeconds()){let I=Math.floor(u),p=c.sanitizeMetricKey(n),m=c.sanitizeTags(d),h=c.sanitizeUnit(g),C=c.getBucketKey(t,p,h,m),b=this._buckets.get(C),y=b&&t===o.SET_METRIC_TYPE?b.metric.weight:0;b?(b.metric.add(r),b.timestamp<I&&(b.timestamp=I)):(b={metric:new a.METRIC_MAP[t](r),timestamp:I,metricType:t,name:p,unit:h,tags:m},this._buckets.set(C,b));let G="string"==typeof r?b.metric.weight-y:r;l.updateMetricSummaryOnActiveSpan(t,p,G,h,d,C),this._bucketsTotalWeight+=b.metric.weight,this._bucketsTotalWeight>=o.MAX_WEIGHT&&this.flush()}flush(){this._forceFlush=!0,this._flush()}close(){this._forceFlush=!0,clearInterval(this._interval),this._flush()}_flush(){if(this._forceFlush){this._forceFlush=!1,this._bucketsTotalWeight=0,this._captureMetrics(this._buckets),this._buckets.clear();return}let t=Math.floor(i.timestampInSeconds())-o.DEFAULT_FLUSH_INTERVAL/1e3-this._flushShift,n=new Map;for(let[r,i]of this._buckets)i.timestamp<=t&&(n.set(r,i),this._bucketsTotalWeight-=i.metric.weight);for(let[t]of n)this._buckets.delete(t);this._captureMetrics(n)}_captureMetrics(t){if(t.size>0&&this._client.captureAggregateMetrics){let n=Array.from(t).map(([,t])=>t);this._client.captureAggregateMetrics(n)}}}},22065:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(650),a=r(2030),l=r(30982),c=r(28933);n.BrowserMetricsAggregator=class{constructor(t){this._client=t,this._buckets=new Map,this._interval=setInterval(()=>this.flush(),o.DEFAULT_BROWSER_FLUSH_INTERVAL)}add(t,n,r,g="none",d={},u=i.timestampInSeconds()){let I=Math.floor(u),p=c.sanitizeMetricKey(n),m=c.sanitizeTags(d),h=c.sanitizeUnit(g),C=c.getBucketKey(t,p,h,m),b=this._buckets.get(C),y=b&&t===o.SET_METRIC_TYPE?b.metric.weight:0;b?(b.metric.add(r),b.timestamp<I&&(b.timestamp=I)):(b={metric:new a.METRIC_MAP[t](r),timestamp:I,metricType:t,name:p,unit:h,tags:m},this._buckets.set(C,b));let G="string"==typeof r?b.metric.weight-y:r;l.updateMetricSummaryOnActiveSpan(t,p,G,h,d,C)}flush(){if(0!==this._buckets.size){if(this._client.captureAggregateMetrics){let t=Array.from(this._buckets).map(([,t])=>t);this._client.captureAggregateMetrics(t)}this._buckets.clear()}}close(){clearInterval(this._interval),this.flush()}}},650:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.COUNTER_METRIC_TYPE="c",n.DEFAULT_BROWSER_FLUSH_INTERVAL=5e3,n.DEFAULT_FLUSH_INTERVAL=1e4,n.DISTRIBUTION_METRIC_TYPE="d",n.GAUGE_METRIC_TYPE="g",n.MAX_WEIGHT=1e4,n.SET_METRIC_TYPE="s"},6675:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(28933);n.createMetricEnvelope=function(t,n,r,a){let l={sent_at:new Date().toISOString()};r&&r.sdk&&(l.sdk={name:r.sdk.name,version:r.sdk.version}),a&&n&&(l.dsn=i.dsnToString(n));let c=function(t){let n=o.serializeMetricBuckets(t),r={type:"statsd",length:n.length};return[r,n]}(t);return i.createEnvelope(l,[c])}},24515:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(14455),l=r(87177),c=r(650),g=r(71174);function addToMetricsAggregator(t,n,r,c={}){let g=a.getClient(),d=a.getCurrentScope();if(g){if(!g.metricsAggregator){o.DEBUG_BUILD&&i.logger.warn("No metrics aggregator enabled. Please add the MetricsAggregator integration to use metrics APIs");return}let{unit:a,tags:u,timestamp:I}=c,{release:p,environment:m}=g.getOptions(),h=d.getTransaction(),C={};p&&(C.release=p),m&&(C.environment=m),h&&(C.transaction=l.spanToJSON(h).description||""),o.DEBUG_BUILD&&i.logger.log(`Adding value of ${r} to ${t} metric ${n}`),g.metricsAggregator.add(t,n,r,a,{...C,...u},I)}}function increment(t,n=1,r){addToMetricsAggregator(c.COUNTER_METRIC_TYPE,t,n,r)}function distribution(t,n,r){addToMetricsAggregator(c.DISTRIBUTION_METRIC_TYPE,t,n,r)}function set(t,n,r){addToMetricsAggregator(c.SET_METRIC_TYPE,t,n,r)}function gauge(t,n,r){addToMetricsAggregator(c.GAUGE_METRIC_TYPE,t,n,r)}let d={increment,distribution,set,gauge,MetricsAggregator:g.MetricsAggregator,metricsAggregatorIntegration:g.metricsAggregatorIntegration};n.distribution=distribution,n.gauge=gauge,n.increment=increment,n.metrics=d,n.set=set},2030:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(650),o=r(28933);let CounterMetric=class CounterMetric{constructor(t){this._value=t}get weight(){return 1}add(t){this._value+=t}toString(){return`${this._value}`}};let GaugeMetric=class GaugeMetric{constructor(t){this._last=t,this._min=t,this._max=t,this._sum=t,this._count=1}get weight(){return 5}add(t){this._last=t,t<this._min&&(this._min=t),t>this._max&&(this._max=t),this._sum+=t,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}};let DistributionMetric=class DistributionMetric{constructor(t){this._value=[t]}get weight(){return this._value.length}add(t){this._value.push(t)}toString(){return this._value.join(":")}};let SetMetric=class SetMetric{constructor(t){this.first=t,this._value=new Set([t])}get weight(){return this._value.size}add(t){this._value.add(t)}toString(){return Array.from(this._value).map(t=>"string"==typeof t?o.simpleHash(t):t).join(":")}};let a={[i.COUNTER_METRIC_TYPE]:CounterMetric,[i.GAUGE_METRIC_TYPE]:GaugeMetric,[i.DISTRIBUTION_METRIC_TYPE]:DistributionMetric,[i.SET_METRIC_TYPE]:SetMetric};n.CounterMetric=CounterMetric,n.DistributionMetric=DistributionMetric,n.GaugeMetric=GaugeMetric,n.METRIC_MAP=a,n.SetMetric=SetMetric},71174:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(48323),o=r(22065),a="MetricsAggregator",l=i.defineIntegration(()=>({name:a,setupOnce(){},setup(t){t.metricsAggregator=new o.BrowserMetricsAggregator(t)}})),c=i.convertIntegrationFnToClass(a,l);n.MetricsAggregator=c,n.metricsAggregatorIntegration=l},30982:(t,n,r)=>{let i;Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277);r(92548),r(22053),r(54703);let a=r(62559);function getMetricStorageForSpan(t){return i?i.get(t):void 0}n.getMetricSummaryJsonForSpan=function(t){let n=getMetricStorageForSpan(t);if(!n)return;let r={};for(let[,[t,i]]of n)r[t]||(r[t]=[]),r[t].push(o.dropUndefinedKeys(i));return r},n.updateMetricSummaryOnActiveSpan=function(t,n,r,o,l,c){let g=a.getActiveSpan();if(g){let a=getMetricStorageForSpan(g)||new Map,d=`${t}:${n}@${o}`,u=a.get(c);if(u){let[,t]=u;a.set(c,[d,{min:Math.min(t.min,r),max:Math.max(t.max,r),count:t.count+=1,sum:t.sum+=r,tags:t.tags}])}else a.set(c,[d,{min:r,max:r,count:1,sum:r,tags:l}]);i||(i=new WeakMap),i.set(g,a)}}},28933:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=[["\n","\\n"],["\r","\\r"],["	","\\t"],["\\","\\\\"],["|","\\u{7c}"],[",","\\u{2c}"]];n.getBucketKey=function(t,n,r,o){let a=Object.entries(i.dropUndefinedKeys(o)).sort((t,n)=>t[0].localeCompare(n[0]));return`${t}${n}${r}${a}`},n.sanitizeMetricKey=function(t){return t.replace(/[^\w\-.]+/gi,"_")},n.sanitizeTags=function(t){let n={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){let i=r.replace(/[^\w\-./]+/gi,"");n[i]=[...String(t[r])].reduce((t,n)=>t+function(t){for(let[n,r]of o)if(t===n)return r;return t}(n),"")}return n},n.sanitizeUnit=function(t){return t.replace(/[^\w]+/gi,"_")},n.serializeMetricBuckets=function(t){let n="";for(let r of t){let t=Object.entries(r.tags),i=t.length>0?`|#${t.map(([t,n])=>`${t}:${n}`).join(",")}`:"";n+=`${r.name}@${r.unit}:${r.metric}|${r.metricType}${i}|T${r.timestamp}
`}return n},n.simpleHash=function(t){let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);n=(n<<5)-n+i,n&=n}return n>>>0}},88954:(t,n,r)=>{let i;Object.defineProperty(n,"__esModule",{value:!0});let o=r(81277),a=r(68804),l=r(26231),c=r(37924);let Scope=class Scope{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=generatePropagationContext()}static clone(t){return t?t.clone():new Scope}clone(){let t=new Scope;return t._breadcrumbs=[...this._breadcrumbs],t._tags={...this._tags},t._extra={...this._extra},t._contexts={...this._contexts},t._user=this._user,t._level=this._level,t._span=this._span,t._session=this._session,t._transactionName=this._transactionName,t._fingerprint=this._fingerprint,t._eventProcessors=[...this._eventProcessors],t._requestSession=this._requestSession,t._attachments=[...this._attachments],t._sdkProcessingMetadata={...this._sdkProcessingMetadata},t._propagationContext={...this._propagationContext},t._client=this._client,t}setClient(t){this._client=t}getClient(){return this._client}addScopeListener(t){this._scopeListeners.push(t)}addEventProcessor(t){return this._eventProcessors.push(t),this}setUser(t){return this._user=t||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&l.updateSession(this._session,{user:t}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(t){return this._requestSession=t,this}setTags(t){return this._tags={...this._tags,...t},this._notifyScopeListeners(),this}setTag(t,n){return this._tags={...this._tags,[t]:n},this._notifyScopeListeners(),this}setExtras(t){return this._extra={...this._extra,...t},this._notifyScopeListeners(),this}setExtra(t,n){return this._extra={...this._extra,[t]:n},this._notifyScopeListeners(),this}setFingerprint(t){return this._fingerprint=t,this._notifyScopeListeners(),this}setLevel(t){return this._level=t,this._notifyScopeListeners(),this}setTransactionName(t){return this._transactionName=t,this._notifyScopeListeners(),this}setContext(t,n){return null===n?delete this._contexts[t]:this._contexts[t]=n,this._notifyScopeListeners(),this}setSpan(t){return this._span=t,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){let t=this._span;return t&&t.transaction}setSession(t){return t?this._session=t:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(t){if(!t)return this;let n="function"==typeof t?t(this):t;if(n instanceof Scope){let t=n.getScopeData();this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&Object.keys(t.user).length&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint.length&&(this._fingerprint=t.fingerprint),n.getRequestSession()&&(this._requestSession=n.getRequestSession()),t.propagationContext&&(this._propagationContext=t.propagationContext)}else o.isPlainObject(n)&&(this._tags={...this._tags,...t.tags},this._extra={...this._extra,...t.extra},this._contexts={...this._contexts,...t.contexts},t.user&&(this._user=t.user),t.level&&(this._level=t.level),t.fingerprint&&(this._fingerprint=t.fingerprint),t.requestSession&&(this._requestSession=t.requestSession),t.propagationContext&&(this._propagationContext=t.propagationContext));return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=generatePropagationContext(),this}addBreadcrumb(t,n){let r="number"==typeof n?n:100;if(r<=0)return this;let i={timestamp:o.dateTimestampInSeconds(),...t},a=this._breadcrumbs;return a.push(i),this._breadcrumbs=a.length>r?a.slice(-r):a,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(t){return this._attachments.push(t),this}getAttachments(){let t=this.getScopeData();return t.attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){let{_breadcrumbs:t,_attachments:n,_contexts:r,_tags:i,_extra:o,_user:a,_level:l,_fingerprint:c,_eventProcessors:g,_propagationContext:d,_sdkProcessingMetadata:u,_transactionName:I,_span:p}=this;return{breadcrumbs:t,attachments:n,contexts:r,tags:i,extra:o,user:a,level:l,fingerprint:c||[],eventProcessors:g,propagationContext:d,sdkProcessingMetadata:u,transactionName:I,span:p}}applyToEvent(t,n={},r=[]){c.applyScopeDataToEvent(t,this.getScopeData());let i=[...r,...a.getGlobalEventProcessors(),...this._eventProcessors];return a.notifyEventProcessors(i,t,n)}setSDKProcessingMetadata(t){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...t},this}setPropagationContext(t){return this._propagationContext=t,this}getPropagationContext(){return this._propagationContext}captureException(t,n){let r=n&&n.event_id?n.event_id:o.uuid4();if(!this._client)return o.logger.warn("No client configured on scope - will not capture exception!"),r;let i=Error("Sentry syntheticException");return this._client.captureException(t,{originalException:t,syntheticException:i,...n,event_id:r},this),r}captureMessage(t,n,r){let i=r&&r.event_id?r.event_id:o.uuid4();if(!this._client)return o.logger.warn("No client configured on scope - will not capture message!"),i;let a=Error(t);return this._client.captureMessage(t,n,{originalException:t,syntheticException:a,...r,event_id:i},this),i}captureEvent(t,n){let r=n&&n.event_id?n.event_id:o.uuid4();return this._client?this._client.captureEvent(t,{...n,event_id:r},this):o.logger.warn("No client configured on scope - will not capture event!"),r}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(t=>{t(this)}),this._notifyingListeners=!1)}};function generatePropagationContext(){return{traceId:o.uuid4(),spanId:o.uuid4().substring(16)}}n.Scope=Scope,n.getGlobalScope=function(){return i||(i=new Scope),i},n.setGlobalScope=function(t){i=t}},70503:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(14455),l=r(63634);function setCurrentClient(t){let n=l.getCurrentHub(),r=n.getStackTop();r.client=t,r.scope.setClient(t)}n.initAndBind=function(t,n){!0===n.debug&&(o.DEBUG_BUILD?i.logger.enable():i.consoleSandbox(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")}));let r=a.getCurrentScope();r.update(n.initialScope);let l=new t(n);setCurrentClient(l),l.init?l.init():l.setupIntegrations&&l.setupIntegrations()},n.setCurrentClient=setCurrentClient},70872:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SEMANTIC_ATTRIBUTE_PROFILE_ID="profile_id",n.SEMANTIC_ATTRIBUTE_SENTRY_OP="sentry.op",n.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN="sentry.origin",n.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE="sentry.sample_rate",n.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE="sentry.source"},79426:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(44893),a=r(15773),l=r(92548),c=r(14455),g=r(83068),d=r(34429),u=r(39316),I=r(87177),p=r(82288);r(54703);let m=r(58913);let ServerRuntimeClient=class ServerRuntimeClient extends o.BaseClient{constructor(t){u.addTracingExtensions(),super(t),t._experiments&&t._experiments.metricsAggregator&&(this.metricsAggregator=new g.MetricsAggregator(this))}eventFromException(t,n){return i.resolvedSyncPromise(i.eventFromUnknownInput(c.getClient(),this._options.stackParser,t,n))}eventFromMessage(t,n="info",r){return i.resolvedSyncPromise(i.eventFromMessage(this._options.stackParser,t,n,r,this._options.attachStacktrace))}captureException(t,n,r){if(this._options.autoSessionTracking&&this._sessionFlusher&&r){let t=r.getRequestSession();t&&"ok"===t.status&&(t.status="errored")}return super.captureException(t,n,r)}captureEvent(t,n,r){if(this._options.autoSessionTracking&&this._sessionFlusher&&r){let n=t.type||"exception",i="exception"===n&&t.exception&&t.exception.values&&t.exception.values.length>0;if(i){let t=r.getRequestSession();t&&"ok"===t.status&&(t.status="errored")}}return super.captureEvent(t,n,r)}close(t){return this._sessionFlusher&&this._sessionFlusher.close(),super.close(t)}initSessionFlusher(){let{release:t,environment:n}=this._options;t?this._sessionFlusher=new d.SessionFlusher(this,{release:t,environment:n}):l.DEBUG_BUILD&&i.logger.warn("Cannot initialise an instance of SessionFlusher if no release is provided!")}captureCheckIn(t,n,r){let o="checkInId"in t&&t.checkInId?t.checkInId:i.uuid4();if(!this._isEnabled())return l.DEBUG_BUILD&&i.logger.warn("SDK not enabled, will not capture checkin."),o;let c=this.getOptions(),{release:g,environment:d,tunnel:u}=c,I={check_in_id:o,monitor_slug:t.monitorSlug,status:t.status,release:g,environment:d};"duration"in t&&(I.duration=t.duration),n&&(I.monitor_config={schedule:n.schedule,checkin_margin:n.checkinMargin,max_runtime:n.maxRuntime,timezone:n.timezone});let[p,m]=this._getTraceInfoFromScope(r);m&&(I.contexts={trace:m});let h=a.createCheckInEnvelope(I,p,this.getSdkMetadata(),u,this.getDsn());return l.DEBUG_BUILD&&i.logger.info("Sending checkin:",t.monitorSlug,t.status),this._sendEnvelope(h),o}_captureRequestSession(){this._sessionFlusher?this._sessionFlusher.incrementSessionStatusCount():l.DEBUG_BUILD&&i.logger.warn("Discarded request mode session because autoSessionTracking option was disabled")}_prepareEvent(t,n,r,i){return this._options.platform&&(t.platform=t.platform||this._options.platform),this._options.runtime&&(t.contexts={...t.contexts,runtime:(t.contexts||{}).runtime||this._options.runtime}),this._options.serverName&&(t.server_name=t.server_name||this._options.serverName),super._prepareEvent(t,n,r,i)}_getTraceInfoFromScope(t){if(!t)return[void 0,void 0];let n=t.getSpan();if(n){let t=p.getRootSpan(n)?m.getDynamicSamplingContextFromSpan(n):void 0;return[t,I.spanToTraceContext(n)]}let{traceId:r,spanId:i,parentSpanId:o,dsc:a}=t.getPropagationContext(),l={trace_id:r,span_id:i,parent_span_id:o};return a?[a,l]:[m.getDynamicSamplingContextFromClient(r,this,t),l]}};n.ServerRuntimeClient=ServerRuntimeClient},26231:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);function updateSession(t,n={}){if(!n.user||(!t.ipAddress&&n.user.ip_address&&(t.ipAddress=n.user.ip_address),t.did||n.did||(t.did=n.user.id||n.user.email||n.user.username)),t.timestamp=n.timestamp||i.timestampInSeconds(),n.abnormal_mechanism&&(t.abnormal_mechanism=n.abnormal_mechanism),n.ignoreDuration&&(t.ignoreDuration=n.ignoreDuration),n.sid&&(t.sid=32===n.sid.length?n.sid:i.uuid4()),void 0!==n.init&&(t.init=n.init),!t.did&&n.did&&(t.did=`${n.did}`),"number"==typeof n.started&&(t.started=n.started),t.ignoreDuration)t.duration=void 0;else if("number"==typeof n.duration)t.duration=n.duration;else{let n=t.timestamp-t.started;t.duration=n>=0?n:0}n.release&&(t.release=n.release),n.environment&&(t.environment=n.environment),!t.ipAddress&&n.ipAddress&&(t.ipAddress=n.ipAddress),!t.userAgent&&n.userAgent&&(t.userAgent=n.userAgent),"number"==typeof n.errors&&(t.errors=n.errors),n.status&&(t.status=n.status)}n.closeSession=function(t,n){let r={};n?r={status:n}:"ok"===t.status&&(r={status:"exited"}),updateSession(t,r)},n.makeSession=function(t){let n=i.timestampInSeconds(),r={sid:i.uuid4(),init:!0,timestamp:n,started:n,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>i.dropUndefinedKeys({sid:`${r.sid}`,init:r.init,started:new Date(1e3*r.started).toISOString(),timestamp:new Date(1e3*r.timestamp).toISOString(),status:r.status,errors:r.errors,did:"number"==typeof r.did||"string"==typeof r.did?`${r.did}`:void 0,duration:r.duration,abnormal_mechanism:r.abnormal_mechanism,attrs:{release:r.release,environment:r.environment,ip_address:r.ipAddress,user_agent:r.userAgent}})};return t&&updateSession(r,t),r},n.updateSession=updateSession},34429:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(14455);n.SessionFlusher=class{constructor(t,n){this._client=t,this.flushTimeout=60,this._pendingAggregates={},this._isEnabled=!0,this._intervalId=setInterval(()=>this.flush(),1e3*this.flushTimeout),this._intervalId.unref&&this._intervalId.unref(),this._sessionAttrs=n}flush(){let t=this.getSessionAggregates();0!==t.aggregates.length&&(this._pendingAggregates={},this._client.sendSession(t))}getSessionAggregates(){let t=Object.keys(this._pendingAggregates).map(t=>this._pendingAggregates[parseInt(t)]),n={attrs:this._sessionAttrs,aggregates:t};return i.dropUndefinedKeys(n)}close(){clearInterval(this._intervalId),this._isEnabled=!1,this.flush()}incrementSessionStatusCount(){if(!this._isEnabled)return;let t=o.getCurrentScope(),n=t.getRequestSession();n&&n.status&&(this._incrementSessionStatusCount(n.status,new Date),t.setRequestSession(void 0))}_incrementSessionStatusCount(t,n){let r=new Date(n).setSeconds(0,0);this._pendingAggregates[r]=this._pendingAggregates[r]||{};let i=this._pendingAggregates[r];switch(i.started||(i.started=new Date(r).toISOString()),t){case"errored":return i.errored=(i.errored||0)+1,i.errored;case"ok":return i.exited=(i.exited||0)+1,i.exited;default:return i.crashed=(i.crashed||0)+1,i.crashed}}}},42416:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);function createSpanItem(t){return[{type:"span"},t]}n.createSpanEnvelope=function(t,n){let r={sent_at:new Date().toISOString()};n&&(r.dsn=i.dsnToString(n));let o=t.map(createSpanItem);return i.createEnvelope(r,o)}},58913:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(68799),a=r(14455),l=r(82288),c=r(87177);function getDynamicSamplingContextFromClient(t,n,r){let a=n.getOptions(),{publicKey:l}=n.getDsn()||{},{segment:c}=r&&r.getUser()||{},g=i.dropUndefinedKeys({environment:a.environment||o.DEFAULT_ENVIRONMENT,release:a.release,user_segment:c,public_key:l,trace_id:t});return n.emit&&n.emit("createDsc",g),g}n.getDynamicSamplingContextFromClient=getDynamicSamplingContextFromClient,n.getDynamicSamplingContextFromSpan=function(t){let n=a.getClient();if(!n)return{};let r=getDynamicSamplingContextFromClient(c.spanToJSON(t).trace_id||"",n,a.getCurrentScope()),i=l.getRootSpan(t);if(!i)return r;let o=i&&i._frozenDynamicSamplingContext;if(o)return o;let{sampleRate:g,source:d}=i.metadata;null!=g&&(r.sample_rate=`${g}`);let u=c.spanToJSON(i);return d&&"url"!==d&&(r.transaction=u.description),r.sampled=String(c.spanIsSampled(i)),n.emit&&n.emit("createDsc",r),r}},22053:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(35507),l=!1;function errorCallback(){let t=a.getActiveTransaction();if(t){let n="internal_error";o.DEBUG_BUILD&&i.logger.log(`[Tracing] Transaction: ${n} -> Global error occured`),t.setStatus(n)}}errorCallback.tag="sentry_tracingErrorCallback",n.registerErrorInstrumentation=function(){l||(l=!0,i.addGlobalErrorInstrumentationHandler(errorCallback),i.addGlobalUnhandledRejectionInstrumentationHandler(errorCallback))}},39316:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(63634),l=r(87177),c=r(22053),g=r(94982),d=r(78047),u=r(38534);function traceHeaders(){let t=this.getScope(),n=t.getSpan();return n?{"sentry-trace":l.spanToTraceHeader(n)}:{}}function _startTransaction(t,n){let r=this.getClient(),a=r&&r.getOptions()||{},l=a.instrumenter||"sentry",c=t.instrumenter||"sentry";l!==c&&(o.DEBUG_BUILD&&i.logger.error(`A transaction was started with instrumenter=\`${c}\`, but the SDK is configured with the \`${l}\` instrumenter.
The transaction will not be sampled. Please use the ${l} instrumentation to start transactions.`),t.sampled=!1);let g=new u.Transaction(t,this);return(g=d.sampleTransaction(g,a,{name:t.name,parentSampled:t.parentSampled,transactionContext:t,attributes:{...t.data,...t.attributes},...n})).isRecording()&&g.initSpanRecorder(a._experiments&&a._experiments.maxSpans),r&&r.emit&&r.emit("startTransaction",g),g}n.addTracingExtensions=function(){let t=a.getMainCarrier();t.__SENTRY__&&(t.__SENTRY__.extensions=t.__SENTRY__.extensions||{},t.__SENTRY__.extensions.startTransaction||(t.__SENTRY__.extensions.startTransaction=_startTransaction),t.__SENTRY__.extensions.traceHeaders||(t.__SENTRY__.extensions.traceHeaders=traceHeaders),c.registerErrorInstrumentation())},n.startIdleTransaction=function(t,n,r,i,o,a,l,c=!1){let u=t.getClient(),I=u&&u.getOptions()||{},p=new g.IdleTransaction(n,t,r,i,l,o,c);return(p=d.sampleTransaction(p,I,{name:n.name,parentSampled:n.parentSampled,transactionContext:n,attributes:{...n.data,...n.attributes},...a})).isRecording()&&p.initSpanRecorder(I._experiments&&I._experiments.maxSpans),u&&u.emit&&u.emit("startTransaction",p),p}},94982:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(87177),l=r(83269),c=r(38534),g={idleTimeout:1e3,finalTimeout:3e4,heartbeatInterval:5e3};let IdleTransactionSpanRecorder=class IdleTransactionSpanRecorder extends l.SpanRecorder{constructor(t,n,r,i){super(i),this._pushActivity=t,this._popActivity=n,this.transactionSpanId=r}add(t){if(t.spanContext().spanId!==this.transactionSpanId){let n=t.end;t.end=(...r)=>(this._popActivity(t.spanContext().spanId),n.apply(t,r)),void 0===a.spanToJSON(t).timestamp&&this._pushActivity(t.spanContext().spanId)}super.add(t)}};let IdleTransaction=class IdleTransaction extends c.Transaction{constructor(t,n,r=g.idleTimeout,a=g.finalTimeout,l=g.heartbeatInterval,c=!1,d=!1){super(t,n),this._idleHub=n,this._idleTimeout=r,this._finalTimeout=a,this._heartbeatInterval=l,this._onScope=c,this.activities={},this._heartbeatCounter=0,this._finished=!1,this._idleTimeoutCanceledPermanently=!1,this._beforeFinishCallbacks=[],this._finishReason="externalFinish",this._autoFinishAllowed=!d,c&&(o.DEBUG_BUILD&&i.logger.log(`Setting idle transaction on scope. Span ID: ${this.spanContext().spanId}`),n.getScope().setSpan(this)),d||this._restartIdleTimeout(),setTimeout(()=>{this._finished||(this.setStatus("deadline_exceeded"),this._finishReason="finalTimeout",this.end())},this._finalTimeout)}end(t){let n=a.spanTimeInputToSeconds(t);if(this._finished=!0,this.activities={},"ui.action.click"===this.op&&this.setAttribute("finishReason",this._finishReason),this.spanRecorder){for(let t of(o.DEBUG_BUILD&&i.logger.log("[Tracing] finishing IdleTransaction",new Date(1e3*n).toISOString(),this.op),this._beforeFinishCallbacks))t(this,n);this.spanRecorder.spans=this.spanRecorder.spans.filter(t=>{if(t.spanContext().spanId===this.spanContext().spanId)return!0;!a.spanToJSON(t).timestamp&&(t.setStatus("cancelled"),t.end(n),o.DEBUG_BUILD&&i.logger.log("[Tracing] cancelling span since transaction ended early",JSON.stringify(t,void 0,2)));let{start_timestamp:r,timestamp:l}=a.spanToJSON(t),c=r&&r<n,g=(this._finalTimeout+this._idleTimeout)/1e3,d=l&&r&&l-r<g;if(o.DEBUG_BUILD){let n=JSON.stringify(t,void 0,2);c?d||i.logger.log("[Tracing] discarding Span since it finished after Transaction final timeout",n):i.logger.log("[Tracing] discarding Span since it happened after Transaction was finished",n)}return c&&d}),o.DEBUG_BUILD&&i.logger.log("[Tracing] flushing IdleTransaction")}else o.DEBUG_BUILD&&i.logger.log("[Tracing] No active IdleTransaction");if(this._onScope){let t=this._idleHub.getScope();t.getTransaction()===this&&t.setSpan(void 0)}return super.end(t)}registerBeforeFinishCallback(t){this._beforeFinishCallbacks.push(t)}initSpanRecorder(t){this.spanRecorder||(this.spanRecorder=new IdleTransactionSpanRecorder(t=>{this._finished||this._pushActivity(t)},t=>{this._finished||this._popActivity(t)},this.spanContext().spanId,t),o.DEBUG_BUILD&&i.logger.log("Starting heartbeat"),this._pingHeartbeat()),this.spanRecorder.add(this)}cancelIdleTimeout(t,{restartOnChildSpanChange:n}={restartOnChildSpanChange:!0}){this._idleTimeoutCanceledPermanently=!1===n,this._idleTimeoutID&&(clearTimeout(this._idleTimeoutID),this._idleTimeoutID=void 0,0===Object.keys(this.activities).length&&this._idleTimeoutCanceledPermanently&&(this._finishReason="cancelled",this.end(t)))}setFinishReason(t){this._finishReason=t}sendAutoFinishSignal(){this._autoFinishAllowed||(o.DEBUG_BUILD&&i.logger.log("[Tracing] Received finish signal for idle transaction."),this._restartIdleTimeout(),this._autoFinishAllowed=!0)}_restartIdleTimeout(t){this.cancelIdleTimeout(),this._idleTimeoutID=setTimeout(()=>{this._finished||0!==Object.keys(this.activities).length||(this._finishReason="idleTimeout",this.end(t))},this._idleTimeout)}_pushActivity(t){this.cancelIdleTimeout(void 0,{restartOnChildSpanChange:!this._idleTimeoutCanceledPermanently}),o.DEBUG_BUILD&&i.logger.log(`[Tracing] pushActivity: ${t}`),this.activities[t]=!0,o.DEBUG_BUILD&&i.logger.log("[Tracing] new activities count",Object.keys(this.activities).length)}_popActivity(t){if(this.activities[t]&&(o.DEBUG_BUILD&&i.logger.log(`[Tracing] popActivity ${t}`),delete this.activities[t],o.DEBUG_BUILD&&i.logger.log("[Tracing] new activities count",Object.keys(this.activities).length)),0===Object.keys(this.activities).length){let t=i.timestampInSeconds();this._idleTimeoutCanceledPermanently?this._autoFinishAllowed&&(this._finishReason="cancelled",this.end(t)):this._restartIdleTimeout(t+this._idleTimeout/1e3)}}_beat(){if(this._finished)return;let t=Object.keys(this.activities).join("");t===this._prevHeartbeatString?this._heartbeatCounter++:this._heartbeatCounter=1,this._prevHeartbeatString=t,this._heartbeatCounter>=3?this._autoFinishAllowed&&(o.DEBUG_BUILD&&i.logger.log("[Tracing] Transaction finished because of no change for 3 heart beats"),this.setStatus("deadline_exceeded"),this._finishReason="heartbeatFailed",this.end()):this._pingHeartbeat()}_pingHeartbeat(){o.DEBUG_BUILD&&i.logger.log(`pinging Heartbeat -> current counter: ${this._heartbeatCounter}`),setTimeout(()=>{this._beat()},this._heartbeatInterval)}};n.IdleTransaction=IdleTransaction,n.IdleTransactionSpanRecorder=IdleTransactionSpanRecorder,n.TRACING_DEFAULTS=g},42401:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(35507);n.setMeasurement=function(t,n,r){let o=i.getActiveTransaction();o&&o.setMeasurement(t,n,r)}},78047:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(70872),l=r(52679),c=r(87177);function isValidSampleRate(t){return i.isNaN(t)||!("number"==typeof t||"boolean"==typeof t)?(o.DEBUG_BUILD&&i.logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(t)} of type ${JSON.stringify(typeof t)}.`),!1):!(t<0)&&!(t>1)||(o.DEBUG_BUILD&&i.logger.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${t}.`),!1)}n.isValidSampleRate=isValidSampleRate,n.sampleTransaction=function(t,n,r){let g;return l.hasTracingEnabled(n)?void 0!==t.sampled?t.setAttribute(a.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(t.sampled)):("function"==typeof n.tracesSampler?(g=n.tracesSampler(r),t.setAttribute(a.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(g))):void 0!==r.parentSampled?g=r.parentSampled:void 0!==n.tracesSampleRate?(g=n.tracesSampleRate,t.setAttribute(a.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,Number(g))):(g=1,t.setAttribute(a.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,g)),isValidSampleRate(g))?g?(t.sampled=Math.random()<g,t.sampled)?o.DEBUG_BUILD&&i.logger.log(`[Tracing] starting ${t.op} transaction - ${c.spanToJSON(t).description}`):o.DEBUG_BUILD&&i.logger.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(g)})`):(o.DEBUG_BUILD&&i.logger.log(`[Tracing] Discarding transaction because ${"function"==typeof n.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),t.sampled=!1):(o.DEBUG_BUILD&&i.logger.warn("[Tracing] Discarding transaction because of invalid sample rate."),t.sampled=!1):t.sampled=!1,t}},83269:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(30982),l=r(70872),c=r(82288),g=r(87177),d=r(54703);let Span=class Span{constructor(t={}){this._traceId=t.traceId||i.uuid4(),this._spanId=t.spanId||i.uuid4().substring(16),this._startTime=t.startTimestamp||i.timestampInSeconds(),this.tags=t.tags?{...t.tags}:{},this.data=t.data?{...t.data}:{},this.instrumenter=t.instrumenter||"sentry",this._attributes={},this.setAttributes({[l.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:t.origin||"manual",[l.SEMANTIC_ATTRIBUTE_SENTRY_OP]:t.op,...t.attributes}),this._name=t.name||t.description,t.parentSpanId&&(this._parentSpanId=t.parentSpanId),"sampled"in t&&(this._sampled=t.sampled),t.status&&(this._status=t.status),t.endTimestamp&&(this._endTime=t.endTimestamp),void 0!==t.exclusiveTime&&(this._exclusiveTime=t.exclusiveTime),this._measurements=t.measurements?{...t.measurements}:{}}get name(){return this._name||""}set name(t){this.updateName(t)}get description(){return this._name}set description(t){this._name=t}get traceId(){return this._traceId}set traceId(t){this._traceId=t}get spanId(){return this._spanId}set spanId(t){this._spanId=t}set parentSpanId(t){this._parentSpanId=t}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(t){this._sampled=t}get attributes(){return this._attributes}set attributes(t){this._attributes=t}get startTimestamp(){return this._startTime}set startTimestamp(t){this._startTime=t}get endTimestamp(){return this._endTime}set endTimestamp(t){this._endTime=t}get status(){return this._status}set status(t){this._status=t}get op(){return this._attributes[l.SEMANTIC_ATTRIBUTE_SENTRY_OP]}set op(t){this.setAttribute(l.SEMANTIC_ATTRIBUTE_SENTRY_OP,t)}get origin(){return this._attributes[l.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]}set origin(t){this.setAttribute(l.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN,t)}spanContext(){let{_spanId:t,_traceId:n,_sampled:r}=this;return{spanId:t,traceId:n,traceFlags:r?g.TRACE_FLAG_SAMPLED:g.TRACE_FLAG_NONE}}startChild(t){let n=new Span({...t,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});n.spanRecorder=this.spanRecorder,n.spanRecorder&&n.spanRecorder.add(n);let r=c.getRootSpan(this);if(n.transaction=r,o.DEBUG_BUILD&&r){let o=t&&t.op||"< unknown op >",a=g.spanToJSON(n).description||"< unknown name >",l=r.spanContext().spanId,c=`[Tracing] Starting '${o}' span on transaction '${a}' (${l}).`;i.logger.log(c),this._logMessage=c}return n}setTag(t,n){return this.tags={...this.tags,[t]:n},this}setData(t,n){return this.data={...this.data,[t]:n},this}setAttribute(t,n){void 0===n?delete this._attributes[t]:this._attributes[t]=n}setAttributes(t){Object.keys(t).forEach(n=>this.setAttribute(n,t[n]))}setStatus(t){return this._status=t,this}setHttpStatus(t){return d.setHttpStatus(this,t),this}setName(t){this.updateName(t)}updateName(t){return this._name=t,this}isSuccess(){return"ok"===this._status}finish(t){return this.end(t)}end(t){if(this._endTime)return;let n=c.getRootSpan(this);if(o.DEBUG_BUILD&&n&&n.spanContext().spanId!==this._spanId){let t=this._logMessage;t&&i.logger.log(t.replace("Starting","Finishing"))}this._endTime=g.spanTimeInputToSeconds(t)}toTraceparent(){return g.spanToTraceHeader(this)}toContext(){return i.dropUndefinedKeys({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(t){return this.data=t.data||{},this._name=t.name||t.description,this._endTime=t.endTimestamp,this.op=t.op,this._parentSpanId=t.parentSpanId,this._sampled=t.sampled,this._spanId=t.spanId||this._spanId,this._startTime=t.startTimestamp||this._startTime,this._status=t.status,this.tags=t.tags||{},this._traceId=t.traceId||this._traceId,this}getTraceContext(){return g.spanToTraceContext(this)}getSpanJSON(){return i.dropUndefinedKeys({data:this._getData(),description:this._name,op:this._attributes[l.SEMANTIC_ATTRIBUTE_SENTRY_OP],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[l.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN],_metrics_summary:a.getMetricSummaryJsonForSpan(this),profile_id:this._attributes[l.SEMANTIC_ATTRIBUTE_PROFILE_ID],exclusive_time:this._exclusiveTime,measurements:Object.keys(this._measurements).length>0?this._measurements:void 0})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){let{data:t,_attributes:n}=this,r=Object.keys(t).length>0,i=Object.keys(n).length>0;return r||i?r&&i?{...t,...n}:r?t:n:void 0}};n.Span=Span,n.SpanRecorder=class{constructor(t=1e3){this._maxlen=t,this.spans=[]}add(t){this.spans.length>this._maxlen?t.spanRecorder=void 0:this.spans.push(t)}}},54703:(t,n)=>{function getSpanStatusFromHttpCode(t){if(t<400&&t>=100)return"ok";if(t>=400&&t<500)switch(t){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(t>=500&&t<600)switch(t){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}Object.defineProperty(n,"__esModule",{value:!0}),n.SpanStatus=void 0,function(t){t.Ok="ok",t.DeadlineExceeded="deadline_exceeded",t.Unauthenticated="unauthenticated",t.PermissionDenied="permission_denied",t.NotFound="not_found",t.ResourceExhausted="resource_exhausted",t.InvalidArgument="invalid_argument",t.Unimplemented="unimplemented",t.Unavailable="unavailable",t.InternalError="internal_error",t.UnknownError="unknown_error",t.Cancelled="cancelled",t.AlreadyExists="already_exists",t.FailedPrecondition="failed_precondition",t.Aborted="aborted",t.OutOfRange="out_of_range",t.DataLoss="data_loss"}(n.SpanStatus||(n.SpanStatus={})),n.getSpanStatusFromHttpCode=getSpanStatusFromHttpCode,n.setHttpStatus=function(t,n){t.setTag("http.status_code",String(n)),t.setData("http.response.status_code",n);let r=getSpanStatusFromHttpCode(n);"unknown_error"!==r&&t.setStatus(r)},n.spanStatusfromHttpCode=getSpanStatusFromHttpCode},62559:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(63634),l=r(87177);r(22053),r(54703);let c=r(58913),g=r(14455),d=r(88533),u=r(52679);function startSpan(t,n){let r=normalizeContext(t);return a.runWithAsyncContext(()=>g.withScope(t.scope,i=>{let o=a.getCurrentHub(),c=i.getSpan(),g=t.onlyIfParent&&!c,u=g?void 0:createChildSpanOrTransaction(o,{parentSpan:c,spanContext:r,forceTransaction:t.forceTransaction,scope:i});return d.handleCallbackErrors(()=>n(u),()=>{if(u){let{status:t}=l.spanToJSON(u);t&&"ok"!==t||u.setStatus("internal_error")}},()=>u&&u.end())}))}function getActiveSpan(){return g.getCurrentScope().getSpan()}function createChildSpanOrTransaction(t,{parentSpan:n,spanContext:r,forceTransaction:o,scope:g}){var d;let m;if(!u.hasTracingEnabled())return;let h=a.getIsolationScope();if(n&&!o)m=n.startChild(r);else if(n){let i=c.getDynamicSamplingContextFromSpan(n),{traceId:o,spanId:a}=n.spanContext(),g=l.spanIsSampled(n);m=t.startTransaction({traceId:o,parentSpanId:a,parentSampled:g,...r,metadata:{dynamicSamplingContext:i,...r.metadata}})}else{let{traceId:n,dsc:i,parentSpanId:o,sampled:a}={...h.getPropagationContext(),...g.getPropagationContext()};m=t.startTransaction({traceId:n,parentSpanId:o,parentSampled:a,...r,metadata:{dynamicSamplingContext:i,...r.metadata}})}return g.setSpan(m),(d=m)&&(i.addNonEnumerableProperty(d,p,h),i.addNonEnumerableProperty(d,I,g)),m}function normalizeContext(t){if(t.startTime){let n={...t};return n.startTimestamp=l.spanTimeInputToSeconds(t.startTime),delete n.startTime,n}return t}let I="_sentryScope",p="_sentryIsolationScope";n.continueTrace=({sentryTrace:t,baggage:n},r)=>{let l=g.getCurrentScope(),{traceparentData:c,dynamicSamplingContext:d,propagationContext:u}=i.tracingContextFromHeaders(t,n);l.setPropagationContext(u),o.DEBUG_BUILD&&c&&i.logger.log(`[Tracing] Continuing trace ${c.traceId}.`);let I={...c,metadata:i.dropUndefinedKeys({dynamicSamplingContext:d})};return r?a.runWithAsyncContext(()=>r(I)):I},n.getActiveSpan=getActiveSpan,n.getCapturedScopesOnSpan=function(t){return{scope:t[I],isolationScope:t[p]}},n.startActiveSpan=startSpan,n.startInactiveSpan=function(t){if(!u.hasTracingEnabled())return;let n=normalizeContext(t),r=a.getCurrentHub(),i=t.scope?t.scope.getSpan():getActiveSpan(),o=t.onlyIfParent&&!i;if(o)return;let l=t.scope||g.getCurrentScope(),c=l.clone();return createChildSpanOrTransaction(r,{parentSpan:i,spanContext:n,forceTransaction:t.forceTransaction,scope:c})},n.startSpan=startSpan,n.startSpanManual=function(t,n){let r=normalizeContext(t);return a.runWithAsyncContext(()=>g.withScope(t.scope,i=>{let o=a.getCurrentHub(),c=i.getSpan(),g=t.onlyIfParent&&!c,u=g?void 0:createChildSpanOrTransaction(o,{parentSpan:c,spanContext:r,forceTransaction:t.forceTransaction,scope:i});function finishAndSetSpan(){u&&u.end()}return d.handleCallbackErrors(()=>n(u,finishAndSetSpan),()=>{if(u&&u.isRecording()){let{status:t}=l.spanToJSON(u);t&&"ok"!==t||u.setStatus("internal_error")}})}))},n.trace=function(t,n,r=()=>{},i=()=>{}){let o=a.getCurrentHub(),l=g.getCurrentScope(),c=l.getSpan(),u=normalizeContext(t),I=createChildSpanOrTransaction(o,{parentSpan:c,spanContext:u,forceTransaction:!1,scope:l});return l.setSpan(I),d.handleCallbackErrors(()=>n(I),t=>{I&&I.setStatus("internal_error"),r(t,I)},()=>{I&&I.end(),l.setSpan(c),i()})}},38534:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548),a=r(63634),l=r(30982),c=r(70872),g=r(87177),d=r(58913),u=r(83269),I=r(62559);let Transaction=class Transaction extends u.Span{constructor(t,n){super(t),this._contexts={},this._hub=n||a.getCurrentHub(),this._name=t.name||"",this._metadata={...t.metadata},this._trimEnd=t.trimEnd,this.transaction=this;let r=this._metadata.dynamicSamplingContext;r&&(this._frozenDynamicSamplingContext={...r})}get name(){return this._name}set name(t){this.setName(t)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[c.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]&&{source:this._attributes[c.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]},...this._attributes[c.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE]&&{sampleRate:this._attributes[c.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE]}}}set metadata(t){this._metadata=t}setName(t,n="custom"){this._name=t,this.setAttribute(c.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,n)}updateName(t){return this._name=t,this}initSpanRecorder(t=1e3){this.spanRecorder||(this.spanRecorder=new u.SpanRecorder(t)),this.spanRecorder.add(this)}setContext(t,n){null===n?delete this._contexts[t]:this._contexts[t]=n}setMeasurement(t,n,r=""){this._measurements[t]={value:n,unit:r}}setMetadata(t){this._metadata={...this._metadata,...t}}end(t){let n=g.spanTimeInputToSeconds(t),r=this._finishTransaction(n);if(r)return this._hub.captureEvent(r)}toContext(){let t=super.toContext();return i.dropUndefinedKeys({...t,name:this._name,trimEnd:this._trimEnd})}updateWithContext(t){return super.updateWithContext(t),this._name=t.name||"",this._trimEnd=t.trimEnd,this}getDynamicSamplingContext(){return d.getDynamicSamplingContextFromSpan(this)}setHub(t){this._hub=t}getProfileId(){if(void 0!==this._contexts&&void 0!==this._contexts.profile)return this._contexts.profile.profile_id}_finishTransaction(t){if(void 0!==this._endTime)return;this._name||(o.DEBUG_BUILD&&i.logger.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(t);let n=this._hub.getClient();if(n&&n.emit&&n.emit("finishTransaction",this),!0!==this._sampled){o.DEBUG_BUILD&&i.logger.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),n&&n.recordDroppedEvent("sample_rate","transaction");return}let r=this.spanRecorder?this.spanRecorder.spans.filter(t=>t!==this&&g.spanToJSON(t).timestamp):[];if(this._trimEnd&&r.length>0){let t=r.map(t=>g.spanToJSON(t).timestamp).filter(Boolean);this._endTime=t.reduce((t,n)=>t>n?t:n)}let{scope:a,isolationScope:c}=I.getCapturedScopesOnSpan(this),{metadata:u}=this,{source:p}=u,m={contexts:{...this._contexts,trace:g.spanToTraceContext(this)},spans:r,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...u,capturedSpanScope:a,capturedSpanIsolationScope:c,...i.dropUndefinedKeys({dynamicSamplingContext:d.getDynamicSamplingContextFromSpan(this)})},_metrics_summary:l.getMetricSummaryJsonForSpan(this),...p&&{transaction_info:{source:p}}},h=Object.keys(this._measurements).length>0;return h&&(o.DEBUG_BUILD&&i.logger.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),m.measurements=this._measurements),o.DEBUG_BUILD&&i.logger.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),m}};n.Transaction=Transaction},35507:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(63634),a=i.extractTraceparentData;n.stripUrlQueryAndFragment=i.stripUrlQueryAndFragment,n.extractTraceparentData=a,n.getActiveTransaction=function(t){let n=t||o.getCurrentHub(),r=n.getScope();return r.getTransaction()}},50253:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548);function getEventForEnvelopeItem(t,n){if("event"===n||"transaction"===n)return Array.isArray(t)?t[1]:void 0}n.DEFAULT_TRANSPORT_BUFFER_SIZE=30,n.createTransport=function(t,n,r=i.makePromiseBuffer(t.bufferSize||30)){let a={};function send(l){let c=[];if(i.forEachEnvelopeItem(l,(n,r)=>{let o=i.envelopeItemTypeToDataCategory(r);if(i.isRateLimited(a,o)){let i=getEventForEnvelopeItem(n,r);t.recordDroppedEvent("ratelimit_backoff",o,i)}else c.push(n)}),0===c.length)return i.resolvedSyncPromise();let g=i.createEnvelope(l[0],c),recordEnvelopeLoss=n=>{i.forEachEnvelopeItem(g,(r,o)=>{let a=getEventForEnvelopeItem(r,o);t.recordDroppedEvent(n,i.envelopeItemTypeToDataCategory(o),a)})};return r.add(()=>n({body:i.serializeEnvelope(g,t.textEncoder)}).then(t=>(void 0!==t.statusCode&&(t.statusCode<200||t.statusCode>=300)&&o.DEBUG_BUILD&&i.logger.warn(`Sentry responded with status code ${t.statusCode} to sent event.`),a=i.updateRateLimits(a,t),t),t=>{throw recordEnvelopeLoss("network_error"),t})).then(t=>t,t=>{if(t instanceof i.SentryError)return o.DEBUG_BUILD&&i.logger.error("Skipped sending event because buffer is full."),recordEnvelopeLoss("queue_overflow"),i.resolvedSyncPromise();throw t})}return send.__sentry__baseTransport__=!0,{send,flush:t=>r.drain(t)}}},86021:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(75931);function eventFromEnvelope(t,n){let r;return i.forEachEnvelopeItem(t,(t,i)=>(n.includes(i)&&(r=Array.isArray(t)?t[1]:void 0),!!r)),r}n.eventFromEnvelope=eventFromEnvelope,n.makeMultiplexedTransport=function(t,n){return r=>{let a=t(r),l=new Map;function getTransport(n,a){let c=a?`${n}:${a}`:n,g=l.get(c);if(!g){let d=i.dsnFromString(n);if(!d)return;let u=o.getEnvelopeEndpointWithUrlEncodedAuth(d,r.tunnel);g=a?(n=>{let r=t(n);return{...r,send:async t=>{let n=eventFromEnvelope(t,["event","transaction","profile","replay_event"]);return n&&(n.release=a),r.send(t)}}})({...r,url:u}):t({...r,url:u}),l.set(c,g)}return[n,g]}return{send:async function(t){let r=n({envelope:t,getEvent:function(n){let r=n&&n.length?n:["event"];return eventFromEnvelope(t,r)}}).map(t=>"string"==typeof t?getTransport(t,void 0):getTransport(t.dsn,t.release)).filter(t=>!!t);0===r.length&&r.push(["",a]);let o=await Promise.all(r.map(([n,r])=>r.send(i.createEnvelope(n?{...t[0],dsn:n}:t[0],t[1]))));return o[0]},flush:async function(t){let n=[await a.flush(t)];for(let[,r]of l)n.push(await r.flush(t));return n.every(t=>t)}}}}},79850:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(92548);function log(t,n){o.DEBUG_BUILD&&i.logger.info(`[Offline]: ${t}`,n)}n.MIN_DELAY=100,n.START_DELAY=5e3,n.makeOfflineTransport=function(t){return n=>{let r;let o=t(n),a=n.createStore?n.createStore(n):void 0,l=5e3;function flushIn(t){a&&(r&&clearTimeout(r),"number"!=typeof(r=setTimeout(async()=>{r=void 0;let t=await a.pop();t&&(log("Attempting to send previously queued event"),send(t).catch(t=>{log("Failed to retry sending",t)}))},t))&&r.unref&&r.unref())}function flushWithBackOff(){r||(flushIn(l),l=Math.min(2*l,36e5))}async function send(t){try{let n=await o.send(t),r=100;if(n){if(n.headers&&n.headers["retry-after"])r=i.parseRetryAfterHeader(n.headers["retry-after"]);else if((n.statusCode||0)>=400)return n}return flushIn(r),l=5e3,n}catch(o){var r;if(a&&await (r=l,!i.envelopeContainsItemType(t,["replay_event","replay_recording","client_report"])&&(!n.shouldStore||n.shouldStore(t,o,r))))return await a.insert(t),flushWithBackOff(),log("Error sending. Event queued",o),{};throw o}}return n.flushAtStartup&&flushWithBackOff(),{send,flush:t=>o.flush(t)}}}},37924:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(58913),a=r(82288),l=r(87177);function mergeAndOverwriteScopeData(t,n,r){if(r&&Object.keys(r).length)for(let i in t[n]={...t[n]},r)Object.prototype.hasOwnProperty.call(r,i)&&(t[n][i]=r[i])}n.applyScopeDataToEvent=function(t,n){let{fingerprint:r,span:c,breadcrumbs:g,sdkProcessingMetadata:d}=n;(function(t,n){let{extra:r,tags:o,user:a,contexts:l,level:c,transactionName:g}=n,d=i.dropUndefinedKeys(r);d&&Object.keys(d).length&&(t.extra={...d,...t.extra});let u=i.dropUndefinedKeys(o);u&&Object.keys(u).length&&(t.tags={...u,...t.tags});let I=i.dropUndefinedKeys(a);I&&Object.keys(I).length&&(t.user={...I,...t.user});let p=i.dropUndefinedKeys(l);p&&Object.keys(p).length&&(t.contexts={...p,...t.contexts}),c&&(t.level=c),g&&(t.transaction=g)})(t,n),c&&function(t,n){t.contexts={trace:l.spanToTraceContext(n),...t.contexts};let r=a.getRootSpan(n);if(r){t.sdkProcessingMetadata={dynamicSamplingContext:o.getDynamicSamplingContextFromSpan(n),...t.sdkProcessingMetadata};let i=l.spanToJSON(r).description;i&&(t.tags={transaction:i,...t.tags})}}(t,c),t.fingerprint=t.fingerprint?i.arrayify(t.fingerprint):[],r&&(t.fingerprint=t.fingerprint.concat(r)),t.fingerprint&&!t.fingerprint.length&&delete t.fingerprint,function(t,n){let r=[...t.breadcrumbs||[],...n];t.breadcrumbs=r.length?r:void 0}(t,g),t.sdkProcessingMetadata={...t.sdkProcessingMetadata,...d}},n.mergeAndOverwriteScopeData=mergeAndOverwriteScopeData,n.mergeScopeData=function(t,n){let{extra:r,tags:i,user:o,contexts:a,level:l,sdkProcessingMetadata:c,breadcrumbs:g,fingerprint:d,eventProcessors:u,attachments:I,propagationContext:p,transactionName:m,span:h}=n;mergeAndOverwriteScopeData(t,"extra",r),mergeAndOverwriteScopeData(t,"tags",i),mergeAndOverwriteScopeData(t,"user",o),mergeAndOverwriteScopeData(t,"contexts",a),mergeAndOverwriteScopeData(t,"sdkProcessingMetadata",c),l&&(t.level=l),m&&(t.transactionName=m),h&&(t.span=h),g.length&&(t.breadcrumbs=[...t.breadcrumbs,...g]),d.length&&(t.fingerprint=[...t.fingerprint,...d]),u.length&&(t.eventProcessors=[...t.eventProcessors,...u]),I.length&&(t.attachments=[...t.attachments,...I]),t.propagationContext={...t.propagationContext,...p}}},82288:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getRootSpan=function(t){return t.transaction}},88533:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);n.handleCallbackErrors=function(t,n,r=()=>{}){var o;let a;try{a=t()}catch(t){throw n(t),r(),t}return o=a,i.isThenable(o)?o.then(t=>(r(),t),t=>{throw n(t),r(),t}):(r(),o)}},52679:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(14455);n.hasTracingEnabled=function(t){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;let n=i.getClient(),r=t||n&&n.getOptions();return!!r&&(r.enableTracing||"tracesSampleRate"in r||"tracesSampler"in r)}},94192:(t,n)=>{function removeTrailingSlash(t){return"/"===t[t.length-1]?t.slice(0,-1):t}Object.defineProperty(n,"__esModule",{value:!0}),n.isSentryRequestUrl=function(t,n){let r=n&&void 0!==n.getClient?n.getClient():n,i=r&&r.getDsn(),o=r&&r.getOptions().tunnel;return!!i&&t.includes(i.host)||!!o&&removeTrailingSlash(t)===removeTrailingSlash(o)}},1265:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.parameterize=function(t,...n){let r=new String(String.raw(t,...n));return r.__sentry_template_string__=t.join("\x00").replace(/%/g,"%%").replace(/\0/g,"%s"),r.__sentry_template_values__=n,r}},69e3:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(68799),a=r(68804),l=r(88954),c=r(37924),g=r(87177),d=new WeakMap;function applyDebugIds(t,n){let r;let o=i.GLOBAL_OBJ._sentryDebugIds;if(!o)return;let a=d.get(n);a?r=a:(r=new Map,d.set(n,r));let l=Object.keys(o).reduce((t,i)=>{let a;let l=r.get(i);l?a=l:(a=n(i),r.set(i,a));for(let n=a.length-1;n>=0;n--){let r=a[n];if(r.filename){t[r.filename]=o[i];break}}return t},{});try{t.exception.values.forEach(t=>{t.stacktrace.frames.forEach(t=>{t.filename&&(t.debug_id=l[t.filename])})})}catch(t){}}function applyDebugMeta(t){let n={};try{t.exception.values.forEach(t=>{t.stacktrace.frames.forEach(t=>{t.debug_id&&(t.abs_path?n[t.abs_path]=t.debug_id:t.filename&&(n[t.filename]=t.debug_id),delete t.debug_id)})})}catch(t){}if(0===Object.keys(n).length)return;t.debug_meta=t.debug_meta||{},t.debug_meta.images=t.debug_meta.images||[];let r=t.debug_meta.images;Object.keys(n).forEach(t=>{r.push({type:"sourcemap",code_file:t,debug_id:n[t]})})}let u=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"];n.applyDebugIds=applyDebugIds,n.applyDebugMeta=applyDebugMeta,n.parseEventHintOrCaptureContext=function(t){return t?t instanceof l.Scope||"function"==typeof t||Object.keys(t).some(t=>u.includes(t))?{captureContext:t}:t:void 0},n.prepareEvent=function(t,n,r,d,u,I){let{normalizeDepth:p=3,normalizeMaxBreadth:m=1e3}=t,h={...n,event_id:n.event_id||r.event_id||i.uuid4(),timestamp:n.timestamp||i.dateTimestampInSeconds()},C=r.integrations||t.integrations.map(t=>t.name);(function(t,n){let{environment:r,release:a,dist:l,maxValueLength:c=250}=n;"environment"in t||(t.environment="environment"in n?r:o.DEFAULT_ENVIRONMENT),void 0===t.release&&void 0!==a&&(t.release=a),void 0===t.dist&&void 0!==l&&(t.dist=l),t.message&&(t.message=i.truncate(t.message,c));let g=t.exception&&t.exception.values&&t.exception.values[0];g&&g.value&&(g.value=i.truncate(g.value,c));let d=t.request;d&&d.url&&(d.url=i.truncate(d.url,c))})(h,t),C.length>0&&(h.sdk=h.sdk||{},h.sdk.integrations=[...h.sdk.integrations||[],...C]),void 0===n.type&&applyDebugIds(h,t.stackParser);let b=function(t,n){if(!n)return t;let r=t?t.clone():new l.Scope;return r.update(n),r}(d,r.captureContext);r.mechanism&&i.addExceptionMechanism(h,r.mechanism);let y=u&&u.getEventProcessors?u.getEventProcessors():[],G=l.getGlobalScope().getScopeData();if(I){let t=I.getScopeData();c.mergeScopeData(G,t)}if(b){let t=b.getScopeData();c.mergeScopeData(G,t)}let A=[...r.attachments||[],...G.attachments];A.length&&(r.attachments=A),c.applyScopeDataToEvent(h,G);let B=[...y,...a.getGlobalEventProcessors(),...G.eventProcessors],Z=a.notifyEventProcessors(B,h,r);return Z.then(t=>(t&&applyDebugMeta(t),"number"==typeof p&&p>0)?function(t,n,r){if(!t)return null;let o={...t,...t.breadcrumbs&&{breadcrumbs:t.breadcrumbs.map(t=>({...t,...t.data&&{data:i.normalize(t.data,n,r)}}))},...t.user&&{user:i.normalize(t.user,n,r)},...t.contexts&&{contexts:i.normalize(t.contexts,n,r)},...t.extra&&{extra:i.normalize(t.extra,n,r)}};return t.contexts&&t.contexts.trace&&o.contexts&&(o.contexts.trace=t.contexts.trace,t.contexts.trace.data&&(o.contexts.trace.data=i.normalize(t.contexts.trace.data,n,r))),t.spans&&(o.spans=t.spans.map(t=>{let o=g.spanToJSON(t).data;return o&&(t.data=i.normalize(o,n,r)),t})),o}(t,p,m):t)}},67663:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(41277);n.applySdkMetadata=function(t,n,r=[n],o="npm"){let a=t._metadata||{};a.sdk||(a.sdk={name:`sentry.javascript.${n}`,packages:r.map(t=>({name:`${o}:@sentry/${t}`,version:i.SDK_VERSION})),version:i.SDK_VERSION}),t._metadata=a}},87177:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);function ensureTimestampInSeconds(t){return t>9999999999?t/1e3:t}function spanToJSON(t){return"function"==typeof t.getSpanJSON?t.getSpanJSON():"function"==typeof t.toJSON?t.toJSON():{}}function spanIsSampled(t){let{traceFlags:n}=t.spanContext();return!!(1&n)}n.TRACE_FLAG_NONE=0,n.TRACE_FLAG_SAMPLED=1,n.spanIsSampled=spanIsSampled,n.spanTimeInputToSeconds=function(t){return"number"==typeof t?ensureTimestampInSeconds(t):Array.isArray(t)?t[0]+t[1]/1e9:t instanceof Date?ensureTimestampInSeconds(t.getTime()):i.timestampInSeconds()},n.spanToJSON=spanToJSON,n.spanToTraceContext=function(t){let{spanId:n,traceId:r}=t.spanContext(),{data:o,op:a,parent_span_id:l,status:c,tags:g,origin:d}=spanToJSON(t);return i.dropUndefinedKeys({data:o,op:a,parent_span_id:l,span_id:n,status:c,tags:g,trace_id:r,origin:d})},n.spanToTraceHeader=function(t){let{traceId:n,spanId:r}=t.spanContext(),o=spanIsSampled(t);return i.generateSentryTraceHeader(n,r,o)}},41277:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SDK_VERSION="7.120.3"},43911:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a="CaptureConsole",l=i.defineIntegration((t={})=>{let n=t.levels||o.CONSOLE_LEVELS;return{name:a,setupOnce(){},setup(t){"console"in o.GLOBAL_OBJ&&o.addConsoleInstrumentationHandler(({args:r,level:a})=>{i.getClient()===t&&n.includes(a)&&function(t,n){let r={level:o.severityLevelFromString(n),extra:{arguments:t}};i.withScope(a=>{if(a.addEventProcessor(t=>(t.logger="console",o.addExceptionMechanism(t,{handled:!1,type:"console"}),t)),"assert"===n&&!1===t[0]){let n=`Assertion failed: ${o.safeJoin(t.slice(1)," ")||"console.assert"}`;a.setExtra("arguments",t.slice(1)),i.captureMessage(n,r);return}let l=t.find(t=>t instanceof Error);if("error"===n&&l){i.captureException(l,r);return}let c=o.safeJoin(t," ");i.captureMessage(c,r)})}(r,a)})}}}),c=i.convertIntegrationFnToClass(a,l);n.CaptureConsole=c,n.captureConsoleIntegration=l},1357:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=o.GLOBAL_OBJ,l="ContextLines",c=i.defineIntegration((t={})=>{let n=null!=t.frameContextLines?t.frameContextLines:7;return{name:l,setupOnce(){},processEvent:t=>(function(t,n){let r=a.document,i=a.location&&o.stripUrlQueryAndFragment(a.location.href);if(!r||!i)return t;let l=t.exception&&t.exception.values;if(!l||!l.length)return t;let c=r.documentElement.innerHTML;if(!c)return t;let g=["<!DOCTYPE html>","<html>",...c.split("\n"),"</html>"];return l.forEach(t=>{let r=t.stacktrace;r&&r.frames&&(r.frames=r.frames.map(t=>applySourceContextToFrame(t,g,i,n)))}),t})(t,n)}}),g=i.convertIntegrationFnToClass(l,c);function applySourceContextToFrame(t,n,r,i){return t.filename===r&&t.lineno&&n.length&&o.addContextToFrame(n,t,i),t}n.ContextLines=g,n.applySourceContextToFrame=applySourceContextToFrame,n.contextLinesIntegration=c},60932:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;n.DEBUG_BUILD=r},74622:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a="Debug",l=i.defineIntegration((t={})=>{let n={debugger:!1,stringify:!1,...t};return{name:a,setupOnce(){},setup(t){t.on&&t.on("beforeSendEvent",(t,r)=>{n.debugger,o.consoleSandbox(()=>{n.stringify?(console.log(JSON.stringify(t,null,2)),r&&Object.keys(r).length&&console.log(JSON.stringify(r,null,2))):(console.log(t),r&&Object.keys(r).length&&console.log(r))})})}}}),c=i.convertIntegrationFnToClass(a,l);n.Debug=c,n.debugIntegration=l},91010:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(60932),l="Dedupe",c=i.defineIntegration(()=>{let t;return{name:l,setupOnce(){},processEvent(n){if(n.type)return n;try{if(_shouldDropEvent(n,t))return a.DEBUG_BUILD&&o.logger.warn("Event dropped due to being a duplicate of previously captured event."),null}catch(t){}return t=n}}}),g=i.convertIntegrationFnToClass(l,c);function _shouldDropEvent(t,n){return!!n&&!!(function(t,n){let r=t.message,i=n.message;return!!((r||i)&&(!r||i)&&(r||!i)&&r===i&&_isSameFingerprint(t,n)&&_isSameStacktrace(t,n))}(t,n)||function(t,n){let r=_getExceptionFromEvent(n),i=_getExceptionFromEvent(t);return!!(r&&i&&r.type===i.type&&r.value===i.value&&_isSameFingerprint(t,n)&&_isSameStacktrace(t,n))}(t,n))}function _isSameStacktrace(t,n){let r=_getFramesFromEvent(t),i=_getFramesFromEvent(n);if(!r&&!i)return!0;if(r&&!i||!r&&i||i.length!==r.length)return!1;for(let t=0;t<i.length;t++){let n=i[t],o=r[t];if(n.filename!==o.filename||n.lineno!==o.lineno||n.colno!==o.colno||n.function!==o.function)return!1}return!0}function _isSameFingerprint(t,n){let r=t.fingerprint,i=n.fingerprint;if(!r&&!i)return!0;if(r&&!i||!r&&i)return!1;try{return!(r.join("")!==i.join(""))}catch(t){return!1}}function _getExceptionFromEvent(t){return t.exception&&t.exception.values&&t.exception.values[0]}function _getFramesFromEvent(t){let n=t.exception;if(n)try{return n.values[0].stacktrace.frames}catch(t){}}n.Dedupe=g,n._shouldDropEvent=_shouldDropEvent,n.dedupeIntegration=c},18180:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(60932),l="ExtraErrorData",c=i.defineIntegration((t={})=>{let n=t.depth||3,r=t.captureErrorCause||!1;return{name:l,setupOnce(){},processEvent:(t,i)=>(function(t,n={},r,i){if(!n.originalException||!o.isError(n.originalException))return t;let l=n.originalException.name||n.originalException.constructor.name,c=function(t,n){try{let r=["name","message","stack","line","column","fileName","lineNumber","columnNumber","toJSON"],i={};for(let n of Object.keys(t)){if(-1!==r.indexOf(n))continue;let a=t[n];i[n]=o.isError(a)?a.toString():a}if(n&&void 0!==t.cause&&(i.cause=o.isError(t.cause)?t.cause.toString():t.cause),"function"==typeof t.toJSON){let n=t.toJSON();for(let t of Object.keys(n)){let r=n[t];i[t]=o.isError(r)?r.toString():r}}return i}catch(t){a.DEBUG_BUILD&&o.logger.error("Unable to extract extra data from the Error object:",t)}return null}(n.originalException,i);if(c){let n={...t.contexts},i=o.normalize(c,r);return o.isPlainObject(i)&&(o.addNonEnumerableProperty(i,"__sentry_skip_normalization__",!0),n[l]=i),{...t,contexts:n}}return t})(t,i,n,r)}}),g=i.convertIntegrationFnToClass(l,c);n.ExtraErrorData=g,n.extraErrorDataIntegration=c},96741:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(60932),l="HttpClient",c=i.defineIntegration((t={})=>{let n={failedRequestStatusCodes:[[500,599]],failedRequestTargets:[/.*/],...t};return{name:l,setupOnce(){},setup(t){o.supportsNativeFetch()&&o.addFetchInstrumentationHandler(r=>{if(i.getClient()!==t)return;let{response:l,args:c}=r,[g,d]=c;l&&function(t,n,r,l){if(_shouldCaptureResponse(t,r.status,r.url)){let t,c,g,d;let u=!l&&n instanceof Request||n instanceof Request&&n.bodyUsed?n:new Request(n,l);_shouldSendDefaultPii()&&([{headers:t,cookies:g},{headers:c,cookies:d}]=[{cookieHeader:"Cookie",obj:u},{cookieHeader:"Set-Cookie",obj:r}].map(({cookieHeader:t,obj:n})=>{let r;let i=function(t){let n={};return t.forEach((t,r)=>{n[r]=t}),n}(n.headers);try{let n=i[t]||i[t.toLowerCase()]||void 0;n&&(r=_parseCookieString(n))}catch(n){a.DEBUG_BUILD&&o.logger.log(`Could not extract cookies from header ${t}`)}return{headers:i,cookies:r}}));let I=_createEvent({url:u.url,method:u.method,status:r.status,requestHeaders:t,responseHeaders:c,requestCookies:g,responseCookies:d});i.captureEvent(I)}}(n,g,l,d)}),"XMLHttpRequest"in o.GLOBAL_OBJ&&o.addXhrInstrumentationHandler(r=>{if(i.getClient()!==t)return;let l=r.xhr,c=l[o.SENTRY_XHR_DATA_KEY];if(!c)return;let{method:g,request_headers:d}=c;try{!function(t,n,r,l){if(_shouldCaptureResponse(t,n.status,n.responseURL)){let t,c,g;if(_shouldSendDefaultPii()){try{let t=n.getResponseHeader("Set-Cookie")||n.getResponseHeader("set-cookie")||void 0;t&&(c=_parseCookieString(t))}catch(t){a.DEBUG_BUILD&&o.logger.log("Could not extract cookies from response headers")}try{g=function(t){let n=t.getAllResponseHeaders();return n?n.split("\r\n").reduce((t,n)=>{let[r,i]=n.split(": ");return t[r]=i,t},{}):{}}(n)}catch(t){a.DEBUG_BUILD&&o.logger.log("Could not extract headers from response")}t=l}let d=_createEvent({url:n.responseURL,method:r,status:n.status,requestHeaders:t,responseHeaders:g,responseCookies:c});i.captureEvent(d)}}(n,l,g,d)}catch(t){a.DEBUG_BUILD&&o.logger.warn("Error while extracting response event form XHR response",t)}})}}}),g=i.convertIntegrationFnToClass(l,c);function _parseCookieString(t){return t.split("; ").reduce((t,n)=>{let[r,i]=n.split("=");return t[r]=i,t},{})}function _shouldCaptureResponse(t,n,r){return t.failedRequestStatusCodes.some(t=>"number"==typeof t?t===n:n>=t[0]&&n<=t[1])&&t.failedRequestTargets.some(t=>"string"==typeof t?r.includes(t):t.test(r))&&!i.isSentryRequestUrl(r,i.getClient())}function _createEvent(t){let n=`HTTP Client Error with status code: ${t.status}`,r={message:n,exception:{values:[{type:"Error",value:n}]},request:{url:t.url,method:t.method,headers:t.requestHeaders,cookies:t.requestCookies},contexts:{response:{status_code:t.status,headers:t.responseHeaders,cookies:t.responseCookies,body_size:function(t){if(t){let n=t["Content-Length"]||t["content-length"];if(n)return parseInt(n,10)}}(t.responseHeaders)}}};return o.addExceptionMechanism(r,{type:"http.client",handled:!1}),r}function _shouldSendDefaultPii(){let t=i.getClient();return!!t&&!!t.getOptions().sendDefaultPii}n.HttpClient=g,n.httpClientIntegration=c},46875:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(43911),o=r(74622),a=r(91010),l=r(18180),c=r(2082),g=r(33613),d=r(94948),u=r(29114),I=r(51732),p=r(96741),m=r(1357);n.CaptureConsole=i.CaptureConsole,n.captureConsoleIntegration=i.captureConsoleIntegration,n.Debug=o.Debug,n.debugIntegration=o.debugIntegration,n.Dedupe=a.Dedupe,n.dedupeIntegration=a.dedupeIntegration,n.ExtraErrorData=l.ExtraErrorData,n.extraErrorDataIntegration=l.extraErrorDataIntegration,n.Offline=c.Offline,n.ReportingObserver=g.ReportingObserver,n.reportingObserverIntegration=g.reportingObserverIntegration,n.RewriteFrames=d.RewriteFrames,n.rewriteFramesIntegration=d.rewriteFramesIntegration,n.SessionTiming=u.SessionTiming,n.sessionTimingIntegration=u.sessionTimingIntegration,n.Transaction=I.Transaction,n.HttpClient=p.HttpClient,n.httpClientIntegration=p.httpClientIntegration,n.ContextLines=m.ContextLines,n.contextLinesIntegration=m.contextLinesIntegration},2082:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=r(32967),a=r(60932),l=i.GLOBAL_OBJ;let Offline=class Offline{static __initStatic(){this.id="Offline"}constructor(t={}){this.name=Offline.id,this.maxStoredEvents=t.maxStoredEvents||30,this.offlineEventStore=o.createInstance({name:"sentry/offlineEventStore"})}setupOnce(t,n){this.hub=n(),"addEventListener"in l&&l.addEventListener("online",()=>{this._sendEvents().catch(()=>{a.DEBUG_BUILD&&i.logger.warn("could not send cached events")})});let eventProcessor=t=>this.hub&&this.hub.getIntegration(Offline)&&"navigator"in l&&"onLine"in l.navigator&&!l.navigator.onLine?(a.DEBUG_BUILD&&i.logger.log("Event dropped due to being a offline - caching instead"),this._cacheEvent(t).then(t=>this._enforceMaxEvents()).catch(t=>{a.DEBUG_BUILD&&i.logger.warn("could not cache event while offline")}),null):t;eventProcessor.id=this.name,t(eventProcessor),"navigator"in l&&"onLine"in l.navigator&&l.navigator.onLine&&this._sendEvents().catch(()=>{a.DEBUG_BUILD&&i.logger.warn("could not send cached events")})}async _cacheEvent(t){return this.offlineEventStore.setItem(i.uuid4(),i.normalize(t))}async _enforceMaxEvents(){let t=[];return this.offlineEventStore.iterate((n,r,i)=>{t.push({cacheKey:r,event:n})}).then(()=>this._purgeEvents(t.sort((t,n)=>(n.event.timestamp||0)-(t.event.timestamp||0)).slice(this.maxStoredEvents<t.length?this.maxStoredEvents:t.length).map(t=>t.cacheKey))).catch(t=>{a.DEBUG_BUILD&&i.logger.warn("could not enforce max events")})}async _purgeEvent(t){return this.offlineEventStore.removeItem(t)}async _purgeEvents(t){return Promise.all(t.map(t=>this._purgeEvent(t))).then()}async _sendEvents(){return this.offlineEventStore.iterate((t,n,r)=>{this.hub?(this.hub.captureEvent(t),this._purgeEvent(n).catch(t=>{a.DEBUG_BUILD&&i.logger.warn("could not purge event from cache")})):a.DEBUG_BUILD&&i.logger.warn("no hub found - could not send cached event")})}};Offline.__initStatic(),n.Offline=Offline},33613:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=o.GLOBAL_OBJ,l="ReportingObserver",c=new WeakMap,g=i.defineIntegration((t={})=>{let n=t.types||["crash","deprecation","intervention"];function handler(t){if(c.has(i.getClient()))for(let n of t)i.withScope(t=>{t.setExtra("url",n.url);let r=`ReportingObserver [${n.type}]`,o="No details available";if(n.body){let r={};for(let t in n.body)r[t]=n.body[t];if(t.setExtra("body",r),"crash"===n.type){let t=n.body;o=[t.crashId||"",t.reason||""].join(" ").trim()||o}else{let t=n.body;o=t.message||o}}i.captureMessage(`${r}: ${o}`)})}return{name:l,setupOnce(){if(!o.supportsReportingObserver())return;let t=new a.ReportingObserver(handler,{buffered:!0,types:n});t.observe()},setup(t){c.set(t,!0)}}}),d=i.convertIntegrationFnToClass(l,g);n.ReportingObserver=d,n.reportingObserverIntegration=g},94948:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a="RewriteFrames",l=i.defineIntegration((t={})=>{let n=t.root,r=t.prefix||"app:///",i=t.iteratee||(t=>{if(!t.filename)return t;let i=/^[a-zA-Z]:\\/.test(t.filename)||t.filename.includes("\\")&&!t.filename.includes("/"),a=/^\//.test(t.filename);if(i||a){let a=i?t.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):t.filename,l=n?o.relative(n,a):o.basename(a);t.filename=`${r}${l}`}return t});return{name:a,setupOnce(){},processEvent(t){let n=t;return t.exception&&Array.isArray(t.exception.values)&&(n=function(t){try{return{...t,exception:{...t.exception,values:t.exception.values.map(t=>{var n;return{...t,...t.stacktrace&&{stacktrace:{...n=t.stacktrace,frames:n&&n.frames&&n.frames.map(t=>i(t))}}}})}}}catch(n){return t}}(n)),n}}}),c=i.convertIntegrationFnToClass(a,l);n.RewriteFrames=c,n.rewriteFramesIntegration=l},29114:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o="SessionTiming",a=i.defineIntegration(()=>{let t=Date.now();return{name:o,setupOnce(){},processEvent(n){let r=Date.now();return{...n,extra:{...n.extra,"session:start":t,"session:duration":r-t,"session:end":r}}}}}),l=i.convertIntegrationFnToClass(o,a);n.SessionTiming=l,n.sessionTimingIntegration=a},51732:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o="Transaction",a=i.convertIntegrationFnToClass(o,()=>({name:o,setupOnce(){},processEvent(t){let n=function(t){let n=t.exception&&t.exception.values&&t.exception.values[0];return n&&n.stacktrace&&n.stacktrace.frames||[]}(t);for(let r=n.length-1;r>=0;r--){let i=n[r];if(!0===i.in_app){t.transaction=i.module||i.function?`${i.module||"?"}/${i.function||"?"}`:"<unknown>";break}}return t}}));n.Transaction=a},41108:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(47047);async function captureUnderscoreErrorException(t){let{req:n,res:r,err:a}=t,l=r&&r.statusCode||t.statusCode;if(l&&l<500||!t.pathname)return Promise.resolve();i.withScope(t=>{n&&t.setSDKProcessingMetadata({request:n}),i.captureException(a||`_error.js called with falsy error (${a})`,{mechanism:{type:"instrument",handled:!1,data:{function:"_error.getInitialProps"}}})}),await o.flushQueue()}n.captureUnderscoreErrorException=captureUnderscoreErrorException},73961:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;n.DEBUG_BUILD=r},14863:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(81277),l=r(1462),c=a.GLOBAL_OBJ;async function resolveStackFrame(t,n){try{if(!(o([t,"access",t=>t.file,"optionalAccess",t=>t.startsWith,"call",t=>t("webpack-internal:")])||o([t,"access",t=>t.file,"optionalAccess",t=>t.startsWith,"call",t=>t("file:")])))return null;let r=new URLSearchParams;r.append("isServer",String(!1)),r.append("isEdgeServer",String(!1)),r.append("isAppDirectory",String(!0)),r.append("errorMessage",n.toString()),Object.keys(t).forEach(n=>{r.append(n,i(t[n],()=>"").toString())});let a=i(c.__sentryBasePath,()=>"");""===a||a.match(/^\//)||(a=`/${a}`);let l=new AbortController,g=setTimeout(()=>l.abort(),3e3),d=await fetch(`${"undefined"==typeof window?"http://localhost:3000":""}${a}/__nextjs_original-stack-frame?${r.toString()}`,{signal:l.signal}).finally(()=>{clearTimeout(g)});if(!d.ok||204===d.status)return null;let u=await d.json();return{originalCodeFrame:u.originalCodeFrame,originalStackFrame:u.originalStackFrame}}catch(t){return null}}async function devErrorSymbolicationEventProcessor(t,n){try{if(n.originalException&&n.originalException instanceof Error&&n.originalException.stack){let r=l.parse(n.originalException.stack),i=await Promise.all(r.map(t=>resolveStackFrame(t,n.originalException)));o([t,"access",t=>t.exception,"optionalAccess",t=>t.values,"optionalAccess",t=>t[0],"access",t=>t.stacktrace,"optionalAccess",t=>t.frames])&&(t.exception.values[0].stacktrace.frames=t.exception.values[0].stacktrace.frames.map((t,n,r)=>{let a=i[r.length-1-n];if(!a||!a.originalStackFrame||!a.originalCodeFrame)return{...t,platform:o([t,"access",t=>t.filename,"optionalAccess",t=>t.startsWith,"call",t=>t("node:internal")])?"nodejs":void 0,in_app:!1};let{contextLine:l,preContextLines:c,postContextLines:g}=function(t){let n;let r=t.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"").split("\n").filter(t=>!t.match(/^\s*\|/)).map(t=>({line:t,isErrorLine:!!t.match(/^>/)})).map(t=>({...t,line:t.line.replace(/^.*\|/,"")})),i=[],o=[],a=!1;for(let t of r)t.isErrorLine?(n=t.line,a=!0):a?o.push(t.line):i.push(t.line);return{contextLine:n,preContextLines:i,postContextLines:o}}(a.originalCodeFrame);return{...t,pre_context:c,context_line:l,post_context:g,function:a.originalStackFrame.methodName,filename:a.originalStackFrame.file||void 0,lineno:a.originalStackFrame.lineNumber||void 0,colno:a.originalStackFrame.column||void 0}}))}}catch(t){}return t}n.devErrorSymbolicationEventProcessor=devErrorSymbolicationEventProcessor},34780:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getVercelEnv=function(t){let n=t?process.env.NEXT_PUBLIC_VERCEL_ENV:process.env.VERCEL_ENV;return n?`vercel-${n}`:void 0}},67206:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);n.isNotFoundNavigationError=function(t){return i.isError(t)&&"NEXT_NOT_FOUND"===t.digest},n.isRedirectNavigationError=function(t){return i.isError(t)&&"string"==typeof t.digest&&t.digest.startsWith("NEXT_REDIRECT;")}},48999:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r=new WeakMap;n.commonObjectToPropagationContext=function(t,n){if("object"!=typeof t||!t)return n;{let i=r.get(t);return i||(r.set(t,n),n)}}},9617:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(47047);n.withEdgeWrapping=function(t,n){return async function(...r){let l,c;i.addTracingExtensions();let g=r[0];return g instanceof Request&&(l=g.headers.get("sentry-trace")||"",c=g.headers.get("baggage")),i.continueTrace({sentryTrace:l,baggage:c},()=>i.startSpan({name:n.spanDescription,op:n.spanOp,attributes:{[i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route",[i.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.function.nextjs.withEdgeWrapping"},metadata:{request:g instanceof Request?o.winterCGRequestToRequestData(g):void 0}},async o=>{let a=await i.handleCallbackErrors(()=>t.apply(this,r),t=>{i.captureException(t,{mechanism:{type:"instrument",handled:!1,data:{function:n.mechanismFunctionName}}})});return o&&(a instanceof Response?i.setHttpStatus(o,a.status):o.setStatus("ok")),a}).finally(()=>a.flushQueue()))}}},97666:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(20502);n.isBuild=function(){return process.env.NEXT_PHASE===i.PHASE_PRODUCTION_BUILD}},80562:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.platformSupportsStreaming=()=>!process.env.LAMBDA_TASK_ROOT&&!process.env.VERCEL},47047:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(73961);function finishSpan(t,n){t&&(i.setHttpStatus(t,n.statusCode),t.end())}async function flushQueue(){try{a.DEBUG_BUILD&&o.logger.log("Flushing events..."),await i.flush(2e3),a.DEBUG_BUILD&&o.logger.log("Done flushing events")}catch(t){a.DEBUG_BUILD&&o.logger.log("Error while flushing events:\n",t)}}n.autoEndSpanOnResponseEnd=function(t,n){n.end&&!n.end.__sentry_original__&&o.fill(n,"end",n=>function(...r){return finishSpan(t,this),n.call(this,...r)})},n.finishSpan=finishSpan,n.flushQueue=flushQueue},84360:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(80562),c=r(47047);function getSpanFromRequest(t){return t._sentrySpan}async function callDataFetcherTraced(t,n,r){let{parameterizedRoute:a,dataFetchingMethodName:g}=r;return o.startSpan({op:"function.nextjs",name:`${g} (${a})`,attributes:{[o.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.function.nextjs",[o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route"}},async r=>{i([r,"optionalAccess",t=>t.setStatus,"call",t=>t("ok")]);try{return await t(...n)}catch(t){throw i([r,"optionalAccess",t=>t.setStatus,"call",t=>t("internal_error")]),o.captureException(t,{mechanism:{handled:!1}}),t}finally{i([r,"optionalAccess",t=>t.end,"call",t=>t()]),l.platformSupportsStreaming()||await c.flushQueue()}})}n.callDataFetcherTraced=callDataFetcherTraced,n.getSpanFromRequest=getSpanFromRequest,n.withErrorInstrumentation=function(t){return async function(...n){try{return await t.apply(this,n)}catch(t){throw o.captureException(t,{mechanism:{handled:!1}}),t}}},n.withTracedServerSideDataFetcher=function(t,n,r,g){return async function(...d){return o.withIsolationScope(async u=>{u.setSDKProcessingMetadata({request:n});let I=n.headers&&a.isString(n.headers["sentry-trace"])?n.headers["sentry-trace"]:void 0,p=i([n,"access",t=>t.headers,"optionalAccess",t=>t.baggage]);return o.continueTrace({sentryTrace:I,baggage:p},()=>{let a=getSpanFromRequest(n);if(!a&&(a=o.startInactiveSpan({name:g.requestedRouteName,op:"http.server",attributes:{[o.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.function.nextjs",[o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route"}}))){var u;a.setStatus("ok"),u=a,n._sentrySpan=u,c.autoEndSpanOnResponseEnd(a,r)}let withActiveSpanCallback=()=>o.startSpanManual({op:"function.nextjs",name:`${g.dataFetchingMethodName} (${g.dataFetcherRouteName})`,attributes:{[o.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.function.nextjs",[o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route"}},async n=>{i([n,"optionalAccess",t=>t.setStatus,"call",t=>t("ok")]);try{return await t.apply(this,d)}catch(t){throw i([n,"optionalAccess",t=>t.setStatus,"call",t=>t("internal_error")]),i([a,"optionalAccess",t=>t.setStatus,"call",t=>t("internal_error")]),t}finally{i([n,"optionalAccess",t=>t.end,"call",t=>t()]),l.platformSupportsStreaming()||await c.flushQueue()}});return a?o.withActiveSpan(a,withActiveSpanCallback):withActiveSpanCallback()})})}}},81579:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(73961),g=r(67206),d=r(80562),u=r(47047);async function withServerActionInstrumentationImplementation(t,n,r){return a.addTracingExtensions(),a.withIsolationScope(I=>{let p,m;let h=o([a.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t(),"access",t=>t.sendDefaultPii]),C={};try{p=i(o([n,"access",t=>t.headers,"optionalAccess",t=>t.get,"call",t=>t("sentry-trace")]),()=>void 0),m=o([n,"access",t=>t.headers,"optionalAccess",t=>t.get,"call",t=>t("baggage")]),o([n,"access",t=>t.headers,"optionalAccess",t=>t.forEach,"call",t=>t((t,n)=>{C[n]=t})])}catch(t){c.DEBUG_BUILD&&l.logger.warn("Sentry wasn't able to extract the tracing headers for a server action. Will not trace this request.")}return I.setSDKProcessingMetadata({request:{headers:C}}),a.continueTrace({sentryTrace:p,baggage:m},async()=>{try{return await a.startSpan({op:"function.server_action",name:`serverAction/${t}`,metadata:{source:"route"}},async t=>{let i=await a.handleCallbackErrors(r,n=>{g.isNotFoundNavigationError(n)?o([t,"optionalAccess",t=>t.setStatus,"call",t=>t("not_found")]):g.isRedirectNavigationError(n)||(o([t,"optionalAccess",t=>t.setStatus,"call",t=>t("internal_error")]),a.captureException(n,{mechanism:{handled:!1}}))});return(void 0!==n.recordResponse?n.recordResponse:h)&&a.getIsolationScope().setExtra("server_action_result",i),n.formData&&n.formData.forEach((t,n)=>{a.getIsolationScope().setExtra(`server_action_form_data.${n}`,"string"==typeof t?t:"[non-string value]")}),i})}finally{d.platformSupportsStreaming()||await u.flushQueue()}})})}n.withServerActionInstrumentation=function(...t){if("function"==typeof t[1]){let[n,r]=t;return withServerActionInstrumentationImplementation(n,{},r)}{let[n,r,i]=t;return withServerActionInstrumentationImplementation(n,r,i)}}},44606:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(80562),c=r(47047);function wrapApiHandlerWithSentry(t,n){return new Proxy(t,{apply:(t,r,i)=>withSentry(t,n).apply(r,i)})}function withSentry(t,n){return new Proxy(t,{apply:(t,r,g)=>{let[d,u]=g;return d?u?d.__withSentry_applied__?t.apply(r,g):(d.__withSentry_applied__=!0,o.addTracingExtensions(),o.runWithAsyncContext(()=>o.continueTrace({sentryTrace:d.headers&&a.isString(d.headers["sentry-trace"])?d.headers["sentry-trace"]:void 0,baggage:i([d,"access",t=>t.headers,"optionalAccess",t=>t.baggage])},()=>{let i=n;if(!i){let t=`${d.url}`;if(i=a.stripUrlQueryAndFragment(t),d.query)for(let[t,n]of Object.entries(d.query))i=i.replace(`${n}`,`[${t}]`)}let I=`${(d.method||"GET").toUpperCase()} `;return o.getCurrentScope().setSDKProcessingMetadata({request:d}),o.startSpanManual({name:`${I}${i}`,op:"http.server",attributes:{[o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route",[o.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.http.nextjs"},metadata:{request:d}},async n=>{u.end=new Proxy(u.end,{apply(r,i,a){n&&(o.setHttpStatus(n,u.statusCode),n.end()),l.platformSupportsStreaming()&&!t.__sentry_test_doesnt_support_streaming__?r.apply(i,a):c.flushQueue().then(()=>{r.apply(i,a)})}});try{let n=await t.apply(r,g);return n}catch(i){let r=a.objectify(i);throw o.captureException(r,{mechanism:{type:"instrument",handled:!1,data:{wrapped_handler:t.name,function:"withSentry"}}}),u.statusCode=500,u.statusMessage="Internal Server Error",n&&(o.setHttpStatus(n,u.statusCode),n.end()),l.platformSupportsStreaming()&&!t.__sentry_test_doesnt_support_streaming__&&await c.flushQueue(),r}})}))):(a.logger.debug(`Wrapped API handler on route "${n}" was not passed a response object. Will not instrument.`),t.apply(r,g)):(a.logger.debug(`Wrapped API handler on route "${n}" was not passed a request object. Will not instrument.`),t.apply(r,g))}})}n.withSentry=withSentry,n.withSentryAPI=wrapApiHandlerWithSentry,n.wrapApiHandlerWithSentry=wrapApiHandlerWithSentry},18212:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961);n.wrapApiHandlerWithSentryVercelCrons=function(t,n){return new Proxy(t,{apply:(t,r,a)=>o.runWithAsyncContext(()=>{let l;if(!a||!a[0])return t.apply(r,a);o.addTracingExtensions();let[c]=a,g="nextUrl"in c?c.nextUrl.pathname:c.url,d="nextUrl"in c?c.headers.get("user-agent"):c.headers["user-agent"];if(!n||!i([d,"optionalAccess",t=>t.includes,"call",t=>t("vercel-cron")]))return t.apply(r,a);let u=n.find(t=>t.path===g);if(!u||!u.path||!u.schedule)return t.apply(r,a);let I=u.path,p=o.captureCheckIn({monitorSlug:I,status:"in_progress"},{maxRuntime:720,schedule:{type:"crontab",value:u.schedule}}),m=Date.now()/1e3,handleErrorCase=()=>{o.captureCheckIn({checkInId:p,monitorSlug:I,status:"error",duration:Date.now()/1e3-m})};try{l=t.apply(r,a)}catch(t){throw handleErrorCase(),t}return"object"==typeof l&&null!==l&&"then"in l?Promise.resolve(l).then(()=>{o.captureCheckIn({checkInId:p,monitorSlug:I,status:"ok",duration:Date.now()/1e3-m})},()=>{handleErrorCase()}):o.captureCheckIn({checkInId:p,monitorSlug:I,status:"ok",duration:Date.now()/1e3-m}),l})})}},8443:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(97666),g=r(84360);function wrapAppGetInitialPropsWithSentry(t){return new Proxy(t,{apply:async(t,n,r)=>{if(c.isBuild())return t.apply(n,r);a.addTracingExtensions();let[d]=r,{req:u,res:I}=d.ctx,p=g.withErrorInstrumentation(t),m=o([a.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]);if(!u||!I||"sentry"!==o([m,"optionalAccess",t=>t.instrumenter]))return p.apply(n,r);{let t=g.withTracedServerSideDataFetcher(p,u,I,{dataFetcherRouteName:"/_app",requestedRouteName:d.ctx.pathname,dataFetchingMethodName:"getInitialProps"}),o=await t.apply(n,r),c=a.getActiveSpan(),m=i(g.getSpanFromRequest(u),()=>c?a.getRootSpan(c):void 0);if(o.pageProps||(o.pageProps={}),m){o.pageProps._sentryTraceData=a.spanToTraceHeader(m);let t=a.getDynamicSamplingContextFromSpan(m);o.pageProps._sentryBaggage=l.dynamicSamplingContextToSentryBaggageHeader(t)}return o}}})}n.withSentryServerSideAppGetInitialProps=wrapAppGetInitialPropsWithSentry,n.wrapAppGetInitialPropsWithSentry=wrapAppGetInitialPropsWithSentry},89570:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(97666),l=r(84360);function wrapDocumentGetInitialPropsWithSentry(t){return new Proxy(t,{apply:(t,n,r)=>{if(a.isBuild())return t.apply(n,r);o.addTracingExtensions();let[c]=r,{req:g,res:d}=c,u=l.withErrorInstrumentation(t),I=i([o.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]);if(!g||!d||"sentry"!==i([I,"optionalAccess",t=>t.instrumenter]))return u.apply(n,r);{let t=l.withTracedServerSideDataFetcher(u,g,d,{dataFetcherRouteName:"/_document",requestedRouteName:c.pathname,dataFetchingMethodName:"getInitialProps"});return t.apply(n,r)}}})}n.withSentryServerSideDocumentGetInitialProps=wrapDocumentGetInitialPropsWithSentry,n.wrapDocumentGetInitialPropsWithSentry=wrapDocumentGetInitialPropsWithSentry},74654:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(97666),g=r(84360);function wrapErrorGetInitialPropsWithSentry(t){return new Proxy(t,{apply:async(t,n,r)=>{if(c.isBuild())return t.apply(n,r);a.addTracingExtensions();let[d]=r,{req:u,res:I}=d,p=g.withErrorInstrumentation(t),m=o([a.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]);if(!u||!I||"sentry"!==o([m,"optionalAccess",t=>t.instrumenter]))return p.apply(n,r);{let t=g.withTracedServerSideDataFetcher(p,u,I,{dataFetcherRouteName:"/_error",requestedRouteName:d.pathname,dataFetchingMethodName:"getInitialProps"}),o=await t.apply(n,r),c=a.getActiveSpan(),m=i(g.getSpanFromRequest(u),()=>c?a.getRootSpan(c):void 0);if(m){o._sentryTraceData=a.spanToTraceHeader(m);let t=a.getDynamicSamplingContextFromSpan(m);o._sentryBaggage=l.dynamicSamplingContextToSentryBaggageHeader(t)}return o}}})}n.withSentryServerSideErrorGetInitialProps=wrapErrorGetInitialPropsWithSentry,n.wrapErrorGetInitialPropsWithSentry=wrapErrorGetInitialPropsWithSentry},77132:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(67206),g=r(48999);n.wrapGenerationFunctionWithSentry=function(t,n){a.addTracingExtensions();let{requestAsyncStorage:r,componentRoute:d,componentType:u,generationFunctionIdentifier:I}=n;return new Proxy(t,{apply:(t,n,p)=>{let m,h;try{m=o([r,"optionalAccess",t=>t.getStore,"call",t=>t(),"optionalAccess",t=>t.headers])}catch(t){}if(o([a.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t(),"access",t=>t.sendDefaultPii])){let t=p[0],n=t&&"object"==typeof t&&"params"in t?t.params:void 0,r=t&&"object"==typeof t&&"searchParams"in t?t.searchParams:void 0;h={params:n,searchParams:r}}return a.withIsolationScope(r=>{r.setSDKProcessingMetadata({request:{headers:m?l.winterCGHeadersToDict(m):void 0}}),r.setExtra("route_data",h);let C=l.propagationContextFromHeaders(i(o([m,"optionalAccess",t=>t.get,"call",t=>t("sentry-trace")]),()=>void 0),o([m,"optionalAccess",t=>t.get,"call",t=>t("baggage")])),b=g.commonObjectToPropagationContext(m,C);return r.setPropagationContext(b),a.getCurrentScope().setPropagationContext(b),a.startSpanManual({op:"function.nextjs",name:`${u}.${I} (${d})`,data:h,attributes:{[a.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route",[a.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.function.nextjs"}},r=>a.handleCallbackErrors(()=>t.apply(n,p),t=>{c.isNotFoundNavigationError(t)?o([r,"optionalAccess",t=>t.setStatus,"call",t=>t("not_found")]):c.isRedirectNavigationError(t)?o([r,"optionalAccess",t=>t.setStatus,"call",t=>t("ok")]):(o([r,"optionalAccess",t=>t.setStatus,"call",t=>t("internal_error")]),a.captureException(t,{mechanism:{handled:!1}}))},()=>{o([r,"optionalAccess",t=>t.end,"call",t=>t()])}))})}})}},6594:(t,n,r)=>{var{_nullishCoalesce:i,_asyncNullishCoalesce:o,_optionalChain:a}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let l=r(17961),c=r(81277),g=r(97666),d=r(84360);function wrapGetInitialPropsWithSentry(t){return new Proxy(t,{apply:async(t,n,r)=>{if(g.isBuild())return t.apply(n,r);l.addTracingExtensions();let[u]=r,{req:I,res:p}=u,m=d.withErrorInstrumentation(t),h=a([l.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]);if(!I||!p||"sentry"!==a([h,"optionalAccess",t=>t.instrumenter]))return m.apply(n,r);{let t=d.withTracedServerSideDataFetcher(m,I,p,{dataFetcherRouteName:u.pathname,requestedRouteName:u.pathname,dataFetchingMethodName:"getInitialProps"}),a=await o(await t.apply(n,r),async()=>({})),g=l.getActiveSpan(),h=i(d.getSpanFromRequest(I),()=>g?l.getRootSpan(g):void 0);if(h){a._sentryTraceData=l.spanToTraceHeader(h);let t=l.getDynamicSamplingContextFromSpan(h);a._sentryBaggage=c.dynamicSamplingContextToSentryBaggageHeader(t)}return a}}})}n.withSentryServerSideGetInitialProps=wrapGetInitialPropsWithSentry,n.wrapGetInitialPropsWithSentry=wrapGetInitialPropsWithSentry},63825:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(97666),g=r(84360);function wrapGetServerSidePropsWithSentry(t,n){return new Proxy(t,{apply:async(t,r,d)=>{if(c.isBuild())return t.apply(r,d);a.addTracingExtensions();let[u]=d,{req:I,res:p}=u,m=g.withErrorInstrumentation(t),h=o([a.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]);if("sentry"!==o([h,"optionalAccess",t=>t.instrumenter]))return m.apply(r,d);{let t=g.withTracedServerSideDataFetcher(m,I,p,{dataFetcherRouteName:n,requestedRouteName:n,dataFetchingMethodName:"getServerSideProps"}),o=await t.apply(r,d);if(o&&"props"in o){let t=a.getActiveSpan(),n=i(g.getSpanFromRequest(I),()=>t?a.getRootSpan(t):void 0);if(n){o.props._sentryTraceData=a.spanToTraceHeader(n);let t=a.getDynamicSamplingContextFromSpan(n);o.props._sentryBaggage=l.dynamicSamplingContextToSentryBaggageHeader(t)}}return o}}})}n.withSentryGetServerSideProps=wrapGetServerSidePropsWithSentry,n.wrapGetServerSidePropsWithSentry=wrapGetServerSidePropsWithSentry},45921:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(97666),l=r(84360);function wrapGetStaticPropsWithSentry(t,n){return new Proxy(t,{apply:(t,r,c)=>{if(a.isBuild())return t.apply(r,c);o.addTracingExtensions();let g=l.withErrorInstrumentation(t),d=i([o.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]);return"sentry"===i([d,"optionalAccess",t=>t.instrumenter])?l.callDataFetcherTraced(g,c,{parameterizedRoute:n,dataFetchingMethodName:"getStaticProps"}):g.apply(r,c)}})}n.withSentryGetStaticProps=wrapGetStaticPropsWithSentry,n.wrapGetStaticPropsWithSentry=wrapGetStaticPropsWithSentry},22895:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(9617);n.wrapMiddlewareWithSentry=function(t){return new Proxy(t,{apply:(t,n,r)=>i.withEdgeWrapping(t,{spanDescription:"middleware",spanOp:"middleware.nextjs",mechanismFunctionName:"withSentryMiddleware"}).apply(n,r)})}},8844:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277);n.wrapPageComponentWithSentry=function(t){return(o.addTracingExtensions(),"function"==typeof t&&i([t,"optionalAccess",t=>t.prototype,"optionalAccess",t=>t.isReactComponent]))?class extends t{render(...t){return o.runWithAsyncContext(()=>{let n=o.getCurrentScope(),r="object"==typeof this.props&&null!==this.props&&"_sentryTraceData"in this.props&&"string"==typeof this.props._sentryTraceData?this.props._sentryTraceData:void 0;if(r){let t=a.extractTraceparentData(r);n.setContext("trace",{span_id:i([t,"optionalAccess",t=>t.parentSpanId]),trace_id:i([t,"optionalAccess",t=>t.traceId])})}try{return super.render(...t)}catch(t){throw o.captureException(t,{mechanism:{handled:!1}}),t}})}}:"function"==typeof t?new Proxy(t,{apply:(t,n,r)=>o.runWithAsyncContext(()=>{let l=o.getCurrentScope(),c=i([r,"optionalAccess",t=>t[0],"optionalAccess",t=>t._sentryTraceData]);if(c){let t=a.extractTraceparentData(c);l.setContext("trace",{span_id:i([t,"optionalAccess",t=>t.parentSpanId]),trace_id:i([t,"optionalAccess",t=>t.traceId])})}try{return t.apply(n,r)}catch(t){throw o.captureException(t,{mechanism:{handled:!1}}),t}})}):t}},67980:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(67206),g=r(80562),d=r(47047);n.wrapRouteHandlerWithSentry=function(t,n){a.addTracingExtensions();let{method:r,parameterizedRoute:u,baggageHeader:I,sentryTraceHeader:p,headers:m}=n;return new Proxy(t,{apply:(t,n,h)=>a.withIsolationScope(async C=>(C.setSDKProcessingMetadata({request:{headers:m?l.winterCGHeadersToDict(m):void 0}}),a.continueTrace({sentryTrace:i(i(p,()=>o([m,"optionalAccess",t=>t.get,"call",t=>t("sentry-trace")])),()=>void 0),baggage:i(I,()=>o([m,"optionalAccess",t=>t.get,"call",t=>t("baggage")]))},async()=>{try{return await a.startSpan({op:"http.server",name:`${r} ${u}`,attributes:{[a.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"route",[a.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.function.nextjs"}},async r=>{let i=await a.handleCallbackErrors(()=>t.apply(n,h),t=>{c.isRedirectNavigationError(t)||a.captureException(t,{mechanism:{handled:!1}})});try{r&&a.setHttpStatus(r,i.status)}catch(t){}return i})}finally{g.platformSupportsStreaming()||await d.flushQueue()}})))})}},54699:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(81277),c=r(67206),g=r(48999),d=r(47047);n.wrapServerComponentWithSentry=function(t,n){a.addTracingExtensions();let{componentRoute:r,componentType:u}=n;return new Proxy(t,{apply:(t,I,p)=>a.withIsolationScope(m=>{let h=n.headers?l.winterCGHeadersToDict(n.headers):{};m.setSDKProcessingMetadata({request:{headers:h}});let C=l.propagationContextFromHeaders(i(n.sentryTraceHeader,()=>h["sentry-trace"]),i(n.baggageHeader,()=>h.baggage)),b=g.commonObjectToPropagationContext(n.headers,C);return m.setPropagationContext(b),a.getCurrentScope().setPropagationContext(b),a.startSpanManual({op:"function.nextjs",name:`${u} Server Component (${r})`,attributes:{[a.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:"component",[a.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN]:"auto.function.nextjs"}},n=>a.handleCallbackErrors(()=>t.apply(I,p),t=>{c.isNotFoundNavigationError(t)?o([n,"optionalAccess",t=>t.setStatus,"call",t=>t("not_found")]):c.isRedirectNavigationError(t)?o([n,"optionalAccess",t=>t.setStatus,"call",t=>t("ok")]):(o([n,"optionalAccess",t=>t.setStatus,"call",t=>t("internal_error")]),a.captureException(t,{mechanism:{handled:!1}}))},()=>{o([n,"optionalAccess",t=>t.end,"call",t=>t()]),d.flushQueue()}))})})}},97320:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(75720);let Http=class Http extends i.Integrations.Http{constructor(t){super({...t,tracing:!0})}};n.Http=Http},9534:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(75720),a=r(81277),l=r(73961);r(14863);let c=r(34780),g=r(97666),d=r(97320),u=r(93698),I=r(63255),p=r(41108),m=r(45921),h=r(6594),C=r(8443),b=r(89570),y=r(74654),G=r(63825),A=r(54699),B=r(67980),Z=r(18212),f=r(22895),v=r(8844),W=r(77132),S=r(81579),R=r(44606),V={...o.Integrations,Http:d.Http,OnUncaughtException:u.OnUncaughtException},H=g.isBuild(),N=!!process.env.VERCEL;for(let t in n.rewriteFramesIntegration=I.rewriteFramesIntegration,n.captureUnderscoreErrorException=p.captureUnderscoreErrorException,n.withSentryGetStaticProps=m.withSentryGetStaticProps,n.wrapGetStaticPropsWithSentry=m.wrapGetStaticPropsWithSentry,n.withSentryServerSideGetInitialProps=h.withSentryServerSideGetInitialProps,n.wrapGetInitialPropsWithSentry=h.wrapGetInitialPropsWithSentry,n.withSentryServerSideAppGetInitialProps=C.withSentryServerSideAppGetInitialProps,n.wrapAppGetInitialPropsWithSentry=C.wrapAppGetInitialPropsWithSentry,n.withSentryServerSideDocumentGetInitialProps=b.withSentryServerSideDocumentGetInitialProps,n.wrapDocumentGetInitialPropsWithSentry=b.wrapDocumentGetInitialPropsWithSentry,n.withSentryServerSideErrorGetInitialProps=y.withSentryServerSideErrorGetInitialProps,n.wrapErrorGetInitialPropsWithSentry=y.wrapErrorGetInitialPropsWithSentry,n.withSentryGetServerSideProps=G.withSentryGetServerSideProps,n.wrapGetServerSidePropsWithSentry=G.wrapGetServerSidePropsWithSentry,n.wrapServerComponentWithSentry=A.wrapServerComponentWithSentry,n.wrapRouteHandlerWithSentry=B.wrapRouteHandlerWithSentry,n.wrapApiHandlerWithSentryVercelCrons=Z.wrapApiHandlerWithSentryVercelCrons,n.wrapMiddlewareWithSentry=f.wrapMiddlewareWithSentry,n.wrapPageComponentWithSentry=v.wrapPageComponentWithSentry,n.wrapGenerationFunctionWithSentry=W.wrapGenerationFunctionWithSentry,n.withServerActionInstrumentation=S.withServerActionInstrumentation,n.withSentry=R.withSentry,n.withSentryAPI=R.withSentryAPI,n.wrapApiHandlerWithSentry=R.wrapApiHandlerWithSentry,n.ErrorBoundary=t=>t.children?"function"==typeof t.children?t.children():t.children:null,n.IS_BUILD=H,n.Integrations=V,n.createReduxEnhancer=function(){return t=>t},n.init=function(t){if(i.addTracingExtensions(),g.isBuild())return;let n=[...o.getDefaultIntegrations(t).filter(t=>!["Http","OnUncaughtException"].includes(t.name)),I.rewriteFramesIntegration(),new d.Http,new u.OnUncaughtException],r={environment:process.env.SENTRY_ENVIRONMENT||c.getVercelEnv(!1)||"production",defaultIntegrations:n,...t,autoSessionTracking:!1};if(l.DEBUG_BUILD&&r.debug&&a.logger.enable(),l.DEBUG_BUILD&&a.logger.log("Initializing SDK..."),i.getClient()){l.DEBUG_BUILD&&a.logger.log("SDK already initialized");return}i.applySdkMetadata(r,"nextjs",["nextjs","node"]),o.init(r);let filterTransactions=t=>"transaction"===t.type&&"/404"===t.transaction?null:t;filterTransactions.id="NextServer404TransactionFilter";let p=o.getCurrentScope();p.setTag("runtime","node"),N&&p.setTag("vercel",!0),p.addEventProcessor(filterTransactions),l.DEBUG_BUILD&&a.logger.log("SDK successfully initialized")},n.isBuild=()=>g.isBuild(),n.showReportDialog=function(){},n.withErrorBoundary=function(t){return t},o)"default"===t||n.hasOwnProperty(t)||(n[t]=o[t])},93698:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(75720);let OnUncaughtException=class OnUncaughtException extends i.Integrations.OnUncaughtException{constructor(t){super({exitEvenIfOtherHandlersAreRegistered:!1,...t})}};n.OnUncaughtException=OnUncaughtException},63255:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(71017),a=r(17961),l=r(46875),c=r(81277),g=c.GLOBAL_OBJ,customRewriteFramesIntegration=t=>{let n=g.__rewriteFramesDistDir__;if(n){let r=o.resolve(n).replace(/(\/|\\)$/,""),a=new RegExp(c.escapeStringForRegex(r));return l.rewriteFramesIntegration({iteratee:t=>(t.filename=i([t,"access",t=>t.filename,"optionalAccess",t=>t.replace,"call",t=>t(a,"app:///_next")]),t),...t})}return{name:l.RewriteFrames.id,setupOnce:()=>{},processEvent:t=>t}},d=a.defineIntegration(customRewriteFramesIntegration);n.customRewriteFramesIntegration=customRewriteFramesIntegration,n.rewriteFramesIntegration=d},70668:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(13639),a=r(17961);function getCurrentHub(){let t=o.active;if(t)return a.ensureHubOnCarrier(t),a.getHubFromCarrier(t)}function runWithAsyncContext(t,n){let r=o.active;if(r&&i([n,"optionalAccess",t=>t.reuseExisting]))return t();let l=o.create(),c=r?a.getHubFromCarrier(r):void 0,g=function(t){let n={};return a.ensureHubOnCarrier(n,t),a.getHubFromCarrier(n)}(c);return a.setHubOnCarrier(l,g),l.bind(()=>t())()}n.setDomainAsyncContextStrategy=function(){a.setAsyncContextStrategy({getCurrentHub,runWithAsyncContext})}},70481:(t,n,r)=>{let i;var{_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(17961),l=r(50852);n.setHooksAsyncContextStrategy=function(){function getCurrentHub(){return i.getStore()}i||(i=new l.AsyncLocalStorage),a.setAsyncContextStrategy({getCurrentHub,runWithAsyncContext:function(t,n){let r=getCurrentHub();if(r&&o([n,"optionalAccess",t=>t.reuseExisting]))return t();let l=function(t){let n={};return a.ensureHubOnCarrier(n,t),a.getHubFromCarrier(n)}(r);return i.run(l,()=>t())}})}},135:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(1365),o=r(70668),a=r(70481);n.setNodeAsyncContextStrategy=function(){i.NODE_VERSION.major>=14?a.setHooksAsyncContextStrategy():o.setDomainAsyncContextStrategy()}},34881:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(22037),o=r(73837),a=r(17961);let NodeClient=class NodeClient extends a.ServerRuntimeClient{constructor(t){a.applySdkMetadata(t,"node"),t.transportOptions={textEncoder:new o.TextEncoder,...t.transportOptions};let n={...t,platform:"node",runtime:{name:"node",version:global.process.version},serverName:t.serverName||global.process.env.SENTRY_NAME||i.hostname()};super(n)}};n.NodeClient=NodeClient},35667:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r=[["january","1"],["february","2"],["march","3"],["april","4"],["may","5"],["june","6"],["july","7"],["august","8"],["september","9"],["october","10"],["november","11"],["december","12"],["jan","1"],["feb","2"],["mar","3"],["apr","4"],["may","5"],["jun","6"],["jul","7"],["aug","8"],["sep","9"],["oct","10"],["nov","11"],["dec","12"],["sunday","0"],["monday","1"],["tuesday","2"],["wednesday","3"],["thursday","4"],["friday","5"],["saturday","6"],["sun","0"],["mon","1"],["tue","2"],["wed","3"],["thu","4"],["fri","5"],["sat","6"]];n.replaceCronNames=function(t){return r.reduce((t,[n,r])=>t.replace(RegExp(n,"gi"),r),t)}},99314:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(35667),a="Automatic instrumentation of CronJob only supports crontab string";n.instrumentCron=function(t,n){let r=!1;return new Proxy(t,{construct(t,l){let[c,g,d,u,I,...p]=l;if("string"!=typeof c)throw Error(a);if(r)throw Error(`A job named '${n}' has already been scheduled`);r=!0;let m=o.replaceCronNames(c);return new t(c,function(t,r){return i.withMonitor(n,()=>g(t,r),{schedule:{type:"crontab",value:m},timezone:I||void 0})},d,u,I,...p)},get:(t,l)=>"from"===l?l=>{let{cronTime:c,onTick:g,timeZone:d}=l;if("string"!=typeof c)throw Error(a);if(r)throw Error(`A job named '${n}' has already been scheduled`);r=!0;let u=o.replaceCronNames(c);return l.onTick=(t,r)=>i.withMonitor(n,()=>g(t,r),{schedule:{type:"crontab",value:u},timezone:d||void 0}),t.from(l)}:t[l]})}},4005:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(35667);n.instrumentNodeCron=function(t){return new Proxy(t,{get:(t,n)=>"schedule"===n&&t.schedule?new Proxy(t.schedule,{apply(t,n,r){let[l,,c]=r;if(!i([c,"optionalAccess",t=>t.name]))throw Error('Missing "name" for scheduled job. A name is required for Sentry check-in monitoring.');return o.withMonitor(c.name,()=>t.apply(n,r),{schedule:{type:"crontab",value:a.replaceCronNames(l)},timezone:i([c,"optionalAccess",t=>t.timezone])})}}):t[n]})}},53321:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(35667);n.instrumentNodeSchedule=function(t){return new Proxy(t,{get:(t,n)=>"scheduleJob"===n?new Proxy(t.scheduleJob,{apply(t,n,r){let[a,l]=r;if("string"!=typeof a||"string"!=typeof l)throw Error("Automatic instrumentation of 'node-schedule' requires the first parameter of 'scheduleJob' to be a job name string and the second parameter to be a crontab string");return i.withMonitor(a,()=>t.apply(n,r),{schedule:{type:"crontab",value:o.replaceCronNames(l)}})}}):t[n]})}},60037:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;n.DEBUG_BUILD=r},62854:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(60037),c=r(35290),g=r(28485),d=r(60123);function defaultShouldHandleError(t){let n=function(t){let n=t.status||t.statusCode||t.status_code||t.output&&t.output.statusCode;return n?parseInt(n,10):500}(t);return n>=500}let u=g.trpcMiddleware;n.extractRequestData=d.extractRequestData,n.parseRequest=d.parseRequest,n.errorHandler=function(t){return function(n,r,i,a){let l=t&&t.shouldHandleError||defaultShouldHandleError;if(l(n)){o.withScope(t=>{t.setSDKProcessingMetadata({request:r});let l=i.__sentry_transaction;l&&!o.getActiveSpan()&&t.setSpan(l);let g=o.getClient();if(g&&c.isAutoSessionTrackingEnabled(g)){let n=void 0!==g._sessionFlusher;if(n){let n=t.getRequestSession();n&&void 0!==n.status&&(n.status="crashed")}}let d=o.captureException(n,{mechanism:{type:"middleware",handled:!1}});i.sentry=d,a(n)});return}a(n)}},n.requestHandler=function(t){let n=function(t={}){let n;if("include"in t)n={include:t.include};else{let{ip:r,request:i,transaction:o,user:l}=t;(r||i||o||l)&&(n={include:a.dropUndefinedKeys({ip:r,request:i,transaction:o,user:l})})}return n}(t),r=o.getClient();if(r&&c.isAutoSessionTrackingEnabled(r)){r.initSessionFlusher();let t=o.getCurrentScope();t.getSession()&&t.setSession()}return function(r,i,g){if(t&&t.flushTimeout&&t.flushTimeout>0){let n=i.end;i.end=function(r,i,c){o.flush(t.flushTimeout).then(()=>{n.call(this,r,i,c)}).then(null,t=>{l.DEBUG_BUILD&&a.logger.error(t),n.call(this,r,i,c)})}}o.runWithAsyncContext(()=>{let t=o.getCurrentScope();t.setSDKProcessingMetadata({request:r,requestDataOptionsFromExpressHandler:n});let a=o.getClient();c.isAutoSessionTrackingEnabled(a)&&t.setRequestSession({status:"ok"}),i.once("finish",()=>{let t=o.getClient();c.isAutoSessionTrackingEnabled(t)&&setImmediate(()=>{t&&t._captureRequestSession&&t._captureRequestSession()})}),g()})}},n.tracingHandler=function(){return function(t,n,r){let l=i([o.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]);if(!l||"sentry"!==l.instrumenter||"OPTIONS"===i([t,"access",t=>t.method,"optionalAccess",t=>t.toUpperCase,"call",t=>t()])||"HEAD"===i([t,"access",t=>t.method,"optionalAccess",t=>t.toUpperCase,"call",t=>t()]))return r();let c=t.headers&&a.isString(t.headers["sentry-trace"])?t.headers["sentry-trace"]:void 0,g=i([t,"access",t=>t.headers,"optionalAccess",t=>t.baggage]);if(!o.hasTracingEnabled(l))return r();let[d,u]=a.extractPathForTransaction(t,{path:!0,method:!0}),I=o.continueTrace({sentryTrace:c,baggage:g},n=>o.startTransaction({name:d,op:"http.server",origin:"auto.http.node.tracingHandler",...n,data:{[o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE]:u},metadata:{...n.metadata,request:t}},{request:a.extractRequestData(t)}));o.getCurrentScope().setSpan(I),n.__sentry_transaction=I,n.once("finish",()=>{setImmediate(()=>{a.addRequestDataToTransaction(I,t),o.setHttpStatus(I,n.statusCode),I.end()})}),r()}},n.trpcMiddleware=u},75720:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(92864),a=r(34881),l=r(32178),c=r(35290),g=r(81277),d=r(85422),u=r(53020),I=r(53006),p=r(62854),m=r(55542),h=r(48207),C=r(46875),b=r(48427),y=r(31342),G=r(61837),A=r(60208),B=r(48475),Z=r(15017),f=r(10127),v=r(58935),W=r(51076),S=r(3420),R=r(1384),V=r(37470),H=r(28485),N=r(99314),Y=r(4005),X=r(53321),E=u.createGetModuleFromFilename(),T={...i.Integrations,...m,...h},_={instrumentCron:N.instrumentCron,instrumentNodeCron:Y.instrumentNodeCron,instrumentNodeSchedule:X.instrumentNodeSchedule};n.Hub=i.Hub,n.SDK_VERSION=i.SDK_VERSION,n.SEMANTIC_ATTRIBUTE_SENTRY_OP=i.SEMANTIC_ATTRIBUTE_SENTRY_OP,n.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN=i.SEMANTIC_ATTRIBUTE_SENTRY_ORIGIN,n.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE=i.SEMANTIC_ATTRIBUTE_SENTRY_SAMPLE_RATE,n.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE=i.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,n.Scope=i.Scope,n.addBreadcrumb=i.addBreadcrumb,n.addEventProcessor=i.addEventProcessor,n.addGlobalEventProcessor=i.addGlobalEventProcessor,n.addIntegration=i.addIntegration,n.captureCheckIn=i.captureCheckIn,n.captureEvent=i.captureEvent,n.captureException=i.captureException,n.captureMessage=i.captureMessage,n.captureSession=i.captureSession,n.close=i.close,n.configureScope=i.configureScope,n.continueTrace=i.continueTrace,n.createTransport=i.createTransport,n.endSession=i.endSession,n.extractTraceparentData=i.extractTraceparentData,n.flush=i.flush,n.functionToStringIntegration=i.functionToStringIntegration,n.getActiveSpan=i.getActiveSpan,n.getActiveTransaction=i.getActiveTransaction,n.getClient=i.getClient,n.getCurrentHub=i.getCurrentHub,n.getCurrentScope=i.getCurrentScope,n.getGlobalScope=i.getGlobalScope,n.getHubFromCarrier=i.getHubFromCarrier,n.getIsolationScope=i.getIsolationScope,n.getSpanStatusFromHttpCode=i.getSpanStatusFromHttpCode,n.inboundFiltersIntegration=i.inboundFiltersIntegration,n.isInitialized=i.isInitialized,n.lastEventId=i.lastEventId,n.linkedErrorsIntegration=i.linkedErrorsIntegration,n.makeMain=i.makeMain,n.metrics=i.metrics,n.parameterize=i.parameterize,n.requestDataIntegration=i.requestDataIntegration,n.runWithAsyncContext=i.runWithAsyncContext,n.setContext=i.setContext,n.setCurrentClient=i.setCurrentClient,n.setExtra=i.setExtra,n.setExtras=i.setExtras,n.setHttpStatus=i.setHttpStatus,n.setMeasurement=i.setMeasurement,n.setTag=i.setTag,n.setTags=i.setTags,n.setUser=i.setUser,n.spanStatusfromHttpCode=i.spanStatusfromHttpCode,n.startActiveSpan=i.startActiveSpan,n.startInactiveSpan=i.startInactiveSpan,n.startSession=i.startSession,n.startSpan=i.startSpan,n.startSpanManual=i.startSpanManual,n.startTransaction=i.startTransaction,n.trace=i.trace,n.withActiveSpan=i.withActiveSpan,n.withIsolationScope=i.withIsolationScope,n.withMonitor=i.withMonitor,n.withScope=i.withScope,n.autoDiscoverNodePerformanceMonitoringIntegrations=o.autoDiscoverNodePerformanceMonitoringIntegrations,n.NodeClient=a.NodeClient,n.makeNodeTransport=l.makeNodeTransport,n.defaultIntegrations=c.defaultIntegrations,n.defaultStackParser=c.defaultStackParser,n.getDefaultIntegrations=c.getDefaultIntegrations,n.getSentryRelease=c.getSentryRelease,n.init=c.init,n.DEFAULT_USER_INCLUDES=g.DEFAULT_USER_INCLUDES,n.addRequestDataToEvent=g.addRequestDataToEvent,n.extractRequestData=g.extractRequestData,n.deepReadDirSync=d.deepReadDirSync,n.createGetModuleFromFilename=u.createGetModuleFromFilename,n.enableAnrDetection=I.enableAnrDetection,n.Handlers=p,n.captureConsoleIntegration=C.captureConsoleIntegration,n.debugIntegration=C.debugIntegration,n.dedupeIntegration=C.dedupeIntegration,n.extraErrorDataIntegration=C.extraErrorDataIntegration,n.httpClientIntegration=C.httpClientIntegration,n.reportingObserverIntegration=C.reportingObserverIntegration,n.rewriteFramesIntegration=C.rewriteFramesIntegration,n.sessionTimingIntegration=C.sessionTimingIntegration,n.consoleIntegration=b.consoleIntegration,n.onUncaughtExceptionIntegration=y.onUncaughtExceptionIntegration,n.onUnhandledRejectionIntegration=G.onUnhandledRejectionIntegration,n.modulesIntegration=A.modulesIntegration,n.contextLinesIntegration=B.contextLinesIntegration,n.nodeContextIntegration=Z.nodeContextIntegration,n.localVariablesIntegration=f.localVariablesIntegration,n.spotlightIntegration=v.spotlightIntegration,n.anrIntegration=W.anrIntegration,n.hapiErrorPlugin=S.hapiErrorPlugin,n.hapiIntegration=S.hapiIntegration,n.Undici=R.Undici,n.nativeNodeFetchintegration=R.nativeNodeFetchintegration,n.Http=V.Http,n.httpIntegration=V.httpIntegration,n.trpcMiddleware=H.trpcMiddleware,n.Integrations=T,n.cron=_,n.getModuleFromFilename=E},51076:(t,n,r)=>{t=r.nmd(t);var{_optionalChain:i,_optionalChainDelete:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(57310),l=r(17961),c=r(81277),g=r(1365),d=r(92507);function log(t,...n){c.logger.log(`[ANR] ${t}`,...n)}function getScopeData(){let t=l.getGlobalScope().getScopeData();return l.mergeScopeData(t,l.getIsolationScope().getScopeData()),l.mergeScopeData(t,l.getCurrentScope().getScopeData()),t.attachments=[],t.eventProcessors=[],t}async function getContexts(t){let n={message:"ANR"},r={};for(let i of t.getEventProcessors()){if(null===n)break;n=await i(n,r)}return i([n,"optionalAccess",t=>t.contexts])||{}}let u=l.defineIntegration((t={})=>{let n,r;if(g.NODE_VERSION.major<16||16===g.NODE_VERSION.major&&g.NODE_VERSION.minor<17)throw Error("ANR detection requires Node 16.17.0 or later");let i=c.GLOBAL_OBJ;return i.__SENTRY_GET_SCOPES__=getScopeData,{name:"Anr",setupOnce(){},startWorker:()=>{!n&&r&&(n=_startWorker(r,t))},stopWorker:()=>{n&&n.then(t=>{t(),n=void 0})},setup(t){r=t,setImmediate(()=>this.startWorker())}}}),I=l.convertIntegrationFnToClass("Anr",u);async function _startWorker(n,i){let g=n.getDsn();if(!g)return()=>{};let u=await getContexts(n);o([u,"access",t=>t.app,"optionalAccess",t=>delete t.app_memory]),o([u,"access",t=>t.device,"optionalAccess",t=>delete t.free_memory]);let I=n.getOptions(),p=n.getSdkMetadata()||{};p.sdk&&(p.sdk.integrations=I.integrations.map(t=>t.name));let m={debug:c.logger.isEnabled(),dsn:g,environment:I.environment||"production",release:I.release,dist:I.dist,sdkMetadata:p,appRootPath:i.appRootPath,pollInterval:i.pollInterval||50,anrThreshold:i.anrThreshold||5e3,captureStackTrace:!!i.captureStackTrace,staticTags:i.staticTags||{},contexts:u};if(m.captureStackTrace){let t=r(31405);t.url()||t.open(0)}let{Worker:h}=c.dynamicRequire(t,"worker_threads"),C=new h(new a.URL(`data:application/javascript;base64,${d.base64WorkerScript}`),{workerData:m});process.on("exit",()=>{C.terminate()});let b=setInterval(()=>{try{let t=l.getCurrentScope().getSession(),n=t?{...t,toJSON:void 0}:void 0;C.postMessage({session:n})}catch(t){}},m.pollInterval);return b.unref(),C.on("message",t=>{"session-ended"===t&&(log("ANR event sent from ANR worker. Clearing session in this thread."),l.getCurrentScope().setSession(void 0))}),C.once("error",t=>{clearInterval(b),log("ANR worker error",t)}),C.once("exit",t=>{clearInterval(b),log("ANR worker exit",t)}),C.unref(),()=>{C.terminate(),clearInterval(b)}}n.Anr=I,n.anrIntegration=u},53006:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(51076);n.enableAnrDetection=function(t){let n=i.getClient(),r=new o.Anr(t);return r.setup(n),Promise.resolve()}},92507:(t,n)=>{/*! @sentry/node 7.120.3 (5a833b4) | https://github.com/getsentry/sentry-javascript */n.base64WorkerScript="aW1wb3J0IHsgU2Vzc2lvbiB9IGZyb20gJ2luc3BlY3Rvcic7CmltcG9ydCB7IHdvcmtlckRhdGEsIHBhcmVudFBvcnQgfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7CmltcG9ydCB7IHBvc2l4LCBzZXAgfSBmcm9tICdwYXRoJzsKaW1wb3J0ICogYXMgaHR0cCBmcm9tICdodHRwJzsKaW1wb3J0ICogYXMgaHR0cHMgZnJvbSAnaHR0cHMnOwppbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7CmltcG9ydCB7IFVSTCB9IGZyb20gJ3VybCc7CmltcG9ydCB7IGNyZWF0ZUd6aXAgfSBmcm9tICd6bGliJzsKaW1wb3J0ICogYXMgbmV0IGZyb20gJ25ldCc7CmltcG9ydCAqIGFzIHRscyBmcm9tICd0bHMnOwoKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC91bmJvdW5kLW1ldGhvZApjb25zdCBvYmplY3RUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIG9uZSBvZiBhIGZldyBFcnJvciBvciBFcnJvci1saWtlCiAqIHtAbGluayBpc0Vycm9yfS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRXJyb3Iod2F0KSB7CiAgc3dpdGNoIChvYmplY3RUb1N0cmluZy5jYWxsKHdhdCkpIHsKICAgIGNhc2UgJ1tvYmplY3QgRXJyb3JdJzoKICAgIGNhc2UgJ1tvYmplY3QgRXhjZXB0aW9uXSc6CiAgICBjYXNlICdbb2JqZWN0IERPTUV4Y2VwdGlvbl0nOgogICAgICByZXR1cm4gdHJ1ZTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBpc0luc3RhbmNlT2Yod2F0LCBFcnJvcik7CiAgfQp9Ci8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSBpcyBhbiBpbnN0YW5jZSBvZiB0aGUgZ2l2ZW4gYnVpbHQtaW4gY2xhc3MuCiAqCiAqIEBwYXJhbSB3YXQgVGhlIHZhbHVlIHRvIGJlIGNoZWNrZWQKICogQHBhcmFtIGNsYXNzTmFtZQogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0J1aWx0aW4od2F0LCBjbGFzc05hbWUpIHsKICByZXR1cm4gb2JqZWN0VG9TdHJpbmcuY2FsbCh3YXQpID09PSBgW29iamVjdCAke2NsYXNzTmFtZX1dYDsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIHN0cmluZwogKiB7QGxpbmsgaXNTdHJpbmd9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNTdHJpbmcod2F0KSB7CiAgcmV0dXJuIGlzQnVpbHRpbih3YXQsICdTdHJpbmcnKTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhbiBvYmplY3QgbGl0ZXJhbCwgb3IgYSBjbGFzcyBpbnN0YW5jZS4KICoge0BsaW5rIGlzUGxhaW5PYmplY3R9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNQbGFpbk9iamVjdCh3YXQpIHsKICByZXR1cm4gaXNCdWlsdGluKHdhdCwgJ09iamVjdCcpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIEV2ZW50IGluc3RhbmNlCiAqIHtAbGluayBpc0V2ZW50fS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRXZlbnQod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiBFdmVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNJbnN0YW5jZU9mKHdhdCwgRXZlbnQpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIEVsZW1lbnQgaW5zdGFuY2UKICoge0BsaW5rIGlzRWxlbWVudH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0VsZW1lbnQod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiBFbGVtZW50ICE9PSAndW5kZWZpbmVkJyAmJiBpc0luc3RhbmNlT2Yod2F0LCBFbGVtZW50KTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlIGhhcyBhIHRoZW4gZnVuY3Rpb24uCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKi8KZnVuY3Rpb24gaXNUaGVuYWJsZSh3YXQpIHsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzCiAgcmV0dXJuIEJvb2xlYW4od2F0ICYmIHdhdC50aGVuICYmIHR5cGVvZiB3YXQudGhlbiA9PT0gJ2Z1bmN0aW9uJyk7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgYSBTeW50aGV0aWNFdmVudAogKiB7QGxpbmsgaXNTeW50aGV0aWNFdmVudH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1N5bnRoZXRpY0V2ZW50KHdhdCkgewogIHJldHVybiBpc1BsYWluT2JqZWN0KHdhdCkgJiYgJ25hdGl2ZUV2ZW50JyBpbiB3YXQgJiYgJ3ByZXZlbnREZWZhdWx0JyBpbiB3YXQgJiYgJ3N0b3BQcm9wYWdhdGlvbicgaW4gd2F0Owp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUgaXMgTmFOCiAqIHtAbGluayBpc05hTn0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc05hTiQxKHdhdCkgewogIHJldHVybiB0eXBlb2Ygd2F0ID09PSAnbnVtYmVyJyAmJiB3YXQgIT09IHdhdDsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhbiBpbnN0YW5jZSBvZiBwcm92aWRlZCBjb25zdHJ1Y3Rvci4KICoge0BsaW5rIGlzSW5zdGFuY2VPZn0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcGFyYW0gYmFzZSBBIGNvbnN0cnVjdG9yIHRvIGJlIHVzZWQgaW4gYSBjaGVjay4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNJbnN0YW5jZU9mKHdhdCwgYmFzZSkgewogIHRyeSB7CiAgICByZXR1cm4gd2F0IGluc3RhbmNlb2YgYmFzZTsKICB9IGNhdGNoIChfZSkgewogICAgcmV0dXJuIGZhbHNlOwogIH0KfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIFZ1ZSBWaWV3TW9kZWwuCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1Z1ZVZpZXdNb2RlbCh3YXQpIHsKICAvLyBOb3QgdXNpbmcgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZyBiZWNhdXNlIGluIFZ1ZSAzIGl0IHdvdWxkIHJlYWQgdGhlIGluc3RhbmNlJ3MgU3ltYm9sKFN5bWJvbC50b1N0cmluZ1RhZykgcHJvcGVydHkuCiAgcmV0dXJuICEhKHR5cGVvZiB3YXQgPT09ICdvYmplY3QnICYmIHdhdCAhPT0gbnVsbCAmJiAoKHdhdCApLl9faXNWdWUgfHwgKHdhdCApLl9pc1Z1ZSkpOwp9CgovKiogSW50ZXJuYWwgZ2xvYmFsIHdpdGggY29tbW9uIHByb3BlcnRpZXMgYW5kIFNlbnRyeSBleHRlbnNpb25zICAqLwoKLy8gVGhlIGNvZGUgYmVsb3cgZm9yICdpc0dsb2JhbE9iaicgYW5kICdHTE9CQUxfT0JKJyB3YXMgY29waWVkIGZyb20gY29yZS1qcyBiZWZvcmUgbW9kaWZpY2F0aW9uCi8vIGh0dHBzOi8vZ2l0aHViLmNvbS96bG9pcm9jay9jb3JlLWpzL2Jsb2IvMWI5NDRkZjU1MjgyY2RjOTljOTBkYjVmNDllYjBiNmVkYTJjYzBhMy9wYWNrYWdlcy9jb3JlLWpzL2ludGVybmFscy9nbG9iYWwuanMKLy8gY29yZS1qcyBoYXMgdGhlIGZvbGxvd2luZyBsaWNlbmNlOgovLwovLyBDb3B5cmlnaHQgKGMpIDIwMTQtMjAyMiBEZW5pcyBQdXNoa2FyZXYKLy8KLy8gUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weQovLyBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSAiU29mdHdhcmUiKSwgdG8gZGVhbAovLyBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzCi8vIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwKLy8gY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzCi8vIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6Ci8vCi8vIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluCi8vIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLgovLwovLyBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUgovLyBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwKLy8gRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFCi8vIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIKLy8gTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwKLy8gT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTgovLyBUSEUgU09GVFdBUkUuCgovKiogUmV0dXJucyAnb2JqJyBpZiBpdCdzIHRoZSBnbG9iYWwgb2JqZWN0LCBvdGhlcndpc2UgcmV0dXJucyB1bmRlZmluZWQgKi8KZnVuY3Rpb24gaXNHbG9iYWxPYmoob2JqKSB7CiAgcmV0dXJuIG9iaiAmJiBvYmouTWF0aCA9PSBNYXRoID8gb2JqIDogdW5kZWZpbmVkOwp9CgovKiogR2V0J3MgdGhlIGdsb2JhbCBvYmplY3QgZm9yIHRoZSBjdXJyZW50IEphdmFTY3JpcHQgcnVudGltZSAqLwpjb25zdCBHTE9CQUxfT0JKID0KICAodHlwZW9mIGdsb2JhbFRoaXMgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmooZ2xvYmFsVGhpcykpIHx8CiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXJlc3RyaWN0ZWQtZ2xvYmFscwogICh0eXBlb2Ygd2luZG93ID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKHdpbmRvdykpIHx8CiAgKHR5cGVvZiBzZWxmID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKHNlbGYpKSB8fAogICh0eXBlb2YgZ2xvYmFsID09ICdvYmplY3QnICYmIGlzR2xvYmFsT2JqKGdsb2JhbCkpIHx8CiAgKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiB0aGlzOwogIH0pKCkgfHwKICB7fTsKCi8qKgogKiBAZGVwcmVjYXRlZCBVc2UgR0xPQkFMX09CSiBpbnN0ZWFkIG9yIFdJTkRPVyBmcm9tIEBzZW50cnkvYnJvd3Nlci4gVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdjgKICovCmZ1bmN0aW9uIGdldEdsb2JhbE9iamVjdCgpIHsKICByZXR1cm4gR0xPQkFMX09CSiA7Cn0KCi8qKgogKiBSZXR1cm5zIGEgZ2xvYmFsIHNpbmdsZXRvbiBjb250YWluZWQgaW4gdGhlIGdsb2JhbCBgX19TRU5UUllfX2Agb2JqZWN0LgogKgogKiBJZiB0aGUgc2luZ2xldG9uIGRvZXNuJ3QgYWxyZWFkeSBleGlzdCBpbiBgX19TRU5UUllfX2AsIGl0IHdpbGwgYmUgY3JlYXRlZCB1c2luZyB0aGUgZ2l2ZW4gZmFjdG9yeQogKiBmdW5jdGlvbiBhbmQgYWRkZWQgdG8gdGhlIGBfX1NFTlRSWV9fYCBvYmplY3QuCiAqCiAqIEBwYXJhbSBuYW1lIG5hbWUgb2YgdGhlIGdsb2JhbCBzaW5nbGV0b24gb24gX19TRU5UUllfXwogKiBAcGFyYW0gY3JlYXRvciBjcmVhdG9yIEZhY3RvcnkgZnVuY3Rpb24gdG8gY3JlYXRlIHRoZSBzaW5nbGV0b24gaWYgaXQgZG9lc24ndCBhbHJlYWR5IGV4aXN0IG9uIGBfX1NFTlRSWV9fYAogKiBAcGFyYW0gb2JqIChPcHRpb25hbCkgVGhlIGdsb2JhbCBvYmplY3Qgb24gd2hpY2ggdG8gbG9vayBmb3IgYF9fU0VOVFJZX19gLCBpZiBub3QgYEdMT0JBTF9PQkpgJ3MgcmV0dXJuIHZhbHVlCiAqIEByZXR1cm5zIHRoZSBzaW5nbGV0b24KICovCmZ1bmN0aW9uIGdldEdsb2JhbFNpbmdsZXRvbihuYW1lLCBjcmVhdG9yLCBvYmopIHsKICBjb25zdCBnYmwgPSAob2JqIHx8IEdMT0JBTF9PQkopIDsKICBjb25zdCBfX1NFTlRSWV9fID0gKGdibC5fX1NFTlRSWV9fID0gZ2JsLl9fU0VOVFJZX18gfHwge30pOwogIGNvbnN0IHNpbmdsZXRvbiA9IF9fU0VOVFJZX19bbmFtZV0gfHwgKF9fU0VOVFJZX19bbmFtZV0gPSBjcmVhdG9yKCkpOwogIHJldHVybiBzaW5nbGV0b247Cn0KCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpjb25zdCBXSU5ET1cgPSBnZXRHbG9iYWxPYmplY3QoKTsKCmNvbnN0IERFRkFVTFRfTUFYX1NUUklOR19MRU5HVEggPSA4MDsKCi8qKgogKiBHaXZlbiBhIGNoaWxkIERPTSBlbGVtZW50LCByZXR1cm5zIGEgcXVlcnktc2VsZWN0b3Igc3RhdGVtZW50IGRlc2NyaWJpbmcgdGhhdAogKiBhbmQgaXRzIGFuY2VzdG9ycwogKiBlLmcuIFtIVE1MRWxlbWVudF0gPT4gYm9keSA+IGRpdiA+IGlucHV0I2Zvby5idG5bbmFtZT1iYXpdCiAqIEByZXR1cm5zIGdlbmVyYXRlZCBET00gcGF0aAogKi8KZnVuY3Rpb24gaHRtbFRyZWVBc1N0cmluZygKICBlbGVtLAogIG9wdGlvbnMgPSB7fSwKKSB7CiAgaWYgKCFlbGVtKSB7CiAgICByZXR1cm4gJzx1bmtub3duPic7CiAgfQoKICAvLyB0cnkvY2F0Y2ggYm90aDoKICAvLyAtIGFjY2Vzc2luZyBldmVudC50YXJnZXQgKHNlZSBnZXRzZW50cnkvcmF2ZW4tanMjODM4LCAjNzY4KQogIC8vIC0gYGh0bWxUcmVlQXNTdHJpbmdgIGJlY2F1c2UgaXQncyBjb21wbGV4LCBhbmQganVzdCBhY2Nlc3NpbmcgdGhlIERPTSBpbmNvcnJlY3RseQogIC8vIC0gY2FuIHRocm93IGFuIGV4Y2VwdGlvbiBpbiBzb21lIGNpcmN1bXN0YW5jZXMuCiAgdHJ5IHsKICAgIGxldCBjdXJyZW50RWxlbSA9IGVsZW0gOwogICAgY29uc3QgTUFYX1RSQVZFUlNFX0hFSUdIVCA9IDU7CiAgICBjb25zdCBvdXQgPSBbXTsKICAgIGxldCBoZWlnaHQgPSAwOwogICAgbGV0IGxlbiA9IDA7CiAgICBjb25zdCBzZXBhcmF0b3IgPSAnID4gJzsKICAgIGNvbnN0IHNlcExlbmd0aCA9IHNlcGFyYXRvci5sZW5ndGg7CiAgICBsZXQgbmV4dFN0cjsKICAgIGNvbnN0IGtleUF0dHJzID0gQXJyYXkuaXNBcnJheShvcHRpb25zKSA/IG9wdGlvbnMgOiBvcHRpb25zLmtleUF0dHJzOwogICAgY29uc3QgbWF4U3RyaW5nTGVuZ3RoID0gKCFBcnJheS5pc0FycmF5KG9wdGlvbnMpICYmIG9wdGlvbnMubWF4U3RyaW5nTGVuZ3RoKSB8fCBERUZBVUxUX01BWF9TVFJJTkdfTEVOR1RIOwoKICAgIHdoaWxlIChjdXJyZW50RWxlbSAmJiBoZWlnaHQrKyA8IE1BWF9UUkFWRVJTRV9IRUlHSFQpIHsKICAgICAgbmV4dFN0ciA9IF9odG1sRWxlbWVudEFzU3RyaW5nKGN1cnJlbnRFbGVtLCBrZXlBdHRycyk7CiAgICAgIC8vIGJhaWwgb3V0IGlmCiAgICAgIC8vIC0gbmV4dFN0ciBpcyB0aGUgJ2h0bWwnIGVsZW1lbnQKICAgICAgLy8gLSB0aGUgbGVuZ3RoIG9mIHRoZSBzdHJpbmcgdGhhdCB3b3VsZCBiZSBjcmVhdGVkIGV4Y2VlZHMgbWF4U3RyaW5nTGVuZ3RoCiAgICAgIC8vICAgKGlnbm9yZSB0aGlzIGxpbWl0IGlmIHdlIGFyZSBvbiB0aGUgZmlyc3QgaXRlcmF0aW9uKQogICAgICBpZiAobmV4dFN0ciA9PT0gJ2h0bWwnIHx8IChoZWlnaHQgPiAxICYmIGxlbiArIG91dC5sZW5ndGggKiBzZXBMZW5ndGggKyBuZXh0U3RyLmxlbmd0aCA+PSBtYXhTdHJpbmdMZW5ndGgpKSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIG91dC5wdXNoKG5leHRTdHIpOwoKICAgICAgbGVuICs9IG5leHRTdHIubGVuZ3RoOwogICAgICBjdXJyZW50RWxlbSA9IGN1cnJlbnRFbGVtLnBhcmVudE5vZGU7CiAgICB9CgogICAgcmV0dXJuIG91dC5yZXZlcnNlKCkuam9pbihzZXBhcmF0b3IpOwogIH0gY2F0Y2ggKF9vTykgewogICAgcmV0dXJuICc8dW5rbm93bj4nOwogIH0KfQoKLyoqCiAqIFJldHVybnMgYSBzaW1wbGUsIHF1ZXJ5LXNlbGVjdG9yIHJlcHJlc2VudGF0aW9uIG9mIGEgRE9NIGVsZW1lbnQKICogZS5nLiBbSFRNTEVsZW1lbnRdID0+IGlucHV0I2Zvby5idG5bbmFtZT1iYXpdCiAqIEByZXR1cm5zIGdlbmVyYXRlZCBET00gcGF0aAogKi8KZnVuY3Rpb24gX2h0bWxFbGVtZW50QXNTdHJpbmcoZWwsIGtleUF0dHJzKSB7CiAgY29uc3QgZWxlbSA9IGVsCgo7CgogIGNvbnN0IG91dCA9IFtdOwogIGxldCBjbGFzc05hbWU7CiAgbGV0IGNsYXNzZXM7CiAgbGV0IGtleTsKICBsZXQgYXR0cjsKICBsZXQgaTsKCiAgaWYgKCFlbGVtIHx8ICFlbGVtLnRhZ05hbWUpIHsKICAgIHJldHVybiAnJzsKICB9CgogIC8vIEB0cy1leHBlY3QtZXJyb3IgV0lORE9XIGhhcyBIVE1MRWxlbWVudAogIGlmIChXSU5ET1cuSFRNTEVsZW1lbnQpIHsKICAgIC8vIElmIHVzaW5nIHRoZSBjb21wb25lbnQgbmFtZSBhbm5vdGF0aW9uIHBsdWdpbiwgdGhpcyB2YWx1ZSBtYXkgYmUgYXZhaWxhYmxlIG9uIHRoZSBET00gbm9kZQogICAgaWYgKGVsZW0gaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBlbGVtLmRhdGFzZXQgJiYgZWxlbS5kYXRhc2V0WydzZW50cnlDb21wb25lbnQnXSkgewogICAgICByZXR1cm4gZWxlbS5kYXRhc2V0WydzZW50cnlDb21wb25lbnQnXTsKICAgIH0KICB9CgogIG91dC5wdXNoKGVsZW0udGFnTmFtZS50b0xvd2VyQ2FzZSgpKTsKCiAgLy8gUGFpcnMgb2YgYXR0cmlidXRlIGtleXMgZGVmaW5lZCBpbiBgc2VyaWFsaXplQXR0cmlidXRlYCBhbmQgdGhlaXIgdmFsdWVzIG9uIGVsZW1lbnQuCiAgY29uc3Qga2V5QXR0clBhaXJzID0KICAgIGtleUF0dHJzICYmIGtleUF0dHJzLmxlbmd0aAogICAgICA/IGtleUF0dHJzLmZpbHRlcihrZXlBdHRyID0+IGVsZW0uZ2V0QXR0cmlidXRlKGtleUF0dHIpKS5tYXAoa2V5QXR0ciA9PiBba2V5QXR0ciwgZWxlbS5nZXRBdHRyaWJ1dGUoa2V5QXR0cildKQogICAgICA6IG51bGw7CgogIGlmIChrZXlBdHRyUGFpcnMgJiYga2V5QXR0clBhaXJzLmxlbmd0aCkgewogICAga2V5QXR0clBhaXJzLmZvckVhY2goa2V5QXR0clBhaXIgPT4gewogICAgICBvdXQucHVzaChgWyR7a2V5QXR0clBhaXJbMF19PSIke2tleUF0dHJQYWlyWzFdfSJdYCk7CiAgICB9KTsKICB9IGVsc2UgewogICAgaWYgKGVsZW0uaWQpIHsKICAgICAgb3V0LnB1c2goYCMke2VsZW0uaWR9YCk7CiAgICB9CgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHByZWZlci1jb25zdAogICAgY2xhc3NOYW1lID0gZWxlbS5jbGFzc05hbWU7CiAgICBpZiAoY2xhc3NOYW1lICYmIGlzU3RyaW5nKGNsYXNzTmFtZSkpIHsKICAgICAgY2xhc3NlcyA9IGNsYXNzTmFtZS5zcGxpdCgvXHMrLyk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBjbGFzc2VzLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgb3V0LnB1c2goYC4ke2NsYXNzZXNbaV19YCk7CiAgICAgIH0KICAgIH0KICB9CiAgY29uc3QgYWxsb3dlZEF0dHJzID0gWydhcmlhLWxhYmVsJywgJ3R5cGUnLCAnbmFtZScsICd0aXRsZScsICdhbHQnXTsKICBmb3IgKGkgPSAwOyBpIDwgYWxsb3dlZEF0dHJzLmxlbmd0aDsgaSsrKSB7CiAgICBrZXkgPSBhbGxvd2VkQXR0cnNbaV07CiAgICBhdHRyID0gZWxlbS5nZXRBdHRyaWJ1dGUoa2V5KTsKICAgIGlmIChhdHRyKSB7CiAgICAgIG91dC5wdXNoKGBbJHtrZXl9PSIke2F0dHJ9Il1gKTsKICAgIH0KICB9CiAgcmV0dXJuIG91dC5qb2luKCcnKTsKfQoKLyoqCiAqIFRoaXMgc2VydmVzIGFzIGEgYnVpbGQgdGltZSBmbGFnIHRoYXQgd2lsbCBiZSB0cnVlIGJ5IGRlZmF1bHQsIGJ1dCBmYWxzZSBpbiBub24tZGVidWcgYnVpbGRzIG9yIGlmIHVzZXJzIHJlcGxhY2UgYF9fU0VOVFJZX0RFQlVHX19gIGluIHRoZWlyIGdlbmVyYXRlZCBjb2RlLgogKgogKiBBVFRFTlRJT046IFRoaXMgY29uc3RhbnQgbXVzdCBuZXZlciBjcm9zcyBwYWNrYWdlIGJvdW5kYXJpZXMgKGkuZS4gYmUgZXhwb3J0ZWQpIHRvIGd1YXJhbnRlZSB0aGF0IGl0IGNhbiBiZSB1c2VkIGZvciB0cmVlIHNoYWtpbmcuCiAqLwpjb25zdCBERUJVR19CVUlMRCQxID0gKHR5cGVvZiBfX1NFTlRSWV9ERUJVR19fID09PSAndW5kZWZpbmVkJyB8fCBfX1NFTlRSWV9ERUJVR19fKTsKCi8qKiBQcmVmaXggZm9yIGxvZ2dpbmcgc3RyaW5ncyAqLwpjb25zdCBQUkVGSVggPSAnU2VudHJ5IExvZ2dlciAnOwoKY29uc3QgQ09OU09MRV9MRVZFTFMgPSBbCiAgJ2RlYnVnJywKICAnaW5mbycsCiAgJ3dhcm4nLAogICdlcnJvcicsCiAgJ2xvZycsCiAgJ2Fzc2VydCcsCiAgJ3RyYWNlJywKXSA7CgovKiogVGhpcyBtYXkgYmUgbXV0YXRlZCBieSB0aGUgY29uc29sZSBpbnN0cnVtZW50YXRpb24uICovCmNvbnN0IG9yaWdpbmFsQ29uc29sZU1ldGhvZHMKCiA9IHt9OwoKLyoqIEpTRG9jICovCgovKioKICogVGVtcG9yYXJpbHkgZGlzYWJsZSBzZW50cnkgY29uc29sZSBpbnN0cnVtZW50YXRpb25zLgogKgogKiBAcGFyYW0gY2FsbGJhY2sgVGhlIGZ1bmN0aW9uIHRvIHJ1biBhZ2FpbnN0IHRoZSBvcmlnaW5hbCBgY29uc29sZWAgbWVzc2FnZXMKICogQHJldHVybnMgVGhlIHJlc3VsdHMgb2YgdGhlIGNhbGxiYWNrCiAqLwpmdW5jdGlvbiBjb25zb2xlU2FuZGJveChjYWxsYmFjaykgewogIGlmICghKCdjb25zb2xlJyBpbiBHTE9CQUxfT0JKKSkgewogICAgcmV0dXJuIGNhbGxiYWNrKCk7CiAgfQoKICBjb25zdCBjb25zb2xlID0gR0xPQkFMX09CSi5jb25zb2xlIDsKICBjb25zdCB3cmFwcGVkRnVuY3MgPSB7fTsKCiAgY29uc3Qgd3JhcHBlZExldmVscyA9IE9iamVjdC5rZXlzKG9yaWdpbmFsQ29uc29sZU1ldGhvZHMpIDsKCiAgLy8gUmVzdG9yZSBhbGwgd3JhcHBlZCBjb25zb2xlIG1ldGhvZHMKICB3cmFwcGVkTGV2ZWxzLmZvckVhY2gobGV2ZWwgPT4gewogICAgY29uc3Qgb3JpZ2luYWxDb25zb2xlTWV0aG9kID0gb3JpZ2luYWxDb25zb2xlTWV0aG9kc1tsZXZlbF0gOwogICAgd3JhcHBlZEZ1bmNzW2xldmVsXSA9IGNvbnNvbGVbbGV2ZWxdIDsKICAgIGNvbnNvbGVbbGV2ZWxdID0gb3JpZ2luYWxDb25zb2xlTWV0aG9kOwogIH0pOwoKICB0cnkgewogICAgcmV0dXJuIGNhbGxiYWNrKCk7CiAgfSBmaW5hbGx5IHsKICAgIC8vIFJldmVydCByZXN0b3JhdGlvbiB0byB3cmFwcGVkIHN0YXRlCiAgICB3cmFwcGVkTGV2ZWxzLmZvckVhY2gobGV2ZWwgPT4gewogICAgICBjb25zb2xlW2xldmVsXSA9IHdyYXBwZWRGdW5jc1tsZXZlbF0gOwogICAgfSk7CiAgfQp9CgpmdW5jdGlvbiBtYWtlTG9nZ2VyKCkgewogIGxldCBlbmFibGVkID0gZmFsc2U7CiAgY29uc3QgbG9nZ2VyID0gewogICAgZW5hYmxlOiAoKSA9PiB7CiAgICAgIGVuYWJsZWQgPSB0cnVlOwogICAgfSwKICAgIGRpc2FibGU6ICgpID0+IHsKICAgICAgZW5hYmxlZCA9IGZhbHNlOwogICAgfSwKICAgIGlzRW5hYmxlZDogKCkgPT4gZW5hYmxlZCwKICB9OwoKICBpZiAoREVCVUdfQlVJTEQkMSkgewogICAgQ09OU09MRV9MRVZFTFMuZm9yRWFjaChuYW1lID0+IHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKICAgICAgbG9nZ2VyW25hbWVdID0gKC4uLmFyZ3MpID0+IHsKICAgICAgICBpZiAoZW5hYmxlZCkgewogICAgICAgICAgY29uc29sZVNhbmRib3goKCkgPT4gewogICAgICAgICAgICBHTE9CQUxfT0JKLmNvbnNvbGVbbmFtZV0oYCR7UFJFRklYfVske25hbWV9XTpgLCAuLi5hcmdzKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBDT05TT0xFX0xFVkVMUy5mb3JFYWNoKG5hbWUgPT4gewogICAgICBsb2dnZXJbbmFtZV0gPSAoKSA9PiB1bmRlZmluZWQ7CiAgICB9KTsKICB9CgogIHJldHVybiBsb2dnZXIgOwp9Cgpjb25zdCBsb2dnZXIgPSBtYWtlTG9nZ2VyKCk7CgovKioKICogUmVuZGVycyB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoaXMgRHNuLgogKgogKiBCeSBkZWZhdWx0LCB0aGlzIHdpbGwgcmVuZGVyIHRoZSBwdWJsaWMgcmVwcmVzZW50YXRpb24gd2l0aG91dCB0aGUgcGFzc3dvcmQKICogY29tcG9uZW50LiBUbyBnZXQgdGhlIGRlcHJlY2F0ZWQgcHJpdmF0ZSByZXByZXNlbnRhdGlvbiwgc2V0IGB3aXRoUGFzc3dvcmRgCiAqIHRvIHRydWUuCiAqCiAqIEBwYXJhbSB3aXRoUGFzc3dvcmQgV2hlbiBzZXQgdG8gdHJ1ZSwgdGhlIHBhc3N3b3JkIHdpbGwgYmUgaW5jbHVkZWQuCiAqLwpmdW5jdGlvbiBkc25Ub1N0cmluZyhkc24sIHdpdGhQYXNzd29yZCA9IGZhbHNlKSB7CiAgY29uc3QgeyBob3N0LCBwYXRoLCBwYXNzLCBwb3J0LCBwcm9qZWN0SWQsIHByb3RvY29sLCBwdWJsaWNLZXkgfSA9IGRzbjsKICByZXR1cm4gKAogICAgYCR7cHJvdG9jb2x9Oi8vJHtwdWJsaWNLZXl9JHt3aXRoUGFzc3dvcmQgJiYgcGFzcyA/IGA6JHtwYXNzfWAgOiAnJ31gICsKICAgIGBAJHtob3N0fSR7cG9ydCA/IGA6JHtwb3J0fWAgOiAnJ30vJHtwYXRoID8gYCR7cGF0aH0vYCA6IHBhdGh9JHtwcm9qZWN0SWR9YAogICk7Cn0KCi8qKiBBbiBlcnJvciBlbWl0dGVkIGJ5IFNlbnRyeSBTREtzIGFuZCByZWxhdGVkIHV0aWxpdGllcy4gKi8KY2xhc3MgU2VudHJ5RXJyb3IgZXh0ZW5kcyBFcnJvciB7CiAgLyoqIERpc3BsYXkgbmFtZSBvZiB0aGlzIGVycm9yIGluc3RhbmNlLiAqLwoKICAgY29uc3RydWN0b3IoIG1lc3NhZ2UsIGxvZ0xldmVsID0gJ3dhcm4nKSB7CiAgICBzdXBlcihtZXNzYWdlKTt0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlOwogICAgdGhpcy5uYW1lID0gbmV3LnRhcmdldC5wcm90b3R5cGUuY29uc3RydWN0b3IubmFtZTsKICAgIC8vIFRoaXMgc2V0cyB0aGUgcHJvdG90eXBlIHRvIGJlIGBFcnJvcmAsIG5vdCBgU2VudHJ5RXJyb3JgLiBJdCdzIHVuY2xlYXIgd2h5IHdlIGRvIHRoaXMsIGJ1dCBjb21tZW50aW5nIHRoaXMgbGluZQogICAgLy8gb3V0IGNhdXNlcyB2YXJpb3VzIChzZWVtaW5nbHkgdG90YWxseSB1bnJlbGF0ZWQpIHBsYXl3cmlnaHQgdGVzdHMgY29uc2lzdGVudGx5IHRpbWUgb3V0LiBGWUksIHRoaXMgbWFrZXMKICAgIC8vIGluc3RhbmNlcyBvZiBgU2VudHJ5RXJyb3JgIGZhaWwgYG9iaiBpbnN0YW5jZW9mIFNlbnRyeUVycm9yYCBjaGVja3MuCiAgICBPYmplY3Quc2V0UHJvdG90eXBlT2YodGhpcywgbmV3LnRhcmdldC5wcm90b3R5cGUpOwogICAgdGhpcy5sb2dMZXZlbCA9IGxvZ0xldmVsOwogIH0KfQoKLyoqCiAqIEVuY29kZXMgZ2l2ZW4gb2JqZWN0IGludG8gdXJsLWZyaWVuZGx5IGZvcm1hdAogKgogKiBAcGFyYW0gb2JqZWN0IEFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIHNlcmlhbGl6YWJsZSB2YWx1ZXMKICogQHJldHVybnMgc3RyaW5nIEVuY29kZWQKICovCmZ1bmN0aW9uIHVybEVuY29kZShvYmplY3QpIHsKICByZXR1cm4gT2JqZWN0LmtleXMob2JqZWN0KQogICAgLm1hcChrZXkgPT4gYCR7ZW5jb2RlVVJJQ29tcG9uZW50KGtleSl9PSR7ZW5jb2RlVVJJQ29tcG9uZW50KG9iamVjdFtrZXldKX1gKQogICAgLmpvaW4oJyYnKTsKfQoKLyoqCiAqIFRyYW5zZm9ybXMgYW55IGBFcnJvcmAgb3IgYEV2ZW50YCBpbnRvIGEgcGxhaW4gb2JqZWN0IHdpdGggYWxsIG9mIHRoZWlyIGVudW1lcmFibGUgcHJvcGVydGllcywgYW5kIHNvbWUgb2YgdGhlaXIKICogbm9uLWVudW1lcmFibGUgcHJvcGVydGllcyBhdHRhY2hlZC4KICoKICogQHBhcmFtIHZhbHVlIEluaXRpYWwgc291cmNlIHRoYXQgd2UgaGF2ZSB0byB0cmFuc2Zvcm0gaW4gb3JkZXIgZm9yIGl0IHRvIGJlIHVzYWJsZSBieSB0aGUgc2VyaWFsaXplcgogKiBAcmV0dXJucyBBbiBFdmVudCBvciBFcnJvciB0dXJuZWQgaW50byBhbiBvYmplY3QgLSBvciB0aGUgdmFsdWUgYXJndXJtZW50IGl0c2VsZiwgd2hlbiB2YWx1ZSBpcyBuZWl0aGVyIGFuIEV2ZW50IG5vcgogKiAgYW4gRXJyb3IuCiAqLwpmdW5jdGlvbiBjb252ZXJ0VG9QbGFpbk9iamVjdCgKICB2YWx1ZSwKKQoKIHsKICBpZiAoaXNFcnJvcih2YWx1ZSkpIHsKICAgIHJldHVybiB7CiAgICAgIG1lc3NhZ2U6IHZhbHVlLm1lc3NhZ2UsCiAgICAgIG5hbWU6IHZhbHVlLm5hbWUsCiAgICAgIHN0YWNrOiB2YWx1ZS5zdGFjaywKICAgICAgLi4uZ2V0T3duUHJvcGVydGllcyh2YWx1ZSksCiAgICB9OwogIH0gZWxzZSBpZiAoaXNFdmVudCh2YWx1ZSkpIHsKICAgIGNvbnN0IG5ld09iagoKID0gewogICAgICB0eXBlOiB2YWx1ZS50eXBlLAogICAgICB0YXJnZXQ6IHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHZhbHVlLnRhcmdldCksCiAgICAgIGN1cnJlbnRUYXJnZXQ6IHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHZhbHVlLmN1cnJlbnRUYXJnZXQpLAogICAgICAuLi5nZXRPd25Qcm9wZXJ0aWVzKHZhbHVlKSwKICAgIH07CgogICAgaWYgKHR5cGVvZiBDdXN0b21FdmVudCAhPT0gJ3VuZGVmaW5lZCcgJiYgaXNJbnN0YW5jZU9mKHZhbHVlLCBDdXN0b21FdmVudCkpIHsKICAgICAgbmV3T2JqLmRldGFpbCA9IHZhbHVlLmRldGFpbDsKICAgIH0KCiAgICByZXR1cm4gbmV3T2JqOwogIH0gZWxzZSB7CiAgICByZXR1cm4gdmFsdWU7CiAgfQp9CgovKiogQ3JlYXRlcyBhIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiB0aGUgdGFyZ2V0IG9mIGFuIGBFdmVudGAgb2JqZWN0ICovCmZ1bmN0aW9uIHNlcmlhbGl6ZUV2ZW50VGFyZ2V0KHRhcmdldCkgewogIHRyeSB7CiAgICByZXR1cm4gaXNFbGVtZW50KHRhcmdldCkgPyBodG1sVHJlZUFzU3RyaW5nKHRhcmdldCkgOiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwodGFyZ2V0KTsKICB9IGNhdGNoIChfb08pIHsKICAgIHJldHVybiAnPHVua25vd24+JzsKICB9Cn0KCi8qKiBGaWx0ZXJzIG91dCBhbGwgYnV0IGFuIG9iamVjdCdzIG93biBwcm9wZXJ0aWVzICovCmZ1bmN0aW9uIGdldE93blByb3BlcnRpZXMob2JqKSB7CiAgaWYgKHR5cGVvZiBvYmogPT09ICdvYmplY3QnICYmIG9iaiAhPT0gbnVsbCkgewogICAgY29uc3QgZXh0cmFjdGVkUHJvcHMgPSB7fTsKICAgIGZvciAoY29uc3QgcHJvcGVydHkgaW4gb2JqKSB7CiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wZXJ0eSkpIHsKICAgICAgICBleHRyYWN0ZWRQcm9wc1twcm9wZXJ0eV0gPSAob2JqIClbcHJvcGVydHldOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gZXh0cmFjdGVkUHJvcHM7CiAgfSBlbHNlIHsKICAgIHJldHVybiB7fTsKICB9Cn0KCi8qKgogKiBHaXZlbiBhbnkgb2JqZWN0LCByZXR1cm4gYSBuZXcgb2JqZWN0IGhhdmluZyByZW1vdmVkIGFsbCBmaWVsZHMgd2hvc2UgdmFsdWUgd2FzIGB1bmRlZmluZWRgLgogKiBXb3JrcyByZWN1cnNpdmVseSBvbiBvYmplY3RzIGFuZCBhcnJheXMuCiAqCiAqIEF0dGVudGlvbjogVGhpcyBmdW5jdGlvbiBrZWVwcyBjaXJjdWxhciByZWZlcmVuY2VzIGluIHRoZSByZXR1cm5lZCBvYmplY3QuCiAqLwpmdW5jdGlvbiBkcm9wVW5kZWZpbmVkS2V5cyhpbnB1dFZhbHVlKSB7CiAgLy8gVGhpcyBtYXAga2VlcHMgdHJhY2sgb2Ygd2hhdCBhbHJlYWR5IHZpc2l0ZWQgbm9kZXMgbWFwIHRvLgogIC8vIE91ciBTZXQgLSBiYXNlZCBtZW1vQnVpbGRlciBkb2Vzbid0IHdvcmsgaGVyZSBiZWNhdXNlIHdlIHdhbnQgdG8gdGhlIG91dHB1dCBvYmplY3QgdG8gaGF2ZSB0aGUgc2FtZSBjaXJjdWxhcgogIC8vIHJlZmVyZW5jZXMgYXMgdGhlIGlucHV0IG9iamVjdC4KICBjb25zdCBtZW1vaXphdGlvbk1hcCA9IG5ldyBNYXAoKTsKCiAgLy8gVGhpcyBmdW5jdGlvbiBqdXN0IHByb3hpZXMgYF9kcm9wVW5kZWZpbmVkS2V5c2AgdG8ga2VlcCB0aGUgYG1lbW9CdWlsZGVyYCBvdXQgb2YgdGhpcyBmdW5jdGlvbidzIEFQSQogIHJldHVybiBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZSwgbWVtb2l6YXRpb25NYXApOwp9CgpmdW5jdGlvbiBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZSwgbWVtb2l6YXRpb25NYXApIHsKICBpZiAoaXNQb2pvKGlucHV0VmFsdWUpKSB7CiAgICAvLyBJZiB0aGlzIG5vZGUgaGFzIGFscmVhZHkgYmVlbiB2aXNpdGVkIGR1ZSB0byBhIGNpcmN1bGFyIHJlZmVyZW5jZSwgcmV0dXJuIHRoZSBvYmplY3QgaXQgd2FzIG1hcHBlZCB0byBpbiB0aGUgbmV3IG9iamVjdAogICAgY29uc3QgbWVtb1ZhbCA9IG1lbW9pemF0aW9uTWFwLmdldChpbnB1dFZhbHVlKTsKICAgIGlmIChtZW1vVmFsICE9PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIG1lbW9WYWwgOwogICAgfQoKICAgIGNvbnN0IHJldHVyblZhbHVlID0ge307CiAgICAvLyBTdG9yZSB0aGUgbWFwcGluZyBvZiB0aGlzIHZhbHVlIGluIGNhc2Ugd2UgdmlzaXQgaXQgYWdhaW4sIGluIGNhc2Ugb2YgY2lyY3VsYXIgZGF0YQogICAgbWVtb2l6YXRpb25NYXAuc2V0KGlucHV0VmFsdWUsIHJldHVyblZhbHVlKTsKCiAgICBmb3IgKGNvbnN0IGtleSBvZiBPYmplY3Qua2V5cyhpbnB1dFZhbHVlKSkgewogICAgICBpZiAodHlwZW9mIGlucHV0VmFsdWVba2V5XSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICByZXR1cm5WYWx1ZVtrZXldID0gX2Ryb3BVbmRlZmluZWRLZXlzKGlucHV0VmFsdWVba2V5XSwgbWVtb2l6YXRpb25NYXApOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJldHVyblZhbHVlIDsKICB9CgogIGlmIChBcnJheS5pc0FycmF5KGlucHV0VmFsdWUpKSB7CiAgICAvLyBJZiB0aGlzIG5vZGUgaGFzIGFscmVhZHkgYmVlbiB2aXNpdGVkIGR1ZSB0byBhIGNpcmN1bGFyIHJlZmVyZW5jZSwgcmV0dXJuIHRoZSBhcnJheSBpdCB3YXMgbWFwcGVkIHRvIGluIHRoZSBuZXcgb2JqZWN0CiAgICBjb25zdCBtZW1vVmFsID0gbWVtb2l6YXRpb25NYXAuZ2V0KGlucHV0VmFsdWUpOwogICAgaWYgKG1lbW9WYWwgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gbWVtb1ZhbCA7CiAgICB9CgogICAgY29uc3QgcmV0dXJuVmFsdWUgPSBbXTsKICAgIC8vIFN0b3JlIHRoZSBtYXBwaW5nIG9mIHRoaXMgdmFsdWUgaW4gY2FzZSB3ZSB2aXNpdCBpdCBhZ2FpbiwgaW4gY2FzZSBvZiBjaXJjdWxhciBkYXRhCiAgICBtZW1vaXphdGlvbk1hcC5zZXQoaW5wdXRWYWx1ZSwgcmV0dXJuVmFsdWUpOwoKICAgIGlucHV0VmFsdWUuZm9yRWFjaCgoaXRlbSkgPT4gewogICAgICByZXR1cm5WYWx1ZS5wdXNoKF9kcm9wVW5kZWZpbmVkS2V5cyhpdGVtLCBtZW1vaXphdGlvbk1hcCkpOwogICAgfSk7CgogICAgcmV0dXJuIHJldHVyblZhbHVlIDsKICB9CgogIHJldHVybiBpbnB1dFZhbHVlOwp9CgpmdW5jdGlvbiBpc1Bvam8oaW5wdXQpIHsKICBpZiAoIWlzUGxhaW5PYmplY3QoaW5wdXQpKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQoKICB0cnkgewogICAgY29uc3QgbmFtZSA9IChPYmplY3QuZ2V0UHJvdG90eXBlT2YoaW5wdXQpICkuY29uc3RydWN0b3IubmFtZTsKICAgIHJldHVybiAhbmFtZSB8fCBuYW1lID09PSAnT2JqZWN0JzsKICB9IGNhdGNoIChlKSB7CiAgICByZXR1cm4gdHJ1ZTsKICB9Cn0KCi8qKgogKiBEb2VzIHRoaXMgZmlsZW5hbWUgbG9vayBsaWtlIGl0J3MgcGFydCBvZiB0aGUgYXBwIGNvZGU/CiAqLwpmdW5jdGlvbiBmaWxlbmFtZUlzSW5BcHAoZmlsZW5hbWUsIGlzTmF0aXZlID0gZmFsc2UpIHsKICBjb25zdCBpc0ludGVybmFsID0KICAgIGlzTmF0aXZlIHx8CiAgICAoZmlsZW5hbWUgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgaXQncyBhbiBhYnNvbHV0ZSBsaW51eCBwYXRoCiAgICAgICFmaWxlbmFtZS5zdGFydHNXaXRoKCcvJykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgaXQncyBhbiBhYnNvbHV0ZSB3aW5kb3dzIHBhdGgKICAgICAgIWZpbGVuYW1lLm1hdGNoKC9eW0EtWl06LykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgdGhlIHBhdGggaXMgc3RhcnRpbmcgd2l0aCBhIGRvdAogICAgICAhZmlsZW5hbWUuc3RhcnRzV2l0aCgnLicpICYmCiAgICAgIC8vIEl0J3Mgbm90IGludGVybmFsIGlmIHRoZSBmcmFtZSBoYXMgYSBwcm90b2NvbC4gSW4gbm9kZSwgdGhpcyBpcyB1c3VhbGx5IHRoZSBjYXNlIGlmIHRoZSBmaWxlIGdvdCBwcmUtcHJvY2Vzc2VkIHdpdGggYSBidW5kbGVyIGxpa2Ugd2VicGFjawogICAgICAhZmlsZW5hbWUubWF0Y2goL15bYS16QS1aXShbYS16QS1aMC05LlwtK10pKjpcL1wvLykpOyAvLyBTY2hlbWEgZnJvbTogaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9hLzM2NDE3ODIKCiAgLy8gaW5fYXBwIGlzIGFsbCB0aGF0J3Mgbm90IGFuIGludGVybmFsIE5vZGUgZnVuY3Rpb24gb3IgYSBtb2R1bGUgd2l0aGluIG5vZGVfbW9kdWxlcwogIC8vIG5vdGUgdGhhdCBpc05hdGl2ZSBhcHBlYXJzIHRvIHJldHVybiB0cnVlIGV2ZW4gZm9yIG5vZGUgY29yZSBsaWJyYXJpZXMKICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9yYXZlbi1ub2RlL2lzc3Vlcy8xNzYKCiAgcmV0dXJuICFpc0ludGVybmFsICYmIGZpbGVuYW1lICE9PSB1bmRlZmluZWQgJiYgIWZpbGVuYW1lLmluY2x1ZGVzKCdub2RlX21vZHVsZXMvJyk7Cn0KCmNvbnN0IFNUQUNLVFJBQ0VfRlJBTUVfTElNSVQgPSA1MDsKY29uc3QgU1RSSVBfRlJBTUVfUkVHRVhQID0gL2NhcHR1cmVNZXNzYWdlfGNhcHR1cmVFeGNlcHRpb24vOwoKLyoqCiAqIFJlbW92ZXMgU2VudHJ5IGZyYW1lcyBmcm9tIHRoZSB0b3AgYW5kIGJvdHRvbSBvZiB0aGUgc3RhY2sgaWYgcHJlc2VudCBhbmQgZW5mb3JjZXMgYSBsaW1pdCBvZiBtYXggbnVtYmVyIG9mIGZyYW1lcy4KICogQXNzdW1lcyBzdGFjayBpbnB1dCBpcyBvcmRlcmVkIGZyb20gdG9wIHRvIGJvdHRvbSBhbmQgcmV0dXJucyB0aGUgcmV2ZXJzZSByZXByZXNlbnRhdGlvbiBzbyBjYWxsIHNpdGUgb2YgdGhlCiAqIGZ1bmN0aW9uIHRoYXQgY2F1c2VkIHRoZSBjcmFzaCBpcyB0aGUgbGFzdCBmcmFtZSBpbiB0aGUgYXJyYXkuCiAqIEBoaWRkZW4KICovCmZ1bmN0aW9uIHN0cmlwU2VudHJ5RnJhbWVzQW5kUmV2ZXJzZShzdGFjaykgewogIGlmICghc3RhY2subGVuZ3RoKSB7CiAgICByZXR1cm4gW107CiAgfQoKICBjb25zdCBsb2NhbFN0YWNrID0gQXJyYXkuZnJvbShzdGFjayk7CgogIC8vIElmIHN0YWNrIHN0YXJ0cyB3aXRoIG9uZSBvZiBvdXIgQVBJIGNhbGxzLCByZW1vdmUgaXQgKHN0YXJ0cywgbWVhbmluZyBpdCdzIHRoZSB0b3Agb2YgdGhlIHN0YWNrIC0gYWthIGxhc3QgY2FsbCkKICBpZiAoL3NlbnRyeVdyYXBwZWQvLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgbG9jYWxTdGFjay5wb3AoKTsKICB9CgogIC8vIFJldmVyc2luZyBpbiB0aGUgbWlkZGxlIG9mIHRoZSBwcm9jZWR1cmUgYWxsb3dzIHVzIHRvIGp1c3QgcG9wIHRoZSB2YWx1ZXMgb2ZmIHRoZSBzdGFjawogIGxvY2FsU3RhY2sucmV2ZXJzZSgpOwoKICAvLyBJZiBzdGFjayBlbmRzIHdpdGggb25lIG9mIG91ciBpbnRlcm5hbCBBUEkgY2FsbHMsIHJlbW92ZSBpdCAoZW5kcywgbWVhbmluZyBpdCdzIHRoZSBib3R0b20gb2YgdGhlIHN0YWNrIC0gYWthIHRvcC1tb3N0IGNhbGwpCiAgaWYgKFNUUklQX0ZSQU1FX1JFR0VYUC50ZXN0KGxvY2FsU3RhY2tbbG9jYWxTdGFjay5sZW5ndGggLSAxXS5mdW5jdGlvbiB8fCAnJykpIHsKICAgIGxvY2FsU3RhY2sucG9wKCk7CgogICAgLy8gV2hlbiB1c2luZyBzeW50aGV0aWMgZXZlbnRzLCB3ZSB3aWxsIGhhdmUgYSAyIGxldmVscyBkZWVwIHN0YWNrLCBhcyBgbmV3IEVycm9yKCdTZW50cnkgc3ludGhldGljRXhjZXB0aW9uJylgCiAgICAvLyBpcyBwcm9kdWNlZCB3aXRoaW4gdGhlIGh1YiBpdHNlbGYsIG1ha2luZyBpdDoKICAgIC8vCiAgICAvLyAgIFNlbnRyeS5jYXB0dXJlRXhjZXB0aW9uKCkKICAgIC8vICAgZ2V0Q3VycmVudEh1YigpLmNhcHR1cmVFeGNlcHRpb24oKQogICAgLy8KICAgIC8vIGluc3RlYWQgb2YganVzdCB0aGUgdG9wIGBTZW50cnlgIGNhbGwgaXRzZWxmLgogICAgLy8gVGhpcyBmb3JjZXMgdXMgdG8gcG9zc2libHkgc3RyaXAgYW4gYWRkaXRpb25hbCBmcmFtZSBpbiB0aGUgZXhhY3Qgc2FtZSB3YXMgYXMgYWJvdmUuCiAgICBpZiAoU1RSSVBfRlJBTUVfUkVHRVhQLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgICBsb2NhbFN0YWNrLnBvcCgpOwogICAgfQogIH0KCiAgcmV0dXJuIGxvY2FsU3RhY2suc2xpY2UoMCwgU1RBQ0tUUkFDRV9GUkFNRV9MSU1JVCkubWFwKGZyYW1lID0+ICh7CiAgICAuLi5mcmFtZSwKICAgIGZpbGVuYW1lOiBmcmFtZS5maWxlbmFtZSB8fCBsb2NhbFN0YWNrW2xvY2FsU3RhY2subGVuZ3RoIC0gMV0uZmlsZW5hbWUsCiAgICBmdW5jdGlvbjogZnJhbWUuZnVuY3Rpb24gfHwgJz8nLAogIH0pKTsKfQoKY29uc3QgZGVmYXVsdEZ1bmN0aW9uTmFtZSA9ICc8YW5vbnltb3VzPic7CgovKioKICogU2FmZWx5IGV4dHJhY3QgZnVuY3Rpb24gbmFtZSBmcm9tIGl0c2VsZgogKi8KZnVuY3Rpb24gZ2V0RnVuY3Rpb25OYW1lKGZuKSB7CiAgdHJ5IHsKICAgIGlmICghZm4gfHwgdHlwZW9mIGZuICE9PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBkZWZhdWx0RnVuY3Rpb25OYW1lOwogICAgfQogICAgcmV0dXJuIGZuLm5hbWUgfHwgZGVmYXVsdEZ1bmN0aW9uTmFtZTsKICB9IGNhdGNoIChlKSB7CiAgICAvLyBKdXN0IGFjY2Vzc2luZyBjdXN0b20gcHJvcHMgaW4gc29tZSBTZWxlbml1bSBlbnZpcm9ubWVudHMKICAgIC8vIGNhbiBjYXVzZSBhICJQZXJtaXNzaW9uIGRlbmllZCIgZXhjZXB0aW9uIChzZWUgcmF2ZW4tanMjNDk1KS4KICAgIHJldHVybiBkZWZhdWx0RnVuY3Rpb25OYW1lOwogIH0KfQoKLyoqCiAqIFVVSUQ0IGdlbmVyYXRvcgogKgogKiBAcmV0dXJucyBzdHJpbmcgR2VuZXJhdGVkIFVVSUQ0LgogKi8KZnVuY3Rpb24gdXVpZDQoKSB7CiAgY29uc3QgZ2JsID0gR0xPQkFMX09CSiA7CiAgY29uc3QgY3J5cHRvID0gZ2JsLmNyeXB0byB8fCBnYmwubXNDcnlwdG87CgogIGxldCBnZXRSYW5kb21CeXRlID0gKCkgPT4gTWF0aC5yYW5kb20oKSAqIDE2OwogIHRyeSB7CiAgICBpZiAoY3J5cHRvICYmIGNyeXB0by5yYW5kb21VVUlEKSB7CiAgICAgIHJldHVybiBjcnlwdG8ucmFuZG9tVVVJRCgpLnJlcGxhY2UoLy0vZywgJycpOwogICAgfQogICAgaWYgKGNyeXB0byAmJiBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzKSB7CiAgICAgIGdldFJhbmRvbUJ5dGUgPSAoKSA9PiB7CiAgICAgICAgLy8gY3J5cHRvLmdldFJhbmRvbVZhbHVlcyBtaWdodCByZXR1cm4gdW5kZWZpbmVkIGluc3RlYWQgb2YgdGhlIHR5cGVkIGFycmF5CiAgICAgICAgLy8gaW4gb2xkIENocm9taXVtIHZlcnNpb25zIChlLmcuIDIzLjAuMTIzNS4wICgxNTE0MjIpKQogICAgICAgIC8vIEhvd2V2ZXIsIGB0eXBlZEFycmF5YCBpcyBzdGlsbCBmaWxsZWQgaW4tcGxhY2UuCiAgICAgICAgLy8gQHNlZSBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvQ3J5cHRvL2dldFJhbmRvbVZhbHVlcyN0eXBlZGFycmF5CiAgICAgICAgY29uc3QgdHlwZWRBcnJheSA9IG5ldyBVaW50OEFycmF5KDEpOwogICAgICAgIGNyeXB0by5nZXRSYW5kb21WYWx1ZXModHlwZWRBcnJheSk7CiAgICAgICAgcmV0dXJuIHR5cGVkQXJyYXlbMF07CiAgICAgIH07CiAgICB9CiAgfSBjYXRjaCAoXykgewogICAgLy8gc29tZSBydW50aW1lcyBjYW4gY3Jhc2ggaW52b2tpbmcgY3J5cHRvCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy84OTM1CiAgfQoKICAvLyBodHRwOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzEwNTAzNC9ob3ctdG8tY3JlYXRlLWEtZ3VpZC11dWlkLWluLWphdmFzY3JpcHQvMjExNzUyMyMyMTE3NTIzCiAgLy8gQ29uY2F0ZW5hdGluZyB0aGUgZm9sbG93aW5nIG51bWJlcnMgYXMgc3RyaW5ncyByZXN1bHRzIGluICcxMDAwMDAwMDEwMDA0MDAwODAwMDEwMDAwMDAwMDAwMCcKICByZXR1cm4gKChbMWU3XSApICsgMWUzICsgNGUzICsgOGUzICsgMWUxMSkucmVwbGFjZSgvWzAxOF0vZywgYyA9PgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWJpdHdpc2UKICAgICgoYyApIF4gKChnZXRSYW5kb21CeXRlKCkgJiAxNSkgPj4gKChjICkgLyA0KSkpLnRvU3RyaW5nKDE2KSwKICApOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgdGhlIGdpdmVuIGlucHV0IGlzIGFscmVhZHkgYW4gYXJyYXksIGFuZCBpZiBpdCBpc24ndCwgd3JhcHMgaXQgaW4gb25lLgogKgogKiBAcGFyYW0gbWF5YmVBcnJheSBJbnB1dCB0byB0dXJuIGludG8gYW4gYXJyYXksIGlmIG5lY2Vzc2FyeQogKiBAcmV0dXJucyBUaGUgaW5wdXQsIGlmIGFscmVhZHkgYW4gYXJyYXksIG9yIGFuIGFycmF5IHdpdGggdGhlIGlucHV0IGFzIHRoZSBvbmx5IGVsZW1lbnQsIGlmIG5vdAogKi8KZnVuY3Rpb24gYXJyYXlpZnkobWF5YmVBcnJheSkgewogIHJldHVybiBBcnJheS5pc0FycmF5KG1heWJlQXJyYXkpID8gbWF5YmVBcnJheSA6IFttYXliZUFycmF5XTsKfQoKLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzICovCi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkgKi8KCi8qKgogKiBIZWxwZXIgdG8gZGVjeWNsZSBqc29uIG9iamVjdHMKICovCmZ1bmN0aW9uIG1lbW9CdWlsZGVyKCkgewogIGNvbnN0IGhhc1dlYWtTZXQgPSB0eXBlb2YgV2Vha1NldCA9PT0gJ2Z1bmN0aW9uJzsKICBjb25zdCBpbm5lciA9IGhhc1dlYWtTZXQgPyBuZXcgV2Vha1NldCgpIDogW107CiAgZnVuY3Rpb24gbWVtb2l6ZShvYmopIHsKICAgIGlmIChoYXNXZWFrU2V0KSB7CiAgICAgIGlmIChpbm5lci5oYXMob2JqKSkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9CiAgICAgIGlubmVyLmFkZChvYmopOwogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3ByZWZlci1mb3Itb2YKICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaW5uZXIubGVuZ3RoOyBpKyspIHsKICAgICAgY29uc3QgdmFsdWUgPSBpbm5lcltpXTsKICAgICAgaWYgKHZhbHVlID09PSBvYmopIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgfQogICAgaW5uZXIucHVzaChvYmopOwogICAgcmV0dXJuIGZhbHNlOwogIH0KCiAgZnVuY3Rpb24gdW5tZW1vaXplKG9iaikgewogICAgaWYgKGhhc1dlYWtTZXQpIHsKICAgICAgaW5uZXIuZGVsZXRlKG9iaik7CiAgICB9IGVsc2UgewogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlubmVyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGlubmVyW2ldID09PSBvYmopIHsKICAgICAgICAgIGlubmVyLnNwbGljZShpLCAxKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICByZXR1cm4gW21lbW9pemUsIHVubWVtb2l6ZV07Cn0KCi8qKgogKiBSZWN1cnNpdmVseSBub3JtYWxpemVzIHRoZSBnaXZlbiBvYmplY3QuCiAqCiAqIC0gQ3JlYXRlcyBhIGNvcHkgdG8gcHJldmVudCBvcmlnaW5hbCBpbnB1dCBtdXRhdGlvbgogKiAtIFNraXBzIG5vbi1lbnVtZXJhYmxlIHByb3BlcnRpZXMKICogLSBXaGVuIHN0cmluZ2lmeWluZywgY2FsbHMgYHRvSlNPTmAgaWYgaW1wbGVtZW50ZWQKICogLSBSZW1vdmVzIGNpcmN1bGFyIHJlZmVyZW5jZXMKICogLSBUcmFuc2xhdGVzIG5vbi1zZXJpYWxpemFibGUgdmFsdWVzIChgdW5kZWZpbmVkYC9gTmFOYC9mdW5jdGlvbnMpIHRvIHNlcmlhbGl6YWJsZSBmb3JtYXQKICogLSBUcmFuc2xhdGVzIGtub3duIGdsb2JhbCBvYmplY3RzL2NsYXNzZXMgdG8gYSBzdHJpbmcgcmVwcmVzZW50YXRpb25zCiAqIC0gVGFrZXMgY2FyZSBvZiBgRXJyb3JgIG9iamVjdCBzZXJpYWxpemF0aW9uCiAqIC0gT3B0aW9uYWxseSBsaW1pdHMgZGVwdGggb2YgZmluYWwgb3V0cHV0CiAqIC0gT3B0aW9uYWxseSBsaW1pdHMgbnVtYmVyIG9mIHByb3BlcnRpZXMvZWxlbWVudHMgaW5jbHVkZWQgaW4gYW55IHNpbmdsZSBvYmplY3QvYXJyYXkKICoKICogQHBhcmFtIGlucHV0IFRoZSBvYmplY3QgdG8gYmUgbm9ybWFsaXplZC4KICogQHBhcmFtIGRlcHRoIFRoZSBtYXggZGVwdGggdG8gd2hpY2ggdG8gbm9ybWFsaXplIHRoZSBvYmplY3QuIChBbnl0aGluZyBkZWVwZXIgc3RyaW5naWZpZWQgd2hvbGUuKQogKiBAcGFyYW0gbWF4UHJvcGVydGllcyBUaGUgbWF4IG51bWJlciBvZiBlbGVtZW50cyBvciBwcm9wZXJ0aWVzIHRvIGJlIGluY2x1ZGVkIGluIGFueSBzaW5nbGUgYXJyYXkgb3IKICogb2JqZWN0IGluIHRoZSBub3JtYWxsaXplZCBvdXRwdXQuCiAqIEByZXR1cm5zIEEgbm9ybWFsaXplZCB2ZXJzaW9uIG9mIHRoZSBvYmplY3QsIG9yIGAiKipub24tc2VyaWFsaXphYmxlKioiYCBpZiBhbnkgZXJyb3JzIGFyZSB0aHJvd24gZHVyaW5nIG5vcm1hbGl6YXRpb24uCiAqLwovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQpmdW5jdGlvbiBub3JtYWxpemUoaW5wdXQsIGRlcHRoID0gMTAwLCBtYXhQcm9wZXJ0aWVzID0gK0luZmluaXR5KSB7CiAgdHJ5IHsKICAgIC8vIHNpbmNlIHdlJ3JlIGF0IHRoZSBvdXRlcm1vc3QgbGV2ZWwsIHdlIGRvbid0IHByb3ZpZGUgYSBrZXkKICAgIHJldHVybiB2aXNpdCgnJywgaW5wdXQsIGRlcHRoLCBtYXhQcm9wZXJ0aWVzKTsKICB9IGNhdGNoIChlcnIpIHsKICAgIHJldHVybiB7IEVSUk9SOiBgKipub24tc2VyaWFsaXphYmxlKiogKCR7ZXJyfSlgIH07CiAgfQp9CgovKioKICogVmlzaXRzIGEgbm9kZSB0byBwZXJmb3JtIG5vcm1hbGl6YXRpb24gb24gaXQKICoKICogQHBhcmFtIGtleSBUaGUga2V5IGNvcnJlc3BvbmRpbmcgdG8gdGhlIGdpdmVuIG5vZGUKICogQHBhcmFtIHZhbHVlIFRoZSBub2RlIHRvIGJlIHZpc2l0ZWQKICogQHBhcmFtIGRlcHRoIE9wdGlvbmFsIG51bWJlciBpbmRpY2F0aW5nIHRoZSBtYXhpbXVtIHJlY3Vyc2lvbiBkZXB0aAogKiBAcGFyYW0gbWF4UHJvcGVydGllcyBPcHRpb25hbCBtYXhpbXVtIG51bWJlciBvZiBwcm9wZXJ0aWVzL2VsZW1lbnRzIGluY2x1ZGVkIGluIGFueSBzaW5nbGUgb2JqZWN0L2FycmF5CiAqIEBwYXJhbSBtZW1vIE9wdGlvbmFsIE1lbW8gY2xhc3MgaGFuZGxpbmcgZGVjeWNsaW5nCiAqLwpmdW5jdGlvbiB2aXNpdCgKICBrZXksCiAgdmFsdWUsCiAgZGVwdGggPSArSW5maW5pdHksCiAgbWF4UHJvcGVydGllcyA9ICtJbmZpbml0eSwKICBtZW1vID0gbWVtb0J1aWxkZXIoKSwKKSB7CiAgY29uc3QgW21lbW9pemUsIHVubWVtb2l6ZV0gPSBtZW1vOwoKICAvLyBHZXQgdGhlIHNpbXBsZSBjYXNlcyBvdXQgb2YgdGhlIHdheSBmaXJzdAogIGlmICgKICAgIHZhbHVlID09IG51bGwgfHwgLy8gdGhpcyBtYXRjaGVzIG51bGwgYW5kIHVuZGVmaW5lZCAtPiBlcWVxIG5vdCBlcWVxZXEKICAgIChbJ251bWJlcicsICdib29sZWFuJywgJ3N0cmluZyddLmluY2x1ZGVzKHR5cGVvZiB2YWx1ZSkgJiYgIWlzTmFOJDEodmFsdWUpKQogICkgewogICAgcmV0dXJuIHZhbHVlIDsKICB9CgogIGNvbnN0IHN0cmluZ2lmaWVkID0gc3RyaW5naWZ5VmFsdWUoa2V5LCB2YWx1ZSk7CgogIC8vIEFueXRoaW5nIHdlIGNvdWxkIHBvdGVudGlhbGx5IGRpZyBpbnRvIG1vcmUgKG9iamVjdHMgb3IgYXJyYXlzKSB3aWxsIGhhdmUgY29tZSBiYWNrIGFzIGAiW29iamVjdCBYWFhYXSJgLgogIC8vIEV2ZXJ5dGhpbmcgZWxzZSB3aWxsIGhhdmUgYWxyZWFkeSBiZWVuIHNlcmlhbGl6ZWQsIHNvIGlmIHdlIGRvbid0IHNlZSB0aGF0IHBhdHRlcm4sIHdlJ3JlIGRvbmUuCiAgaWYgKCFzdHJpbmdpZmllZC5zdGFydHNXaXRoKCdbb2JqZWN0ICcpKSB7CiAgICByZXR1cm4gc3RyaW5naWZpZWQ7CiAgfQoKICAvLyBGcm9tIGhlcmUgb24sIHdlIGNhbiBhc3NlcnQgdGhhdCBgdmFsdWVgIGlzIGVpdGhlciBhbiBvYmplY3Qgb3IgYW4gYXJyYXkuCgogIC8vIERvIG5vdCBub3JtYWxpemUgb2JqZWN0cyB0aGF0IHdlIGtub3cgaGF2ZSBhbHJlYWR5IGJlZW4gbm9ybWFsaXplZC4gQXMgYSBnZW5lcmFsIHJ1bGUsIHRoZQogIC8vICJfX3NlbnRyeV9za2lwX25vcm1hbGl6YXRpb25fXyIgcHJvcGVydHkgc2hvdWxkIG9ubHkgYmUgdXNlZCBzcGFyaW5nbHkgYW5kIG9ubHkgc2hvdWxkIG9ubHkgYmUgc2V0IG9uIG9iamVjdHMgdGhhdAogIC8vIGhhdmUgYWxyZWFkeSBiZWVuIG5vcm1hbGl6ZWQuCiAgaWYgKCh2YWx1ZSApWydfX3NlbnRyeV9za2lwX25vcm1hbGl6YXRpb25fXyddKSB7CiAgICByZXR1cm4gdmFsdWUgOwogIH0KCiAgLy8gV2UgY2FuIHNldCBgX19zZW50cnlfb3ZlcnJpZGVfbm9ybWFsaXphdGlvbl9kZXB0aF9fYCBvbiBhbiBvYmplY3QgdG8gZW5zdXJlIHRoYXQgZnJvbSB0aGVyZQogIC8vIFdlIGtlZXAgYSBjZXJ0YWluIGFtb3VudCBvZiBkZXB0aC4KICAvLyBUaGlzIHNob3VsZCBiZSB1c2VkIHNwYXJpbmdseSwgZS5nLiB3ZSB1c2UgaXQgZm9yIHRoZSByZWR1eCBpbnRlZ3JhdGlvbiB0byBlbnN1cmUgd2UgZ2V0IGEgY2VydGFpbiBhbW91bnQgb2Ygc3RhdGUuCiAgY29uc3QgcmVtYWluaW5nRGVwdGggPQogICAgdHlwZW9mICh2YWx1ZSApWydfX3NlbnRyeV9vdmVycmlkZV9ub3JtYWxpemF0aW9uX2RlcHRoX18nXSA9PT0gJ251bWJlcicKICAgICAgPyAoKHZhbHVlIClbJ19fc2VudHJ5X292ZXJyaWRlX25vcm1hbGl6YXRpb25fZGVwdGhfXyddICkKICAgICAgOiBkZXB0aDsKCiAgLy8gV2UncmUgYWxzbyBkb25lIGlmIHdlJ3ZlIHJlYWNoZWQgdGhlIG1heCBkZXB0aAogIGlmIChyZW1haW5pbmdEZXB0aCA9PT0gMCkgewogICAgLy8gQXQgdGhpcyBwb2ludCB3ZSBrbm93IGBzZXJpYWxpemVkYCBpcyBhIHN0cmluZyBvZiB0aGUgZm9ybSBgIltvYmplY3QgWFhYWF0iYC4gQ2xlYW4gaXQgdXAgc28gaXQncyBqdXN0IGAiW1hYWFhdImAuCiAgICByZXR1cm4gc3RyaW5naWZpZWQucmVwbGFjZSgnb2JqZWN0ICcsICcnKTsKICB9CgogIC8vIElmIHdlJ3ZlIGFscmVhZHkgdmlzaXRlZCB0aGlzIGJyYW5jaCwgYmFpbCBvdXQsIGFzIGl0J3MgY2lyY3VsYXIgcmVmZXJlbmNlLiBJZiBub3QsIG5vdGUgdGhhdCB3ZSdyZSBzZWVpbmcgaXQgbm93LgogIGlmIChtZW1vaXplKHZhbHVlKSkgewogICAgcmV0dXJuICdbQ2lyY3VsYXIgfl0nOwogIH0KCiAgLy8gSWYgdGhlIHZhbHVlIGhhcyBhIGB0b0pTT05gIG1ldGhvZCwgd2UgY2FsbCBpdCB0byBleHRyYWN0IG1vcmUgaW5mb3JtYXRpb24KICBjb25zdCB2YWx1ZVdpdGhUb0pTT04gPSB2YWx1ZSA7CiAgaWYgKHZhbHVlV2l0aFRvSlNPTiAmJiB0eXBlb2YgdmFsdWVXaXRoVG9KU09OLnRvSlNPTiA9PT0gJ2Z1bmN0aW9uJykgewogICAgdHJ5IHsKICAgICAgY29uc3QganNvblZhbHVlID0gdmFsdWVXaXRoVG9KU09OLnRvSlNPTigpOwogICAgICAvLyBXZSBuZWVkIHRvIG5vcm1hbGl6ZSB0aGUgcmV0dXJuIHZhbHVlIG9mIGAudG9KU09OKClgIGluIGNhc2UgaXQgaGFzIGNpcmN1bGFyIHJlZmVyZW5jZXMKICAgICAgcmV0dXJuIHZpc2l0KCcnLCBqc29uVmFsdWUsIHJlbWFpbmluZ0RlcHRoIC0gMSwgbWF4UHJvcGVydGllcywgbWVtbyk7CiAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgLy8gcGFzcyAoVGhlIGJ1aWx0LWluIGB0b0pTT05gIGZhaWxlZCwgYnV0IHdlIGNhbiBzdGlsbCB0cnkgdG8gZG8gaXQgb3Vyc2VsdmVzKQogICAgfQogIH0KCiAgLy8gQXQgdGhpcyBwb2ludCB3ZSBrbm93IHdlIGVpdGhlciBoYXZlIGFuIG9iamVjdCBvciBhbiBhcnJheSwgd2UgaGF2ZW4ndCBzZWVuIGl0IGJlZm9yZSwgYW5kIHdlJ3JlIGdvaW5nIHRvIHJlY3Vyc2UKICAvLyBiZWNhdXNlIHdlIGhhdmVuJ3QgeWV0IHJlYWNoZWQgdGhlIG1heCBkZXB0aC4gQ3JlYXRlIGFuIGFjY3VtdWxhdG9yIHRvIGhvbGQgdGhlIHJlc3VsdHMgb2YgdmlzaXRpbmcgZWFjaAogIC8vIHByb3BlcnR5L2VudHJ5LCBhbmQga2VlcCB0cmFjayBvZiB0aGUgbnVtYmVyIG9mIGl0ZW1zIHdlIGFkZCB0byBpdC4KICBjb25zdCBub3JtYWxpemVkID0gKEFycmF5LmlzQXJyYXkodmFsdWUpID8gW10gOiB7fSkgOwogIGxldCBudW1BZGRlZCA9IDA7CgogIC8vIEJlZm9yZSB3ZSBiZWdpbiwgY29udmVydGBFcnJvcmAgYW5kYEV2ZW50YCBpbnN0YW5jZXMgaW50byBwbGFpbiBvYmplY3RzLCBzaW5jZSBzb21lIG9mIGVhY2ggb2YgdGhlaXIgcmVsZXZhbnQKICAvLyBwcm9wZXJ0aWVzIGFyZSBub24tZW51bWVyYWJsZSBhbmQgb3RoZXJ3aXNlIHdvdWxkIGdldCBtaXNzZWQuCiAgY29uc3QgdmlzaXRhYmxlID0gY29udmVydFRvUGxhaW5PYmplY3QodmFsdWUgKTsKCiAgZm9yIChjb25zdCB2aXNpdEtleSBpbiB2aXNpdGFibGUpIHsKICAgIC8vIEF2b2lkIGl0ZXJhdGluZyBvdmVyIGZpZWxkcyBpbiB0aGUgcHJvdG90eXBlIGlmIHRoZXkndmUgc29tZWhvdyBiZWVuIGV4cG9zZWQgdG8gZW51bWVyYXRpb24uCiAgICBpZiAoIU9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh2aXNpdGFibGUsIHZpc2l0S2V5KSkgewogICAgICBjb250aW51ZTsKICAgIH0KCiAgICBpZiAobnVtQWRkZWQgPj0gbWF4UHJvcGVydGllcykgewogICAgICBub3JtYWxpemVkW3Zpc2l0S2V5XSA9ICdbTWF4UHJvcGVydGllcyB+XSc7CiAgICAgIGJyZWFrOwogICAgfQoKICAgIC8vIFJlY3Vyc2l2ZWx5IHZpc2l0IGFsbCB0aGUgY2hpbGQgbm9kZXMKICAgIGNvbnN0IHZpc2l0VmFsdWUgPSB2aXNpdGFibGVbdmlzaXRLZXldOwogICAgbm9ybWFsaXplZFt2aXNpdEtleV0gPSB2aXNpdCh2aXNpdEtleSwgdmlzaXRWYWx1ZSwgcmVtYWluaW5nRGVwdGggLSAxLCBtYXhQcm9wZXJ0aWVzLCBtZW1vKTsKCiAgICBudW1BZGRlZCsrOwogIH0KCiAgLy8gT25jZSB3ZSd2ZSB2aXNpdGVkIGFsbCB0aGUgYnJhbmNoZXMsIHJlbW92ZSB0aGUgcGFyZW50IGZyb20gbWVtbyBzdG9yYWdlCiAgdW5tZW1vaXplKHZhbHVlKTsKCiAgLy8gUmV0dXJuIGFjY3VtdWxhdGVkIHZhbHVlcwogIHJldHVybiBub3JtYWxpemVkOwp9CgovKiBlc2xpbnQtZGlzYWJsZSBjb21wbGV4aXR5ICovCi8qKgogKiBTdHJpbmdpZnkgdGhlIGdpdmVuIHZhbHVlLiBIYW5kbGVzIHZhcmlvdXMga25vd24gc3BlY2lhbCB2YWx1ZXMgYW5kIHR5cGVzLgogKgogKiBOb3QgbWVhbnQgdG8gYmUgdXNlZCBvbiBzaW1wbGUgcHJpbWl0aXZlcyB3aGljaCBhbHJlYWR5IGhhdmUgYSBzdHJpbmcgcmVwcmVzZW50YXRpb24sIGFzIGl0IHdpbGwsIGZvciBleGFtcGxlLCB0dXJuCiAqIHRoZSBudW1iZXIgMTIzMSBpbnRvICJbT2JqZWN0IE51bWJlcl0iLCBub3Igb24gYG51bGxgLCBhcyBpdCB3aWxsIHRocm93LgogKgogKiBAcGFyYW0gdmFsdWUgVGhlIHZhbHVlIHRvIHN0cmluZ2lmeQogKiBAcmV0dXJucyBBIHN0cmluZ2lmaWVkIHJlcHJlc2VudGF0aW9uIG9mIHRoZSBnaXZlbiB2YWx1ZQogKi8KZnVuY3Rpb24gc3RyaW5naWZ5VmFsdWUoCiAga2V5LAogIC8vIHRoaXMgdHlwZSBpcyBhIHRpbnkgYml0IG9mIGEgY2hlYXQsIHNpbmNlIHRoaXMgZnVuY3Rpb24gZG9lcyBoYW5kbGUgTmFOICh3aGljaCBpcyB0ZWNobmljYWxseSBhIG51bWJlciksIGJ1dCBmb3IKICAvLyBvdXIgaW50ZXJuYWwgdXNlLCBpdCdsbCBkbwogIHZhbHVlLAopIHsKICB0cnkgewogICAgaWYgKGtleSA9PT0gJ2RvbWFpbicgJiYgdmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiAodmFsdWUgKS5fZXZlbnRzKSB7CiAgICAgIHJldHVybiAnW0RvbWFpbl0nOwogICAgfQoKICAgIGlmIChrZXkgPT09ICdkb21haW5FbWl0dGVyJykgewogICAgICByZXR1cm4gJ1tEb21haW5FbWl0dGVyXSc7CiAgICB9CgogICAgLy8gSXQncyBzYWZlIHRvIHVzZSBgZ2xvYmFsYCwgYHdpbmRvd2AsIGFuZCBgZG9jdW1lbnRgIGhlcmUgaW4gdGhpcyBtYW5uZXIsIGFzIHdlIGFyZSBhc3NlcnRpbmcgdXNpbmcgYHR5cGVvZmAgZmlyc3QKICAgIC8vIHdoaWNoIHdvbid0IHRocm93IGlmIHRoZXkgYXJlIG5vdCBwcmVzZW50LgoKICAgIGlmICh0eXBlb2YgZ2xvYmFsICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSA9PT0gZ2xvYmFsKSB7CiAgICAgIHJldHVybiAnW0dsb2JhbF0nOwogICAgfQoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHMKICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSA9PT0gd2luZG93KSB7CiAgICAgIHJldHVybiAnW1dpbmRvd10nOwogICAgfQoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLWdsb2JhbHMKICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnICYmIHZhbHVlID09PSBkb2N1bWVudCkgewogICAgICByZXR1cm4gJ1tEb2N1bWVudF0nOwogICAgfQoKICAgIGlmIChpc1Z1ZVZpZXdNb2RlbCh2YWx1ZSkpIHsKICAgICAgcmV0dXJuICdbVnVlVmlld01vZGVsXSc7CiAgICB9CgogICAgLy8gUmVhY3QncyBTeW50aGV0aWNFdmVudCB0aGluZ3kKICAgIGlmIChpc1N5bnRoZXRpY0V2ZW50KHZhbHVlKSkgewogICAgICByZXR1cm4gJ1tTeW50aGV0aWNFdmVudF0nOwogICAgfQoKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIHZhbHVlICE9PSB2YWx1ZSkgewogICAgICByZXR1cm4gJ1tOYU5dJzsKICAgIH0KCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nKSB7CiAgICAgIHJldHVybiBgW0Z1bmN0aW9uOiAke2dldEZ1bmN0aW9uTmFtZSh2YWx1ZSl9XWA7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N5bWJvbCcpIHsKICAgICAgcmV0dXJuIGBbJHtTdHJpbmcodmFsdWUpfV1gOwogICAgfQoKICAgIC8vIHN0cmluZ2lmaWVkIEJpZ0ludHMgYXJlIGluZGlzdGluZ3Vpc2hhYmxlIGZyb20gcmVndWxhciBudW1iZXJzLCBzbyB3ZSBuZWVkIHRvIGxhYmVsIHRoZW0gdG8gYXZvaWQgY29uZnVzaW9uCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnYmlnaW50JykgewogICAgICByZXR1cm4gYFtCaWdJbnQ6ICR7U3RyaW5nKHZhbHVlKX1dYDsKICAgIH0KCiAgICAvLyBOb3cgdGhhdCB3ZSd2ZSBrbm9ja2VkIG91dCBhbGwgdGhlIHNwZWNpYWwgY2FzZXMgYW5kIHRoZSBwcmltaXRpdmVzLCBhbGwgd2UgaGF2ZSBsZWZ0IGFyZSBvYmplY3RzLiBTaW1wbHkgY2FzdGluZwogICAgLy8gdGhlbSB0byBzdHJpbmdzIG1lYW5zIHRoYXQgaW5zdGFuY2VzIG9mIGNsYXNzZXMgd2hpY2ggaGF2ZW4ndCBkZWZpbmVkIHRoZWlyIGB0b1N0cmluZ1RhZ2Agd2lsbCBqdXN0IGNvbWUgb3V0IGFzCiAgICAvLyBgIltvYmplY3QgT2JqZWN0XSJgLiBJZiB3ZSBpbnN0ZWFkIGxvb2sgYXQgdGhlIGNvbnN0cnVjdG9yJ3MgbmFtZSAod2hpY2ggaXMgdGhlIHNhbWUgYXMgdGhlIG5hbWUgb2YgdGhlIGNsYXNzKSwKICAgIC8vIHdlIGNhbiBtYWtlIHN1cmUgdGhhdCBvbmx5IHBsYWluIG9iamVjdHMgY29tZSBvdXQgdGhhdCB3YXkuCiAgICBjb25zdCBvYmpOYW1lID0gZ2V0Q29uc3RydWN0b3JOYW1lKHZhbHVlKTsKCiAgICAvLyBIYW5kbGUgSFRNTCBFbGVtZW50cwogICAgaWYgKC9eSFRNTChcdyopRWxlbWVudCQvLnRlc3Qob2JqTmFtZSkpIHsKICAgICAgcmV0dXJuIGBbSFRNTEVsZW1lbnQ6ICR7b2JqTmFtZX1dYDsKICAgIH0KCiAgICByZXR1cm4gYFtvYmplY3QgJHtvYmpOYW1lfV1gOwogIH0gY2F0Y2ggKGVycikgewogICAgcmV0dXJuIGAqKm5vbi1zZXJpYWxpemFibGUqKiAoJHtlcnJ9KWA7CiAgfQp9Ci8qIGVzbGludC1lbmFibGUgY29tcGxleGl0eSAqLwoKZnVuY3Rpb24gZ2V0Q29uc3RydWN0b3JOYW1lKHZhbHVlKSB7CiAgY29uc3QgcHJvdG90eXBlID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKHZhbHVlKTsKCiAgcmV0dXJuIHByb3RvdHlwZSA/IHByb3RvdHlwZS5jb25zdHJ1Y3Rvci5uYW1lIDogJ251bGwgcHJvdG90eXBlJzsKfQoKLyoqCiAqIE5vcm1hbGl6ZXMgVVJMcyBpbiBleGNlcHRpb25zIGFuZCBzdGFja3RyYWNlcyB0byBhIGJhc2UgcGF0aCBzbyBTZW50cnkgY2FuIGZpbmdlcnByaW50CiAqIGFjcm9zcyBwbGF0Zm9ybXMgYW5kIHdvcmtpbmcgZGlyZWN0b3J5LgogKgogKiBAcGFyYW0gdXJsIFRoZSBVUkwgdG8gYmUgbm9ybWFsaXplZC4KICogQHBhcmFtIGJhc2VQYXRoIFRoZSBhcHBsaWNhdGlvbiBiYXNlIHBhdGguCiAqIEByZXR1cm5zIFRoZSBub3JtYWxpemVkIFVSTC4KICovCmZ1bmN0aW9uIG5vcm1hbGl6ZVVybFRvQmFzZSh1cmwsIGJhc2VQYXRoKSB7CiAgY29uc3QgZXNjYXBlZEJhc2UgPSBiYXNlUGF0aAogICAgLy8gQmFja3NsYXNoIHRvIGZvcndhcmQKICAgIC5yZXBsYWNlKC9cXC9nLCAnLycpCiAgICAvLyBFc2NhcGUgUmVnRXhwIHNwZWNpYWwgY2hhcmFjdGVycwogICAgLnJlcGxhY2UoL1t8XFx7fSgpW1xdXiQrKj8uXS9nLCAnXFwkJicpOwoKICBsZXQgbmV3VXJsID0gdXJsOwogIHRyeSB7CiAgICBuZXdVcmwgPSBkZWNvZGVVUkkodXJsKTsKICB9IGNhdGNoIChfT28pIHsKICAgIC8vIFNvbWV0aW1lIHRoaXMgYnJlYWtzCiAgfQogIHJldHVybiAoCiAgICBuZXdVcmwKICAgICAgLnJlcGxhY2UoL1xcL2csICcvJykKICAgICAgLnJlcGxhY2UoL3dlYnBhY2s6XC8/L2csICcnKSAvLyBSZW1vdmUgaW50ZXJtZWRpYXRlIGJhc2UgcGF0aAogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHNlbnRyeS1pbnRlcm5hbC9zZGsvbm8tcmVnZXhwLWNvbnN0cnVjdG9yCiAgICAgIC5yZXBsYWNlKG5ldyBSZWdFeHAoYChmaWxlOi8vKT8vKiR7ZXNjYXBlZEJhc2V9LypgLCAnaWcnKSwgJ2FwcDovLy8nKQogICk7Cn0KCi8vIFNsaWdodGx5IG1vZGlmaWVkIChubyBJRTggc3VwcG9ydCwgRVM2KSBhbmQgdHJhbnNjcmliZWQgdG8gVHlwZVNjcmlwdAoKLy8gU3BsaXQgYSBmaWxlbmFtZSBpbnRvIFtyb290LCBkaXIsIGJhc2VuYW1lLCBleHRdLCB1bml4IHZlcnNpb24KLy8gJ3Jvb3QnIGlzIGp1c3QgYSBzbGFzaCwgb3Igbm90aGluZy4KY29uc3Qgc3BsaXRQYXRoUmUgPSAvXihcUys6XFx8XC8/KShbXHNcU10qPykoKD86XC57MSwyfXxbXi9cXF0rP3wpKFwuW14uL1xcXSp8KSkoPzpbL1xcXSopJC87Ci8qKiBKU0RvYyAqLwpmdW5jdGlvbiBzcGxpdFBhdGgoZmlsZW5hbWUpIHsKICAvLyBUcnVuY2F0ZSBmaWxlcyBuYW1lcyBncmVhdGVyIHRoYW4gMTAyNCBjaGFyYWN0ZXJzIHRvIGF2b2lkIHJlZ2V4IGRvcwogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvcHVsbC84NzM3I2Rpc2N1c3Npb25fcjEyODU3MTkxNzIKICBjb25zdCB0cnVuY2F0ZWQgPSBmaWxlbmFtZS5sZW5ndGggPiAxMDI0ID8gYDx0cnVuY2F0ZWQ+JHtmaWxlbmFtZS5zbGljZSgtMTAyNCl9YCA6IGZpbGVuYW1lOwogIGNvbnN0IHBhcnRzID0gc3BsaXRQYXRoUmUuZXhlYyh0cnVuY2F0ZWQpOwogIHJldHVybiBwYXJ0cyA/IHBhcnRzLnNsaWNlKDEpIDogW107Cn0KCi8qKiBKU0RvYyAqLwpmdW5jdGlvbiBkaXJuYW1lKHBhdGgpIHsKICBjb25zdCByZXN1bHQgPSBzcGxpdFBhdGgocGF0aCk7CiAgY29uc3Qgcm9vdCA9IHJlc3VsdFswXTsKICBsZXQgZGlyID0gcmVzdWx0WzFdOwoKICBpZiAoIXJvb3QgJiYgIWRpcikgewogICAgLy8gTm8gZGlybmFtZSB3aGF0c29ldmVyCiAgICByZXR1cm4gJy4nOwogIH0KCiAgaWYgKGRpcikgewogICAgLy8gSXQgaGFzIGEgZGlybmFtZSwgc3RyaXAgdHJhaWxpbmcgc2xhc2gKICAgIGRpciA9IGRpci5zbGljZSgwLCBkaXIubGVuZ3RoIC0gMSk7CiAgfQoKICByZXR1cm4gcm9vdCArIGRpcjsKfQoKLyogZXNsaW50LWRpc2FibGUgQHR5cGVzY3JpcHQtZXNsaW50L2V4cGxpY2l0LWZ1bmN0aW9uLXJldHVybi10eXBlICovCgovKiogU3luY1Byb21pc2UgaW50ZXJuYWwgc3RhdGVzICovCnZhciBTdGF0ZXM7IChmdW5jdGlvbiAoU3RhdGVzKSB7CiAgLyoqIFBlbmRpbmcgKi8KICBjb25zdCBQRU5ESU5HID0gMDsgU3RhdGVzW1N0YXRlc1siUEVORElORyJdID0gUEVORElOR10gPSAiUEVORElORyI7CiAgLyoqIFJlc29sdmVkIC8gT0sgKi8KICBjb25zdCBSRVNPTFZFRCA9IDE7IFN0YXRlc1tTdGF0ZXNbIlJFU09MVkVEIl0gPSBSRVNPTFZFRF0gPSAiUkVTT0xWRUQiOwogIC8qKiBSZWplY3RlZCAvIEVycm9yICovCiAgY29uc3QgUkVKRUNURUQgPSAyOyBTdGF0ZXNbU3RhdGVzWyJSRUpFQ1RFRCJdID0gUkVKRUNURURdID0gIlJFSkVDVEVEIjsKfSkoU3RhdGVzIHx8IChTdGF0ZXMgPSB7fSkpOwoKLy8gT3ZlcmxvYWRzIHNvIHdlIGNhbiBjYWxsIHJlc29sdmVkU3luY1Byb21pc2Ugd2l0aG91dCBhcmd1bWVudHMgYW5kIGdlbmVyaWMgYXJndW1lbnQKCi8qKgogKiBDcmVhdGVzIGEgcmVzb2x2ZWQgc3luYyBwcm9taXNlLgogKgogKiBAcGFyYW0gdmFsdWUgdGhlIHZhbHVlIHRvIHJlc29sdmUgdGhlIHByb21pc2Ugd2l0aAogKiBAcmV0dXJucyB0aGUgcmVzb2x2ZWQgc3luYyBwcm9taXNlCiAqLwpmdW5jdGlvbiByZXNvbHZlZFN5bmNQcm9taXNlKHZhbHVlKSB7CiAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZShyZXNvbHZlID0+IHsKICAgIHJlc29sdmUodmFsdWUpOwogIH0pOwp9CgovKioKICogQ3JlYXRlcyBhIHJlamVjdGVkIHN5bmMgcHJvbWlzZS4KICoKICogQHBhcmFtIHZhbHVlIHRoZSB2YWx1ZSB0byByZWplY3QgdGhlIHByb21pc2Ugd2l0aAogKiBAcmV0dXJucyB0aGUgcmVqZWN0ZWQgc3luYyBwcm9taXNlCiAqLwpmdW5jdGlvbiByZWplY3RlZFN5bmNQcm9taXNlKHJlYXNvbikgewogIHJldHVybiBuZXcgU3luY1Byb21pc2UoKF8sIHJlamVjdCkgPT4gewogICAgcmVqZWN0KHJlYXNvbik7CiAgfSk7Cn0KCi8qKgogKiBUaGVuYWJsZSBjbGFzcyB0aGF0IGJlaGF2ZXMgbGlrZSBhIFByb21pc2UgYW5kIGZvbGxvd3MgaXQncyBpbnRlcmZhY2UKICogYnV0IGlzIG5vdCBhc3luYyBpbnRlcm5hbGx5CiAqLwpjbGFzcyBTeW5jUHJvbWlzZSB7CgogICBjb25zdHJ1Y3RvcigKICAgIGV4ZWN1dG9yLAogICkge1N5bmNQcm9taXNlLnByb3RvdHlwZS5fX2luaXQuY2FsbCh0aGlzKTtTeW5jUHJvbWlzZS5wcm90b3R5cGUuX19pbml0Mi5jYWxsKHRoaXMpO1N5bmNQcm9taXNlLnByb3RvdHlwZS5fX2luaXQzLmNhbGwodGhpcyk7U3luY1Byb21pc2UucHJvdG90eXBlLl9faW5pdDQuY2FsbCh0aGlzKTsKICAgIHRoaXMuX3N0YXRlID0gU3RhdGVzLlBFTkRJTkc7CiAgICB0aGlzLl9oYW5kbGVycyA9IFtdOwoKICAgIHRyeSB7CiAgICAgIGV4ZWN1dG9yKHRoaXMuX3Jlc29sdmUsIHRoaXMuX3JlamVjdCk7CiAgICB9IGNhdGNoIChlKSB7CiAgICAgIHRoaXMuX3JlamVjdChlKTsKICAgIH0KICB9CgogIC8qKiBKU0RvYyAqLwogICB0aGVuKAogICAgb25mdWxmaWxsZWQsCiAgICBvbnJlamVjdGVkLAogICkgewogICAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIHRoaXMuX2hhbmRsZXJzLnB1c2goWwogICAgICAgIGZhbHNlLAogICAgICAgIHJlc3VsdCA9PiB7CiAgICAgICAgICBpZiAoIW9uZnVsZmlsbGVkKSB7CiAgICAgICAgICAgIC8vIFRPRE86IMKvXF8o44OEKV8vwq8KICAgICAgICAgICAgLy8gVE9ETzogRklYTUUKICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQgKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcmVzb2x2ZShvbmZ1bGZpbGxlZChyZXN1bHQpKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcmVhc29uID0+IHsKICAgICAgICAgIGlmICghb25yZWplY3RlZCkgewogICAgICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgcmVzb2x2ZShvbnJlamVjdGVkKHJlYXNvbikpOwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgcmVqZWN0KGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgXSk7CiAgICAgIHRoaXMuX2V4ZWN1dGVIYW5kbGVycygpOwogICAgfSk7CiAgfQoKICAvKiogSlNEb2MgKi8KICAgY2F0Y2goCiAgICBvbnJlamVjdGVkLAogICkgewogICAgcmV0dXJuIHRoaXMudGhlbih2YWwgPT4gdmFsLCBvbnJlamVjdGVkKTsKICB9CgogIC8qKiBKU0RvYyAqLwogICBmaW5hbGx5KG9uZmluYWxseSkgewogICAgcmV0dXJuIG5ldyBTeW5jUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGxldCB2YWw7CiAgICAgIGxldCBpc1JlamVjdGVkOwoKICAgICAgcmV0dXJuIHRoaXMudGhlbigKICAgICAgICB2YWx1ZSA9PiB7CiAgICAgICAgICBpc1JlamVjdGVkID0gZmFsc2U7CiAgICAgICAgICB2YWwgPSB2YWx1ZTsKICAgICAgICAgIGlmIChvbmZpbmFsbHkpIHsKICAgICAgICAgICAgb25maW5hbGx5KCk7CiAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICByZWFzb24gPT4gewogICAgICAgICAgaXNSZWplY3RlZCA9IHRydWU7CiAgICAgICAgICB2YWwgPSByZWFzb247CiAgICAgICAgICBpZiAob25maW5hbGx5KSB7CiAgICAgICAgICAgIG9uZmluYWxseSgpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICkudGhlbigoKSA9PiB7CiAgICAgICAgaWYgKGlzUmVqZWN0ZWQpIHsKICAgICAgICAgIHJlamVjdCh2YWwpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgcmVzb2x2ZSh2YWwgKTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0KCkge3RoaXMuX3Jlc29sdmUgPSAodmFsdWUpID0+IHsKICAgIHRoaXMuX3NldFJlc3VsdChTdGF0ZXMuUkVTT0xWRUQsIHZhbHVlKTsKICB9O30KCiAgLyoqIEpTRG9jICovCiAgICBfX2luaXQyKCkge3RoaXMuX3JlamVjdCA9IChyZWFzb24pID0+IHsKICAgIHRoaXMuX3NldFJlc3VsdChTdGF0ZXMuUkVKRUNURUQsIHJlYXNvbik7CiAgfTt9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0MygpIHt0aGlzLl9zZXRSZXN1bHQgPSAoc3RhdGUsIHZhbHVlKSA9PiB7CiAgICBpZiAodGhpcy5fc3RhdGUgIT09IFN0YXRlcy5QRU5ESU5HKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBpZiAoaXNUaGVuYWJsZSh2YWx1ZSkpIHsKICAgICAgdm9pZCAodmFsdWUgKS50aGVuKHRoaXMuX3Jlc29sdmUsIHRoaXMuX3JlamVjdCk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0aGlzLl9zdGF0ZSA9IHN0YXRlOwogICAgdGhpcy5fdmFsdWUgPSB2YWx1ZTsKCiAgICB0aGlzLl9leGVjdXRlSGFuZGxlcnMoKTsKICB9O30KCiAgLyoqIEpTRG9jICovCiAgICBfX2luaXQ0KCkge3RoaXMuX2V4ZWN1dGVIYW5kbGVycyA9ICgpID0+IHsKICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gU3RhdGVzLlBFTkRJTkcpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIGNvbnN0IGNhY2hlZEhhbmRsZXJzID0gdGhpcy5faGFuZGxlcnMuc2xpY2UoKTsKICAgIHRoaXMuX2hhbmRsZXJzID0gW107CgogICAgY2FjaGVkSGFuZGxlcnMuZm9yRWFjaChoYW5kbGVyID0+IHsKICAgICAgaWYgKGhhbmRsZXJbMF0pIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gU3RhdGVzLlJFU09MVkVEKSB7CiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1mbG9hdGluZy1wcm9taXNlcwogICAgICAgIGhhbmRsZXJbMV0odGhpcy5fdmFsdWUgKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuX3N0YXRlID09PSBTdGF0ZXMuUkVKRUNURUQpIHsKICAgICAgICBoYW5kbGVyWzJdKHRoaXMuX3ZhbHVlKTsKICAgICAgfQoKICAgICAgaGFuZGxlclswXSA9IHRydWU7CiAgICB9KTsKICB9O30KfQoKLyoqCiAqIENyZWF0ZXMgYW4gbmV3IFByb21pc2VCdWZmZXIgb2JqZWN0IHdpdGggdGhlIHNwZWNpZmllZCBsaW1pdAogKiBAcGFyYW0gbGltaXQgbWF4IG51bWJlciBvZiBwcm9taXNlcyB0aGF0IGNhbiBiZSBzdG9yZWQgaW4gdGhlIGJ1ZmZlcgogKi8KZnVuY3Rpb24gbWFrZVByb21pc2VCdWZmZXIobGltaXQpIHsKICBjb25zdCBidWZmZXIgPSBbXTsKCiAgZnVuY3Rpb24gaXNSZWFkeSgpIHsKICAgIHJldHVybiBsaW1pdCA9PT0gdW5kZWZpbmVkIHx8IGJ1ZmZlci5sZW5ndGggPCBsaW1pdDsKICB9CgogIC8qKgogICAqIFJlbW92ZSBhIHByb21pc2UgZnJvbSB0aGUgcXVldWUuCiAgICoKICAgKiBAcGFyYW0gdGFzayBDYW4gYmUgYW55IFByb21pc2VMaWtlPFQ+CiAgICogQHJldHVybnMgUmVtb3ZlZCBwcm9taXNlLgogICAqLwogIGZ1bmN0aW9uIHJlbW92ZSh0YXNrKSB7CiAgICByZXR1cm4gYnVmZmVyLnNwbGljZShidWZmZXIuaW5kZXhPZih0YXNrKSwgMSlbMF07CiAgfQoKICAvKioKICAgKiBBZGQgYSBwcm9taXNlIChyZXByZXNlbnRpbmcgYW4gaW4tZmxpZ2h0IGFjdGlvbikgdG8gdGhlIHF1ZXVlLCBhbmQgc2V0IGl0IHRvIHJlbW92ZSBpdHNlbGYgb24gZnVsZmlsbG1lbnQuCiAgICoKICAgKiBAcGFyYW0gdGFza1Byb2R1Y2VyIEEgZnVuY3Rpb24gcHJvZHVjaW5nIGFueSBQcm9taXNlTGlrZTxUPjsgSW4gcHJldmlvdXMgdmVyc2lvbnMgdGhpcyB1c2VkIHRvIGJlIGB0YXNrOgogICAqICAgICAgICBQcm9taXNlTGlrZTxUPmAsIGJ1dCB1bmRlciB0aGF0IG1vZGVsLCBQcm9taXNlcyB3ZXJlIGluc3RhbnRseSBjcmVhdGVkIG9uIHRoZSBjYWxsLXNpdGUgYW5kIHRoZWlyIGV4ZWN1dG9yCiAgICogICAgICAgIGZ1bmN0aW9ucyB0aGVyZWZvcmUgcmFuIGltbWVkaWF0ZWx5LiBUaHVzLCBldmVuIGlmIHRoZSBidWZmZXIgd2FzIGZ1bGwsIHRoZSBhY3Rpb24gc3RpbGwgaGFwcGVuZWQuIEJ5CiAgICogICAgICAgIHJlcXVpcmluZyB0aGUgcHJvbWlzZSB0byBiZSB3cmFwcGVkIGluIGEgZnVuY3Rpb24sIHdlIGNhbiBkZWZlciBwcm9taXNlIGNyZWF0aW9uIHVudGlsIGFmdGVyIHRoZSBidWZmZXIKICAgKiAgICAgICAgbGltaXQgY2hlY2suCiAgICogQHJldHVybnMgVGhlIG9yaWdpbmFsIHByb21pc2UuCiAgICovCiAgZnVuY3Rpb24gYWRkKHRhc2tQcm9kdWNlcikgewogICAgaWYgKCFpc1JlYWR5KCkpIHsKICAgICAgcmV0dXJuIHJlamVjdGVkU3luY1Byb21pc2UobmV3IFNlbnRyeUVycm9yKCdOb3QgYWRkaW5nIFByb21pc2UgYmVjYXVzZSBidWZmZXIgbGltaXQgd2FzIHJlYWNoZWQuJykpOwogICAgfQoKICAgIC8vIHN0YXJ0IHRoZSB0YXNrIGFuZCBhZGQgaXRzIHByb21pc2UgdG8gdGhlIHF1ZXVlCiAgICBjb25zdCB0YXNrID0gdGFza1Byb2R1Y2VyKCk7CiAgICBpZiAoYnVmZmVyLmluZGV4T2YodGFzaykgPT09IC0xKSB7CiAgICAgIGJ1ZmZlci5wdXNoKHRhc2spOwogICAgfQogICAgdm9pZCB0YXNrCiAgICAgIC50aGVuKCgpID0+IHJlbW92ZSh0YXNrKSkKICAgICAgLy8gVXNlIGB0aGVuKG51bGwsIHJlamVjdGlvbkhhbmRsZXIpYCByYXRoZXIgdGhhbiBgY2F0Y2gocmVqZWN0aW9uSGFuZGxlcilgIHNvIHRoYXQgd2UgY2FuIHVzZSBgUHJvbWlzZUxpa2VgCiAgICAgIC8vIHJhdGhlciB0aGFuIGBQcm9taXNlYC4gYFByb21pc2VMaWtlYCBkb2Vzbid0IGhhdmUgYSBgLmNhdGNoYCBtZXRob2QsIG1ha2luZyBpdHMgcG9seWZpbGwgc21hbGxlci4gKEVTNSBkaWRuJ3QKICAgICAgLy8gaGF2ZSBwcm9taXNlcywgc28gVFMgaGFzIHRvIHBvbHlmaWxsIHdoZW4gZG93bi1jb21waWxpbmcuKQogICAgICAudGhlbihudWxsLCAoKSA9PgogICAgICAgIHJlbW92ZSh0YXNrKS50aGVuKG51bGwsICgpID0+IHsKICAgICAgICAgIC8vIFdlIGhhdmUgdG8gYWRkIGFub3RoZXIgY2F0Y2ggaGVyZSBiZWNhdXNlIGByZW1vdmUoKWAgc3RhcnRzIGEgbmV3IHByb21pc2UgY2hhaW4uCiAgICAgICAgfSksCiAgICAgICk7CiAgICByZXR1cm4gdGFzazsKICB9CgogIC8qKgogICAqIFdhaXQgZm9yIGFsbCBwcm9taXNlcyBpbiB0aGUgcXVldWUgdG8gcmVzb2x2ZSBvciBmb3IgdGltZW91dCB0byBleHBpcmUsIHdoaWNoZXZlciBjb21lcyBmaXJzdC4KICAgKgogICAqIEBwYXJhbSB0aW1lb3V0IFRoZSB0aW1lLCBpbiBtcywgYWZ0ZXIgd2hpY2ggdG8gcmVzb2x2ZSB0byBgZmFsc2VgIGlmIHRoZSBxdWV1ZSBpcyBzdGlsbCBub24tZW1wdHkuIFBhc3NpbmcgYDBgIChvcgogICAqIG5vdCBwYXNzaW5nIGFueXRoaW5nKSB3aWxsIG1ha2UgdGhlIHByb21pc2Ugd2FpdCBhcyBsb25nIGFzIGl0IHRha2VzIGZvciB0aGUgcXVldWUgdG8gZHJhaW4gYmVmb3JlIHJlc29sdmluZyB0bwogICAqIGB0cnVlYC4KICAgKiBAcmV0dXJucyBBIHByb21pc2Ugd2hpY2ggd2lsbCByZXNvbHZlIHRvIGB0cnVlYCBpZiB0aGUgcXVldWUgaXMgYWxyZWFkeSBlbXB0eSBvciBkcmFpbnMgYmVmb3JlIHRoZSB0aW1lb3V0LCBhbmQKICAgKiBgZmFsc2VgIG90aGVyd2lzZQogICAqLwogIGZ1bmN0aW9uIGRyYWluKHRpbWVvdXQpIHsKICAgIHJldHVybiBuZXcgU3luY1Byb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBsZXQgY291bnRlciA9IGJ1ZmZlci5sZW5ndGg7CgogICAgICBpZiAoIWNvdW50ZXIpIHsKICAgICAgICByZXR1cm4gcmVzb2x2ZSh0cnVlKTsKICAgICAgfQoKICAgICAgLy8gd2FpdCBmb3IgYHRpbWVvdXRgIG1zIGFuZCB0aGVuIHJlc29sdmUgdG8gYGZhbHNlYCAoaWYgbm90IGNhbmNlbGxlZCBmaXJzdCkKICAgICAgY29uc3QgY2FwdHVyZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgaWYgKHRpbWVvdXQgJiYgdGltZW91dCA+IDApIHsKICAgICAgICAgIHJlc29sdmUoZmFsc2UpOwogICAgICAgIH0KICAgICAgfSwgdGltZW91dCk7CgogICAgICAvLyBpZiBhbGwgcHJvbWlzZXMgcmVzb2x2ZSBpbiB0aW1lLCBjYW5jZWwgdGhlIHRpbWVyIGFuZCByZXNvbHZlIHRvIGB0cnVlYAogICAgICBidWZmZXIuZm9yRWFjaChpdGVtID0+IHsKICAgICAgICB2b2lkIHJlc29sdmVkU3luY1Byb21pc2UoaXRlbSkudGhlbigoKSA9PiB7CiAgICAgICAgICBpZiAoIS0tY291bnRlcikgewogICAgICAgICAgICBjbGVhclRpbWVvdXQoY2FwdHVyZWRTZXRUaW1lb3V0KTsKICAgICAgICAgICAgcmVzb2x2ZSh0cnVlKTsKICAgICAgICAgIH0KICAgICAgICB9LCByZWplY3QpOwogICAgICB9KTsKICAgIH0pOwogIH0KCiAgcmV0dXJuIHsKICAgICQ6IGJ1ZmZlciwKICAgIGFkZCwKICAgIGRyYWluLAogIH07Cn0KCmNvbnN0IE9ORV9TRUNPTkRfSU5fTVMgPSAxMDAwOwoKLyoqCiAqIEEgcGFydGlhbCBkZWZpbml0aW9uIG9mIHRoZSBbUGVyZm9ybWFuY2UgV2ViIEFQSV17QGxpbmsgaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQVBJL1BlcmZvcm1hbmNlfQogKiBmb3IgYWNjZXNzaW5nIGEgaGlnaC1yZXNvbHV0aW9uIG1vbm90b25pYyBjbG9jay4KICovCgovKioKICogUmV0dXJucyBhIHRpbWVzdGFtcCBpbiBzZWNvbmRzIHNpbmNlIHRoZSBVTklYIGVwb2NoIHVzaW5nIHRoZSBEYXRlIEFQSS4KICoKICogVE9ETyh2OCk6IFJldHVybiB0eXBlIHNob3VsZCBiZSByb3VuZGVkLgogKi8KZnVuY3Rpb24gZGF0ZVRpbWVzdGFtcEluU2Vjb25kcygpIHsKICByZXR1cm4gRGF0ZS5ub3coKSAvIE9ORV9TRUNPTkRfSU5fTVM7Cn0KCi8qKgogKiBSZXR1cm5zIGEgd3JhcHBlciBhcm91bmQgdGhlIG5hdGl2ZSBQZXJmb3JtYW5jZSBBUEkgYnJvd3NlciBpbXBsZW1lbnRhdGlvbiwgb3IgdW5kZWZpbmVkIGZvciBicm93c2VycyB0aGF0IGRvIG5vdAogKiBzdXBwb3J0IHRoZSBBUEkuCiAqCiAqIFdyYXBwaW5nIHRoZSBuYXRpdmUgQVBJIHdvcmtzIGFyb3VuZCBkaWZmZXJlbmNlcyBpbiBiZWhhdmlvciBmcm9tIGRpZmZlcmVudCBicm93c2Vycy4KICovCmZ1bmN0aW9uIGNyZWF0ZVVuaXhUaW1lc3RhbXBJblNlY29uZHNGdW5jKCkgewogIGNvbnN0IHsgcGVyZm9ybWFuY2UgfSA9IEdMT0JBTF9PQkogOwogIGlmICghcGVyZm9ybWFuY2UgfHwgIXBlcmZvcm1hbmNlLm5vdykgewogICAgcmV0dXJuIGRhdGVUaW1lc3RhbXBJblNlY29uZHM7CiAgfQoKICAvLyBTb21lIGJyb3dzZXIgYW5kIGVudmlyb25tZW50cyBkb24ndCBoYXZlIGEgdGltZU9yaWdpbiwgc28gd2UgZmFsbGJhY2sgdG8KICAvLyB1c2luZyBEYXRlLm5vdygpIHRvIGNvbXB1dGUgdGhlIHN0YXJ0aW5nIHRpbWUuCiAgY29uc3QgYXBwcm94U3RhcnRpbmdUaW1lT3JpZ2luID0gRGF0ZS5ub3coKSAtIHBlcmZvcm1hbmNlLm5vdygpOwogIGNvbnN0IHRpbWVPcmlnaW4gPSBwZXJmb3JtYW5jZS50aW1lT3JpZ2luID09IHVuZGVmaW5lZCA/IGFwcHJveFN0YXJ0aW5nVGltZU9yaWdpbiA6IHBlcmZvcm1hbmNlLnRpbWVPcmlnaW47CgogIC8vIHBlcmZvcm1hbmNlLm5vdygpIGlzIGEgbW9ub3RvbmljIGNsb2NrLCB3aGljaCBtZWFucyBpdCBzdGFydHMgYXQgMCB3aGVuIHRoZSBwcm9jZXNzIGJlZ2lucy4gVG8gZ2V0IHRoZSBjdXJyZW50CiAgLy8gd2FsbCBjbG9jayB0aW1lIChhY3R1YWwgVU5JWCB0aW1lc3RhbXApLCB3ZSBuZWVkIHRvIGFkZCB0aGUgc3RhcnRpbmcgdGltZSBvcmlnaW4gYW5kIHRoZSBjdXJyZW50IHRpbWUgZWxhcHNlZC4KICAvLwogIC8vIFRPRE86IFRoaXMgZG9lcyBub3QgYWNjb3VudCBmb3IgdGhlIGNhc2Ugd2hlcmUgdGhlIG1vbm90b25pYyBjbG9jayB0aGF0IHBvd2VycyBwZXJmb3JtYW5jZS5ub3coKSBkcmlmdHMgZnJvbSB0aGUKICAvLyB3YWxsIGNsb2NrIHRpbWUsIHdoaWNoIGNhdXNlcyB0aGUgcmV0dXJuZWQgdGltZXN0YW1wIHRvIGJlIGluYWNjdXJhdGUuIFdlIHNob3VsZCBpbnZlc3RpZ2F0ZSBob3cgdG8gZGV0ZWN0IGFuZAogIC8vIGNvcnJlY3QgZm9yIHRoaXMuCiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy8yNTkwCiAgLy8gU2VlOiBodHRwczovL2dpdGh1Yi5jb20vbWRuL2NvbnRlbnQvaXNzdWVzLzQ3MTMKICAvLyBTZWU6IGh0dHBzOi8vZGV2LnRvL25vYW1yL3doZW4tYS1taWxsaXNlY29uZC1pcy1ub3QtYS1taWxsaXNlY29uZC0zaDYKICByZXR1cm4gKCkgPT4gewogICAgcmV0dXJuICh0aW1lT3JpZ2luICsgcGVyZm9ybWFuY2Uubm93KCkpIC8gT05FX1NFQ09ORF9JTl9NUzsKICB9Owp9CgovKioKICogUmV0dXJucyBhIHRpbWVzdGFtcCBpbiBzZWNvbmRzIHNpbmNlIHRoZSBVTklYIGVwb2NoIHVzaW5nIGVpdGhlciB0aGUgUGVyZm9ybWFuY2Ugb3IgRGF0ZSBBUElzLCBkZXBlbmRpbmcgb24gdGhlCiAqIGF2YWlsYWJpbGl0eSBvZiB0aGUgUGVyZm9ybWFuY2UgQVBJLgogKgogKiBCVUc6IE5vdGUgdGhhdCBiZWNhdXNlIG9mIGhvdyBicm93c2VycyBpbXBsZW1lbnQgdGhlIFBlcmZvcm1hbmNlIEFQSSwgdGhlIGNsb2NrIG1pZ2h0IHN0b3Agd2hlbiB0aGUgY29tcHV0ZXIgaXMKICogYXNsZWVwLiBUaGlzIGNyZWF0ZXMgYSBza2V3IGJldHdlZW4gYGRhdGVUaW1lc3RhbXBJblNlY29uZHNgIGFuZCBgdGltZXN0YW1wSW5TZWNvbmRzYC4gVGhlCiAqIHNrZXcgY2FuIGdyb3cgdG8gYXJiaXRyYXJ5IGFtb3VudHMgbGlrZSBkYXlzLCB3ZWVrcyBvciBtb250aHMuCiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L2lzc3Vlcy8yNTkwLgogKi8KY29uc3QgdGltZXN0YW1wSW5TZWNvbmRzID0gY3JlYXRlVW5peFRpbWVzdGFtcEluU2Vjb25kc0Z1bmMoKTsKCi8qKgogKiBUaGUgbnVtYmVyIG9mIG1pbGxpc2Vjb25kcyBzaW5jZSB0aGUgVU5JWCBlcG9jaC4gVGhpcyB2YWx1ZSBpcyBvbmx5IHVzYWJsZSBpbiBhIGJyb3dzZXIsIGFuZCBvbmx5IHdoZW4gdGhlCiAqIHBlcmZvcm1hbmNlIEFQSSBpcyBhdmFpbGFibGUuCiAqLwooKCkgPT4gewogIC8vIFVuZm9ydHVuYXRlbHkgYnJvd3NlcnMgbWF5IHJlcG9ydCBhbiBpbmFjY3VyYXRlIHRpbWUgb3JpZ2luIGRhdGEsIHRocm91Z2ggZWl0aGVyIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4gb3IKICAvLyBwZXJmb3JtYW5jZS50aW1pbmcubmF2aWdhdGlvblN0YXJ0LCB3aGljaCByZXN1bHRzIGluIHBvb3IgcmVzdWx0cyBpbiBwZXJmb3JtYW5jZSBkYXRhLiBXZSBvbmx5IHRyZWF0IHRpbWUgb3JpZ2luCiAgLy8gZGF0YSBhcyByZWxpYWJsZSBpZiB0aGV5IGFyZSB3aXRoaW4gYSByZWFzb25hYmxlIHRocmVzaG9sZCBvZiB0aGUgY3VycmVudCB0aW1lLgoKICBjb25zdCB7IHBlcmZvcm1hbmNlIH0gPSBHTE9CQUxfT0JKIDsKICBpZiAoIXBlcmZvcm1hbmNlIHx8ICFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICBjb25zdCB0aHJlc2hvbGQgPSAzNjAwICogMTAwMDsKICBjb25zdCBwZXJmb3JtYW5jZU5vdyA9IHBlcmZvcm1hbmNlLm5vdygpOwogIGNvbnN0IGRhdGVOb3cgPSBEYXRlLm5vdygpOwoKICAvLyBpZiB0aW1lT3JpZ2luIGlzbid0IGF2YWlsYWJsZSBzZXQgZGVsdGEgdG8gdGhyZXNob2xkIHNvIGl0IGlzbid0IHVzZWQKICBjb25zdCB0aW1lT3JpZ2luRGVsdGEgPSBwZXJmb3JtYW5jZS50aW1lT3JpZ2luCiAgICA/IE1hdGguYWJzKHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4gKyBwZXJmb3JtYW5jZU5vdyAtIGRhdGVOb3cpCiAgICA6IHRocmVzaG9sZDsKICBjb25zdCB0aW1lT3JpZ2luSXNSZWxpYWJsZSA9IHRpbWVPcmlnaW5EZWx0YSA8IHRocmVzaG9sZDsKCiAgLy8gV2hpbGUgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCBpcyBkZXByZWNhdGVkIGluIGZhdm9yIG9mIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4sIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW4KICAvLyBpcyBub3QgYXMgd2lkZWx5IHN1cHBvcnRlZC4gTmFtZWx5LCBwZXJmb3JtYW5jZS50aW1lT3JpZ2luIGlzIHVuZGVmaW5lZCBpbiBTYWZhcmkgYXMgb2Ygd3JpdGluZy4KICAvLyBBbHNvIGFzIG9mIHdyaXRpbmcsIHBlcmZvcm1hbmNlLnRpbWluZyBpcyBub3QgYXZhaWxhYmxlIGluIFdlYiBXb3JrZXJzIGluIG1haW5zdHJlYW0gYnJvd3NlcnMsIHNvIGl0IGlzIG5vdCBhbHdheXMKICAvLyBhIHZhbGlkIGZhbGxiYWNrLiBJbiB0aGUgYWJzZW5jZSBvZiBhbiBpbml0aWFsIHRpbWUgcHJvdmlkZWQgYnkgdGhlIGJyb3dzZXIsIGZhbGxiYWNrIHRvIHRoZSBjdXJyZW50IHRpbWUgZnJvbSB0aGUKICAvLyBEYXRlIEFQSS4KICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICBjb25zdCBuYXZpZ2F0aW9uU3RhcnQgPSBwZXJmb3JtYW5jZS50aW1pbmcgJiYgcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydDsKICBjb25zdCBoYXNOYXZpZ2F0aW9uU3RhcnQgPSB0eXBlb2YgbmF2aWdhdGlvblN0YXJ0ID09PSAnbnVtYmVyJzsKICAvLyBpZiBuYXZpZ2F0aW9uU3RhcnQgaXNuJ3QgYXZhaWxhYmxlIHNldCBkZWx0YSB0byB0aHJlc2hvbGQgc28gaXQgaXNuJ3QgdXNlZAogIGNvbnN0IG5hdmlnYXRpb25TdGFydERlbHRhID0gaGFzTmF2aWdhdGlvblN0YXJ0ID8gTWF0aC5hYnMobmF2aWdhdGlvblN0YXJ0ICsgcGVyZm9ybWFuY2VOb3cgLSBkYXRlTm93KSA6IHRocmVzaG9sZDsKICBjb25zdCBuYXZpZ2F0aW9uU3RhcnRJc1JlbGlhYmxlID0gbmF2aWdhdGlvblN0YXJ0RGVsdGEgPCB0aHJlc2hvbGQ7CgogIGlmICh0aW1lT3JpZ2luSXNSZWxpYWJsZSB8fCBuYXZpZ2F0aW9uU3RhcnRJc1JlbGlhYmxlKSB7CiAgICAvLyBVc2UgdGhlIG1vcmUgcmVsaWFibGUgdGltZSBvcmlnaW4KICAgIGlmICh0aW1lT3JpZ2luRGVsdGEgPD0gbmF2aWdhdGlvblN0YXJ0RGVsdGEpIHsKICAgICAgcmV0dXJuIHBlcmZvcm1hbmNlLnRpbWVPcmlnaW47CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gbmF2aWdhdGlvblN0YXJ0OwogICAgfQogIH0KICByZXR1cm4gZGF0ZU5vdzsKfSkoKTsKCi8qKgogKiBDcmVhdGVzIGFuIGVudmVsb3BlLgogKiBNYWtlIHN1cmUgdG8gYWx3YXlzIGV4cGxpY2l0bHkgcHJvdmlkZSB0aGUgZ2VuZXJpYyB0byB0aGlzIGZ1bmN0aW9uCiAqIHNvIHRoYXQgdGhlIGVudmVsb3BlIHR5cGVzIHJlc29sdmUgY29ycmVjdGx5LgogKi8KZnVuY3Rpb24gY3JlYXRlRW52ZWxvcGUoaGVhZGVycywgaXRlbXMgPSBbXSkgewogIHJldHVybiBbaGVhZGVycywgaXRlbXNdIDsKfQoKLyoqCiAqIENvbnZlbmllbmNlIGZ1bmN0aW9uIHRvIGxvb3AgdGhyb3VnaCB0aGUgaXRlbXMgYW5kIGl0ZW0gdHlwZXMgb2YgYW4gZW52ZWxvcGUuCiAqIChUaGlzIGZ1bmN0aW9uIHdhcyBtb3N0bHkgY3JlYXRlZCBiZWNhdXNlIHdvcmtpbmcgd2l0aCBlbnZlbG9wZSB0eXBlcyBpcyBwYWluZnVsIGF0IHRoZSBtb21lbnQpCiAqCiAqIElmIHRoZSBjYWxsYmFjayByZXR1cm5zIHRydWUsIHRoZSByZXN0IG9mIHRoZSBpdGVtcyB3aWxsIGJlIHNraXBwZWQuCiAqLwpmdW5jdGlvbiBmb3JFYWNoRW52ZWxvcGVJdGVtKAogIGVudmVsb3BlLAogIGNhbGxiYWNrLAopIHsKICBjb25zdCBlbnZlbG9wZUl0ZW1zID0gZW52ZWxvcGVbMV07CgogIGZvciAoY29uc3QgZW52ZWxvcGVJdGVtIG9mIGVudmVsb3BlSXRlbXMpIHsKICAgIGNvbnN0IGVudmVsb3BlSXRlbVR5cGUgPSBlbnZlbG9wZUl0ZW1bMF0udHlwZTsKICAgIGNvbnN0IHJlc3VsdCA9IGNhbGxiYWNrKGVudmVsb3BlSXRlbSwgZW52ZWxvcGVJdGVtVHlwZSk7CgogICAgaWYgKHJlc3VsdCkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9CgogIHJldHVybiBmYWxzZTsKfQoKLyoqCiAqIEVuY29kZSBhIHN0cmluZyB0byBVVEY4LgogKi8KZnVuY3Rpb24gZW5jb2RlVVRGOChpbnB1dCwgdGV4dEVuY29kZXIpIHsKICBjb25zdCB1dGY4ID0gdGV4dEVuY29kZXIgfHwgbmV3IFRleHRFbmNvZGVyKCk7CiAgcmV0dXJuIHV0ZjguZW5jb2RlKGlucHV0KTsKfQoKLyoqCiAqIFNlcmlhbGl6ZXMgYW4gZW52ZWxvcGUuCiAqLwpmdW5jdGlvbiBzZXJpYWxpemVFbnZlbG9wZShlbnZlbG9wZSwgdGV4dEVuY29kZXIpIHsKICBjb25zdCBbZW52SGVhZGVycywgaXRlbXNdID0gZW52ZWxvcGU7CgogIC8vIEluaXRpYWxseSB3ZSBjb25zdHJ1Y3Qgb3VyIGVudmVsb3BlIGFzIGEgc3RyaW5nIGFuZCBvbmx5IGNvbnZlcnQgdG8gYmluYXJ5IGNodW5rcyBpZiB3ZSBlbmNvdW50ZXIgYmluYXJ5IGRhdGEKICBsZXQgcGFydHMgPSBKU09OLnN0cmluZ2lmeShlbnZIZWFkZXJzKTsKCiAgZnVuY3Rpb24gYXBwZW5kKG5leHQpIHsKICAgIGlmICh0eXBlb2YgcGFydHMgPT09ICdzdHJpbmcnKSB7CiAgICAgIHBhcnRzID0gdHlwZW9mIG5leHQgPT09ICdzdHJpbmcnID8gcGFydHMgKyBuZXh0IDogW2VuY29kZVVURjgocGFydHMsIHRleHRFbmNvZGVyKSwgbmV4dF07CiAgICB9IGVsc2UgewogICAgICBwYXJ0cy5wdXNoKHR5cGVvZiBuZXh0ID09PSAnc3RyaW5nJyA/IGVuY29kZVVURjgobmV4dCwgdGV4dEVuY29kZXIpIDogbmV4dCk7CiAgICB9CiAgfQoKICBmb3IgKGNvbnN0IGl0ZW0gb2YgaXRlbXMpIHsKICAgIGNvbnN0IFtpdGVtSGVhZGVycywgcGF5bG9hZF0gPSBpdGVtOwoKICAgIGFwcGVuZChgXG4ke0pTT04uc3RyaW5naWZ5KGl0ZW1IZWFkZXJzKX1cbmApOwoKICAgIGlmICh0eXBlb2YgcGF5bG9hZCA9PT0gJ3N0cmluZycgfHwgcGF5bG9hZCBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpIHsKICAgICAgYXBwZW5kKHBheWxvYWQpOwogICAgfSBlbHNlIHsKICAgICAgbGV0IHN0cmluZ2lmaWVkUGF5bG9hZDsKICAgICAgdHJ5IHsKICAgICAgICBzdHJpbmdpZmllZFBheWxvYWQgPSBKU09OLnN0cmluZ2lmeShwYXlsb2FkKTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIC8vIEluIGNhc2UsIGRlc3BpdGUgYWxsIG91ciBlZmZvcnRzIHRvIGtlZXAgYHBheWxvYWRgIGNpcmN1bGFyLWRlcGVuZGVuY3ktZnJlZSwgYEpTT04uc3RyaW5pZnkoKWAgc3RpbGwKICAgICAgICAvLyBmYWlscywgd2UgdHJ5IGFnYWluIGFmdGVyIG5vcm1hbGl6aW5nIGl0IGFnYWluIHdpdGggaW5maW5pdGUgbm9ybWFsaXphdGlvbiBkZXB0aC4gVGhpcyBvZiBjb3Vyc2UgaGFzIGEKICAgICAgICAvLyBwZXJmb3JtYW5jZSBpbXBhY3QgYnV0IGluIHRoaXMgY2FzZSBhIHBlcmZvcm1hbmNlIGhpdCBpcyBiZXR0ZXIgdGhhbiB0aHJvd2luZy4KICAgICAgICBzdHJpbmdpZmllZFBheWxvYWQgPSBKU09OLnN0cmluZ2lmeShub3JtYWxpemUocGF5bG9hZCkpOwogICAgICB9CiAgICAgIGFwcGVuZChzdHJpbmdpZmllZFBheWxvYWQpOwogICAgfQogIH0KCiAgcmV0dXJuIHR5cGVvZiBwYXJ0cyA9PT0gJ3N0cmluZycgPyBwYXJ0cyA6IGNvbmNhdEJ1ZmZlcnMocGFydHMpOwp9CgpmdW5jdGlvbiBjb25jYXRCdWZmZXJzKGJ1ZmZlcnMpIHsKICBjb25zdCB0b3RhbExlbmd0aCA9IGJ1ZmZlcnMucmVkdWNlKChhY2MsIGJ1ZikgPT4gYWNjICsgYnVmLmxlbmd0aCwgMCk7CgogIGNvbnN0IG1lcmdlZCA9IG5ldyBVaW50OEFycmF5KHRvdGFsTGVuZ3RoKTsKICBsZXQgb2Zmc2V0ID0gMDsKICBmb3IgKGNvbnN0IGJ1ZmZlciBvZiBidWZmZXJzKSB7CiAgICBtZXJnZWQuc2V0KGJ1ZmZlciwgb2Zmc2V0KTsKICAgIG9mZnNldCArPSBidWZmZXIubGVuZ3RoOwogIH0KCiAgcmV0dXJuIG1lcmdlZDsKfQoKY29uc3QgSVRFTV9UWVBFX1RPX0RBVEFfQ0FURUdPUllfTUFQID0gewogIHNlc3Npb246ICdzZXNzaW9uJywKICBzZXNzaW9uczogJ3Nlc3Npb24nLAogIGF0dGFjaG1lbnQ6ICdhdHRhY2htZW50JywKICB0cmFuc2FjdGlvbjogJ3RyYW5zYWN0aW9uJywKICBldmVudDogJ2Vycm9yJywKICBjbGllbnRfcmVwb3J0OiAnaW50ZXJuYWwnLAogIHVzZXJfcmVwb3J0OiAnZGVmYXVsdCcsCiAgcHJvZmlsZTogJ3Byb2ZpbGUnLAogIHJlcGxheV9ldmVudDogJ3JlcGxheScsCiAgcmVwbGF5X3JlY29yZGluZzogJ3JlcGxheScsCiAgY2hlY2tfaW46ICdtb25pdG9yJywKICBmZWVkYmFjazogJ2ZlZWRiYWNrJywKICBzcGFuOiAnc3BhbicsCiAgc3RhdHNkOiAnbWV0cmljX2J1Y2tldCcsCn07CgovKioKICogTWFwcyB0aGUgdHlwZSBvZiBhbiBlbnZlbG9wZSBpdGVtIHRvIGEgZGF0YSBjYXRlZ29yeS4KICovCmZ1bmN0aW9uIGVudmVsb3BlSXRlbVR5cGVUb0RhdGFDYXRlZ29yeSh0eXBlKSB7CiAgcmV0dXJuIElURU1fVFlQRV9UT19EQVRBX0NBVEVHT1JZX01BUFt0eXBlXTsKfQoKLyoqIEV4dHJhY3RzIHRoZSBtaW5pbWFsIFNESyBpbmZvIGZyb20gdGhlIG1ldGFkYXRhIG9yIGFuIGV2ZW50cyAqLwpmdW5jdGlvbiBnZXRTZGtNZXRhZGF0YUZvckVudmVsb3BlSGVhZGVyKG1ldGFkYXRhT3JFdmVudCkgewogIGlmICghbWV0YWRhdGFPckV2ZW50IHx8ICFtZXRhZGF0YU9yRXZlbnQuc2RrKSB7CiAgICByZXR1cm47CiAgfQogIGNvbnN0IHsgbmFtZSwgdmVyc2lvbiB9ID0gbWV0YWRhdGFPckV2ZW50LnNkazsKICByZXR1cm4geyBuYW1lLCB2ZXJzaW9uIH07Cn0KCi8qKgogKiBDcmVhdGVzIGV2ZW50IGVudmVsb3BlIGhlYWRlcnMsIGJhc2VkIG9uIGV2ZW50LCBzZGsgaW5mbyBhbmQgdHVubmVsCiAqIE5vdGU6IFRoaXMgZnVuY3Rpb24gd2FzIGV4dHJhY3RlZCBmcm9tIHRoZSBjb3JlIHBhY2thZ2UgdG8gbWFrZSBpdCBhdmFpbGFibGUgaW4gUmVwbGF5CiAqLwpmdW5jdGlvbiBjcmVhdGVFdmVudEVudmVsb3BlSGVhZGVycygKICBldmVudCwKICBzZGtJbmZvLAogIHR1bm5lbCwKICBkc24sCikgewogIGNvbnN0IGR5bmFtaWNTYW1wbGluZ0NvbnRleHQgPSBldmVudC5zZGtQcm9jZXNzaW5nTWV0YWRhdGEgJiYgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhLmR5bmFtaWNTYW1wbGluZ0NvbnRleHQ7CiAgcmV0dXJuIHsKICAgIGV2ZW50X2lkOiBldmVudC5ldmVudF9pZCAsCiAgICBzZW50X2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksCiAgICAuLi4oc2RrSW5mbyAmJiB7IHNkazogc2RrSW5mbyB9KSwKICAgIC4uLighIXR1bm5lbCAmJiBkc24gJiYgeyBkc246IGRzblRvU3RyaW5nKGRzbikgfSksCiAgICAuLi4oZHluYW1pY1NhbXBsaW5nQ29udGV4dCAmJiB7CiAgICAgIHRyYWNlOiBkcm9wVW5kZWZpbmVkS2V5cyh7IC4uLmR5bmFtaWNTYW1wbGluZ0NvbnRleHQgfSksCiAgICB9KSwKICB9Owp9CgovLyBJbnRlbnRpb25hbGx5IGtlZXBpbmcgdGhlIGtleSBicm9hZCwgYXMgd2UgZG9uJ3Qga25vdyBmb3Igc3VyZSB3aGF0IHJhdGUgbGltaXQgaGVhZGVycyBnZXQgcmV0dXJuZWQgZnJvbSBiYWNrZW5kCgpjb25zdCBERUZBVUxUX1JFVFJZX0FGVEVSID0gNjAgKiAxMDAwOyAvLyA2MCBzZWNvbmRzCgovKioKICogRXh0cmFjdHMgUmV0cnktQWZ0ZXIgdmFsdWUgZnJvbSB0aGUgcmVxdWVzdCBoZWFkZXIgb3IgcmV0dXJucyBkZWZhdWx0IHZhbHVlCiAqIEBwYXJhbSBoZWFkZXIgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mICdSZXRyeS1BZnRlcicgaGVhZGVyCiAqIEBwYXJhbSBub3cgY3VycmVudCB1bml4IHRpbWVzdGFtcAogKgogKi8KZnVuY3Rpb24gcGFyc2VSZXRyeUFmdGVySGVhZGVyKGhlYWRlciwgbm93ID0gRGF0ZS5ub3coKSkgewogIGNvbnN0IGhlYWRlckRlbGF5ID0gcGFyc2VJbnQoYCR7aGVhZGVyfWAsIDEwKTsKICBpZiAoIWlzTmFOKGhlYWRlckRlbGF5KSkgewogICAgcmV0dXJuIGhlYWRlckRlbGF5ICogMTAwMDsKICB9CgogIGNvbnN0IGhlYWRlckRhdGUgPSBEYXRlLnBhcnNlKGAke2hlYWRlcn1gKTsKICBpZiAoIWlzTmFOKGhlYWRlckRhdGUpKSB7CiAgICByZXR1cm4gaGVhZGVyRGF0ZSAtIG5vdzsKICB9CgogIHJldHVybiBERUZBVUxUX1JFVFJZX0FGVEVSOwp9CgovKioKICogR2V0cyB0aGUgdGltZSB0aGF0IHRoZSBnaXZlbiBjYXRlZ29yeSBpcyBkaXNhYmxlZCB1bnRpbCBmb3IgcmF0ZSBsaW1pdGluZy4KICogSW4gY2FzZSBubyBjYXRlZ29yeS1zcGVjaWZpYyBsaW1pdCBpcyBzZXQgYnV0IGEgZ2VuZXJhbCByYXRlIGxpbWl0IGFjcm9zcyBhbGwgY2F0ZWdvcmllcyBpcyBhY3RpdmUsCiAqIHRoYXQgdGltZSBpcyByZXR1cm5lZC4KICoKICogQHJldHVybiB0aGUgdGltZSBpbiBtcyB0aGF0IHRoZSBjYXRlZ29yeSBpcyBkaXNhYmxlZCB1bnRpbCBvciAwIGlmIHRoZXJlJ3Mgbm8gYWN0aXZlIHJhdGUgbGltaXQuCiAqLwpmdW5jdGlvbiBkaXNhYmxlZFVudGlsKGxpbWl0cywgZGF0YUNhdGVnb3J5KSB7CiAgcmV0dXJuIGxpbWl0c1tkYXRhQ2F0ZWdvcnldIHx8IGxpbWl0cy5hbGwgfHwgMDsKfQoKLyoqCiAqIENoZWNrcyBpZiBhIGNhdGVnb3J5IGlzIHJhdGUgbGltaXRlZAogKi8KZnVuY3Rpb24gaXNSYXRlTGltaXRlZChsaW1pdHMsIGRhdGFDYXRlZ29yeSwgbm93ID0gRGF0ZS5ub3coKSkgewogIHJldHVybiBkaXNhYmxlZFVudGlsKGxpbWl0cywgZGF0YUNhdGVnb3J5KSA+IG5vdzsKfQoKLyoqCiAqIFVwZGF0ZSByYXRlbGltaXRzIGZyb20gaW5jb21pbmcgaGVhZGVycy4KICoKICogQHJldHVybiB0aGUgdXBkYXRlZCBSYXRlTGltaXRzIG9iamVjdC4KICovCmZ1bmN0aW9uIHVwZGF0ZVJhdGVMaW1pdHMoCiAgbGltaXRzLAogIHsgc3RhdHVzQ29kZSwgaGVhZGVycyB9LAogIG5vdyA9IERhdGUubm93KCksCikgewogIGNvbnN0IHVwZGF0ZWRSYXRlTGltaXRzID0gewogICAgLi4ubGltaXRzLAogIH07CgogIC8vICJUaGUgbmFtZSBpcyBjYXNlLWluc2Vuc2l0aXZlLiIKICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSGVhZGVycy9nZXQKICBjb25zdCByYXRlTGltaXRIZWFkZXIgPSBoZWFkZXJzICYmIGhlYWRlcnNbJ3gtc2VudHJ5LXJhdGUtbGltaXRzJ107CiAgY29uc3QgcmV0cnlBZnRlckhlYWRlciA9IGhlYWRlcnMgJiYgaGVhZGVyc1sncmV0cnktYWZ0ZXInXTsKCiAgaWYgKHJhdGVMaW1pdEhlYWRlcikgewogICAgLyoqCiAgICAgKiByYXRlIGxpbWl0IGhlYWRlcnMgYXJlIG9mIHRoZSBmb3JtCiAgICAgKiAgICAgPGhlYWRlcj4sPGhlYWRlcj4sLi4KICAgICAqIHdoZXJlIGVhY2ggPGhlYWRlcj4gaXMgb2YgdGhlIGZvcm0KICAgICAqICAgICA8cmV0cnlfYWZ0ZXI+OiA8Y2F0ZWdvcmllcz46IDxzY29wZT46IDxyZWFzb25fY29kZT46IDxuYW1lc3BhY2VzPgogICAgICogd2hlcmUKICAgICAqICAgICA8cmV0cnlfYWZ0ZXI+IGlzIGEgZGVsYXkgaW4gc2Vjb25kcwogICAgICogICAgIDxjYXRlZ29yaWVzPiBpcyB0aGUgZXZlbnQgdHlwZShzKSAoZXJyb3IsIHRyYW5zYWN0aW9uLCBldGMpIGJlaW5nIHJhdGUgbGltaXRlZCBhbmQgaXMgb2YgdGhlIGZvcm0KICAgICAqICAgICAgICAgPGNhdGVnb3J5Pjs8Y2F0ZWdvcnk+Oy4uLgogICAgICogICAgIDxzY29wZT4gaXMgd2hhdCdzIGJlaW5nIGxpbWl0ZWQgKG9yZywgcHJvamVjdCwgb3Iga2V5KSAtIGlnbm9yZWQgYnkgU0RLCiAgICAgKiAgICAgPHJlYXNvbl9jb2RlPiBpcyBhbiBhcmJpdHJhcnkgc3RyaW5nIGxpa2UgIm9yZ19xdW90YSIgLSBpZ25vcmVkIGJ5IFNESwogICAgICogICAgIDxuYW1lc3BhY2VzPiBTZW1pY29sb24tc2VwYXJhdGVkIGxpc3Qgb2YgbWV0cmljIG5hbWVzcGFjZSBpZGVudGlmaWVycy4gRGVmaW5lcyB3aGljaCBuYW1lc3BhY2Uocykgd2lsbCBiZSBhZmZlY3RlZC4KICAgICAqICAgICAgICAgT25seSBwcmVzZW50IGlmIHJhdGUgbGltaXQgYXBwbGllcyB0byB0aGUgbWV0cmljX2J1Y2tldCBkYXRhIGNhdGVnb3J5LgogICAgICovCiAgICBmb3IgKGNvbnN0IGxpbWl0IG9mIHJhdGVMaW1pdEhlYWRlci50cmltKCkuc3BsaXQoJywnKSkgewogICAgICBjb25zdCBbcmV0cnlBZnRlciwgY2F0ZWdvcmllcywgLCAsIG5hbWVzcGFjZXNdID0gbGltaXQuc3BsaXQoJzonLCA1KTsKICAgICAgY29uc3QgaGVhZGVyRGVsYXkgPSBwYXJzZUludChyZXRyeUFmdGVyLCAxMCk7CiAgICAgIGNvbnN0IGRlbGF5ID0gKCFpc05hTihoZWFkZXJEZWxheSkgPyBoZWFkZXJEZWxheSA6IDYwKSAqIDEwMDA7IC8vIDYwc2VjIGRlZmF1bHQKICAgICAgaWYgKCFjYXRlZ29yaWVzKSB7CiAgICAgICAgdXBkYXRlZFJhdGVMaW1pdHMuYWxsID0gbm93ICsgZGVsYXk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChjb25zdCBjYXRlZ29yeSBvZiBjYXRlZ29yaWVzLnNwbGl0KCc7JykpIHsKICAgICAgICAgIGlmIChjYXRlZ29yeSA9PT0gJ21ldHJpY19idWNrZXQnKSB7CiAgICAgICAgICAgIC8vIG5hbWVzcGFjZXMgd2lsbCBiZSBwcmVzZW50IHdoZW4gY2F0ZWdvcnkgPT09ICdtZXRyaWNfYnVja2V0JwogICAgICAgICAgICBpZiAoIW5hbWVzcGFjZXMgfHwgbmFtZXNwYWNlcy5zcGxpdCgnOycpLmluY2x1ZGVzKCdjdXN0b20nKSkgewogICAgICAgICAgICAgIHVwZGF0ZWRSYXRlTGltaXRzW2NhdGVnb3J5XSA9IG5vdyArIGRlbGF5OwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB1cGRhdGVkUmF0ZUxpbWl0c1tjYXRlZ29yeV0gPSBub3cgKyBkZWxheTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9IGVsc2UgaWYgKHJldHJ5QWZ0ZXJIZWFkZXIpIHsKICAgIHVwZGF0ZWRSYXRlTGltaXRzLmFsbCA9IG5vdyArIHBhcnNlUmV0cnlBZnRlckhlYWRlcihyZXRyeUFmdGVySGVhZGVyLCBub3cpOwogIH0gZWxzZSBpZiAoc3RhdHVzQ29kZSA9PT0gNDI5KSB7CiAgICB1cGRhdGVkUmF0ZUxpbWl0cy5hbGwgPSBub3cgKyA2MCAqIDEwMDA7CiAgfQoKICByZXR1cm4gdXBkYXRlZFJhdGVMaW1pdHM7Cn0KCi8qKgogKiBBIG5vZGUuanMgd2F0Y2hkb2cgdGltZXIKICogQHBhcmFtIHBvbGxJbnRlcnZhbCBUaGUgaW50ZXJ2YWwgdGhhdCB3ZSBleHBlY3QgdG8gZ2V0IHBvbGxlZCBhdAogKiBAcGFyYW0gYW5yVGhyZXNob2xkIFRoZSB0aHJlc2hvbGQgZm9yIHdoZW4gd2UgY29uc2lkZXIgQU5SCiAqIEBwYXJhbSBjYWxsYmFjayBUaGUgY2FsbGJhY2sgdG8gY2FsbCBmb3IgQU5SCiAqIEByZXR1cm5zIEFuIG9iamVjdCB3aXRoIGBwb2xsYCBhbmQgYGVuYWJsZWRgIGZ1bmN0aW9ucyB7QGxpbmsgV2F0Y2hkb2dSZXR1cm59CiAqLwpmdW5jdGlvbiB3YXRjaGRvZ1RpbWVyKAogIGNyZWF0ZVRpbWVyLAogIHBvbGxJbnRlcnZhbCwKICBhbnJUaHJlc2hvbGQsCiAgY2FsbGJhY2ssCikgewogIGNvbnN0IHRpbWVyID0gY3JlYXRlVGltZXIoKTsKICBsZXQgdHJpZ2dlcmVkID0gZmFsc2U7CiAgbGV0IGVuYWJsZWQgPSB0cnVlOwoKICBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgICBjb25zdCBkaWZmTXMgPSB0aW1lci5nZXRUaW1lTXMoKTsKCiAgICBpZiAodHJpZ2dlcmVkID09PSBmYWxzZSAmJiBkaWZmTXMgPiBwb2xsSW50ZXJ2YWwgKyBhbnJUaHJlc2hvbGQpIHsKICAgICAgdHJpZ2dlcmVkID0gdHJ1ZTsKICAgICAgaWYgKGVuYWJsZWQpIHsKICAgICAgICBjYWxsYmFjaygpOwogICAgICB9CiAgICB9CgogICAgaWYgKGRpZmZNcyA8IHBvbGxJbnRlcnZhbCArIGFuclRocmVzaG9sZCkgewogICAgICB0cmlnZ2VyZWQgPSBmYWxzZTsKICAgIH0KICB9LCAyMCk7CgogIHJldHVybiB7CiAgICBwb2xsOiAoKSA9PiB7CiAgICAgIHRpbWVyLnJlc2V0KCk7CiAgICB9LAogICAgZW5hYmxlZDogKHN0YXRlKSA9PiB7CiAgICAgIGVuYWJsZWQgPSBzdGF0ZTsKICAgIH0sCiAgfTsKfQoKLy8gdHlwZXMgY29waWVkIGZyb20gaW5zcGVjdG9yLmQudHMKCi8qKgogKiBDb252ZXJ0cyBEZWJ1Z2dlci5DYWxsRnJhbWUgdG8gU2VudHJ5IFN0YWNrRnJhbWUKICovCmZ1bmN0aW9uIGNhbGxGcmFtZVRvU3RhY2tGcmFtZSgKICBmcmFtZSwKICB1cmwsCiAgZ2V0TW9kdWxlRnJvbUZpbGVuYW1lLAopIHsKICBjb25zdCBmaWxlbmFtZSA9IHVybCA/IHVybC5yZXBsYWNlKC9eZmlsZTpcL1wvLywgJycpIDogdW5kZWZpbmVkOwoKICAvLyBDYWxsRnJhbWUgcm93L2NvbCBhcmUgMCBiYXNlZCwgd2hlcmVhcyBTdGFja0ZyYW1lIGFyZSAxIGJhc2VkCiAgY29uc3QgY29sbm8gPSBmcmFtZS5sb2NhdGlvbi5jb2x1bW5OdW1iZXIgPyBmcmFtZS5sb2NhdGlvbi5jb2x1bW5OdW1iZXIgKyAxIDogdW5kZWZpbmVkOwogIGNvbnN0IGxpbmVubyA9IGZyYW1lLmxvY2F0aW9uLmxpbmVOdW1iZXIgPyBmcmFtZS5sb2NhdGlvbi5saW5lTnVtYmVyICsgMSA6IHVuZGVmaW5lZDsKCiAgcmV0dXJuIGRyb3BVbmRlZmluZWRLZXlzKHsKICAgIGZpbGVuYW1lLAogICAgbW9kdWxlOiBnZXRNb2R1bGVGcm9tRmlsZW5hbWUoZmlsZW5hbWUpLAogICAgZnVuY3Rpb246IGZyYW1lLmZ1bmN0aW9uTmFtZSB8fCAnPycsCiAgICBjb2xubywKICAgIGxpbmVubywKICAgIGluX2FwcDogZmlsZW5hbWUgPyBmaWxlbmFtZUlzSW5BcHAoZmlsZW5hbWUpIDogdW5kZWZpbmVkLAogIH0pOwp9CgovKioKICogVGhpcyBzZXJ2ZXMgYXMgYSBidWlsZCB0aW1lIGZsYWcgdGhhdCB3aWxsIGJlIHRydWUgYnkgZGVmYXVsdCwgYnV0IGZhbHNlIGluIG5vbi1kZWJ1ZyBidWlsZHMgb3IgaWYgdXNlcnMgcmVwbGFjZSBgX19TRU5UUllfREVCVUdfX2AgaW4gdGhlaXIgZ2VuZXJhdGVkIGNvZGUuCiAqCiAqIEFUVEVOVElPTjogVGhpcyBjb25zdGFudCBtdXN0IG5ldmVyIGNyb3NzIHBhY2thZ2UgYm91bmRhcmllcyAoaS5lLiBiZSBleHBvcnRlZCkgdG8gZ3VhcmFudGVlIHRoYXQgaXQgY2FuIGJlIHVzZWQgZm9yIHRyZWUgc2hha2luZy4KICovCmNvbnN0IERFQlVHX0JVSUxEID0gKHR5cGVvZiBfX1NFTlRSWV9ERUJVR19fID09PSAndW5kZWZpbmVkJyB8fCBfX1NFTlRSWV9ERUJVR19fKTsKCmNvbnN0IERFRkFVTFRfRU5WSVJPTk1FTlQgPSAncHJvZHVjdGlvbic7CgovKioKICogUmV0dXJucyB0aGUgZ2xvYmFsIGV2ZW50IHByb2Nlc3NvcnMuCiAqIEBkZXByZWNhdGVkIEdsb2JhbCBldmVudCBwcm9jZXNzb3JzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4KICovCmZ1bmN0aW9uIGdldEdsb2JhbEV2ZW50UHJvY2Vzc29ycygpIHsKICByZXR1cm4gZ2V0R2xvYmFsU2luZ2xldG9uKCdnbG9iYWxFdmVudFByb2Nlc3NvcnMnLCAoKSA9PiBbXSk7Cn0KCi8qKgogKiBQcm9jZXNzIGFuIGFycmF5IG9mIGV2ZW50IHByb2Nlc3NvcnMsIHJldHVybmluZyB0aGUgcHJvY2Vzc2VkIGV2ZW50IChvciBgbnVsbGAgaWYgdGhlIGV2ZW50IHdhcyBkcm9wcGVkKS4KICovCmZ1bmN0aW9uIG5vdGlmeUV2ZW50UHJvY2Vzc29ycygKICBwcm9jZXNzb3JzLAogIGV2ZW50LAogIGhpbnQsCiAgaW5kZXggPSAwLAopIHsKICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIGNvbnN0IHByb2Nlc3NvciA9IHByb2Nlc3NvcnNbaW5kZXhdOwogICAgaWYgKGV2ZW50ID09PSBudWxsIHx8IHR5cGVvZiBwcm9jZXNzb3IgIT09ICdmdW5jdGlvbicpIHsKICAgICAgcmVzb2x2ZShldmVudCk7CiAgICB9IGVsc2UgewogICAgICBjb25zdCByZXN1bHQgPSBwcm9jZXNzb3IoeyAuLi5ldmVudCB9LCBoaW50KSA7CgogICAgICBERUJVR19CVUlMRCAmJiBwcm9jZXNzb3IuaWQgJiYgcmVzdWx0ID09PSBudWxsICYmIGxvZ2dlci5sb2coYEV2ZW50IHByb2Nlc3NvciAiJHtwcm9jZXNzb3IuaWR9IiBkcm9wcGVkIGV2ZW50YCk7CgogICAgICBpZiAoaXNUaGVuYWJsZShyZXN1bHQpKSB7CiAgICAgICAgdm9pZCByZXN1bHQKICAgICAgICAgIC50aGVuKGZpbmFsID0+IG5vdGlmeUV2ZW50UHJvY2Vzc29ycyhwcm9jZXNzb3JzLCBmaW5hbCwgaGludCwgaW5kZXggKyAxKS50aGVuKHJlc29sdmUpKQogICAgICAgICAgLnRoZW4obnVsbCwgcmVqZWN0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2b2lkIG5vdGlmeUV2ZW50UHJvY2Vzc29ycyhwcm9jZXNzb3JzLCByZXN1bHQsIGhpbnQsIGluZGV4ICsgMSkKICAgICAgICAgIC50aGVuKHJlc29sdmUpCiAgICAgICAgICAudGhlbihudWxsLCByZWplY3QpOwogICAgICB9CiAgICB9CiAgfSk7Cn0KCi8qKgogKiBDcmVhdGVzIGEgbmV3IGBTZXNzaW9uYCBvYmplY3QgYnkgc2V0dGluZyBjZXJ0YWluIGRlZmF1bHQgcGFyYW1ldGVycy4gSWYgb3B0aW9uYWwgQHBhcmFtIGNvbnRleHQKICogaXMgcGFzc2VkLCB0aGUgcGFzc2VkIHByb3BlcnRpZXMgYXJlIGFwcGxpZWQgdG8gdGhlIHNlc3Npb24gb2JqZWN0LgogKgogKiBAcGFyYW0gY29udGV4dCAob3B0aW9uYWwpIGFkZGl0aW9uYWwgcHJvcGVydGllcyB0byBiZSBhcHBsaWVkIHRvIHRoZSByZXR1cm5lZCBzZXNzaW9uIG9iamVjdAogKgogKiBAcmV0dXJucyBhIG5ldyBgU2Vzc2lvbmAgb2JqZWN0CiAqLwpmdW5jdGlvbiBtYWtlU2Vzc2lvbihjb250ZXh0KSB7CiAgLy8gQm90aCB0aW1lc3RhbXAgYW5kIHN0YXJ0ZWQgYXJlIGluIHNlY29uZHMgc2luY2UgdGhlIFVOSVggZXBvY2guCiAgY29uc3Qgc3RhcnRpbmdUaW1lID0gdGltZXN0YW1wSW5TZWNvbmRzKCk7CgogIGNvbnN0IHNlc3Npb24gPSB7CiAgICBzaWQ6IHV1aWQ0KCksCiAgICBpbml0OiB0cnVlLAogICAgdGltZXN0YW1wOiBzdGFydGluZ1RpbWUsCiAgICBzdGFydGVkOiBzdGFydGluZ1RpbWUsCiAgICBkdXJhdGlvbjogMCwKICAgIHN0YXR1czogJ29rJywKICAgIGVycm9yczogMCwKICAgIGlnbm9yZUR1cmF0aW9uOiBmYWxzZSwKICAgIHRvSlNPTjogKCkgPT4gc2Vzc2lvblRvSlNPTihzZXNzaW9uKSwKICB9OwoKICBpZiAoY29udGV4dCkgewogICAgdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCBjb250ZXh0KTsKICB9CgogIHJldHVybiBzZXNzaW9uOwp9CgovKioKICogVXBkYXRlcyBhIHNlc3Npb24gb2JqZWN0IHdpdGggdGhlIHByb3BlcnRpZXMgcGFzc2VkIGluIHRoZSBjb250ZXh0LgogKgogKiBOb3RlIHRoYXQgdGhpcyBmdW5jdGlvbiBtdXRhdGVzIHRoZSBwYXNzZWQgb2JqZWN0IGFuZCByZXR1cm5zIHZvaWQuCiAqIChIYWQgdG8gZG8gdGhpcyBpbnN0ZWFkIG9mIHJldHVybmluZyBhIG5ldyBhbmQgdXBkYXRlZCBzZXNzaW9uIGJlY2F1c2UgY2xvc2luZyBhbmQgc2VuZGluZyBhIHNlc3Npb24KICogbWFrZXMgYW4gdXBkYXRlIHRvIHRoZSBzZXNzaW9uIGFmdGVyIGl0IHdhcyBwYXNzZWQgdG8gdGhlIHNlbmRpbmcgbG9naWMuCiAqIEBzZWUgQmFzZUNsaWVudC5jYXB0dXJlU2Vzc2lvbiApCiAqCiAqIEBwYXJhbSBzZXNzaW9uIHRoZSBgU2Vzc2lvbmAgdG8gdXBkYXRlCiAqIEBwYXJhbSBjb250ZXh0IHRoZSBgU2Vzc2lvbkNvbnRleHRgIGhvbGRpbmcgdGhlIHByb3BlcnRpZXMgdGhhdCBzaG91bGQgYmUgdXBkYXRlZCBpbiBAcGFyYW0gc2Vzc2lvbgogKi8KLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHkKZnVuY3Rpb24gdXBkYXRlU2Vzc2lvbihzZXNzaW9uLCBjb250ZXh0ID0ge30pIHsKICBpZiAoY29udGV4dC51c2VyKSB7CiAgICBpZiAoIXNlc3Npb24uaXBBZGRyZXNzICYmIGNvbnRleHQudXNlci5pcF9hZGRyZXNzKSB7CiAgICAgIHNlc3Npb24uaXBBZGRyZXNzID0gY29udGV4dC51c2VyLmlwX2FkZHJlc3M7CiAgICB9CgogICAgaWYgKCFzZXNzaW9uLmRpZCAmJiAhY29udGV4dC5kaWQpIHsKICAgICAgc2Vzc2lvbi5kaWQgPSBjb250ZXh0LnVzZXIuaWQgfHwgY29udGV4dC51c2VyLmVtYWlsIHx8IGNvbnRleHQudXNlci51c2VybmFtZTsKICAgIH0KICB9CgogIHNlc3Npb24udGltZXN0YW1wID0gY29udGV4dC50aW1lc3RhbXAgfHwgdGltZXN0YW1wSW5TZWNvbmRzKCk7CgogIGlmIChjb250ZXh0LmFibm9ybWFsX21lY2hhbmlzbSkgewogICAgc2Vzc2lvbi5hYm5vcm1hbF9tZWNoYW5pc20gPSBjb250ZXh0LmFibm9ybWFsX21lY2hhbmlzbTsKICB9CgogIGlmIChjb250ZXh0Lmlnbm9yZUR1cmF0aW9uKSB7CiAgICBzZXNzaW9uLmlnbm9yZUR1cmF0aW9uID0gY29udGV4dC5pZ25vcmVEdXJhdGlvbjsKICB9CiAgaWYgKGNvbnRleHQuc2lkKSB7CiAgICAvLyBHb29kIGVub3VnaCB1dWlkIHZhbGlkYXRpb24uIOKAlCBLYW1pbAogICAgc2Vzc2lvbi5zaWQgPSBjb250ZXh0LnNpZC5sZW5ndGggPT09IDMyID8gY29udGV4dC5zaWQgOiB1dWlkNCgpOwogIH0KICBpZiAoY29udGV4dC5pbml0ICE9PSB1bmRlZmluZWQpIHsKICAgIHNlc3Npb24uaW5pdCA9IGNvbnRleHQuaW5pdDsKICB9CiAgaWYgKCFzZXNzaW9uLmRpZCAmJiBjb250ZXh0LmRpZCkgewogICAgc2Vzc2lvbi5kaWQgPSBgJHtjb250ZXh0LmRpZH1gOwogIH0KICBpZiAodHlwZW9mIGNvbnRleHQuc3RhcnRlZCA9PT0gJ251bWJlcicpIHsKICAgIHNlc3Npb24uc3RhcnRlZCA9IGNvbnRleHQuc3RhcnRlZDsKICB9CiAgaWYgKHNlc3Npb24uaWdub3JlRHVyYXRpb24pIHsKICAgIHNlc3Npb24uZHVyYXRpb24gPSB1bmRlZmluZWQ7CiAgfSBlbHNlIGlmICh0eXBlb2YgY29udGV4dC5kdXJhdGlvbiA9PT0gJ251bWJlcicpIHsKICAgIHNlc3Npb24uZHVyYXRpb24gPSBjb250ZXh0LmR1cmF0aW9uOwogIH0gZWxzZSB7CiAgICBjb25zdCBkdXJhdGlvbiA9IHNlc3Npb24udGltZXN0YW1wIC0gc2Vzc2lvbi5zdGFydGVkOwogICAgc2Vzc2lvbi5kdXJhdGlvbiA9IGR1cmF0aW9uID49IDAgPyBkdXJhdGlvbiA6IDA7CiAgfQogIGlmIChjb250ZXh0LnJlbGVhc2UpIHsKICAgIHNlc3Npb24ucmVsZWFzZSA9IGNvbnRleHQucmVsZWFzZTsKICB9CiAgaWYgKGNvbnRleHQuZW52aXJvbm1lbnQpIHsKICAgIHNlc3Npb24uZW52aXJvbm1lbnQgPSBjb250ZXh0LmVudmlyb25tZW50OwogIH0KICBpZiAoIXNlc3Npb24uaXBBZGRyZXNzICYmIGNvbnRleHQuaXBBZGRyZXNzKSB7CiAgICBzZXNzaW9uLmlwQWRkcmVzcyA9IGNvbnRleHQuaXBBZGRyZXNzOwogIH0KICBpZiAoIXNlc3Npb24udXNlckFnZW50ICYmIGNvbnRleHQudXNlckFnZW50KSB7CiAgICBzZXNzaW9uLnVzZXJBZ2VudCA9IGNvbnRleHQudXNlckFnZW50OwogIH0KICBpZiAodHlwZW9mIGNvbnRleHQuZXJyb3JzID09PSAnbnVtYmVyJykgewogICAgc2Vzc2lvbi5lcnJvcnMgPSBjb250ZXh0LmVycm9yczsKICB9CiAgaWYgKGNvbnRleHQuc3RhdHVzKSB7CiAgICBzZXNzaW9uLnN0YXR1cyA9IGNvbnRleHQuc3RhdHVzOwogIH0KfQoKLyoqCiAqIENsb3NlcyBhIHNlc3Npb24gYnkgc2V0dGluZyBpdHMgc3RhdHVzIGFuZCB1cGRhdGluZyB0aGUgc2Vzc2lvbiBvYmplY3Qgd2l0aCBpdC4KICogSW50ZXJuYWxseSBjYWxscyBgdXBkYXRlU2Vzc2lvbmAgdG8gdXBkYXRlIHRoZSBwYXNzZWQgc2Vzc2lvbiBvYmplY3QuCiAqCiAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIG11dGF0ZXMgdGhlIHBhc3NlZCBzZXNzaW9uIChAc2VlIHVwZGF0ZVNlc3Npb24gZm9yIGV4cGxhbmF0aW9uKS4KICoKICogQHBhcmFtIHNlc3Npb24gdGhlIGBTZXNzaW9uYCBvYmplY3QgdG8gYmUgY2xvc2VkCiAqIEBwYXJhbSBzdGF0dXMgdGhlIGBTZXNzaW9uU3RhdHVzYCB3aXRoIHdoaWNoIHRoZSBzZXNzaW9uIHdhcyBjbG9zZWQuIElmIHlvdSBkb24ndCBwYXNzIGEgc3RhdHVzLAogKiAgICAgICAgICAgICAgIHRoaXMgZnVuY3Rpb24gd2lsbCBrZWVwIHRoZSBwcmV2aW91c2x5IHNldCBzdGF0dXMsIHVubGVzcyBpdCB3YXMgYCdvaydgIGluIHdoaWNoIGNhc2UKICogICAgICAgICAgICAgICBpdCBpcyBjaGFuZ2VkIHRvIGAnZXhpdGVkJ2AuCiAqLwpmdW5jdGlvbiBjbG9zZVNlc3Npb24oc2Vzc2lvbiwgc3RhdHVzKSB7CiAgbGV0IGNvbnRleHQgPSB7fTsKICBpZiAoc3RhdHVzKSB7CiAgICBjb250ZXh0ID0geyBzdGF0dXMgfTsKICB9IGVsc2UgaWYgKHNlc3Npb24uc3RhdHVzID09PSAnb2snKSB7CiAgICBjb250ZXh0ID0geyBzdGF0dXM6ICdleGl0ZWQnIH07CiAgfQoKICB1cGRhdGVTZXNzaW9uKHNlc3Npb24sIGNvbnRleHQpOwp9CgovKioKICogU2VyaWFsaXplcyBhIHBhc3NlZCBzZXNzaW9uIG9iamVjdCB0byBhIEpTT04gb2JqZWN0IHdpdGggYSBzbGlnaHRseSBkaWZmZXJlbnQgc3RydWN0dXJlLgogKiBUaGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHRoZSBTZW50cnkgYmFja2VuZCByZXF1aXJlcyBhIHNsaWdodGx5IGRpZmZlcmVudCBzY2hlbWEgb2YgYSBzZXNzaW9uCiAqIHRoYW4gdGhlIG9uZSB0aGUgSlMgU0RLcyB1c2UgaW50ZXJuYWxseS4KICoKICogQHBhcmFtIHNlc3Npb24gdGhlIHNlc3Npb24gdG8gYmUgY29udmVydGVkCiAqCiAqIEByZXR1cm5zIGEgSlNPTiBvYmplY3Qgb2YgdGhlIHBhc3NlZCBzZXNzaW9uCiAqLwpmdW5jdGlvbiBzZXNzaW9uVG9KU09OKHNlc3Npb24pIHsKICByZXR1cm4gZHJvcFVuZGVmaW5lZEtleXMoewogICAgc2lkOiBgJHtzZXNzaW9uLnNpZH1gLAogICAgaW5pdDogc2Vzc2lvbi5pbml0LAogICAgLy8gTWFrZSBzdXJlIHRoYXQgc2VjIGlzIGNvbnZlcnRlZCB0byBtcyBmb3IgZGF0ZSBjb25zdHJ1Y3RvcgogICAgc3RhcnRlZDogbmV3IERhdGUoc2Vzc2lvbi5zdGFydGVkICogMTAwMCkudG9JU09TdHJpbmcoKSwKICAgIHRpbWVzdGFtcDogbmV3IERhdGUoc2Vzc2lvbi50aW1lc3RhbXAgKiAxMDAwKS50b0lTT1N0cmluZygpLAogICAgc3RhdHVzOiBzZXNzaW9uLnN0YXR1cywKICAgIGVycm9yczogc2Vzc2lvbi5lcnJvcnMsCiAgICBkaWQ6IHR5cGVvZiBzZXNzaW9uLmRpZCA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHNlc3Npb24uZGlkID09PSAnc3RyaW5nJyA/IGAke3Nlc3Npb24uZGlkfWAgOiB1bmRlZmluZWQsCiAgICBkdXJhdGlvbjogc2Vzc2lvbi5kdXJhdGlvbiwKICAgIGFibm9ybWFsX21lY2hhbmlzbTogc2Vzc2lvbi5hYm5vcm1hbF9tZWNoYW5pc20sCiAgICBhdHRyczogewogICAgICByZWxlYXNlOiBzZXNzaW9uLnJlbGVhc2UsCiAgICAgIGVudmlyb25tZW50OiBzZXNzaW9uLmVudmlyb25tZW50LAogICAgICBpcF9hZGRyZXNzOiBzZXNzaW9uLmlwQWRkcmVzcywKICAgICAgdXNlcl9hZ2VudDogc2Vzc2lvbi51c2VyQWdlbnQsCiAgICB9LAogIH0pOwp9Cgpjb25zdCBUUkFDRV9GTEFHX1NBTVBMRUQgPSAweDE7CgovKioKICogQ29udmVydCBhIHNwYW4gdG8gYSB0cmFjZSBjb250ZXh0LCB3aGljaCBjYW4gYmUgc2VudCBhcyB0aGUgYHRyYWNlYCBjb250ZXh0IGluIGFuIGV2ZW50LgogKi8KZnVuY3Rpb24gc3BhblRvVHJhY2VDb250ZXh0KHNwYW4pIHsKICBjb25zdCB7IHNwYW5JZDogc3Bhbl9pZCwgdHJhY2VJZDogdHJhY2VfaWQgfSA9IHNwYW4uc3BhbkNvbnRleHQoKTsKICBjb25zdCB7IGRhdGEsIG9wLCBwYXJlbnRfc3Bhbl9pZCwgc3RhdHVzLCB0YWdzLCBvcmlnaW4gfSA9IHNwYW5Ub0pTT04oc3Bhbik7CgogIHJldHVybiBkcm9wVW5kZWZpbmVkS2V5cyh7CiAgICBkYXRhLAogICAgb3AsCiAgICBwYXJlbnRfc3Bhbl9pZCwKICAgIHNwYW5faWQsCiAgICBzdGF0dXMsCiAgICB0YWdzLAogICAgdHJhY2VfaWQsCiAgICBvcmlnaW4sCiAgfSk7Cn0KCi8qKgogKiBDb252ZXJ0IGEgc3BhbiB0byBhIEpTT04gcmVwcmVzZW50YXRpb24uCiAqIE5vdGUgdGhhdCBhbGwgZmllbGRzIHJldHVybmVkIGhlcmUgYXJlIG9wdGlvbmFsIGFuZCBuZWVkIHRvIGJlIGd1YXJkZWQgYWdhaW5zdC4KICoKICogTm90ZTogQmVjYXVzZSBvZiB0aGlzLCB3ZSBjdXJyZW50bHkgaGF2ZSBhIGNpcmN1bGFyIHR5cGUgZGVwZW5kZW5jeSAod2hpY2ggd2Ugb3B0ZWQgb3V0IG9mIGluIHBhY2thZ2UuanNvbikuCiAqIFRoaXMgaXMgbm90IGF2b2lkYWJsZSBhcyB3ZSBuZWVkIGBzcGFuVG9KU09OYCBpbiBgc3BhblV0aWxzLnRzYCwgd2hpY2ggaW4gdHVybiBpcyBuZWVkZWQgYnkgYHNwYW4udHNgIGZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eS4KICogQW5kIGBzcGFuVG9KU09OYCBuZWVkcyB0aGUgU3BhbiBjbGFzcyBmcm9tIGBzcGFuLnRzYCB0byBjaGVjayBoZXJlLgogKiBUT0RPIHY4OiBXaGVuIHdlIHJlbW92ZSB0aGUgZGVwcmVjYXRlZCBzdHVmZiBmcm9tIGBzcGFuLnRzYCwgd2UgY2FuIHJlbW92ZSB0aGUgY2lyY3VsYXIgZGVwZW5kZW5jeSBhZ2Fpbi4KICovCmZ1bmN0aW9uIHNwYW5Ub0pTT04oc3BhbikgewogIGlmIChzcGFuSXNTcGFuQ2xhc3Moc3BhbikpIHsKICAgIHJldHVybiBzcGFuLmdldFNwYW5KU09OKCk7CiAgfQoKICAvLyBGYWxsYmFjazogV2UgYWxzbyBjaGVjayBmb3IgYC50b0pTT04oKWAgaGVyZS4uLgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIGlmICh0eXBlb2Ygc3Bhbi50b0pTT04gPT09ICdmdW5jdGlvbicpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgcmV0dXJuIHNwYW4udG9KU09OKCk7CiAgfQoKICByZXR1cm4ge307Cn0KCi8qKgogKiBTYWRseSwgZHVlIHRvIGNpcmN1bGFyIGRlcGVuZGVuY3kgY2hlY2tzIHdlIGNhbm5vdCBhY3R1YWxseSBpbXBvcnQgdGhlIFNwYW4gY2xhc3MgaGVyZSBhbmQgY2hlY2sgZm9yIGluc3RhbmNlb2YuCiAqIDooIFNvIGluc3RlYWQgd2UgYXBwcm94aW1hdGUgdGhpcyBieSBjaGVja2luZyBpZiBpdCBoYXMgdGhlIGBnZXRTcGFuSlNPTmAgbWV0aG9kLgogKi8KZnVuY3Rpb24gc3BhbklzU3BhbkNsYXNzKHNwYW4pIHsKICByZXR1cm4gdHlwZW9mIChzcGFuICkuZ2V0U3BhbkpTT04gPT09ICdmdW5jdGlvbic7Cn0KCi8qKgogKiBSZXR1cm5zIHRydWUgaWYgYSBzcGFuIGlzIHNhbXBsZWQuCiAqIEluIG1vc3QgY2FzZXMsIHlvdSBzaG91bGQganVzdCB1c2UgYHNwYW4uaXNSZWNvcmRpbmcoKWAgaW5zdGVhZC4KICogSG93ZXZlciwgdGhpcyBoYXMgYSBzbGlnaHRseSBkaWZmZXJlbnQgc2VtYW50aWMsIGFzIGl0IGFsc28gcmV0dXJucyBmYWxzZSBpZiB0aGUgc3BhbiBpcyBmaW5pc2hlZC4KICogU28gaW4gdGhlIGNhc2Ugd2hlcmUgdGhpcyBkaXN0aW5jdGlvbiBpcyBpbXBvcnRhbnQsIHVzZSB0aGlzIG1ldGhvZC4KICovCmZ1bmN0aW9uIHNwYW5Jc1NhbXBsZWQoc3BhbikgewogIC8vIFdlIGFsaWduIG91ciB0cmFjZSBmbGFncyB3aXRoIHRoZSBvbmVzIE9wZW5UZWxlbWV0cnkgdXNlCiAgLy8gU28gd2UgYWxzbyBjaGVjayBmb3Igc2FtcGxlZCB0aGUgc2FtZSB3YXkgdGhleSBkby4KICBjb25zdCB7IHRyYWNlRmxhZ3MgfSA9IHNwYW4uc3BhbkNvbnRleHQoKTsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYml0d2lzZQogIHJldHVybiBCb29sZWFuKHRyYWNlRmxhZ3MgJiBUUkFDRV9GTEFHX1NBTVBMRUQpOwp9CgovKioKICogR2V0IHRoZSBjdXJyZW50bHkgYWN0aXZlIGNsaWVudC4KICovCmZ1bmN0aW9uIGdldENsaWVudCgpIHsKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICByZXR1cm4gZ2V0Q3VycmVudEh1YigpLmdldENsaWVudCgpOwp9CgovKioKICogR2V0IHRoZSBjdXJyZW50bHkgYWN0aXZlIHNjb3BlLgogKi8KZnVuY3Rpb24gZ2V0Q3VycmVudFNjb3BlKCkgewogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIHJldHVybiBnZXRDdXJyZW50SHViKCkuZ2V0U2NvcGUoKTsKfQoKLyoqCiAqIFJldHVybnMgdGhlIHJvb3Qgc3BhbiBvZiBhIGdpdmVuIHNwYW4uCiAqCiAqIEFzIGxvbmcgYXMgd2UgdXNlIGBUcmFuc2FjdGlvbmBzIGludGVybmFsbHksIHRoZSByZXR1cm5lZCByb290IHNwYW4KICogd2lsbCBiZSBhIGBUcmFuc2FjdGlvbmAgYnV0IGJlIGF3YXJlIHRoYXQgdGhpcyBtaWdodCBjaGFuZ2UgaW4gdGhlIGZ1dHVyZS4KICoKICogSWYgdGhlIGdpdmVuIHNwYW4gaGFzIG5vIHJvb3Qgc3BhbiBvciB0cmFuc2FjdGlvbiwgYHVuZGVmaW5lZGAgaXMgcmV0dXJuZWQuCiAqLwpmdW5jdGlvbiBnZXRSb290U3BhbihzcGFuKSB7CiAgLy8gVE9ETyAodjgpOiBSZW1vdmUgdGhpcyBjaGVjayBhbmQganVzdCByZXR1cm4gc3BhbgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIHJldHVybiBzcGFuLnRyYW5zYWN0aW9uOwp9CgovKioKICogQ3JlYXRlcyBhIGR5bmFtaWMgc2FtcGxpbmcgY29udGV4dCBmcm9tIGEgY2xpZW50LgogKgogKiBEaXNwYXRjaGVzIHRoZSBgY3JlYXRlRHNjYCBsaWZlY3ljbGUgaG9vayBhcyBhIHNpZGUgZWZmZWN0LgogKi8KZnVuY3Rpb24gZ2V0RHluYW1pY1NhbXBsaW5nQ29udGV4dEZyb21DbGllbnQoCiAgdHJhY2VfaWQsCiAgY2xpZW50LAogIHNjb3BlLAopIHsKICBjb25zdCBvcHRpb25zID0gY2xpZW50LmdldE9wdGlvbnMoKTsKCiAgY29uc3QgeyBwdWJsaWNLZXk6IHB1YmxpY19rZXkgfSA9IGNsaWVudC5nZXREc24oKSB8fCB7fTsKICAvLyBUT0RPKHY4KTogUmVtb3ZlIHNlZ21lbnQgZnJvbSBVc2VyCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgY29uc3QgeyBzZWdtZW50OiB1c2VyX3NlZ21lbnQgfSA9IChzY29wZSAmJiBzY29wZS5nZXRVc2VyKCkpIHx8IHt9OwoKICBjb25zdCBkc2MgPSBkcm9wVW5kZWZpbmVkS2V5cyh7CiAgICBlbnZpcm9ubWVudDogb3B0aW9ucy5lbnZpcm9ubWVudCB8fCBERUZBVUxUX0VOVklST05NRU5ULAogICAgcmVsZWFzZTogb3B0aW9ucy5yZWxlYXNlLAogICAgdXNlcl9zZWdtZW50LAogICAgcHVibGljX2tleSwKICAgIHRyYWNlX2lkLAogIH0pIDsKCiAgY2xpZW50LmVtaXQgJiYgY2xpZW50LmVtaXQoJ2NyZWF0ZURzYycsIGRzYyk7CgogIHJldHVybiBkc2M7Cn0KCi8qKgogKiBBIFNwYW4gd2l0aCBhIGZyb3plbiBkeW5hbWljIHNhbXBsaW5nIGNvbnRleHQuCiAqLwoKLyoqCiAqIENyZWF0ZXMgYSBkeW5hbWljIHNhbXBsaW5nIGNvbnRleHQgZnJvbSBhIHNwYW4gKGFuZCBjbGllbnQgYW5kIHNjb3BlKQogKgogKiBAcGFyYW0gc3BhbiB0aGUgc3BhbiBmcm9tIHdoaWNoIGEgZmV3IHZhbHVlcyBsaWtlIHRoZSByb290IHNwYW4gbmFtZSBhbmQgc2FtcGxlIHJhdGUgYXJlIGV4dHJhY3RlZC4KICoKICogQHJldHVybnMgYSBkeW5hbWljIHNhbXBsaW5nIGNvbnRleHQKICovCmZ1bmN0aW9uIGdldER5bmFtaWNTYW1wbGluZ0NvbnRleHRGcm9tU3BhbihzcGFuKSB7CiAgY29uc3QgY2xpZW50ID0gZ2V0Q2xpZW50KCk7CiAgaWYgKCFjbGllbnQpIHsKICAgIHJldHVybiB7fTsKICB9CgogIC8vIHBhc3NpbmcgZW1pdD1mYWxzZSBoZXJlIHRvIG9ubHkgZW1pdCBsYXRlciBvbmNlIHRoZSBEU0MgaXMgYWN0dWFsbHkgcG9wdWxhdGVkCiAgY29uc3QgZHNjID0gZ2V0RHluYW1pY1NhbXBsaW5nQ29udGV4dEZyb21DbGllbnQoc3BhblRvSlNPTihzcGFuKS50cmFjZV9pZCB8fCAnJywgY2xpZW50LCBnZXRDdXJyZW50U2NvcGUoKSk7CgogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIHY3RnJvemVuRHNjIGFzIGEgVHJhbnNhY3Rpb24gd2lsbCBubyBsb25nZXIgaGF2ZSBfZnJvemVuRHluYW1pY1NhbXBsaW5nQ29udGV4dAogIGNvbnN0IHR4biA9IGdldFJvb3RTcGFuKHNwYW4pIDsKICBpZiAoIXR4bikgewogICAgcmV0dXJuIGRzYzsKICB9CgogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIHY3RnJvemVuRHNjIGFzIGEgVHJhbnNhY3Rpb24gd2lsbCBubyBsb25nZXIgaGF2ZSBfZnJvemVuRHluYW1pY1NhbXBsaW5nQ29udGV4dAogIC8vIEZvciBub3cgd2UgbmVlZCB0byBhdm9pZCBicmVha2luZyB1c2VycyB3aG8gZGlyZWN0bHkgY3JlYXRlZCBhIHR4biB3aXRoIGEgRFNDLCB3aGVyZSB0aGlzIGZpZWxkIGlzIHN0aWxsIHNldC4KICAvLyBAc2VlIFRyYW5zYWN0aW9uIGNsYXNzIGNvbnN0cnVjdG9yCiAgY29uc3QgdjdGcm96ZW5Ec2MgPSB0eG4gJiYgdHhuLl9mcm96ZW5EeW5hbWljU2FtcGxpbmdDb250ZXh0OwogIGlmICh2N0Zyb3plbkRzYykgewogICAgcmV0dXJuIHY3RnJvemVuRHNjOwogIH0KCiAgLy8gVE9ETyAodjgpOiBSZXBsYWNlIHR4bi5tZXRhZGF0YSB3aXRoIHR4bi5hdHRyaWJ1dGVzW10KICAvLyBXZSBjYW4ndCBkbyB0aGlzIHlldCBiZWNhdXNlIGF0dHJpYnV0ZXMgYXJlbid0IGFsd2F5cyBzZXQgeWV0LgogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogIGNvbnN0IHsgc2FtcGxlUmF0ZTogbWF5YmVTYW1wbGVSYXRlLCBzb3VyY2UgfSA9IHR4bi5tZXRhZGF0YTsKICBpZiAobWF5YmVTYW1wbGVSYXRlICE9IG51bGwpIHsKICAgIGRzYy5zYW1wbGVfcmF0ZSA9IGAke21heWJlU2FtcGxlUmF0ZX1gOwogIH0KCiAgLy8gV2UgZG9uJ3Qgd2FudCB0byBoYXZlIGEgdHJhbnNhY3Rpb24gbmFtZSBpbiB0aGUgRFNDIGlmIHRoZSBzb3VyY2UgaXMgInVybCIgYmVjYXVzZSBVUkxzIG1pZ2h0IGNvbnRhaW4gUElJCiAgY29uc3QganNvblNwYW4gPSBzcGFuVG9KU09OKHR4bik7CgogIC8vIGFmdGVyIEpTT04gY29udmVyc2lvbiwgdHhuLm5hbWUgYmVjb21lcyBqc29uU3Bhbi5kZXNjcmlwdGlvbgogIGlmIChzb3VyY2UgJiYgc291cmNlICE9PSAndXJsJykgewogICAgZHNjLnRyYW5zYWN0aW9uID0ganNvblNwYW4uZGVzY3JpcHRpb247CiAgfQoKICBkc2Muc2FtcGxlZCA9IFN0cmluZyhzcGFuSXNTYW1wbGVkKHR4bikpOwoKICBjbGllbnQuZW1pdCAmJiBjbGllbnQuZW1pdCgnY3JlYXRlRHNjJywgZHNjKTsKCiAgcmV0dXJuIGRzYzsKfQoKLyoqCiAqIEFwcGxpZXMgZGF0YSBmcm9tIHRoZSBzY29wZSB0byB0aGUgZXZlbnQgYW5kIHJ1bnMgYWxsIGV2ZW50IHByb2Nlc3NvcnMgb24gaXQuCiAqLwpmdW5jdGlvbiBhcHBseVNjb3BlRGF0YVRvRXZlbnQoZXZlbnQsIGRhdGEpIHsKICBjb25zdCB7IGZpbmdlcnByaW50LCBzcGFuLCBicmVhZGNydW1icywgc2RrUHJvY2Vzc2luZ01ldGFkYXRhIH0gPSBkYXRhOwoKICAvLyBBcHBseSBnZW5lcmFsIGRhdGEKICBhcHBseURhdGFUb0V2ZW50KGV2ZW50LCBkYXRhKTsKCiAgLy8gV2Ugd2FudCB0byBzZXQgdGhlIHRyYWNlIGNvbnRleHQgZm9yIG5vcm1hbCBldmVudHMgb25seSBpZiB0aGVyZSBpc24ndCBhbHJlYWR5CiAgLy8gYSB0cmFjZSBjb250ZXh0IG9uIHRoZSBldmVudC4gVGhlcmUgaXMgYSBwcm9kdWN0IGZlYXR1cmUgaW4gcGxhY2Ugd2hlcmUgd2UgbGluawogIC8vIGVycm9ycyB3aXRoIHRyYW5zYWN0aW9uIGFuZCBpdCByZWxpZXMgb24gdGhhdC4KICBpZiAoc3BhbikgewogICAgYXBwbHlTcGFuVG9FdmVudChldmVudCwgc3Bhbik7CiAgfQoKICBhcHBseUZpbmdlcnByaW50VG9FdmVudChldmVudCwgZmluZ2VycHJpbnQpOwogIGFwcGx5QnJlYWRjcnVtYnNUb0V2ZW50KGV2ZW50LCBicmVhZGNydW1icyk7CiAgYXBwbHlTZGtNZXRhZGF0YVRvRXZlbnQoZXZlbnQsIHNka1Byb2Nlc3NpbmdNZXRhZGF0YSk7Cn0KCmZ1bmN0aW9uIGFwcGx5RGF0YVRvRXZlbnQoZXZlbnQsIGRhdGEpIHsKICBjb25zdCB7CiAgICBleHRyYSwKICAgIHRhZ3MsCiAgICB1c2VyLAogICAgY29udGV4dHMsCiAgICBsZXZlbCwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdHJhbnNhY3Rpb25OYW1lLAogIH0gPSBkYXRhOwoKICBjb25zdCBjbGVhbmVkRXh0cmEgPSBkcm9wVW5kZWZpbmVkS2V5cyhleHRyYSk7CiAgaWYgKGNsZWFuZWRFeHRyYSAmJiBPYmplY3Qua2V5cyhjbGVhbmVkRXh0cmEpLmxlbmd0aCkgewogICAgZXZlbnQuZXh0cmEgPSB7IC4uLmNsZWFuZWRFeHRyYSwgLi4uZXZlbnQuZXh0cmEgfTsKICB9CgogIGNvbnN0IGNsZWFuZWRUYWdzID0gZHJvcFVuZGVmaW5lZEtleXModGFncyk7CiAgaWYgKGNsZWFuZWRUYWdzICYmIE9iamVjdC5rZXlzKGNsZWFuZWRUYWdzKS5sZW5ndGgpIHsKICAgIGV2ZW50LnRhZ3MgPSB7IC4uLmNsZWFuZWRUYWdzLCAuLi5ldmVudC50YWdzIH07CiAgfQoKICBjb25zdCBjbGVhbmVkVXNlciA9IGRyb3BVbmRlZmluZWRLZXlzKHVzZXIpOwogIGlmIChjbGVhbmVkVXNlciAmJiBPYmplY3Qua2V5cyhjbGVhbmVkVXNlcikubGVuZ3RoKSB7CiAgICBldmVudC51c2VyID0geyAuLi5jbGVhbmVkVXNlciwgLi4uZXZlbnQudXNlciB9OwogIH0KCiAgY29uc3QgY2xlYW5lZENvbnRleHRzID0gZHJvcFVuZGVmaW5lZEtleXMoY29udGV4dHMpOwogIGlmIChjbGVhbmVkQ29udGV4dHMgJiYgT2JqZWN0LmtleXMoY2xlYW5lZENvbnRleHRzKS5sZW5ndGgpIHsKICAgIGV2ZW50LmNvbnRleHRzID0geyAuLi5jbGVhbmVkQ29udGV4dHMsIC4uLmV2ZW50LmNvbnRleHRzIH07CiAgfQoKICBpZiAobGV2ZWwpIHsKICAgIGV2ZW50LmxldmVsID0gbGV2ZWw7CiAgfQoKICBpZiAodHJhbnNhY3Rpb25OYW1lKSB7CiAgICBldmVudC50cmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uTmFtZTsKICB9Cn0KCmZ1bmN0aW9uIGFwcGx5QnJlYWRjcnVtYnNUb0V2ZW50KGV2ZW50LCBicmVhZGNydW1icykgewogIGNvbnN0IG1lcmdlZEJyZWFkY3J1bWJzID0gWy4uLihldmVudC5icmVhZGNydW1icyB8fCBbXSksIC4uLmJyZWFkY3J1bWJzXTsKICBldmVudC5icmVhZGNydW1icyA9IG1lcmdlZEJyZWFkY3J1bWJzLmxlbmd0aCA/IG1lcmdlZEJyZWFkY3J1bWJzIDogdW5kZWZpbmVkOwp9CgpmdW5jdGlvbiBhcHBseVNka01ldGFkYXRhVG9FdmVudChldmVudCwgc2RrUHJvY2Vzc2luZ01ldGFkYXRhKSB7CiAgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhID0gewogICAgLi4uZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhLAogICAgLi4uc2RrUHJvY2Vzc2luZ01ldGFkYXRhLAogIH07Cn0KCmZ1bmN0aW9uIGFwcGx5U3BhblRvRXZlbnQoZXZlbnQsIHNwYW4pIHsKICBldmVudC5jb250ZXh0cyA9IHsgdHJhY2U6IHNwYW5Ub1RyYWNlQ29udGV4dChzcGFuKSwgLi4uZXZlbnQuY29udGV4dHMgfTsKICBjb25zdCByb290U3BhbiA9IGdldFJvb3RTcGFuKHNwYW4pOwogIGlmIChyb290U3BhbikgewogICAgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhID0gewogICAgICBkeW5hbWljU2FtcGxpbmdDb250ZXh0OiBnZXREeW5hbWljU2FtcGxpbmdDb250ZXh0RnJvbVNwYW4oc3BhbiksCiAgICAgIC4uLmV2ZW50LnNka1Byb2Nlc3NpbmdNZXRhZGF0YSwKICAgIH07CiAgICBjb25zdCB0cmFuc2FjdGlvbk5hbWUgPSBzcGFuVG9KU09OKHJvb3RTcGFuKS5kZXNjcmlwdGlvbjsKICAgIGlmICh0cmFuc2FjdGlvbk5hbWUpIHsKICAgICAgZXZlbnQudGFncyA9IHsgdHJhbnNhY3Rpb246IHRyYW5zYWN0aW9uTmFtZSwgLi4uZXZlbnQudGFncyB9OwogICAgfQogIH0KfQoKLyoqCiAqIEFwcGxpZXMgZmluZ2VycHJpbnQgZnJvbSB0aGUgc2NvcGUgdG8gdGhlIGV2ZW50IGlmIHRoZXJlJ3Mgb25lLAogKiB1c2VzIG1lc3NhZ2UgaWYgdGhlcmUncyBvbmUgaW5zdGVhZCBvciBnZXQgcmlkIG9mIGVtcHR5IGZpbmdlcnByaW50CiAqLwpmdW5jdGlvbiBhcHBseUZpbmdlcnByaW50VG9FdmVudChldmVudCwgZmluZ2VycHJpbnQpIHsKICAvLyBNYWtlIHN1cmUgaXQncyBhbiBhcnJheSBmaXJzdCBhbmQgd2UgYWN0dWFsbHkgaGF2ZSBzb21ldGhpbmcgaW4gcGxhY2UKICBldmVudC5maW5nZXJwcmludCA9IGV2ZW50LmZpbmdlcnByaW50ID8gYXJyYXlpZnkoZXZlbnQuZmluZ2VycHJpbnQpIDogW107CgogIC8vIElmIHdlIGhhdmUgc29tZXRoaW5nIG9uIHRoZSBzY29wZSwgdGhlbiBtZXJnZSBpdCB3aXRoIGV2ZW50CiAgaWYgKGZpbmdlcnByaW50KSB7CiAgICBldmVudC5maW5nZXJwcmludCA9IGV2ZW50LmZpbmdlcnByaW50LmNvbmNhdChmaW5nZXJwcmludCk7CiAgfQoKICAvLyBJZiB3ZSBoYXZlIG5vIGRhdGEgYXQgYWxsLCByZW1vdmUgZW1wdHkgYXJyYXkgZGVmYXVsdAogIGlmIChldmVudC5maW5nZXJwcmludCAmJiAhZXZlbnQuZmluZ2VycHJpbnQubGVuZ3RoKSB7CiAgICBkZWxldGUgZXZlbnQuZmluZ2VycHJpbnQ7CiAgfQp9CgovKioKICogRGVmYXVsdCB2YWx1ZSBmb3IgbWF4aW11bSBudW1iZXIgb2YgYnJlYWRjcnVtYnMgYWRkZWQgdG8gYW4gZXZlbnQuCiAqLwpjb25zdCBERUZBVUxUX01BWF9CUkVBRENSVU1CUyA9IDEwMDsKCi8qKgogKiBIb2xkcyBhZGRpdGlvbmFsIGV2ZW50IGluZm9ybWF0aW9uLiB7QGxpbmsgU2NvcGUuYXBwbHlUb0V2ZW50fSB3aWxsIGJlCiAqIGNhbGxlZCBieSB0aGUgY2xpZW50IGJlZm9yZSBhbiBldmVudCB3aWxsIGJlIHNlbnQuCiAqLwpjbGFzcyBTY29wZSAgewogIC8qKiBGbGFnIGlmIG5vdGlmeWluZyBpcyBoYXBwZW5pbmcuICovCgogIC8qKiBDYWxsYmFjayBmb3IgY2xpZW50IHRvIHJlY2VpdmUgc2NvcGUgY2hhbmdlcy4gKi8KCiAgLyoqIENhbGxiYWNrIGxpc3QgdGhhdCB3aWxsIGJlIGNhbGxlZCBhZnRlciB7QGxpbmsgYXBwbHlUb0V2ZW50fS4gKi8KCiAgLyoqIEFycmF5IG9mIGJyZWFkY3J1bWJzLiAqLwoKICAvKiogVXNlciAqLwoKICAvKiogVGFncyAqLwoKICAvKiogRXh0cmEgKi8KCiAgLyoqIENvbnRleHRzICovCgogIC8qKiBBdHRhY2htZW50cyAqLwoKICAvKiogUHJvcGFnYXRpb24gQ29udGV4dCBmb3IgZGlzdHJpYnV0ZWQgdHJhY2luZyAqLwoKICAvKioKICAgKiBBIHBsYWNlIHRvIHN0YXNoIGRhdGEgd2hpY2ggaXMgbmVlZGVkIGF0IHNvbWUgcG9pbnQgaW4gdGhlIFNESydzIGV2ZW50IHByb2Nlc3NpbmcgcGlwZWxpbmUgYnV0IHdoaWNoIHNob3VsZG4ndCBnZXQKICAgKiBzZW50IHRvIFNlbnRyeQogICAqLwoKICAvKiogRmluZ2VycHJpbnQgKi8KCiAgLyoqIFNldmVyaXR5ICovCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCgogIC8qKgogICAqIFRyYW5zYWN0aW9uIE5hbWUKICAgKi8KCiAgLyoqIFNwYW4gKi8KCiAgLyoqIFNlc3Npb24gKi8KCiAgLyoqIFJlcXVlc3QgTW9kZSBTZXNzaW9uIFN0YXR1cyAqLwoKICAvKiogVGhlIGNsaWVudCBvbiB0aGlzIHNjb3BlICovCgogIC8vIE5PVEU6IEFueSBmaWVsZCB3aGljaCBnZXRzIGFkZGVkIGhlcmUgc2hvdWxkIGdldCBhZGRlZCBub3Qgb25seSB0byB0aGUgY29uc3RydWN0b3IgYnV0IGFsc28gdG8gdGhlIGBjbG9uZWAgbWV0aG9kLgoKICAgY29uc3RydWN0b3IoKSB7CiAgICB0aGlzLl9ub3RpZnlpbmdMaXN0ZW5lcnMgPSBmYWxzZTsKICAgIHRoaXMuX3Njb3BlTGlzdGVuZXJzID0gW107CiAgICB0aGlzLl9ldmVudFByb2Nlc3NvcnMgPSBbXTsKICAgIHRoaXMuX2JyZWFkY3J1bWJzID0gW107CiAgICB0aGlzLl9hdHRhY2htZW50cyA9IFtdOwogICAgdGhpcy5fdXNlciA9IHt9OwogICAgdGhpcy5fdGFncyA9IHt9OwogICAgdGhpcy5fZXh0cmEgPSB7fTsKICAgIHRoaXMuX2NvbnRleHRzID0ge307CiAgICB0aGlzLl9zZGtQcm9jZXNzaW5nTWV0YWRhdGEgPSB7fTsKICAgIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCA9IGdlbmVyYXRlUHJvcGFnYXRpb25Db250ZXh0KCk7CiAgfQoKICAvKioKICAgKiBJbmhlcml0IHZhbHVlcyBmcm9tIHRoZSBwYXJlbnQgc2NvcGUuCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBzY29wZS5jbG9uZSgpYCBhbmQgYG5ldyBTY29wZSgpYCBpbnN0ZWFkLgogICAqLwogICBzdGF0aWMgY2xvbmUoc2NvcGUpIHsKICAgIHJldHVybiBzY29wZSA/IHNjb3BlLmNsb25lKCkgOiBuZXcgU2NvcGUoKTsKICB9CgogIC8qKgogICAqIENsb25lIHRoaXMgc2NvcGUgaW5zdGFuY2UuCiAgICovCiAgIGNsb25lKCkgewogICAgY29uc3QgbmV3U2NvcGUgPSBuZXcgU2NvcGUoKTsKICAgIG5ld1Njb3BlLl9icmVhZGNydW1icyA9IFsuLi50aGlzLl9icmVhZGNydW1ic107CiAgICBuZXdTY29wZS5fdGFncyA9IHsgLi4udGhpcy5fdGFncyB9OwogICAgbmV3U2NvcGUuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSB9OwogICAgbmV3U2NvcGUuX2NvbnRleHRzID0geyAuLi50aGlzLl9jb250ZXh0cyB9OwogICAgbmV3U2NvcGUuX3VzZXIgPSB0aGlzLl91c2VyOwogICAgbmV3U2NvcGUuX2xldmVsID0gdGhpcy5fbGV2ZWw7CiAgICBuZXdTY29wZS5fc3BhbiA9IHRoaXMuX3NwYW47CiAgICBuZXdTY29wZS5fc2Vzc2lvbiA9IHRoaXMuX3Nlc3Npb247CiAgICBuZXdTY29wZS5fdHJhbnNhY3Rpb25OYW1lID0gdGhpcy5fdHJhbnNhY3Rpb25OYW1lOwogICAgbmV3U2NvcGUuX2ZpbmdlcnByaW50ID0gdGhpcy5fZmluZ2VycHJpbnQ7CiAgICBuZXdTY29wZS5fZXZlbnRQcm9jZXNzb3JzID0gWy4uLnRoaXMuX2V2ZW50UHJvY2Vzc29yc107CiAgICBuZXdTY29wZS5fcmVxdWVzdFNlc3Npb24gPSB0aGlzLl9yZXF1ZXN0U2Vzc2lvbjsKICAgIG5ld1Njb3BlLl9hdHRhY2htZW50cyA9IFsuLi50aGlzLl9hdHRhY2htZW50c107CiAgICBuZXdTY29wZS5fc2RrUHJvY2Vzc2luZ01ldGFkYXRhID0geyAuLi50aGlzLl9zZGtQcm9jZXNzaW5nTWV0YWRhdGEgfTsKICAgIG5ld1Njb3BlLl9wcm9wYWdhdGlvbkNvbnRleHQgPSB7IC4uLnRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCB9OwogICAgbmV3U2NvcGUuX2NsaWVudCA9IHRoaXMuX2NsaWVudDsKCiAgICByZXR1cm4gbmV3U2NvcGU7CiAgfQoKICAvKiogVXBkYXRlIHRoZSBjbGllbnQgb24gdGhlIHNjb3BlLiAqLwogICBzZXRDbGllbnQoY2xpZW50KSB7CiAgICB0aGlzLl9jbGllbnQgPSBjbGllbnQ7CiAgfQoKICAvKioKICAgKiBHZXQgdGhlIGNsaWVudCBhc3NpZ25lZCB0byB0aGlzIHNjb3BlLgogICAqCiAgICogSXQgaXMgZ2VuZXJhbGx5IHJlY29tbWVuZGVkIHRvIHVzZSB0aGUgZ2xvYmFsIGZ1bmN0aW9uIGBTZW50cnkuZ2V0Q2xpZW50KClgIGluc3RlYWQsIHVubGVzcyB5b3Uga25vdyB3aGF0IHlvdSBhcmUgZG9pbmcuCiAgICovCiAgIGdldENsaWVudCgpIHsKICAgIHJldHVybiB0aGlzLl9jbGllbnQ7CiAgfQoKICAvKioKICAgKiBBZGQgaW50ZXJuYWwgb24gY2hhbmdlIGxpc3RlbmVyLiBVc2VkIGZvciBzdWIgU0RLcyB0aGF0IG5lZWQgdG8gc3RvcmUgdGhlIHNjb3BlLgogICAqIEBoaWRkZW4KICAgKi8KICAgYWRkU2NvcGVMaXN0ZW5lcihjYWxsYmFjaykgewogICAgdGhpcy5fc2NvcGVMaXN0ZW5lcnMucHVzaChjYWxsYmFjayk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBhZGRFdmVudFByb2Nlc3NvcihjYWxsYmFjaykgewogICAgdGhpcy5fZXZlbnRQcm9jZXNzb3JzLnB1c2goY2FsbGJhY2spOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRVc2VyKHVzZXIpIHsKICAgIC8vIElmIG51bGwgaXMgcGFzc2VkIHdlIHdhbnQgdG8gdW5zZXQgZXZlcnl0aGluZywgYnV0IHN0aWxsIGRlZmluZSBrZXlzLAogICAgLy8gc28gdGhhdCBsYXRlciBkb3duIGluIHRoZSBwaXBlbGluZSBhbnkgZXhpc3RpbmcgdmFsdWVzIGFyZSBjbGVhcmVkLgogICAgdGhpcy5fdXNlciA9IHVzZXIgfHwgewogICAgICBlbWFpbDogdW5kZWZpbmVkLAogICAgICBpZDogdW5kZWZpbmVkLAogICAgICBpcF9hZGRyZXNzOiB1bmRlZmluZWQsCiAgICAgIHNlZ21lbnQ6IHVuZGVmaW5lZCwKICAgICAgdXNlcm5hbWU6IHVuZGVmaW5lZCwKICAgIH07CgogICAgaWYgKHRoaXMuX3Nlc3Npb24pIHsKICAgICAgdXBkYXRlU2Vzc2lvbih0aGlzLl9zZXNzaW9uLCB7IHVzZXIgfSk7CiAgICB9CgogICAgdGhpcy5fbm90aWZ5U2NvcGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0VXNlcigpIHsKICAgIHJldHVybiB0aGlzLl91c2VyOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0UmVxdWVzdFNlc3Npb24oKSB7CiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdFNlc3Npb247CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRSZXF1ZXN0U2Vzc2lvbihyZXF1ZXN0U2Vzc2lvbikgewogICAgdGhpcy5fcmVxdWVzdFNlc3Npb24gPSByZXF1ZXN0U2Vzc2lvbjsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgc2V0VGFncyh0YWdzKSB7CiAgICB0aGlzLl90YWdzID0gewogICAgICAuLi50aGlzLl90YWdzLAogICAgICAuLi50YWdzLAogICAgfTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldFRhZyhrZXksIHZhbHVlKSB7CiAgICB0aGlzLl90YWdzID0geyAuLi50aGlzLl90YWdzLCBba2V5XTogdmFsdWUgfTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldEV4dHJhcyhleHRyYXMpIHsKICAgIHRoaXMuX2V4dHJhID0gewogICAgICAuLi50aGlzLl9leHRyYSwKICAgICAgLi4uZXh0cmFzLAogICAgfTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldEV4dHJhKGtleSwgZXh0cmEpIHsKICAgIHRoaXMuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSwgW2tleV06IGV4dHJhIH07CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRGaW5nZXJwcmludChmaW5nZXJwcmludCkgewogICAgdGhpcy5fZmluZ2VycHJpbnQgPSBmaW5nZXJwcmludDsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIHNldExldmVsKAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBsZXZlbCwKICApIHsKICAgIHRoaXMuX2xldmVsID0gbGV2ZWw7CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBTZXRzIHRoZSB0cmFuc2FjdGlvbiBuYW1lIG9uIHRoZSBzY29wZSBmb3IgZnV0dXJlIGV2ZW50cy4KICAgKi8KICAgc2V0VHJhbnNhY3Rpb25OYW1lKG5hbWUpIHsKICAgIHRoaXMuX3RyYW5zYWN0aW9uTmFtZSA9IG5hbWU7CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRDb250ZXh0KGtleSwgY29udGV4dCkgewogICAgaWYgKGNvbnRleHQgPT09IG51bGwpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1keW5hbWljLWRlbGV0ZQogICAgICBkZWxldGUgdGhpcy5fY29udGV4dHNba2V5XTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX2NvbnRleHRzW2tleV0gPSBjb250ZXh0OwogICAgfQoKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIFNldHMgdGhlIFNwYW4gb24gdGhlIHNjb3BlLgogICAqIEBwYXJhbSBzcGFuIFNwYW4KICAgKiBAZGVwcmVjYXRlZCBJbnN0ZWFkIG9mIHNldHRpbmcgYSBzcGFuIG9uIGEgc2NvcGUsIHVzZSBgc3RhcnRTcGFuKClgL2BzdGFydFNwYW5NYW51YWwoKWAgaW5zdGVhZC4KICAgKi8KICAgc2V0U3BhbihzcGFuKSB7CiAgICB0aGlzLl9zcGFuID0gc3BhbjsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIFJldHVybnMgdGhlIGBTcGFuYCBpZiB0aGVyZSBpcyBvbmUuCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBnZXRBY3RpdmVTcGFuKClgIGluc3RlYWQuCiAgICovCiAgIGdldFNwYW4oKSB7CiAgICByZXR1cm4gdGhpcy5fc3BhbjsKICB9CgogIC8qKgogICAqIFJldHVybnMgdGhlIGBUcmFuc2FjdGlvbmAgYXR0YWNoZWQgdG8gdGhlIHNjb3BlIChpZiB0aGVyZSBpcyBvbmUpLgogICAqIEBkZXByZWNhdGVkIFlvdSBzaG91bGQgbm90IHJlbHkgb24gdGhlIHRyYW5zYWN0aW9uLCBidXQganVzdCB1c2UgYHN0YXJ0U3BhbigpYCBBUElzIGluc3RlYWQuCiAgICovCiAgIGdldFRyYW5zYWN0aW9uKCkgewogICAgLy8gT2Z0ZW4sIHRoaXMgc3BhbiAoaWYgaXQgZXhpc3RzIGF0IGFsbCkgd2lsbCBiZSBhIHRyYW5zYWN0aW9uLCBidXQgaXQncyBub3QgZ3VhcmFudGVlZCB0byBiZS4gUmVnYXJkbGVzcywgaXQgd2lsbAogICAgLy8gaGF2ZSBhIHBvaW50ZXIgdG8gdGhlIGN1cnJlbnRseS1hY3RpdmUgdHJhbnNhY3Rpb24uCiAgICBjb25zdCBzcGFuID0gdGhpcy5fc3BhbjsKICAgIC8vIENhbm5vdCByZXBsYWNlIHdpdGggZ2V0Um9vdFNwYW4gYmVjYXVzZSBnZXRSb290U3BhbiByZXR1cm5zIGEgc3Bhbiwgbm90IGEgdHJhbnNhY3Rpb24KICAgIC8vIEFsc28sIHRoaXMgbWV0aG9kIHdpbGwgYmUgcmVtb3ZlZCBhbnl3YXkuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHJldHVybiBzcGFuICYmIHNwYW4udHJhbnNhY3Rpb247CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRTZXNzaW9uKHNlc3Npb24pIHsKICAgIGlmICghc2Vzc2lvbikgewogICAgICBkZWxldGUgdGhpcy5fc2Vzc2lvbjsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuX3Nlc3Npb24gPSBzZXNzaW9uOwogICAgfQogICAgdGhpcy5fbm90aWZ5U2NvcGVMaXN0ZW5lcnMoKTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0U2Vzc2lvbigpIHsKICAgIHJldHVybiB0aGlzLl9zZXNzaW9uOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgdXBkYXRlKGNhcHR1cmVDb250ZXh0KSB7CiAgICBpZiAoIWNhcHR1cmVDb250ZXh0KSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGNvbnN0IHNjb3BlVG9NZXJnZSA9IHR5cGVvZiBjYXB0dXJlQ29udGV4dCA9PT0gJ2Z1bmN0aW9uJyA/IGNhcHR1cmVDb250ZXh0KHRoaXMpIDogY2FwdHVyZUNvbnRleHQ7CgogICAgaWYgKHNjb3BlVG9NZXJnZSBpbnN0YW5jZW9mIFNjb3BlKSB7CiAgICAgIGNvbnN0IHNjb3BlRGF0YSA9IHNjb3BlVG9NZXJnZS5nZXRTY29wZURhdGEoKTsKCiAgICAgIHRoaXMuX3RhZ3MgPSB7IC4uLnRoaXMuX3RhZ3MsIC4uLnNjb3BlRGF0YS50YWdzIH07CiAgICAgIHRoaXMuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSwgLi4uc2NvcGVEYXRhLmV4dHJhIH07CiAgICAgIHRoaXMuX2NvbnRleHRzID0geyAuLi50aGlzLl9jb250ZXh0cywgLi4uc2NvcGVEYXRhLmNvbnRleHRzIH07CiAgICAgIGlmIChzY29wZURhdGEudXNlciAmJiBPYmplY3Qua2V5cyhzY29wZURhdGEudXNlcikubGVuZ3RoKSB7CiAgICAgICAgdGhpcy5fdXNlciA9IHNjb3BlRGF0YS51c2VyOwogICAgICB9CiAgICAgIGlmIChzY29wZURhdGEubGV2ZWwpIHsKICAgICAgICB0aGlzLl9sZXZlbCA9IHNjb3BlRGF0YS5sZXZlbDsKICAgICAgfQogICAgICBpZiAoc2NvcGVEYXRhLmZpbmdlcnByaW50Lmxlbmd0aCkgewogICAgICAgIHRoaXMuX2ZpbmdlcnByaW50ID0gc2NvcGVEYXRhLmZpbmdlcnByaW50OwogICAgICB9CiAgICAgIGlmIChzY29wZVRvTWVyZ2UuZ2V0UmVxdWVzdFNlc3Npb24oKSkgewogICAgICAgIHRoaXMuX3JlcXVlc3RTZXNzaW9uID0gc2NvcGVUb01lcmdlLmdldFJlcXVlc3RTZXNzaW9uKCk7CiAgICAgIH0KICAgICAgaWYgKHNjb3BlRGF0YS5wcm9wYWdhdGlvbkNvbnRleHQpIHsKICAgICAgICB0aGlzLl9wcm9wYWdhdGlvbkNvbnRleHQgPSBzY29wZURhdGEucHJvcGFnYXRpb25Db250ZXh0OwogICAgICB9CiAgICB9IGVsc2UgaWYgKGlzUGxhaW5PYmplY3Qoc2NvcGVUb01lcmdlKSkgewogICAgICBjb25zdCBzY29wZUNvbnRleHQgPSBjYXB0dXJlQ29udGV4dCA7CiAgICAgIHRoaXMuX3RhZ3MgPSB7IC4uLnRoaXMuX3RhZ3MsIC4uLnNjb3BlQ29udGV4dC50YWdzIH07CiAgICAgIHRoaXMuX2V4dHJhID0geyAuLi50aGlzLl9leHRyYSwgLi4uc2NvcGVDb250ZXh0LmV4dHJhIH07CiAgICAgIHRoaXMuX2NvbnRleHRzID0geyAuLi50aGlzLl9jb250ZXh0cywgLi4uc2NvcGVDb250ZXh0LmNvbnRleHRzIH07CiAgICAgIGlmIChzY29wZUNvbnRleHQudXNlcikgewogICAgICAgIHRoaXMuX3VzZXIgPSBzY29wZUNvbnRleHQudXNlcjsKICAgICAgfQogICAgICBpZiAoc2NvcGVDb250ZXh0LmxldmVsKSB7CiAgICAgICAgdGhpcy5fbGV2ZWwgPSBzY29wZUNvbnRleHQubGV2ZWw7CiAgICAgIH0KICAgICAgaWYgKHNjb3BlQ29udGV4dC5maW5nZXJwcmludCkgewogICAgICAgIHRoaXMuX2ZpbmdlcnByaW50ID0gc2NvcGVDb250ZXh0LmZpbmdlcnByaW50OwogICAgICB9CiAgICAgIGlmIChzY29wZUNvbnRleHQucmVxdWVzdFNlc3Npb24pIHsKICAgICAgICB0aGlzLl9yZXF1ZXN0U2Vzc2lvbiA9IHNjb3BlQ29udGV4dC5yZXF1ZXN0U2Vzc2lvbjsKICAgICAgfQogICAgICBpZiAoc2NvcGVDb250ZXh0LnByb3BhZ2F0aW9uQ29udGV4dCkgewogICAgICAgIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCA9IHNjb3BlQ29udGV4dC5wcm9wYWdhdGlvbkNvbnRleHQ7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIGNsZWFyKCkgewogICAgdGhpcy5fYnJlYWRjcnVtYnMgPSBbXTsKICAgIHRoaXMuX3RhZ3MgPSB7fTsKICAgIHRoaXMuX2V4dHJhID0ge307CiAgICB0aGlzLl91c2VyID0ge307CiAgICB0aGlzLl9jb250ZXh0cyA9IHt9OwogICAgdGhpcy5fbGV2ZWwgPSB1bmRlZmluZWQ7CiAgICB0aGlzLl90cmFuc2FjdGlvbk5hbWUgPSB1bmRlZmluZWQ7CiAgICB0aGlzLl9maW5nZXJwcmludCA9IHVuZGVmaW5lZDsKICAgIHRoaXMuX3JlcXVlc3RTZXNzaW9uID0gdW5kZWZpbmVkOwogICAgdGhpcy5fc3BhbiA9IHVuZGVmaW5lZDsKICAgIHRoaXMuX3Nlc3Npb24gPSB1bmRlZmluZWQ7CiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwogICAgdGhpcy5fYXR0YWNobWVudHMgPSBbXTsKICAgIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dCA9IGdlbmVyYXRlUHJvcGFnYXRpb25Db250ZXh0KCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIGFkZEJyZWFkY3J1bWIoYnJlYWRjcnVtYiwgbWF4QnJlYWRjcnVtYnMpIHsKICAgIGNvbnN0IG1heENydW1icyA9IHR5cGVvZiBtYXhCcmVhZGNydW1icyA9PT0gJ251bWJlcicgPyBtYXhCcmVhZGNydW1icyA6IERFRkFVTFRfTUFYX0JSRUFEQ1JVTUJTOwoKICAgIC8vIE5vIGRhdGEgaGFzIGJlZW4gY2hhbmdlZCwgc28gZG9uJ3Qgbm90aWZ5IHNjb3BlIGxpc3RlbmVycwogICAgaWYgKG1heENydW1icyA8PSAwKSB7CiAgICAgIHJldHVybiB0aGlzOwogICAgfQoKICAgIGNvbnN0IG1lcmdlZEJyZWFkY3J1bWIgPSB7CiAgICAgIHRpbWVzdGFtcDogZGF0ZVRpbWVzdGFtcEluU2Vjb25kcygpLAogICAgICAuLi5icmVhZGNydW1iLAogICAgfTsKCiAgICBjb25zdCBicmVhZGNydW1icyA9IHRoaXMuX2JyZWFkY3J1bWJzOwogICAgYnJlYWRjcnVtYnMucHVzaChtZXJnZWRCcmVhZGNydW1iKTsKICAgIHRoaXMuX2JyZWFkY3J1bWJzID0gYnJlYWRjcnVtYnMubGVuZ3RoID4gbWF4Q3J1bWJzID8gYnJlYWRjcnVtYnMuc2xpY2UoLW1heENydW1icykgOiBicmVhZGNydW1iczsKCiAgICB0aGlzLl9ub3RpZnlTY29wZUxpc3RlbmVycygpOwoKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0TGFzdEJyZWFkY3J1bWIoKSB7CiAgICByZXR1cm4gdGhpcy5fYnJlYWRjcnVtYnNbdGhpcy5fYnJlYWRjcnVtYnMubGVuZ3RoIC0gMV07CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBjbGVhckJyZWFkY3J1bWJzKCkgewogICAgdGhpcy5fYnJlYWRjcnVtYnMgPSBbXTsKICAgIHRoaXMuX25vdGlmeVNjb3BlTGlzdGVuZXJzKCk7CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgIGFkZEF0dGFjaG1lbnQoYXR0YWNobWVudCkgewogICAgdGhpcy5fYXR0YWNobWVudHMucHVzaChhdHRhY2htZW50KTsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgYGdldFNjb3BlRGF0YSgpYCBpbnN0ZWFkLgogICAqLwogICBnZXRBdHRhY2htZW50cygpIHsKICAgIGNvbnN0IGRhdGEgPSB0aGlzLmdldFNjb3BlRGF0YSgpOwoKICAgIHJldHVybiBkYXRhLmF0dGFjaG1lbnRzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgY2xlYXJBdHRhY2htZW50cygpIHsKICAgIHRoaXMuX2F0dGFjaG1lbnRzID0gW107CiAgICByZXR1cm4gdGhpczsKICB9CgogIC8qKiBAaW5oZXJpdERvYyAqLwogICBnZXRTY29wZURhdGEoKSB7CiAgICBjb25zdCB7CiAgICAgIF9icmVhZGNydW1icywKICAgICAgX2F0dGFjaG1lbnRzLAogICAgICBfY29udGV4dHMsCiAgICAgIF90YWdzLAogICAgICBfZXh0cmEsCiAgICAgIF91c2VyLAogICAgICBfbGV2ZWwsCiAgICAgIF9maW5nZXJwcmludCwKICAgICAgX2V2ZW50UHJvY2Vzc29ycywKICAgICAgX3Byb3BhZ2F0aW9uQ29udGV4dCwKICAgICAgX3Nka1Byb2Nlc3NpbmdNZXRhZGF0YSwKICAgICAgX3RyYW5zYWN0aW9uTmFtZSwKICAgICAgX3NwYW4sCiAgICB9ID0gdGhpczsKCiAgICByZXR1cm4gewogICAgICBicmVhZGNydW1iczogX2JyZWFkY3J1bWJzLAogICAgICBhdHRhY2htZW50czogX2F0dGFjaG1lbnRzLAogICAgICBjb250ZXh0czogX2NvbnRleHRzLAogICAgICB0YWdzOiBfdGFncywKICAgICAgZXh0cmE6IF9leHRyYSwKICAgICAgdXNlcjogX3VzZXIsCiAgICAgIGxldmVsOiBfbGV2ZWwsCiAgICAgIGZpbmdlcnByaW50OiBfZmluZ2VycHJpbnQgfHwgW10sCiAgICAgIGV2ZW50UHJvY2Vzc29yczogX2V2ZW50UHJvY2Vzc29ycywKICAgICAgcHJvcGFnYXRpb25Db250ZXh0OiBfcHJvcGFnYXRpb25Db250ZXh0LAogICAgICBzZGtQcm9jZXNzaW5nTWV0YWRhdGE6IF9zZGtQcm9jZXNzaW5nTWV0YWRhdGEsCiAgICAgIHRyYW5zYWN0aW9uTmFtZTogX3RyYW5zYWN0aW9uTmFtZSwKICAgICAgc3BhbjogX3NwYW4sCiAgICB9OwogIH0KCiAgLyoqCiAgICogQXBwbGllcyBkYXRhIGZyb20gdGhlIHNjb3BlIHRvIHRoZSBldmVudCBhbmQgcnVucyBhbGwgZXZlbnQgcHJvY2Vzc29ycyBvbiBpdC4KICAgKgogICAqIEBwYXJhbSBldmVudCBFdmVudAogICAqIEBwYXJhbSBoaW50IE9iamVjdCBjb250YWluaW5nIGFkZGl0aW9uYWwgaW5mb3JtYXRpb24gYWJvdXQgdGhlIG9yaWdpbmFsIGV4Y2VwdGlvbiwgZm9yIHVzZSBieSB0aGUgZXZlbnQgcHJvY2Vzc29ycy4KICAgKiBAaGlkZGVuCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBhcHBseVNjb3BlRGF0YVRvRXZlbnQoKWAgZGlyZWN0bHkKICAgKi8KICAgYXBwbHlUb0V2ZW50KAogICAgZXZlbnQsCiAgICBoaW50ID0ge30sCiAgICBhZGRpdGlvbmFsRXZlbnRQcm9jZXNzb3JzID0gW10sCiAgKSB7CiAgICBhcHBseVNjb3BlRGF0YVRvRXZlbnQoZXZlbnQsIHRoaXMuZ2V0U2NvcGVEYXRhKCkpOwoKICAgIC8vIFRPRE8gKHY4KTogVXBkYXRlIHRoaXMgb3JkZXIgdG8gYmU6IEdsb2JhbCA+IENsaWVudCA+IFNjb3BlCiAgICBjb25zdCBldmVudFByb2Nlc3NvcnMgPSBbCiAgICAgIC4uLmFkZGl0aW9uYWxFdmVudFByb2Nlc3NvcnMsCiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICAuLi5nZXRHbG9iYWxFdmVudFByb2Nlc3NvcnMoKSwKICAgICAgLi4udGhpcy5fZXZlbnRQcm9jZXNzb3JzLAogICAgXTsKCiAgICByZXR1cm4gbm90aWZ5RXZlbnRQcm9jZXNzb3JzKGV2ZW50UHJvY2Vzc29ycywgZXZlbnQsIGhpbnQpOwogIH0KCiAgLyoqCiAgICogQWRkIGRhdGEgd2hpY2ggd2lsbCBiZSBhY2Nlc3NpYmxlIGR1cmluZyBldmVudCBwcm9jZXNzaW5nIGJ1dCB3b24ndCBnZXQgc2VudCB0byBTZW50cnkKICAgKi8KICAgc2V0U0RLUHJvY2Vzc2luZ01ldGFkYXRhKG5ld0RhdGEpIHsKICAgIHRoaXMuX3Nka1Byb2Nlc3NpbmdNZXRhZGF0YSA9IHsgLi4udGhpcy5fc2RrUHJvY2Vzc2luZ01ldGFkYXRhLCAuLi5uZXdEYXRhIH07CgogICAgcmV0dXJuIHRoaXM7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqLwogICBzZXRQcm9wYWdhdGlvbkNvbnRleHQoY29udGV4dCkgewogICAgdGhpcy5fcHJvcGFnYXRpb25Db250ZXh0ID0gY29udGV4dDsKICAgIHJldHVybiB0aGlzOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKi8KICAgZ2V0UHJvcGFnYXRpb25Db250ZXh0KCkgewogICAgcmV0dXJuIHRoaXMuX3Byb3BhZ2F0aW9uQ29udGV4dDsKICB9CgogIC8qKgogICAqIENhcHR1cmUgYW4gZXhjZXB0aW9uIGZvciB0aGlzIHNjb3BlLgogICAqCiAgICogQHBhcmFtIGV4Y2VwdGlvbiBUaGUgZXhjZXB0aW9uIHRvIGNhcHR1cmUuCiAgICogQHBhcmFtIGhpbnQgT3B0aW5hbCBhZGRpdGlvbmFsIGRhdGEgdG8gYXR0YWNoIHRvIHRoZSBTZW50cnkgZXZlbnQuCiAgICogQHJldHVybnMgdGhlIGlkIG9mIHRoZSBjYXB0dXJlZCBTZW50cnkgZXZlbnQuCiAgICovCiAgIGNhcHR1cmVFeGNlcHRpb24oZXhjZXB0aW9uLCBoaW50KSB7CiAgICBjb25zdCBldmVudElkID0gaGludCAmJiBoaW50LmV2ZW50X2lkID8gaGludC5ldmVudF9pZCA6IHV1aWQ0KCk7CgogICAgaWYgKCF0aGlzLl9jbGllbnQpIHsKICAgICAgbG9nZ2VyLndhcm4oJ05vIGNsaWVudCBjb25maWd1cmVkIG9uIHNjb3BlIC0gd2lsbCBub3QgY2FwdHVyZSBleGNlcHRpb24hJyk7CiAgICAgIHJldHVybiBldmVudElkOwogICAgfQoKICAgIGNvbnN0IHN5bnRoZXRpY0V4Y2VwdGlvbiA9IG5ldyBFcnJvcignU2VudHJ5IHN5bnRoZXRpY0V4Y2VwdGlvbicpOwoKICAgIHRoaXMuX2NsaWVudC5jYXB0dXJlRXhjZXB0aW9uKAogICAgICBleGNlcHRpb24sCiAgICAgIHsKICAgICAgICBvcmlnaW5hbEV4Y2VwdGlvbjogZXhjZXB0aW9uLAogICAgICAgIHN5bnRoZXRpY0V4Y2VwdGlvbiwKICAgICAgICAuLi5oaW50LAogICAgICAgIGV2ZW50X2lkOiBldmVudElkLAogICAgICB9LAogICAgICB0aGlzLAogICAgKTsKCiAgICByZXR1cm4gZXZlbnRJZDsKICB9CgogIC8qKgogICAqIENhcHR1cmUgYSBtZXNzYWdlIGZvciB0aGlzIHNjb3BlLgogICAqCiAgICogQHBhcmFtIG1lc3NhZ2UgVGhlIG1lc3NhZ2UgdG8gY2FwdHVyZS4KICAgKiBAcGFyYW0gbGV2ZWwgQW4gb3B0aW9uYWwgc2V2ZXJpdHkgbGV2ZWwgdG8gcmVwb3J0IHRoZSBtZXNzYWdlIHdpdGguCiAgICogQHBhcmFtIGhpbnQgT3B0aW9uYWwgYWRkaXRpb25hbCBkYXRhIHRvIGF0dGFjaCB0byB0aGUgU2VudHJ5IGV2ZW50LgogICAqIEByZXR1cm5zIHRoZSBpZCBvZiB0aGUgY2FwdHVyZWQgbWVzc2FnZS4KICAgKi8KICAgY2FwdHVyZU1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIGhpbnQpIHsKICAgIGNvbnN0IGV2ZW50SWQgPSBoaW50ICYmIGhpbnQuZXZlbnRfaWQgPyBoaW50LmV2ZW50X2lkIDogdXVpZDQoKTsKCiAgICBpZiAoIXRoaXMuX2NsaWVudCkgewogICAgICBsb2dnZXIud2FybignTm8gY2xpZW50IGNvbmZpZ3VyZWQgb24gc2NvcGUgLSB3aWxsIG5vdCBjYXB0dXJlIG1lc3NhZ2UhJyk7CiAgICAgIHJldHVybiBldmVudElkOwogICAgfQoKICAgIGNvbnN0IHN5bnRoZXRpY0V4Y2VwdGlvbiA9IG5ldyBFcnJvcihtZXNzYWdlKTsKCiAgICB0aGlzLl9jbGllbnQuY2FwdHVyZU1lc3NhZ2UoCiAgICAgIG1lc3NhZ2UsCiAgICAgIGxldmVsLAogICAgICB7CiAgICAgICAgb3JpZ2luYWxFeGNlcHRpb246IG1lc3NhZ2UsCiAgICAgICAgc3ludGhldGljRXhjZXB0aW9uLAogICAgICAgIC4uLmhpbnQsCiAgICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsCiAgICAgIH0sCiAgICAgIHRoaXMsCiAgICApOwoKICAgIHJldHVybiBldmVudElkOwogIH0KCiAgLyoqCiAgICogQ2FwdHVyZXMgYSBtYW51YWxseSBjcmVhdGVkIGV2ZW50IGZvciB0aGlzIHNjb3BlIGFuZCBzZW5kcyBpdCB0byBTZW50cnkuCiAgICoKICAgKiBAcGFyYW0gZXhjZXB0aW9uIFRoZSBldmVudCB0byBjYXB0dXJlLgogICAqIEBwYXJhbSBoaW50IE9wdGlvbmFsIGFkZGl0aW9uYWwgZGF0YSB0byBhdHRhY2ggdG8gdGhlIFNlbnRyeSBldmVudC4KICAgKiBAcmV0dXJucyB0aGUgaWQgb2YgdGhlIGNhcHR1cmVkIGV2ZW50LgogICAqLwogICBjYXB0dXJlRXZlbnQoZXZlbnQsIGhpbnQpIHsKICAgIGNvbnN0IGV2ZW50SWQgPSBoaW50ICYmIGhpbnQuZXZlbnRfaWQgPyBoaW50LmV2ZW50X2lkIDogdXVpZDQoKTsKCiAgICBpZiAoIXRoaXMuX2NsaWVudCkgewogICAgICBsb2dnZXIud2FybignTm8gY2xpZW50IGNvbmZpZ3VyZWQgb24gc2NvcGUgLSB3aWxsIG5vdCBjYXB0dXJlIGV2ZW50IScpOwogICAgICByZXR1cm4gZXZlbnRJZDsKICAgIH0KCiAgICB0aGlzLl9jbGllbnQuY2FwdHVyZUV2ZW50KGV2ZW50LCB7IC4uLmhpbnQsIGV2ZW50X2lkOiBldmVudElkIH0sIHRoaXMpOwoKICAgIHJldHVybiBldmVudElkOwogIH0KCiAgLyoqCiAgICogVGhpcyB3aWxsIGJlIGNhbGxlZCBvbiBldmVyeSBzZXQgY2FsbC4KICAgKi8KICAgX25vdGlmeVNjb3BlTGlzdGVuZXJzKCkgewogICAgLy8gV2UgbmVlZCB0aGlzIGNoZWNrIGZvciB0aGlzLl9ub3RpZnlpbmdMaXN0ZW5lcnMgdG8gYmUgYWJsZSB0byB3b3JrIG9uIHNjb3BlIGR1cmluZyB1cGRhdGVzCiAgICAvLyBJZiB0aGlzIGNoZWNrIGlzIG5vdCBoZXJlIHdlJ2xsIHByb2R1Y2UgZW5kbGVzcyByZWN1cnNpb24gd2hlbiBzb21ldGhpbmcgaXMgZG9uZSB3aXRoIHRoZSBzY29wZQogICAgLy8gZHVyaW5nIHRoZSBjYWxsYmFjay4KICAgIGlmICghdGhpcy5fbm90aWZ5aW5nTGlzdGVuZXJzKSB7CiAgICAgIHRoaXMuX25vdGlmeWluZ0xpc3RlbmVycyA9IHRydWU7CiAgICAgIHRoaXMuX3Njb3BlTGlzdGVuZXJzLmZvckVhY2goY2FsbGJhY2sgPT4gewogICAgICAgIGNhbGxiYWNrKHRoaXMpOwogICAgICB9KTsKICAgICAgdGhpcy5fbm90aWZ5aW5nTGlzdGVuZXJzID0gZmFsc2U7CiAgICB9CiAgfQp9CgpmdW5jdGlvbiBnZW5lcmF0ZVByb3BhZ2F0aW9uQ29udGV4dCgpIHsKICByZXR1cm4gewogICAgdHJhY2VJZDogdXVpZDQoKSwKICAgIHNwYW5JZDogdXVpZDQoKS5zdWJzdHJpbmcoMTYpLAogIH07Cn0KCmNvbnN0IFNES19WRVJTSU9OID0gJzcuMTIwLjMnOwoKLyoqCiAqIEFQSSBjb21wYXRpYmlsaXR5IHZlcnNpb24gb2YgdGhpcyBodWIuCiAqCiAqIFdBUk5JTkc6IFRoaXMgbnVtYmVyIHNob3VsZCBvbmx5IGJlIGluY3JlYXNlZCB3aGVuIHRoZSBnbG9iYWwgaW50ZXJmYWNlCiAqIGNoYW5nZXMgYW5kIG5ldyBtZXRob2RzIGFyZSBpbnRyb2R1Y2VkLgogKgogKiBAaGlkZGVuCiAqLwpjb25zdCBBUElfVkVSU0lPTiA9IHBhcnNlRmxvYXQoU0RLX1ZFUlNJT04pOwoKLyoqCiAqIERlZmF1bHQgbWF4aW11bSBudW1iZXIgb2YgYnJlYWRjcnVtYnMgYWRkZWQgdG8gYW4gZXZlbnQuIENhbiBiZSBvdmVyd3JpdHRlbgogKiB3aXRoIHtAbGluayBPcHRpb25zLm1heEJyZWFkY3J1bWJzfS4KICovCmNvbnN0IERFRkFVTFRfQlJFQURDUlVNQlMgPSAxMDA7CgovKioKICogQGRlcHJlY2F0ZWQgVGhlIGBIdWJgIGNsYXNzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2ZXJzaW9uIDggb2YgdGhlIFNESyBpbiBmYXZvdXIgb2YgYFNjb3BlYCBhbmQgYENsaWVudGAgb2JqZWN0cy4KICoKICogSWYgeW91IHByZXZpb3VzbHkgdXNlZCB0aGUgYEh1YmAgY2xhc3MgZGlyZWN0bHksIHJlcGxhY2UgaXQgd2l0aCBgU2NvcGVgIGFuZCBgQ2xpZW50YCBvYmplY3RzLiBNb3JlIGluZm9ybWF0aW9uOgogKiAtIFtNdWx0aXBsZSBTZW50cnkgSW5zdGFuY2VzXShodHRwczovL2RvY3Muc2VudHJ5LmlvL3BsYXRmb3Jtcy9qYXZhc2NyaXB0L2Jlc3QtcHJhY3RpY2VzL211bHRpcGxlLXNlbnRyeS1pbnN0YW5jZXMvKQogKiAtIFtCcm93c2VyIEV4dGVuc2lvbnNdKGh0dHBzOi8vZG9jcy5zZW50cnkuaW8vcGxhdGZvcm1zL2phdmFzY3JpcHQvYmVzdC1wcmFjdGljZXMvYnJvd3Nlci1leHRlbnNpb25zLykKICoKICogU29tZSBvZiBvdXIgQVBJcyBhcmUgdHlwZWQgd2l0aCB0aGUgSHViIGNsYXNzIGluc3RlYWQgb2YgdGhlIGludGVyZmFjZSAoZS5nLiBgZ2V0Q3VycmVudEh1YmApLiBNb3N0IG9mIHRoZW0gYXJlIGRlcHJlY2F0ZWQKICogdGhlbXNlbHZlcyBhbmQgd2lsbCBhbHNvIGJlIHJlbW92ZWQgaW4gdmVyc2lvbiA4LiBNb3JlIGluZm9ybWF0aW9uOgogKiAtIFtNaWdyYXRpb24gR3VpZGVdKGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvYmxvYi9kZXZlbG9wL01JR1JBVElPTi5tZCNkZXByZWNhdGUtaHViKQogKi8KLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCmNsYXNzIEh1YiAgewogIC8qKiBJcyBhIHtAbGluayBMYXllcn1bXSBjb250YWluaW5nIHRoZSBjbGllbnQgYW5kIHNjb3BlICovCgogIC8qKiBDb250YWlucyB0aGUgbGFzdCBldmVudCBpZCBvZiBhIGNhcHR1cmVkIGV2ZW50LiAgKi8KCiAgLyoqCiAgICogQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgaHViLCB3aWxsIHB1c2ggb25lIHtAbGluayBMYXllcn0gaW50byB0aGUKICAgKiBpbnRlcm5hbCBzdGFjayBvbiBjcmVhdGlvbi4KICAgKgogICAqIEBwYXJhbSBjbGllbnQgYm91bmQgdG8gdGhlIGh1Yi4KICAgKiBAcGFyYW0gc2NvcGUgYm91bmQgdG8gdGhlIGh1Yi4KICAgKiBAcGFyYW0gdmVyc2lvbiBudW1iZXIsIGhpZ2hlciBudW1iZXIgbWVhbnMgaGlnaGVyIHByaW9yaXR5LgogICAqCiAgICogQGRlcHJlY2F0ZWQgSW5zdGFudGlhdGlvbiBvZiBIdWIgb2JqZWN0cyBpcyBkZXByZWNhdGVkIGFuZCB0aGUgY29uc3RydWN0b3Igd2lsbCBiZSByZW1vdmVkIGluIHZlcnNpb24gOCBvZiB0aGUgU0RLLgogICAqCiAgICogSWYgeW91IGFyZSBjdXJyZW50bHkgdXNpbmcgdGhlIEh1YiBmb3IgbXVsdGktY2xpZW50IHVzZSBsaWtlIHNvOgogICAqCiAgICogYGBgCiAgICogLy8gT0xECiAgICogY29uc3QgaHViID0gbmV3IEh1YigpOwogICAqIGh1Yi5iaW5kQ2xpZW50KGNsaWVudCk7CiAgICogbWFrZU1haW4oaHViKQogICAqIGBgYAogICAqCiAgICogaW5zdGVhZCBpbml0aWFsaXplIHRoZSBjbGllbnQgYXMgZm9sbG93czoKICAgKgogICAqIGBgYAogICAqIC8vIE5FVwogICAqIFNlbnRyeS53aXRoSXNvbGF0aW9uU2NvcGUoKCkgPT4gewogICAqICAgIFNlbnRyeS5zZXRDdXJyZW50Q2xpZW50KGNsaWVudCk7CiAgICogICAgY2xpZW50LmluaXQoKTsKICAgKiB9KTsKICAgKiBgYGAKICAgKgogICAqIElmIHlvdSBhcmUgdXNpbmcgdGhlIEh1YiB0byBjYXB0dXJlIGV2ZW50cyBsaWtlIHNvOgogICAqCiAgICogYGBgCiAgICogLy8gT0xECiAgICogY29uc3QgY2xpZW50ID0gbmV3IENsaWVudCgpOwogICAqIGNvbnN0IGh1YiA9IG5ldyBIdWIoY2xpZW50KTsKICAgKiBodWIuY2FwdHVyZUV4Y2VwdGlvbigpCiAgICogYGBgCiAgICoKICAgKiBpbnN0ZWFkIGNhcHR1cmUgaXNvbGF0ZWQgZXZlbnRzIGFzIGZvbGxvd3M6CiAgICoKICAgKiBgYGAKICAgKiAvLyBORVcKICAgKiBjb25zdCBjbGllbnQgPSBuZXcgQ2xpZW50KCk7CiAgICogY29uc3Qgc2NvcGUgPSBuZXcgU2NvcGUoKTsKICAgKiBzY29wZS5zZXRDbGllbnQoY2xpZW50KTsKICAgKiBzY29wZS5jYXB0dXJlRXhjZXB0aW9uKCk7CiAgICogYGBgCiAgICovCiAgIGNvbnN0cnVjdG9yKAogICAgY2xpZW50LAogICAgc2NvcGUsCiAgICBpc29sYXRpb25TY29wZSwKICAgICAgX3ZlcnNpb24gPSBBUElfVkVSU0lPTiwKICApIHt0aGlzLl92ZXJzaW9uID0gX3ZlcnNpb247CiAgICBsZXQgYXNzaWduZWRTY29wZTsKICAgIGlmICghc2NvcGUpIHsKICAgICAgYXNzaWduZWRTY29wZSA9IG5ldyBTY29wZSgpOwogICAgICBhc3NpZ25lZFNjb3BlLnNldENsaWVudChjbGllbnQpOwogICAgfSBlbHNlIHsKICAgICAgYXNzaWduZWRTY29wZSA9IHNjb3BlOwogICAgfQoKICAgIGxldCBhc3NpZ25lZElzb2xhdGlvblNjb3BlOwogICAgaWYgKCFpc29sYXRpb25TY29wZSkgewogICAgICBhc3NpZ25lZElzb2xhdGlvblNjb3BlID0gbmV3IFNjb3BlKCk7CiAgICAgIGFzc2lnbmVkSXNvbGF0aW9uU2NvcGUuc2V0Q2xpZW50KGNsaWVudCk7CiAgICB9IGVsc2UgewogICAgICBhc3NpZ25lZElzb2xhdGlvblNjb3BlID0gaXNvbGF0aW9uU2NvcGU7CiAgICB9CgogICAgdGhpcy5fc3RhY2sgPSBbeyBzY29wZTogYXNzaWduZWRTY29wZSB9XTsKCiAgICBpZiAoY2xpZW50KSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICB0aGlzLmJpbmRDbGllbnQoY2xpZW50KTsKICAgIH0KCiAgICB0aGlzLl9pc29sYXRpb25TY29wZSA9IGFzc2lnbmVkSXNvbGF0aW9uU2NvcGU7CiAgfQoKICAvKioKICAgKiBDaGVja3MgaWYgdGhpcyBodWIncyB2ZXJzaW9uIGlzIG9sZGVyIHRoYW4gdGhlIGdpdmVuIHZlcnNpb24uCiAgICoKICAgKiBAcGFyYW0gdmVyc2lvbiBBIHZlcnNpb24gbnVtYmVyIHRvIGNvbXBhcmUgdG8uCiAgICogQHJldHVybiBUcnVlIGlmIHRoZSBnaXZlbiB2ZXJzaW9uIGlzIG5ld2VyOyBvdGhlcndpc2UgZmFsc2UuCiAgICoKICAgKiBAZGVwcmVjYXRlZCBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4KICAgKi8KICAgaXNPbGRlclRoYW4odmVyc2lvbikgewogICAgcmV0dXJuIHRoaXMuX3ZlcnNpb24gPCB2ZXJzaW9uOwogIH0KCiAgLyoqCiAgICogVGhpcyBiaW5kcyB0aGUgZ2l2ZW4gY2xpZW50IHRvIHRoZSBjdXJyZW50IHNjb3BlLgogICAqIEBwYXJhbSBjbGllbnQgQW4gU0RLIGNsaWVudCAoY2xpZW50KSBpbnN0YW5jZS4KICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgaW5pdEFuZEJpbmQoKWAgZGlyZWN0bHksIG9yIGBzZXRDdXJyZW50Q2xpZW50KClgIGFuZC9vciBgY2xpZW50LmluaXQoKWAgaW5zdGVhZC4KICAgKi8KICAgYmluZENsaWVudChjbGllbnQpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3QgdG9wID0gdGhpcy5nZXRTdGFja1RvcCgpOwogICAgdG9wLmNsaWVudCA9IGNsaWVudDsKICAgIHRvcC5zY29wZS5zZXRDbGllbnQoY2xpZW50KTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgaWYgKGNsaWVudCAmJiBjbGllbnQuc2V0dXBJbnRlZ3JhdGlvbnMpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICAgIGNsaWVudC5zZXR1cEludGVncmF0aW9ucygpOwogICAgfQogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgd2l0aFNjb3BlYCBpbnN0ZWFkLgogICAqLwogICBwdXNoU2NvcGUoKSB7CiAgICAvLyBXZSB3YW50IHRvIGNsb25lIHRoZSBjb250ZW50IG9mIHByZXYgc2NvcGUKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3Qgc2NvcGUgPSB0aGlzLmdldFNjb3BlKCkuY2xvbmUoKTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTdGFjaygpLnB1c2goewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgY2xpZW50OiB0aGlzLmdldENsaWVudCgpLAogICAgICBzY29wZSwKICAgIH0pOwogICAgcmV0dXJuIHNjb3BlOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgd2l0aFNjb3BlYCBpbnN0ZWFkLgogICAqLwogICBwb3BTY29wZSgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgaWYgKHRoaXMuZ2V0U3RhY2soKS5sZW5ndGggPD0gMSkgcmV0dXJuIGZhbHNlOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICByZXR1cm4gISF0aGlzLmdldFN0YWNrKCkucG9wKCk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkud2l0aFNjb3BlKClgIGluc3RlYWQuCiAgICovCiAgIHdpdGhTY29wZShjYWxsYmFjaykgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBjb25zdCBzY29wZSA9IHRoaXMucHVzaFNjb3BlKCk7CgogICAgbGV0IG1heWJlUHJvbWlzZVJlc3VsdDsKICAgIHRyeSB7CiAgICAgIG1heWJlUHJvbWlzZVJlc3VsdCA9IGNhbGxiYWNrKHNjb3BlKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICAgIHRoaXMucG9wU2NvcGUoKTsKICAgICAgdGhyb3cgZTsKICAgIH0KCiAgICBpZiAoaXNUaGVuYWJsZShtYXliZVByb21pc2VSZXN1bHQpKSB7CiAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgLSBpc1RoZW5hYmxlIHJldHVybnMgdGhlIHdyb25nIHR5cGUKICAgICAgcmV0dXJuIG1heWJlUHJvbWlzZVJlc3VsdC50aGVuKAogICAgICAgIHJlcyA9PiB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgICAgIHRoaXMucG9wU2NvcGUoKTsKICAgICAgICAgIHJldHVybiByZXM7CiAgICAgICAgfSwKICAgICAgICBlID0+IHsKICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICAgICAgdGhpcy5wb3BTY29wZSgpOwogICAgICAgICAgdGhyb3cgZTsKICAgICAgICB9LAogICAgICApOwogICAgfQoKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5wb3BTY29wZSgpOwogICAgcmV0dXJuIG1heWJlUHJvbWlzZVJlc3VsdDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5nZXRDbGllbnQoKWAgaW5zdGVhZC4KICAgKi8KICAgZ2V0Q2xpZW50KCkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICByZXR1cm4gdGhpcy5nZXRTdGFja1RvcCgpLmNsaWVudCA7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBzY29wZSBvZiB0aGUgdG9wIHN0YWNrLgogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkuZ2V0Q3VycmVudFNjb3BlKClgIGluc3RlYWQuCiAgICovCiAgIGdldFNjb3BlKCkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICByZXR1cm4gdGhpcy5nZXRTdGFja1RvcCgpLnNjb3BlOwogIH0KCiAgLyoqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkuZ2V0SXNvbGF0aW9uU2NvcGUoKWAgaW5zdGVhZC4KICAgKi8KICAgZ2V0SXNvbGF0aW9uU2NvcGUoKSB7CiAgICByZXR1cm4gdGhpcy5faXNvbGF0aW9uU2NvcGU7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSBzY29wZSBzdGFjayBmb3IgZG9tYWlucyBvciB0aGUgcHJvY2Vzcy4KICAgKiBAZGVwcmVjYXRlZCBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OC4KICAgKi8KICAgZ2V0U3RhY2soKSB7CiAgICByZXR1cm4gdGhpcy5fc3RhY2s7CiAgfQoKICAvKioKICAgKiBSZXR1cm5zIHRoZSB0b3Btb3N0IHNjb3BlIGxheWVyIGluIHRoZSBvcmRlciBkb21haW4gPiBsb2NhbCA+IHByb2Nlc3MuCiAgICogQGRlcHJlY2F0ZWQgVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdjguCiAgICovCiAgIGdldFN0YWNrVG9wKCkgewogICAgcmV0dXJuIHRoaXMuX3N0YWNrW3RoaXMuX3N0YWNrLmxlbmd0aCAtIDFdOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LmNhcHR1cmVFeGNlcHRpb24oKWAgaW5zdGVhZC4KICAgKi8KICAgY2FwdHVyZUV4Y2VwdGlvbihleGNlcHRpb24sIGhpbnQpIHsKICAgIGNvbnN0IGV2ZW50SWQgPSAodGhpcy5fbGFzdEV2ZW50SWQgPSBoaW50ICYmIGhpbnQuZXZlbnRfaWQgPyBoaW50LmV2ZW50X2lkIDogdXVpZDQoKSk7CiAgICBjb25zdCBzeW50aGV0aWNFeGNlcHRpb24gPSBuZXcgRXJyb3IoJ1NlbnRyeSBzeW50aGV0aWNFeGNlcHRpb24nKTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTY29wZSgpLmNhcHR1cmVFeGNlcHRpb24oZXhjZXB0aW9uLCB7CiAgICAgIG9yaWdpbmFsRXhjZXB0aW9uOiBleGNlcHRpb24sCiAgICAgIHN5bnRoZXRpY0V4Y2VwdGlvbiwKICAgICAgLi4uaGludCwKICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsCiAgICB9KTsKCiAgICByZXR1cm4gZXZlbnRJZDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgIGBTZW50cnkuY2FwdHVyZU1lc3NhZ2UoKWAgaW5zdGVhZC4KICAgKi8KICAgY2FwdHVyZU1lc3NhZ2UoCiAgICBtZXNzYWdlLAogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBsZXZlbCwKICAgIGhpbnQsCiAgKSB7CiAgICBjb25zdCBldmVudElkID0gKHRoaXMuX2xhc3RFdmVudElkID0gaGludCAmJiBoaW50LmV2ZW50X2lkID8gaGludC5ldmVudF9pZCA6IHV1aWQ0KCkpOwogICAgY29uc3Qgc3ludGhldGljRXhjZXB0aW9uID0gbmV3IEVycm9yKG1lc3NhZ2UpOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldFNjb3BlKCkuY2FwdHVyZU1lc3NhZ2UobWVzc2FnZSwgbGV2ZWwsIHsKICAgICAgb3JpZ2luYWxFeGNlcHRpb246IG1lc3NhZ2UsCiAgICAgIHN5bnRoZXRpY0V4Y2VwdGlvbiwKICAgICAgLi4uaGludCwKICAgICAgZXZlbnRfaWQ6IGV2ZW50SWQsCiAgICB9KTsKCiAgICByZXR1cm4gZXZlbnRJZDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5jYXB0dXJlRXZlbnQoKWAgaW5zdGVhZC4KICAgKi8KICAgY2FwdHVyZUV2ZW50KGV2ZW50LCBoaW50KSB7CiAgICBjb25zdCBldmVudElkID0gaGludCAmJiBoaW50LmV2ZW50X2lkID8gaGludC5ldmVudF9pZCA6IHV1aWQ0KCk7CiAgICBpZiAoIWV2ZW50LnR5cGUpIHsKICAgICAgdGhpcy5fbGFzdEV2ZW50SWQgPSBldmVudElkOwogICAgfQogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldFNjb3BlKCkuY2FwdHVyZUV2ZW50KGV2ZW50LCB7IC4uLmhpbnQsIGV2ZW50X2lkOiBldmVudElkIH0pOwogICAgcmV0dXJuIGV2ZW50SWQ7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gdjguCiAgICovCiAgIGxhc3RFdmVudElkKCkgewogICAgcmV0dXJuIHRoaXMuX2xhc3RFdmVudElkOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKgogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LmFkZEJyZWFkY3J1bWIoKWAgaW5zdGVhZC4KICAgKi8KICAgYWRkQnJlYWRjcnVtYihicmVhZGNydW1iLCBoaW50KSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IHsgc2NvcGUsIGNsaWVudCB9ID0gdGhpcy5nZXRTdGFja1RvcCgpOwoKICAgIGlmICghY2xpZW50KSByZXR1cm47CgogICAgY29uc3QgeyBiZWZvcmVCcmVhZGNydW1iID0gbnVsbCwgbWF4QnJlYWRjcnVtYnMgPSBERUZBVUxUX0JSRUFEQ1JVTUJTIH0gPQogICAgICAoY2xpZW50LmdldE9wdGlvbnMgJiYgY2xpZW50LmdldE9wdGlvbnMoKSkgfHwge307CgogICAgaWYgKG1heEJyZWFkY3J1bWJzIDw9IDApIHJldHVybjsKCiAgICBjb25zdCB0aW1lc3RhbXAgPSBkYXRlVGltZXN0YW1wSW5TZWNvbmRzKCk7CiAgICBjb25zdCBtZXJnZWRCcmVhZGNydW1iID0geyB0aW1lc3RhbXAsIC4uLmJyZWFkY3J1bWIgfTsKICAgIGNvbnN0IGZpbmFsQnJlYWRjcnVtYiA9IGJlZm9yZUJyZWFkY3J1bWIKICAgICAgPyAoY29uc29sZVNhbmRib3goKCkgPT4gYmVmb3JlQnJlYWRjcnVtYihtZXJnZWRCcmVhZGNydW1iLCBoaW50KSkgKQogICAgICA6IG1lcmdlZEJyZWFkY3J1bWI7CgogICAgaWYgKGZpbmFsQnJlYWRjcnVtYiA9PT0gbnVsbCkgcmV0dXJuOwoKICAgIGlmIChjbGllbnQuZW1pdCkgewogICAgICBjbGllbnQuZW1pdCgnYmVmb3JlQWRkQnJlYWRjcnVtYicsIGZpbmFsQnJlYWRjcnVtYiwgaGludCk7CiAgICB9CgogICAgLy8gVE9ETyh2OCk6IEkga25vdyB0aGlzIGNvbW1lbnQgZG9lc24ndCBtYWtlIG11Y2ggc2Vuc2UgYmVjYXVzZSB0aGUgaHViIHdpbGwgYmUgZGVwcmVjYXRlZCBidXQgSSBzdGlsbCB3YW50ZWQgdG8KICAgIC8vIHdyaXRlIGl0IGRvd24uIEluIHRoZW9yeSwgd2Ugd291bGQgaGF2ZSB0byBhZGQgdGhlIGJyZWFkY3J1bWJzIHRvIHRoZSBpc29sYXRpb24gc2NvcGUgaGVyZSwgaG93ZXZlciwgdGhhdCB3b3VsZAogICAgLy8gZHVwbGljYXRlIGFsbCBvZiB0aGUgYnJlYWRjcnVtYnMuIFRoZXJlIHdhcyB0aGUgcG9zc2liaWxpdHkgb2YgYWRkaW5nIGJyZWFkY3J1bWJzIHRvIGJvdGgsIHRoZSBpc29sYXRpb24gc2NvcGUKICAgIC8vIGFuZCB0aGUgbm9ybWFsIHNjb3BlLCBhbmQgZGVkdXBsaWNhdGluZyBpdCBkb3duIHRoZSBsaW5lIGluIHRoZSBldmVudCBwcm9jZXNzaW5nIHBpcGVsaW5lLiBIb3dldmVyLCB0aGF0IHdvdWxkCiAgICAvLyBoYXZlIGJlZW4gdmVyeSBmcmFnaWxlLCBiZWNhdXNlIHRoZSBicmVhZGNydW1iIG9iamVjdHMgd291bGQgaGF2ZSBuZWVkZWQgdG8ga2VlcCB0aGVpciBpZGVudGl0eSBhbGwgdGhyb3VnaG91dAogICAgLy8gdGhlIGV2ZW50IHByb2Nlc3NpbmcgcGlwZWxpbmUuCiAgICAvLyBJbiB0aGUgbmV3IGltcGxlbWVudGF0aW9uLCB0aGUgdG9wIGxldmVsIGBTZW50cnkuYWRkQnJlYWRjcnVtYigpYCBzaG91bGQgT05MWSB3cml0ZSB0byB0aGUgaXNvbGF0aW9uIHNjb3BlLgoKICAgIHNjb3BlLmFkZEJyZWFkY3J1bWIoZmluYWxCcmVhZGNydW1iLCBtYXhCcmVhZGNydW1icyk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LnNldFVzZXIoKWAgaW5zdGVhZC4KICAgKi8KICAgc2V0VXNlcih1c2VyKSB7CiAgICAvLyBUT0RPKHY4KTogVGhlIHRvcCBsZXZlbCBgU2VudHJ5LnNldFVzZXIoKWAgZnVuY3Rpb24gc2hvdWxkIHdyaXRlIE9OTFkgdG8gdGhlIGlzb2xhdGlvbiBzY29wZS4KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTY29wZSgpLnNldFVzZXIodXNlcik7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0SXNvbGF0aW9uU2NvcGUoKS5zZXRVc2VyKHVzZXIpOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5zZXRUYWdzKClgIGluc3RlYWQuCiAgICovCiAgIHNldFRhZ3ModGFncykgewogICAgLy8gVE9ETyh2OCk6IFRoZSB0b3AgbGV2ZWwgYFNlbnRyeS5zZXRUYWdzKClgIGZ1bmN0aW9uIHNob3VsZCB3cml0ZSBPTkxZIHRvIHRoZSBpc29sYXRpb24gc2NvcGUuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0U2NvcGUoKS5zZXRUYWdzKHRhZ3MpOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldElzb2xhdGlvblNjb3BlKCkuc2V0VGFncyh0YWdzKTsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBTZW50cnkuc2V0RXh0cmFzKClgIGluc3RlYWQuCiAgICovCiAgIHNldEV4dHJhcyhleHRyYXMpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0RXh0cmFzKClgIGZ1bmN0aW9uIHNob3VsZCB3cml0ZSBPTkxZIHRvIHRoZSBpc29sYXRpb24gc2NvcGUuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0U2NvcGUoKS5zZXRFeHRyYXMoZXh0cmFzKTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRJc29sYXRpb25TY29wZSgpLnNldEV4dHJhcyhleHRyYXMpOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgYFNlbnRyeS5zZXRUYWcoKWAgaW5zdGVhZC4KICAgKi8KICAgc2V0VGFnKGtleSwgdmFsdWUpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0VGFnKClgIGZ1bmN0aW9uIHNob3VsZCB3cml0ZSBPTkxZIHRvIHRoZSBpc29sYXRpb24gc2NvcGUuCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0U2NvcGUoKS5zZXRUYWcoa2V5LCB2YWx1ZSk7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIHRoaXMuZ2V0SXNvbGF0aW9uU2NvcGUoKS5zZXRUYWcoa2V5LCB2YWx1ZSk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LnNldEV4dHJhKClgIGluc3RlYWQuCiAgICovCiAgIHNldEV4dHJhKGtleSwgZXh0cmEpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0RXh0cmEoKWAgZnVuY3Rpb24gc2hvdWxkIHdyaXRlIE9OTFkgdG8gdGhlIGlzb2xhdGlvbiBzY29wZS4KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRTY29wZSgpLnNldEV4dHJhKGtleSwgZXh0cmEpOwogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldElzb2xhdGlvblNjb3BlKCkuc2V0RXh0cmEoa2V5LCBleHRyYSk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LnNldENvbnRleHQoKWAgaW5zdGVhZC4KICAgKi8KICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICBzZXRDb250ZXh0KG5hbWUsIGNvbnRleHQpIHsKICAgIC8vIFRPRE8odjgpOiBUaGUgdG9wIGxldmVsIGBTZW50cnkuc2V0Q29udGV4dCgpYCBmdW5jdGlvbiBzaG91bGQgd3JpdGUgT05MWSB0byB0aGUgaXNvbGF0aW9uIHNjb3BlLgogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICB0aGlzLmdldFNjb3BlKCkuc2V0Q29udGV4dChuYW1lLCBjb250ZXh0KTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5nZXRJc29sYXRpb25TY29wZSgpLnNldENvbnRleHQobmFtZSwgY29udGV4dCk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBnZXRTY29wZSgpYCBkaXJlY3RseS4KICAgKi8KICAgY29uZmlndXJlU2NvcGUoY2FsbGJhY2spIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3QgeyBzY29wZSwgY2xpZW50IH0gPSB0aGlzLmdldFN0YWNrVG9wKCk7CiAgICBpZiAoY2xpZW50KSB7CiAgICAgIGNhbGxiYWNrKHNjb3BlKTsKICAgIH0KICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICovCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgIHJ1bihjYWxsYmFjaykgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBjb25zdCBvbGRIdWIgPSBtYWtlTWFpbih0aGlzKTsKICAgIHRyeSB7CiAgICAgIGNhbGxiYWNrKHRoaXMpOwogICAgfSBmaW5hbGx5IHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICAgIG1ha2VNYWluKG9sZEh1Yik7CiAgICB9CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSBgU2VudHJ5LmdldENsaWVudCgpLmdldEludGVncmF0aW9uQnlOYW1lKClgIGluc3RlYWQuCiAgICovCiAgIGdldEludGVncmF0aW9uKGludGVncmF0aW9uKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IGNsaWVudCA9IHRoaXMuZ2V0Q2xpZW50KCk7CiAgICBpZiAoIWNsaWVudCkgcmV0dXJuIG51bGw7CiAgICB0cnkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgcmV0dXJuIGNsaWVudC5nZXRJbnRlZ3JhdGlvbihpbnRlZ3JhdGlvbik7CiAgICB9IGNhdGNoIChfb08pIHsKICAgICAgREVCVUdfQlVJTEQgJiYgbG9nZ2VyLndhcm4oYENhbm5vdCByZXRyaWV2ZSBpbnRlZ3JhdGlvbiAke2ludGVncmF0aW9uLmlkfSBmcm9tIHRoZSBjdXJyZW50IEh1YmApOwogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICB9CgogIC8qKgogICAqIFN0YXJ0cyBhIG5ldyBgVHJhbnNhY3Rpb25gIGFuZCByZXR1cm5zIGl0LiBUaGlzIGlzIHRoZSBlbnRyeSBwb2ludCB0byBtYW51YWwgdHJhY2luZyBpbnN0cnVtZW50YXRpb24uCiAgICoKICAgKiBBIHRyZWUgc3RydWN0dXJlIGNhbiBiZSBidWlsdCBieSBhZGRpbmcgY2hpbGQgc3BhbnMgdG8gdGhlIHRyYW5zYWN0aW9uLCBhbmQgY2hpbGQgc3BhbnMgdG8gb3RoZXIgc3BhbnMuIFRvIHN0YXJ0IGEKICAgKiBuZXcgY2hpbGQgc3BhbiB3aXRoaW4gdGhlIHRyYW5zYWN0aW9uIG9yIGFueSBzcGFuLCBjYWxsIHRoZSByZXNwZWN0aXZlIGAuc3RhcnRDaGlsZCgpYCBtZXRob2QuCiAgICoKICAgKiBFdmVyeSBjaGlsZCBzcGFuIG11c3QgYmUgZmluaXNoZWQgYmVmb3JlIHRoZSB0cmFuc2FjdGlvbiBpcyBmaW5pc2hlZCwgb3RoZXJ3aXNlIHRoZSB1bmZpbmlzaGVkIHNwYW5zIGFyZSBkaXNjYXJkZWQuCiAgICoKICAgKiBUaGUgdHJhbnNhY3Rpb24gbXVzdCBiZSBmaW5pc2hlZCB3aXRoIGEgY2FsbCB0byBpdHMgYC5lbmQoKWAgbWV0aG9kLCBhdCB3aGljaCBwb2ludCB0aGUgdHJhbnNhY3Rpb24gd2l0aCBhbGwgaXRzCiAgICogZmluaXNoZWQgY2hpbGQgc3BhbnMgd2lsbCBiZSBzZW50IHRvIFNlbnRyeS4KICAgKgogICAqIEBwYXJhbSBjb250ZXh0IFByb3BlcnRpZXMgb2YgdGhlIG5ldyBgVHJhbnNhY3Rpb25gLgogICAqIEBwYXJhbSBjdXN0b21TYW1wbGluZ0NvbnRleHQgSW5mb3JtYXRpb24gZ2l2ZW4gdG8gdGhlIHRyYW5zYWN0aW9uIHNhbXBsaW5nIGZ1bmN0aW9uIChhbG9uZyB3aXRoIGNvbnRleHQtZGVwZW5kZW50CiAgICogZGVmYXVsdCB2YWx1ZXMpLiBTZWUge0BsaW5rIE9wdGlvbnMudHJhY2VzU2FtcGxlcn0uCiAgICoKICAgKiBAcmV0dXJucyBUaGUgdHJhbnNhY3Rpb24gd2hpY2ggd2FzIGp1c3Qgc3RhcnRlZAogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBzdGFydFNwYW4oKWAsIGBzdGFydFNwYW5NYW51YWwoKWAgb3IgYHN0YXJ0SW5hY3RpdmVTcGFuKClgIGluc3RlYWQuCiAgICovCiAgIHN0YXJ0VHJhbnNhY3Rpb24oY29udGV4dCwgY3VzdG9tU2FtcGxpbmdDb250ZXh0KSB7CiAgICBjb25zdCByZXN1bHQgPSB0aGlzLl9jYWxsRXh0ZW5zaW9uTWV0aG9kKCdzdGFydFRyYW5zYWN0aW9uJywgY29udGV4dCwgY3VzdG9tU2FtcGxpbmdDb250ZXh0KTsKCiAgICBpZiAoREVCVUdfQlVJTEQgJiYgIXJlc3VsdCkgewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgICAgY29uc3QgY2xpZW50ID0gdGhpcy5nZXRDbGllbnQoKTsKICAgICAgaWYgKCFjbGllbnQpIHsKICAgICAgICBsb2dnZXIud2FybigKICAgICAgICAgICJUcmFjaW5nIGV4dGVuc2lvbiAnc3RhcnRUcmFuc2FjdGlvbicgaXMgbWlzc2luZy4gWW91IHNob3VsZCAnaW5pdCcgdGhlIFNESyBiZWZvcmUgY2FsbGluZyAnc3RhcnRUcmFuc2FjdGlvbiciLAogICAgICAgICk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgbG9nZ2VyLndhcm4oYFRyYWNpbmcgZXh0ZW5zaW9uICdzdGFydFRyYW5zYWN0aW9uJyBoYXMgbm90IGJlZW4gYWRkZWQuIENhbGwgJ2FkZFRyYWNpbmdFeHRlbnNpb25zJyBiZWZvcmUgY2FsbGluZyAnaW5pdCc6ClNlbnRyeS5hZGRUcmFjaW5nRXh0ZW5zaW9ucygpOwpTZW50cnkuaW5pdCh7Li4ufSk7CmApOwogICAgICB9CiAgICB9CgogICAgcmV0dXJuIHJlc3VsdDsKICB9CgogIC8qKgogICAqIEBpbmhlcml0RG9jCiAgICogQGRlcHJlY2F0ZWQgVXNlIGBzcGFuVG9UcmFjZUhlYWRlcigpYCBpbnN0ZWFkLgogICAqLwogICB0cmFjZUhlYWRlcnMoKSB7CiAgICByZXR1cm4gdGhpcy5fY2FsbEV4dGVuc2lvbk1ldGhvZCgndHJhY2VIZWFkZXJzJyk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqCiAgICogQGRlcHJlY2F0ZWQgVXNlIHRvcCBsZXZlbCBgY2FwdHVyZVNlc3Npb25gIGluc3RlYWQuCiAgICovCiAgIGNhcHR1cmVTZXNzaW9uKGVuZFNlc3Npb24gPSBmYWxzZSkgewogICAgLy8gYm90aCBzZW5kIHRoZSB1cGRhdGUgYW5kIHB1bGwgdGhlIHNlc3Npb24gZnJvbSB0aGUgc2NvcGUKICAgIGlmIChlbmRTZXNzaW9uKSB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgICByZXR1cm4gdGhpcy5lbmRTZXNzaW9uKCk7CiAgICB9CgogICAgLy8gb25seSBzZW5kIHRoZSB1cGRhdGUKICAgIHRoaXMuX3NlbmRTZXNzaW9uVXBkYXRlKCk7CiAgfQoKICAvKioKICAgKiBAaW5oZXJpdERvYwogICAqIEBkZXByZWNhdGVkIFVzZSB0b3AgbGV2ZWwgYGVuZFNlc3Npb25gIGluc3RlYWQuCiAgICovCiAgIGVuZFNlc3Npb24oKSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IGxheWVyID0gdGhpcy5nZXRTdGFja1RvcCgpOwogICAgY29uc3Qgc2NvcGUgPSBsYXllci5zY29wZTsKICAgIGNvbnN0IHNlc3Npb24gPSBzY29wZS5nZXRTZXNzaW9uKCk7CiAgICBpZiAoc2Vzc2lvbikgewogICAgICBjbG9zZVNlc3Npb24oc2Vzc2lvbik7CiAgICB9CiAgICB0aGlzLl9zZW5kU2Vzc2lvblVwZGF0ZSgpOwoKICAgIC8vIHRoZSBzZXNzaW9uIGlzIG92ZXI7IHRha2UgaXQgb2ZmIG9mIHRoZSBzY29wZQogICAgc2NvcGUuc2V0U2Vzc2lvbigpOwogIH0KCiAgLyoqCiAgICogQGluaGVyaXREb2MKICAgKiBAZGVwcmVjYXRlZCBVc2UgdG9wIGxldmVsIGBzdGFydFNlc3Npb25gIGluc3RlYWQuCiAgICovCiAgIHN0YXJ0U2Vzc2lvbihjb250ZXh0KSB7CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZGVwcmVjYXRpb24vZGVwcmVjYXRpb24KICAgIGNvbnN0IHsgc2NvcGUsIGNsaWVudCB9ID0gdGhpcy5nZXRTdGFja1RvcCgpOwogICAgY29uc3QgeyByZWxlYXNlLCBlbnZpcm9ubWVudCA9IERFRkFVTFRfRU5WSVJPTk1FTlQgfSA9IChjbGllbnQgJiYgY2xpZW50LmdldE9wdGlvbnMoKSkgfHwge307CgogICAgLy8gV2lsbCBmZXRjaCB1c2VyQWdlbnQgaWYgY2FsbGVkIGZyb20gYnJvd3NlciBzZGsKICAgIGNvbnN0IHsgdXNlckFnZW50IH0gPSBHTE9CQUxfT0JKLm5hdmlnYXRvciB8fCB7fTsKCiAgICBjb25zdCBzZXNzaW9uID0gbWFrZVNlc3Npb24oewogICAgICByZWxlYXNlLAogICAgICBlbnZpcm9ubWVudCwKICAgICAgdXNlcjogc2NvcGUuZ2V0VXNlcigpLAogICAgICAuLi4odXNlckFnZW50ICYmIHsgdXNlckFnZW50IH0pLAogICAgICAuLi5jb250ZXh0LAogICAgfSk7CgogICAgLy8gRW5kIGV4aXN0aW5nIHNlc3Npb24gaWYgdGhlcmUncyBvbmUKICAgIGNvbnN0IGN1cnJlbnRTZXNzaW9uID0gc2NvcGUuZ2V0U2Vzc2lvbiAmJiBzY29wZS5nZXRTZXNzaW9uKCk7CiAgICBpZiAoY3VycmVudFNlc3Npb24gJiYgY3VycmVudFNlc3Npb24uc3RhdHVzID09PSAnb2snKSB7CiAgICAgIHVwZGF0ZVNlc3Npb24oY3VycmVudFNlc3Npb24sIHsgc3RhdHVzOiAnZXhpdGVkJyB9KTsKICAgIH0KICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgdGhpcy5lbmRTZXNzaW9uKCk7CgogICAgLy8gQWZ0ZXJ3YXJkcyB3ZSBzZXQgdGhlIG5ldyBzZXNzaW9uIG9uIHRoZSBzY29wZQogICAgc2NvcGUuc2V0U2Vzc2lvbihzZXNzaW9uKTsKCiAgICByZXR1cm4gc2Vzc2lvbjsKICB9CgogIC8qKgogICAqIFJldHVybnMgaWYgZGVmYXVsdCBQSUkgc2hvdWxkIGJlIHNlbnQgdG8gU2VudHJ5IGFuZCBwcm9wYWdhdGVkIGluIG91cmdvaW5nIHJlcXVlc3RzCiAgICogd2hlbiBUcmFjaW5nIGlzIHVzZWQuCiAgICoKICAgKiBAZGVwcmVjYXRlZCBVc2UgdG9wLWxldmVsIGBnZXRDbGllbnQoKS5nZXRPcHRpb25zKCkuc2VuZERlZmF1bHRQaWlgIGluc3RlYWQuIFRoaXMgZnVuY3Rpb24KICAgKiBvbmx5IHVubmVjZXNzYXJpbHkgaW5jcmVhc2VkIEFQSSBzdXJmYWNlIGJ1dCBvbmx5IHdyYXBwZWQgYWNjZXNzaW5nIHRoZSBvcHRpb24uCiAgICovCiAgIHNob3VsZFNlbmREZWZhdWx0UGlpKCkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBjb25zdCBjbGllbnQgPSB0aGlzLmdldENsaWVudCgpOwogICAgY29uc3Qgb3B0aW9ucyA9IGNsaWVudCAmJiBjbGllbnQuZ2V0T3B0aW9ucygpOwogICAgcmV0dXJuIEJvb2xlYW4ob3B0aW9ucyAmJiBvcHRpb25zLnNlbmREZWZhdWx0UGlpKTsKICB9CgogIC8qKgogICAqIFNlbmRzIHRoZSBjdXJyZW50IFNlc3Npb24gb24gdGhlIHNjb3BlCiAgICovCiAgIF9zZW5kU2Vzc2lvblVwZGF0ZSgpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgY29uc3QgeyBzY29wZSwgY2xpZW50IH0gPSB0aGlzLmdldFN0YWNrVG9wKCk7CgogICAgY29uc3Qgc2Vzc2lvbiA9IHNjb3BlLmdldFNlc3Npb24oKTsKICAgIGlmIChzZXNzaW9uICYmIGNsaWVudCAmJiBjbGllbnQuY2FwdHVyZVNlc3Npb24pIHsKICAgICAgY2xpZW50LmNhcHR1cmVTZXNzaW9uKHNlc3Npb24pOwogICAgfQogIH0KCiAgLyoqCiAgICogQ2FsbHMgZ2xvYmFsIGV4dGVuc2lvbiBtZXRob2QgYW5kIGJpbmRpbmcgY3VycmVudCBpbnN0YW5jZSB0byB0aGUgZnVuY3Rpb24gY2FsbAogICAqLwogIC8vIEB0cy1leHBlY3QtZXJyb3IgRnVuY3Rpb24gbGFja3MgZW5kaW5nIHJldHVybiBzdGF0ZW1lbnQgYW5kIHJldHVybiB0eXBlIGRvZXMgbm90IGluY2x1ZGUgJ3VuZGVmaW5lZCcuIHRzKDIzNjYpCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKICAgX2NhbGxFeHRlbnNpb25NZXRob2QobWV0aG9kLCAuLi5hcmdzKSB7CiAgICBjb25zdCBjYXJyaWVyID0gZ2V0TWFpbkNhcnJpZXIoKTsKICAgIGNvbnN0IHNlbnRyeSA9IGNhcnJpZXIuX19TRU5UUllfXzsKICAgIGlmIChzZW50cnkgJiYgc2VudHJ5LmV4dGVuc2lvbnMgJiYgdHlwZW9mIHNlbnRyeS5leHRlbnNpb25zW21ldGhvZF0gPT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIHNlbnRyeS5leHRlbnNpb25zW21ldGhvZF0uYXBwbHkodGhpcywgYXJncyk7CiAgICB9CiAgICBERUJVR19CVUlMRCAmJiBsb2dnZXIud2FybihgRXh0ZW5zaW9uIG1ldGhvZCAke21ldGhvZH0gY291bGRuJ3QgYmUgZm91bmQsIGRvaW5nIG5vdGhpbmcuYCk7CiAgfQp9CgovKioKICogUmV0dXJucyB0aGUgZ2xvYmFsIHNoaW0gcmVnaXN0cnkuCiAqCiAqIEZJWE1FOiBUaGlzIGZ1bmN0aW9uIGlzIHByb2JsZW1hdGljLCBiZWNhdXNlIGRlc3BpdGUgYWx3YXlzIHJldHVybmluZyBhIHZhbGlkIENhcnJpZXIsCiAqIGl0IGhhcyBhbiBvcHRpb25hbCBgX19TRU5UUllfX2AgcHJvcGVydHksIHdoaWNoIHRoZW4gaW4gdHVybiByZXF1aXJlcyB1cyB0byBhbHdheXMgcGVyZm9ybSBhbiB1bm5lY2Vzc2FyeSBjaGVjawogKiBhdCB0aGUgY2FsbC1zaXRlLiBXZSBhbHdheXMgYWNjZXNzIHRoZSBjYXJyaWVyIHRocm91Z2ggdGhpcyBmdW5jdGlvbiwgc28gd2UgY2FuIGd1YXJhbnRlZSB0aGF0IGBfX1NFTlRSWV9fYCBpcyB0aGVyZS4KICoqLwpmdW5jdGlvbiBnZXRNYWluQ2FycmllcigpIHsKICBHTE9CQUxfT0JKLl9fU0VOVFJZX18gPSBHTE9CQUxfT0JKLl9fU0VOVFJZX18gfHwgewogICAgZXh0ZW5zaW9uczoge30sCiAgICBodWI6IHVuZGVmaW5lZCwKICB9OwogIHJldHVybiBHTE9CQUxfT0JKOwp9CgovKioKICogUmVwbGFjZXMgdGhlIGN1cnJlbnQgbWFpbiBodWIgd2l0aCB0aGUgcGFzc2VkIG9uZSBvbiB0aGUgZ2xvYmFsIG9iamVjdAogKgogKiBAcmV0dXJucyBUaGUgb2xkIHJlcGxhY2VkIGh1YgogKgogKiBAZGVwcmVjYXRlZCBVc2UgYHNldEN1cnJlbnRDbGllbnQoKWAgaW5zdGVhZC4KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBtYWtlTWFpbihodWIpIHsKICBjb25zdCByZWdpc3RyeSA9IGdldE1haW5DYXJyaWVyKCk7CiAgY29uc3Qgb2xkSHViID0gZ2V0SHViRnJvbUNhcnJpZXIocmVnaXN0cnkpOwogIHNldEh1Yk9uQ2FycmllcihyZWdpc3RyeSwgaHViKTsKICByZXR1cm4gb2xkSHViOwp9CgovKioKICogUmV0dXJucyB0aGUgZGVmYXVsdCBodWIgaW5zdGFuY2UuCiAqCiAqIElmIGEgaHViIGlzIGFscmVhZHkgcmVnaXN0ZXJlZCBpbiB0aGUgZ2xvYmFsIGNhcnJpZXIgYnV0IHRoaXMgbW9kdWxlCiAqIGNvbnRhaW5zIGEgbW9yZSByZWNlbnQgdmVyc2lvbiwgaXQgcmVwbGFjZXMgdGhlIHJlZ2lzdGVyZWQgdmVyc2lvbi4KICogT3RoZXJ3aXNlLCB0aGUgY3VycmVudGx5IHJlZ2lzdGVyZWQgaHViIHdpbGwgYmUgcmV0dXJuZWQuCiAqCiAqIEBkZXByZWNhdGVkIFVzZSB0aGUgcmVzcGVjdGl2ZSByZXBsYWNlbWVudCBtZXRob2QgZGlyZWN0bHkgaW5zdGVhZC4KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBnZXRDdXJyZW50SHViKCkgewogIC8vIEdldCBtYWluIGNhcnJpZXIgKGdsb2JhbCBmb3IgZXZlcnkgZW52aXJvbm1lbnQpCiAgY29uc3QgcmVnaXN0cnkgPSBnZXRNYWluQ2FycmllcigpOwoKICBpZiAocmVnaXN0cnkuX19TRU5UUllfXyAmJiByZWdpc3RyeS5fX1NFTlRSWV9fLmFjcykgewogICAgY29uc3QgaHViID0gcmVnaXN0cnkuX19TRU5UUllfXy5hY3MuZ2V0Q3VycmVudEh1YigpOwoKICAgIGlmIChodWIpIHsKICAgICAgcmV0dXJuIGh1YjsKICAgIH0KICB9CgogIC8vIFJldHVybiBodWIgdGhhdCBsaXZlcyBvbiBhIGdsb2JhbCBvYmplY3QKICByZXR1cm4gZ2V0R2xvYmFsSHViKHJlZ2lzdHJ5KTsKfQoKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCmZ1bmN0aW9uIGdldEdsb2JhbEh1YihyZWdpc3RyeSA9IGdldE1haW5DYXJyaWVyKCkpIHsKICAvLyBJZiB0aGVyZSdzIG5vIGh1Yiwgb3IgaXRzIGFuIG9sZCBBUEksIGFzc2lnbiBhIG5ldyBvbmUKCiAgaWYgKAogICAgIWhhc0h1Yk9uQ2FycmllcihyZWdpc3RyeSkgfHwKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgogICAgZ2V0SHViRnJvbUNhcnJpZXIocmVnaXN0cnkpLmlzT2xkZXJUaGFuKEFQSV9WRVJTSU9OKQogICkgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgICBzZXRIdWJPbkNhcnJpZXIocmVnaXN0cnksIG5ldyBIdWIoKSk7CiAgfQoKICAvLyBSZXR1cm4gaHViIHRoYXQgbGl2ZXMgb24gYSBnbG9iYWwgb2JqZWN0CiAgcmV0dXJuIGdldEh1YkZyb21DYXJyaWVyKHJlZ2lzdHJ5KTsKfQoKLyoqCiAqIFRoaXMgd2lsbCB0ZWxsIHdoZXRoZXIgYSBjYXJyaWVyIGhhcyBhIGh1YiBvbiBpdCBvciBub3QKICogQHBhcmFtIGNhcnJpZXIgb2JqZWN0CiAqLwpmdW5jdGlvbiBoYXNIdWJPbkNhcnJpZXIoY2FycmllcikgewogIHJldHVybiAhIShjYXJyaWVyICYmIGNhcnJpZXIuX19TRU5UUllfXyAmJiBjYXJyaWVyLl9fU0VOVFJZX18uaHViKTsKfQoKLyoqCiAqIFRoaXMgd2lsbCBjcmVhdGUgYSBuZXcge0BsaW5rIEh1Yn0gYW5kIGFkZCB0byB0aGUgcGFzc2VkIG9iamVjdCBvbgogKiBfX1NFTlRSWV9fLmh1Yi4KICogQHBhcmFtIGNhcnJpZXIgb2JqZWN0CiAqIEBoaWRkZW4KICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBnZXRIdWJGcm9tQ2FycmllcihjYXJyaWVyKSB7CiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgcmV0dXJuIGdldEdsb2JhbFNpbmdsZXRvbignaHViJywgKCkgPT4gbmV3IEh1YigpLCBjYXJyaWVyKTsKfQoKLyoqCiAqIFRoaXMgd2lsbCBzZXQgcGFzc2VkIHtAbGluayBIdWJ9IG9uIHRoZSBwYXNzZWQgb2JqZWN0J3MgX19TRU5UUllfXy5odWIgYXR0cmlidXRlCiAqIEBwYXJhbSBjYXJyaWVyIG9iamVjdAogKiBAcGFyYW0gaHViIEh1YgogKiBAcmV0dXJucyBBIGJvb2xlYW4gaW5kaWNhdGluZyBzdWNjZXNzIG9yIGZhaWx1cmUKICovCi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBkZXByZWNhdGlvbi9kZXByZWNhdGlvbgpmdW5jdGlvbiBzZXRIdWJPbkNhcnJpZXIoY2FycmllciwgaHViKSB7CiAgaWYgKCFjYXJyaWVyKSByZXR1cm4gZmFsc2U7CiAgY29uc3QgX19TRU5UUllfXyA9IChjYXJyaWVyLl9fU0VOVFJZX18gPSBjYXJyaWVyLl9fU0VOVFJZX18gfHwge30pOwogIF9fU0VOVFJZX18uaHViID0gaHViOwogIHJldHVybiB0cnVlOwp9CgovKioKICogQXBwbHkgU2RrSW5mbyAobmFtZSwgdmVyc2lvbiwgcGFja2FnZXMsIGludGVncmF0aW9ucykgdG8gdGhlIGNvcnJlc3BvbmRpbmcgZXZlbnQga2V5LgogKiBNZXJnZSB3aXRoIGV4aXN0aW5nIGRhdGEgaWYgYW55LgogKiovCmZ1bmN0aW9uIGVuaGFuY2VFdmVudFdpdGhTZGtJbmZvKGV2ZW50LCBzZGtJbmZvKSB7CiAgaWYgKCFzZGtJbmZvKSB7CiAgICByZXR1cm4gZXZlbnQ7CiAgfQogIGV2ZW50LnNkayA9IGV2ZW50LnNkayB8fCB7fTsKICBldmVudC5zZGsubmFtZSA9IGV2ZW50LnNkay5uYW1lIHx8IHNka0luZm8ubmFtZTsKICBldmVudC5zZGsudmVyc2lvbiA9IGV2ZW50LnNkay52ZXJzaW9uIHx8IHNka0luZm8udmVyc2lvbjsKICBldmVudC5zZGsuaW50ZWdyYXRpb25zID0gWy4uLihldmVudC5zZGsuaW50ZWdyYXRpb25zIHx8IFtdKSwgLi4uKHNka0luZm8uaW50ZWdyYXRpb25zIHx8IFtdKV07CiAgZXZlbnQuc2RrLnBhY2thZ2VzID0gWy4uLihldmVudC5zZGsucGFja2FnZXMgfHwgW10pLCAuLi4oc2RrSW5mby5wYWNrYWdlcyB8fCBbXSldOwogIHJldHVybiBldmVudDsKfQoKLyoqIENyZWF0ZXMgYW4gZW52ZWxvcGUgZnJvbSBhIFNlc3Npb24gKi8KZnVuY3Rpb24gY3JlYXRlU2Vzc2lvbkVudmVsb3BlKAogIHNlc3Npb24sCiAgZHNuLAogIG1ldGFkYXRhLAogIHR1bm5lbCwKKSB7CiAgY29uc3Qgc2RrSW5mbyA9IGdldFNka01ldGFkYXRhRm9yRW52ZWxvcGVIZWFkZXIobWV0YWRhdGEpOwogIGNvbnN0IGVudmVsb3BlSGVhZGVycyA9IHsKICAgIHNlbnRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgIC4uLihzZGtJbmZvICYmIHsgc2RrOiBzZGtJbmZvIH0pLAogICAgLi4uKCEhdHVubmVsICYmIGRzbiAmJiB7IGRzbjogZHNuVG9TdHJpbmcoZHNuKSB9KSwKICB9OwoKICBjb25zdCBlbnZlbG9wZUl0ZW0gPQogICAgJ2FnZ3JlZ2F0ZXMnIGluIHNlc3Npb24gPyBbeyB0eXBlOiAnc2Vzc2lvbnMnIH0sIHNlc3Npb25dIDogW3sgdHlwZTogJ3Nlc3Npb24nIH0sIHNlc3Npb24udG9KU09OKCldOwoKICByZXR1cm4gY3JlYXRlRW52ZWxvcGUoZW52ZWxvcGVIZWFkZXJzLCBbZW52ZWxvcGVJdGVtXSk7Cn0KCi8qKgogKiBDcmVhdGUgYW4gRW52ZWxvcGUgZnJvbSBhbiBldmVudC4KICovCmZ1bmN0aW9uIGNyZWF0ZUV2ZW50RW52ZWxvcGUoCiAgZXZlbnQsCiAgZHNuLAogIG1ldGFkYXRhLAogIHR1bm5lbCwKKSB7CiAgY29uc3Qgc2RrSW5mbyA9IGdldFNka01ldGFkYXRhRm9yRW52ZWxvcGVIZWFkZXIobWV0YWRhdGEpOwoKICAvKgogICAgTm90ZTogRHVlIHRvIFRTLCBldmVudC50eXBlIG1heSBiZSBgcmVwbGF5X2V2ZW50YCwgdGhlb3JldGljYWxseS4KICAgIEluIHByYWN0aWNlLCB3ZSBuZXZlciBjYWxsIGBjcmVhdGVFdmVudEVudmVsb3BlYCB3aXRoIGByZXBsYXlfZXZlbnRgIHR5cGUsCiAgICBhbmQgd2UnZCBoYXZlIHRvIGFkanV0IGEgbG9vb3Qgb2YgdHlwZXMgdG8gbWFrZSB0aGlzIHdvcmsgcHJvcGVybHkuCiAgICBXZSB3YW50IHRvIGF2b2lkIGNhc3RpbmcgdGhpcyBhcm91bmQsIGFzIHRoYXQgY291bGQgbGVhZCB0byBidWdzIChlLmcuIHdoZW4gd2UgYWRkIGFub3RoZXIgdHlwZSkKICAgIFNvIHRoZSBzYWZlIGNob2ljZSBpcyB0byByZWFsbHkgZ3VhcmQgYWdhaW5zdCB0aGUgcmVwbGF5X2V2ZW50IHR5cGUgaGVyZS4KICAqLwogIGNvbnN0IGV2ZW50VHlwZSA9IGV2ZW50LnR5cGUgJiYgZXZlbnQudHlwZSAhPT0gJ3JlcGxheV9ldmVudCcgPyBldmVudC50eXBlIDogJ2V2ZW50JzsKCiAgZW5oYW5jZUV2ZW50V2l0aFNka0luZm8oZXZlbnQsIG1ldGFkYXRhICYmIG1ldGFkYXRhLnNkayk7CgogIGNvbnN0IGVudmVsb3BlSGVhZGVycyA9IGNyZWF0ZUV2ZW50RW52ZWxvcGVIZWFkZXJzKGV2ZW50LCBzZGtJbmZvLCB0dW5uZWwsIGRzbik7CgogIC8vIFByZXZlbnQgdGhpcyBkYXRhICh3aGljaCwgaWYgaXQgZXhpc3RzLCB3YXMgdXNlZCBpbiBlYXJsaWVyIHN0ZXBzIGluIHRoZSBwcm9jZXNzaW5nIHBpcGVsaW5lKSBmcm9tIGJlaW5nIHNlbnQgdG8KICAvLyBzZW50cnkuIChOb3RlOiBPdXIgdXNlIG9mIHRoaXMgcHJvcGVydHkgY29tZXMgYW5kIGdvZXMgd2l0aCB3aGF0ZXZlciB3ZSBtaWdodCBiZSBkZWJ1Z2dpbmcsIHdoYXRldmVyIGhhY2tzIHdlIG1heQogIC8vIGhhdmUgdGVtcG9yYXJpbHkgYWRkZWQsIGV0Yy4gRXZlbiBpZiB3ZSBkb24ndCBoYXBwZW4gdG8gYmUgdXNpbmcgaXQgYXQgc29tZSBwb2ludCBpbiB0aGUgZnV0dXJlLCBsZXQncyBub3QgZ2V0IHJpZAogIC8vIG9mIHRoaXMgYGRlbGV0ZWAsIGxlc3Qgd2UgbWlzcyBwdXR0aW5nIGl0IGJhY2sgaW4gdGhlIG5leHQgdGltZSB0aGUgcHJvcGVydHkgaXMgaW4gdXNlLikKICBkZWxldGUgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhOwoKICBjb25zdCBldmVudEl0ZW0gPSBbeyB0eXBlOiBldmVudFR5cGUgfSwgZXZlbnRdOwogIHJldHVybiBjcmVhdGVFbnZlbG9wZShlbnZlbG9wZUhlYWRlcnMsIFtldmVudEl0ZW1dKTsKfQoKY29uc3QgU0VOVFJZX0FQSV9WRVJTSU9OID0gJzcnOwoKLyoqIFJldHVybnMgdGhlIHByZWZpeCB0byBjb25zdHJ1Y3QgU2VudHJ5IGluZ2VzdGlvbiBBUEkgZW5kcG9pbnRzLiAqLwpmdW5jdGlvbiBnZXRCYXNlQXBpRW5kcG9pbnQoZHNuKSB7CiAgY29uc3QgcHJvdG9jb2wgPSBkc24ucHJvdG9jb2wgPyBgJHtkc24ucHJvdG9jb2x9OmAgOiAnJzsKICBjb25zdCBwb3J0ID0gZHNuLnBvcnQgPyBgOiR7ZHNuLnBvcnR9YCA6ICcnOwogIHJldHVybiBgJHtwcm90b2NvbH0vLyR7ZHNuLmhvc3R9JHtwb3J0fSR7ZHNuLnBhdGggPyBgLyR7ZHNuLnBhdGh9YCA6ICcnfS9hcGkvYDsKfQoKLyoqIFJldHVybnMgdGhlIGluZ2VzdCBBUEkgZW5kcG9pbnQgZm9yIHRhcmdldC4gKi8KZnVuY3Rpb24gX2dldEluZ2VzdEVuZHBvaW50KGRzbikgewogIHJldHVybiBgJHtnZXRCYXNlQXBpRW5kcG9pbnQoZHNuKX0ke2Rzbi5wcm9qZWN0SWR9L2VudmVsb3BlL2A7Cn0KCi8qKiBSZXR1cm5zIGEgVVJMLWVuY29kZWQgc3RyaW5nIHdpdGggYXV0aCBjb25maWcgc3VpdGFibGUgZm9yIGEgcXVlcnkgc3RyaW5nLiAqLwpmdW5jdGlvbiBfZW5jb2RlZEF1dGgoZHNuLCBzZGtJbmZvKSB7CiAgcmV0dXJuIHVybEVuY29kZSh7CiAgICAvLyBXZSBzZW5kIG9ubHkgdGhlIG1pbmltdW0gc2V0IG9mIHJlcXVpcmVkIGluZm9ybWF0aW9uLiBTZWUKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvaXNzdWVzLzI1NzIuCiAgICBzZW50cnlfa2V5OiBkc24ucHVibGljS2V5LAogICAgc2VudHJ5X3ZlcnNpb246IFNFTlRSWV9BUElfVkVSU0lPTiwKICAgIC4uLihzZGtJbmZvICYmIHsgc2VudHJ5X2NsaWVudDogYCR7c2RrSW5mby5uYW1lfS8ke3Nka0luZm8udmVyc2lvbn1gIH0pLAogIH0pOwp9CgovKioKICogUmV0dXJucyB0aGUgZW52ZWxvcGUgZW5kcG9pbnQgVVJMIHdpdGggYXV0aCBpbiB0aGUgcXVlcnkgc3RyaW5nLgogKgogKiBTZW5kaW5nIGF1dGggYXMgcGFydCBvZiB0aGUgcXVlcnkgc3RyaW5nIGFuZCBub3QgYXMgY3VzdG9tIEhUVFAgaGVhZGVycyBhdm9pZHMgQ09SUyBwcmVmbGlnaHQgcmVxdWVzdHMuCiAqLwpmdW5jdGlvbiBnZXRFbnZlbG9wZUVuZHBvaW50V2l0aFVybEVuY29kZWRBdXRoKAogIGRzbiwKICAvLyBUT0RPICh2OCk6IFJlbW92ZSBgdHVubmVsT3JPcHRpb25zYCBpbiBmYXZvciBvZiBgb3B0aW9uc2AsIGFuZCB1c2UgdGhlIHN1YnN0aXR1dGUgY29kZSBiZWxvdwogIC8vIG9wdGlvbnM6IENsaWVudE9wdGlvbnMgPSB7fSBhcyBDbGllbnRPcHRpb25zLAogIHR1bm5lbE9yT3B0aW9ucyA9IHt9ICwKKSB7CiAgLy8gVE9ETyAodjgpOiBVc2UgdGhpcyBjb2RlIGluc3RlYWQKICAvLyBjb25zdCB7IHR1bm5lbCwgX21ldGFkYXRhID0ge30gfSA9IG9wdGlvbnM7CiAgLy8gcmV0dXJuIHR1bm5lbCA/IHR1bm5lbCA6IGAke19nZXRJbmdlc3RFbmRwb2ludChkc24pfT8ke19lbmNvZGVkQXV0aChkc24sIF9tZXRhZGF0YS5zZGspfWA7CgogIGNvbnN0IHR1bm5lbCA9IHR5cGVvZiB0dW5uZWxPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gdHVubmVsT3JPcHRpb25zIDogdHVubmVsT3JPcHRpb25zLnR1bm5lbDsKICBjb25zdCBzZGtJbmZvID0KICAgIHR5cGVvZiB0dW5uZWxPck9wdGlvbnMgPT09ICdzdHJpbmcnIHx8ICF0dW5uZWxPck9wdGlvbnMuX21ldGFkYXRhID8gdW5kZWZpbmVkIDogdHVubmVsT3JPcHRpb25zLl9tZXRhZGF0YS5zZGs7CgogIHJldHVybiB0dW5uZWwgPyB0dW5uZWwgOiBgJHtfZ2V0SW5nZXN0RW5kcG9pbnQoZHNuKX0/JHtfZW5jb2RlZEF1dGgoZHNuLCBzZGtJbmZvKX1gOwp9Cgpjb25zdCBERUZBVUxUX1RSQU5TUE9SVF9CVUZGRVJfU0laRSA9IDMwOwoKLyoqCiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYSBTZW50cnkgYFRyYW5zcG9ydGAKICoKICogQHBhcmFtIG9wdGlvbnMKICogQHBhcmFtIG1ha2VSZXF1ZXN0CiAqLwpmdW5jdGlvbiBjcmVhdGVUcmFuc3BvcnQoCiAgb3B0aW9ucywKICBtYWtlUmVxdWVzdCwKICBidWZmZXIgPSBtYWtlUHJvbWlzZUJ1ZmZlcigKICAgIG9wdGlvbnMuYnVmZmVyU2l6ZSB8fCBERUZBVUxUX1RSQU5TUE9SVF9CVUZGRVJfU0laRSwKICApLAopIHsKICBsZXQgcmF0ZUxpbWl0cyA9IHt9OwogIGNvbnN0IGZsdXNoID0gKHRpbWVvdXQpID0+IGJ1ZmZlci5kcmFpbih0aW1lb3V0KTsKCiAgZnVuY3Rpb24gc2VuZChlbnZlbG9wZSkgewogICAgY29uc3QgZmlsdGVyZWRFbnZlbG9wZUl0ZW1zID0gW107CgogICAgLy8gRHJvcCByYXRlIGxpbWl0ZWQgaXRlbXMgZnJvbSBlbnZlbG9wZQogICAgZm9yRWFjaEVudmVsb3BlSXRlbShlbnZlbG9wZSwgKGl0ZW0sIHR5cGUpID0+IHsKICAgICAgY29uc3QgZGF0YUNhdGVnb3J5ID0gZW52ZWxvcGVJdGVtVHlwZVRvRGF0YUNhdGVnb3J5KHR5cGUpOwogICAgICBpZiAoaXNSYXRlTGltaXRlZChyYXRlTGltaXRzLCBkYXRhQ2F0ZWdvcnkpKSB7CiAgICAgICAgY29uc3QgZXZlbnQgPSBnZXRFdmVudEZvckVudmVsb3BlSXRlbShpdGVtLCB0eXBlKTsKICAgICAgICBvcHRpb25zLnJlY29yZERyb3BwZWRFdmVudCgncmF0ZWxpbWl0X2JhY2tvZmYnLCBkYXRhQ2F0ZWdvcnksIGV2ZW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWx0ZXJlZEVudmVsb3BlSXRlbXMucHVzaChpdGVtKTsKICAgICAgfQogICAgfSk7CgogICAgLy8gU2tpcCBzZW5kaW5nIGlmIGVudmVsb3BlIGlzIGVtcHR5IGFmdGVyIGZpbHRlcmluZyBvdXQgcmF0ZSBsaW1pdGVkIGV2ZW50cwogICAgaWYgKGZpbHRlcmVkRW52ZWxvcGVJdGVtcy5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIHJlc29sdmVkU3luY1Byb21pc2UoKTsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICAgY29uc3QgZmlsdGVyZWRFbnZlbG9wZSA9IGNyZWF0ZUVudmVsb3BlKGVudmVsb3BlWzBdLCBmaWx0ZXJlZEVudmVsb3BlSXRlbXMgKTsKCiAgICAvLyBDcmVhdGVzIGNsaWVudCByZXBvcnQgZm9yIGVhY2ggaXRlbSBpbiBhbiBlbnZlbG9wZQogICAgY29uc3QgcmVjb3JkRW52ZWxvcGVMb3NzID0gKHJlYXNvbikgPT4gewogICAgICBmb3JFYWNoRW52ZWxvcGVJdGVtKGZpbHRlcmVkRW52ZWxvcGUsIChpdGVtLCB0eXBlKSA9PiB7CiAgICAgICAgY29uc3QgZXZlbnQgPSBnZXRFdmVudEZvckVudmVsb3BlSXRlbShpdGVtLCB0eXBlKTsKICAgICAgICBvcHRpb25zLnJlY29yZERyb3BwZWRFdmVudChyZWFzb24sIGVudmVsb3BlSXRlbVR5cGVUb0RhdGFDYXRlZ29yeSh0eXBlKSwgZXZlbnQpOwogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgcmVxdWVzdFRhc2sgPSAoKSA9PgogICAgICBtYWtlUmVxdWVzdCh7IGJvZHk6IHNlcmlhbGl6ZUVudmVsb3BlKGZpbHRlcmVkRW52ZWxvcGUsIG9wdGlvbnMudGV4dEVuY29kZXIpIH0pLnRoZW4oCiAgICAgICAgcmVzcG9uc2UgPT4gewogICAgICAgICAgLy8gV2UgZG9uJ3Qgd2FudCB0byB0aHJvdyBvbiBOT0sgcmVzcG9uc2VzLCBidXQgd2Ugd2FudCB0byBhdCBsZWFzdCBsb2cgdGhlbQogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgIT09IHVuZGVmaW5lZCAmJiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA8IDIwMCB8fCByZXNwb25zZS5zdGF0dXNDb2RlID49IDMwMCkpIHsKICAgICAgICAgICAgREVCVUdfQlVJTEQgJiYgbG9nZ2VyLndhcm4oYFNlbnRyeSByZXNwb25kZWQgd2l0aCBzdGF0dXMgY29kZSAke3Jlc3BvbnNlLnN0YXR1c0NvZGV9IHRvIHNlbnQgZXZlbnQuYCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmF0ZUxpbWl0cyA9IHVwZGF0ZVJhdGVMaW1pdHMocmF0ZUxpbWl0cywgcmVzcG9uc2UpOwogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgIH0sCiAgICAgICAgZXJyb3IgPT4gewogICAgICAgICAgcmVjb3JkRW52ZWxvcGVMb3NzKCduZXR3b3JrX2Vycm9yJyk7CiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9LAogICAgICApOwoKICAgIHJldHVybiBidWZmZXIuYWRkKHJlcXVlc3RUYXNrKS50aGVuKAogICAgICByZXN1bHQgPT4gcmVzdWx0LAogICAgICBlcnJvciA9PiB7CiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgU2VudHJ5RXJyb3IpIHsKICAgICAgICAgIERFQlVHX0JVSUxEICYmIGxvZ2dlci5lcnJvcignU2tpcHBlZCBzZW5kaW5nIGV2ZW50IGJlY2F1c2UgYnVmZmVyIGlzIGZ1bGwuJyk7CiAgICAgICAgICByZWNvcmRFbnZlbG9wZUxvc3MoJ3F1ZXVlX292ZXJmbG93Jyk7CiAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRTeW5jUHJvbWlzZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9CiAgICAgIH0sCiAgICApOwogIH0KCiAgLy8gV2UgdXNlIHRoaXMgdG8gaWRlbnRpZmlmeSBpZiB0aGUgdHJhbnNwb3J0IGlzIHRoZSBiYXNlIHRyYW5zcG9ydAogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIHRoaXMgYWdhaW4gYXMgd2UnbGwgbm8gbG9uZ2VyIG5lZWQgaXQKICBzZW5kLl9fc2VudHJ5X19iYXNlVHJhbnNwb3J0X18gPSB0cnVlOwoKICByZXR1cm4gewogICAgc2VuZCwKICAgIGZsdXNoLAogIH07Cn0KCmZ1bmN0aW9uIGdldEV2ZW50Rm9yRW52ZWxvcGVJdGVtKGl0ZW0sIHR5cGUpIHsKICBpZiAodHlwZSAhPT0gJ2V2ZW50JyAmJiB0eXBlICE9PSAndHJhbnNhY3Rpb24nKSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoaXRlbSkgPyAoaXRlbSApWzFdIDogdW5kZWZpbmVkOwp9CgovKiogbm9ybWFsaXplcyBXaW5kb3dzIHBhdGhzICovCmZ1bmN0aW9uIG5vcm1hbGl6ZVdpbmRvd3NQYXRoKHBhdGgpIHsKICByZXR1cm4gcGF0aAogICAgLnJlcGxhY2UoL15bQS1aXTovLCAnJykgLy8gcmVtb3ZlIFdpbmRvd3Mtc3R5bGUgcHJlZml4CiAgICAucmVwbGFjZSgvXFwvZywgJy8nKTsgLy8gcmVwbGFjZSBhbGwgYFxgIGluc3RhbmNlcyB3aXRoIGAvYAp9CgovKiogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgZ2V0cyB0aGUgbW9kdWxlIG5hbWUgZnJvbSBhIGZpbGVuYW1lICovCmZ1bmN0aW9uIGNyZWF0ZUdldE1vZHVsZUZyb21GaWxlbmFtZSgKICBiYXNlUGF0aCA9IHByb2Nlc3MuYXJndlsxXSA/IGRpcm5hbWUocHJvY2Vzcy5hcmd2WzFdKSA6IHByb2Nlc3MuY3dkKCksCiAgaXNXaW5kb3dzID0gc2VwID09PSAnXFwnLAopIHsKICBjb25zdCBub3JtYWxpemVkQmFzZSA9IGlzV2luZG93cyA/IG5vcm1hbGl6ZVdpbmRvd3NQYXRoKGJhc2VQYXRoKSA6IGJhc2VQYXRoOwoKICByZXR1cm4gKGZpbGVuYW1lKSA9PiB7CiAgICBpZiAoIWZpbGVuYW1lKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBub3JtYWxpemVkRmlsZW5hbWUgPSBpc1dpbmRvd3MgPyBub3JtYWxpemVXaW5kb3dzUGF0aChmaWxlbmFtZSkgOiBmaWxlbmFtZTsKCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0CiAgICBsZXQgeyBkaXIsIGJhc2U6IGZpbGUsIGV4dCB9ID0gcG9zaXgucGFyc2Uobm9ybWFsaXplZEZpbGVuYW1lKTsKCiAgICBpZiAoZXh0ID09PSAnLmpzJyB8fCBleHQgPT09ICcubWpzJyB8fCBleHQgPT09ICcuY2pzJykgewogICAgICBmaWxlID0gZmlsZS5zbGljZSgwLCBleHQubGVuZ3RoICogLTEpOwogICAgfQoKICAgIGlmICghZGlyKSB7CiAgICAgIC8vIE5vIGRpcm5hbWUgd2hhdHNvZXZlcgogICAgICBkaXIgPSAnLic7CiAgICB9CgogICAgY29uc3QgbiA9IGRpci5sYXN0SW5kZXhPZignL25vZGVfbW9kdWxlcycpOwogICAgaWYgKG4gPiAtMSkgewogICAgICByZXR1cm4gYCR7ZGlyLnNsaWNlKG4gKyAxNCkucmVwbGFjZSgvXC8vZywgJy4nKX06JHtmaWxlfWA7CiAgICB9CgogICAgLy8gTGV0J3Mgc2VlIGlmIGl0J3MgYSBwYXJ0IG9mIHRoZSBtYWluIG1vZHVsZQogICAgLy8gVG8gYmUgYSBwYXJ0IG9mIG1haW4gbW9kdWxlLCBpdCBoYXMgdG8gc2hhcmUgdGhlIHNhbWUgYmFzZQogICAgaWYgKGRpci5zdGFydHNXaXRoKG5vcm1hbGl6ZWRCYXNlKSkgewogICAgICBsZXQgbW9kdWxlTmFtZSA9IGRpci5zbGljZShub3JtYWxpemVkQmFzZS5sZW5ndGggKyAxKS5yZXBsYWNlKC9cLy9nLCAnLicpOwoKICAgICAgaWYgKG1vZHVsZU5hbWUpIHsKICAgICAgICBtb2R1bGVOYW1lICs9ICc6JzsKICAgICAgfQogICAgICBtb2R1bGVOYW1lICs9IGZpbGU7CgogICAgICByZXR1cm4gbW9kdWxlTmFtZTsKICAgIH0KCiAgICByZXR1cm4gZmlsZTsKICB9Owp9CgpmdW5jdGlvbiBfbnVsbGlzaENvYWxlc2NlJDIobGhzLCByaHNGbikgeyBpZiAobGhzICE9IG51bGwpIHsgcmV0dXJuIGxoczsgfSBlbHNlIHsgcmV0dXJuIHJoc0ZuKCk7IH0gfS8qKgogKiBUaGlzIGNvZGUgd2FzIG9yaWdpbmFsbHkgZm9ya2VkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL1Rvb1RhbGxOYXRlL3Byb3h5LWFnZW50cy90cmVlL2IxMzMyOTVmZDE2ZjY0NzU1NzhiNmIxNWJkOWI0ZTMzZWNiMGQwYjcKICogV2l0aCB0aGUgZm9sbG93aW5nIGxpY2VuY2U6CiAqCiAqIChUaGUgTUlUIExpY2Vuc2UpCiAqCiAqIENvcHlyaWdodCAoYykgMjAxMyBOYXRoYW4gUmFqbGljaCA8bmF0aGFuQHRvb3RhbGxuYXRlLm5ldD4qCiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZwogKiBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKICogJ1NvZnR3YXJlJyksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwogKiB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCiAqIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0bwogKiBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8KICogdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOioKICoKICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUKICogaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuKgogKgogKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgJ0FTIElTJywgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwKICogRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCiAqIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4KICogSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkKICogQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwKICogVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUKICogU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCiAqLwoKY29uc3QgSU5URVJOQUwgPSBTeW1ib2woJ0FnZW50QmFzZUludGVybmFsU3RhdGUnKTsKCmNsYXNzIEFnZW50IGV4dGVuZHMgaHR0cC5BZ2VudCB7CgogIC8vIFNldCBieSBgaHR0cC5BZ2VudGAgLSBtaXNzaW5nIGZyb20gYEB0eXBlcy9ub2RlYAoKICBjb25zdHJ1Y3RvcihvcHRzKSB7CiAgICBzdXBlcihvcHRzKTsKICAgIHRoaXNbSU5URVJOQUxdID0ge307CiAgfQoKICAvKioKICAgKiBEZXRlcm1pbmUgd2hldGhlciB0aGlzIGlzIGFuIGBodHRwYCBvciBgaHR0cHNgIHJlcXVlc3QuCiAgICovCiAgaXNTZWN1cmVFbmRwb2ludChvcHRpb25zKSB7CiAgICBpZiAob3B0aW9ucykgewogICAgICAvLyBGaXJzdCBjaGVjayB0aGUgYHNlY3VyZUVuZHBvaW50YCBwcm9wZXJ0eSBleHBsaWNpdGx5LCBzaW5jZSB0aGlzCiAgICAgIC8vIG1lYW5zIHRoYXQgYSBwYXJlbnQgYEFnZW50YCBpcyAicGFzc2luZyB0aHJvdWdoIiB0byB0aGlzIGluc3RhbmNlLgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSwgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzCiAgICAgIGlmICh0eXBlb2YgKG9wdGlvbnMgKS5zZWN1cmVFbmRwb2ludCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMuc2VjdXJlRW5kcG9pbnQ7CiAgICAgIH0KCiAgICAgIC8vIElmIG5vIGV4cGxpY2l0IGBzZWN1cmVgIGVuZHBvaW50LCBjaGVjayBpZiBgcHJvdG9jb2xgIHByb3BlcnR5IGlzCiAgICAgIC8vIHNldC4gVGhpcyB3aWxsIHVzdWFsbHkgYmUgdGhlIGNhc2Ugc2luY2UgdXNpbmcgYSBmdWxsIHN0cmluZyBVUkwKICAgICAgLy8gb3IgYFVSTGAgaW5zdGFuY2Ugc2hvdWxkIGJlIHRoZSBtb3N0IGNvbW1vbiB1c2FnZS4KICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnByb3RvY29sID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBvcHRpb25zLnByb3RvY29sID09PSAnaHR0cHM6JzsKICAgICAgfQogICAgfQoKICAgIC8vIEZpbmFsbHksIGlmIG5vIGBwcm90b2NvbGAgcHJvcGVydHkgd2FzIHNldCwgdGhlbiBmYWxsIGJhY2sgdG8KICAgIC8vIGNoZWNraW5nIHRoZSBzdGFjayB0cmFjZSBvZiB0aGUgY3VycmVudCBjYWxsIHN0YWNrLCBhbmQgdHJ5IHRvCiAgICAvLyBkZXRlY3QgdGhlICJodHRwcyIgbW9kdWxlLgogICAgY29uc3QgeyBzdGFjayB9ID0gbmV3IEVycm9yKCk7CiAgICBpZiAodHlwZW9mIHN0YWNrICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHN0YWNrLnNwbGl0KCdcbicpLnNvbWUobCA9PiBsLmluZGV4T2YoJyhodHRwcy5qczonKSAhPT0gLTEgfHwgbC5pbmRleE9mKCdub2RlOmh0dHBzOicpICE9PSAtMSk7CiAgfQoKICBjcmVhdGVTb2NrZXQocmVxLCBvcHRpb25zLCBjYikgewogICAgY29uc3QgY29ubmVjdE9wdHMgPSB7CiAgICAgIC4uLm9wdGlvbnMsCiAgICAgIHNlY3VyZUVuZHBvaW50OiB0aGlzLmlzU2VjdXJlRW5kcG9pbnQob3B0aW9ucyksCiAgICB9OwogICAgUHJvbWlzZS5yZXNvbHZlKCkKICAgICAgLnRoZW4oKCkgPT4gdGhpcy5jb25uZWN0KHJlcSwgY29ubmVjdE9wdHMpKQogICAgICAudGhlbihzb2NrZXQgPT4gewogICAgICAgIGlmIChzb2NrZXQgaW5zdGFuY2VvZiBodHRwLkFnZW50KSB7CiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIGBhZGRSZXF1ZXN0KClgIGlzbid0IGRlZmluZWQgaW4gYEB0eXBlcy9ub2RlYAogICAgICAgICAgcmV0dXJuIHNvY2tldC5hZGRSZXF1ZXN0KHJlcSwgY29ubmVjdE9wdHMpOwogICAgICAgIH0KICAgICAgICB0aGlzW0lOVEVSTkFMXS5jdXJyZW50U29ja2V0ID0gc29ja2V0OwogICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgYGNyZWF0ZVNvY2tldCgpYCBpc24ndCBkZWZpbmVkIGluIGBAdHlwZXMvbm9kZWAKICAgICAgICBzdXBlci5jcmVhdGVTb2NrZXQocmVxLCBvcHRpb25zLCBjYik7CiAgICAgIH0sIGNiKTsKICB9CgogIGNyZWF0ZUNvbm5lY3Rpb24oKSB7CiAgICBjb25zdCBzb2NrZXQgPSB0aGlzW0lOVEVSTkFMXS5jdXJyZW50U29ja2V0OwogICAgdGhpc1tJTlRFUk5BTF0uY3VycmVudFNvY2tldCA9IHVuZGVmaW5lZDsKICAgIGlmICghc29ja2V0KSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc29ja2V0IHdhcyByZXR1cm5lZCBpbiB0aGUgYGNvbm5lY3QoKWAgZnVuY3Rpb24nKTsKICAgIH0KICAgIHJldHVybiBzb2NrZXQ7CiAgfQoKICBnZXQgZGVmYXVsdFBvcnQoKSB7CiAgICByZXR1cm4gX251bGxpc2hDb2FsZXNjZSQyKHRoaXNbSU5URVJOQUxdLmRlZmF1bHRQb3J0LCAoKSA9PiAoICh0aGlzLnByb3RvY29sID09PSAnaHR0cHM6JyA/IDQ0MyA6IDgwKSkpOwogIH0KCiAgc2V0IGRlZmF1bHRQb3J0KHYpIHsKICAgIGlmICh0aGlzW0lOVEVSTkFMXSkgewogICAgICB0aGlzW0lOVEVSTkFMXS5kZWZhdWx0UG9ydCA9IHY7CiAgICB9CiAgfQoKICBnZXQgcHJvdG9jb2woKSB7CiAgICByZXR1cm4gX251bGxpc2hDb2FsZXNjZSQyKHRoaXNbSU5URVJOQUxdLnByb3RvY29sLCAoKSA9PiAoICh0aGlzLmlzU2VjdXJlRW5kcG9pbnQoKSA/ICdodHRwczonIDogJ2h0dHA6JykpKTsKICB9CgogIHNldCBwcm90b2NvbCh2KSB7CiAgICBpZiAodGhpc1tJTlRFUk5BTF0pIHsKICAgICAgdGhpc1tJTlRFUk5BTF0ucHJvdG9jb2wgPSB2OwogICAgfQogIH0KfQoKZnVuY3Rpb24gZGVidWckMSguLi5hcmdzKSB7CiAgbG9nZ2VyLmxvZygnW2h0dHBzLXByb3h5LWFnZW50OnBhcnNlLXByb3h5LXJlc3BvbnNlXScsIC4uLmFyZ3MpOwp9CgpmdW5jdGlvbiBwYXJzZVByb3h5UmVzcG9uc2Uoc29ja2V0KSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIC8vIHdlIG5lZWQgdG8gYnVmZmVyIGFueSBIVFRQIHRyYWZmaWMgdGhhdCBoYXBwZW5zIHdpdGggdGhlIHByb3h5IGJlZm9yZSB3ZSBnZXQKICAgIC8vIHRoZSBDT05ORUNUIHJlc3BvbnNlLCBzbyB0aGF0IGlmIHRoZSByZXNwb25zZSBpcyBhbnl0aGluZyBvdGhlciB0aGFuIGFuICIyMDAiCiAgICAvLyByZXNwb25zZSBjb2RlLCB0aGVuIHdlIGNhbiByZS1wbGF5IHRoZSAiZGF0YSIgZXZlbnRzIG9uIHRoZSBzb2NrZXQgb25jZSB0aGUKICAgIC8vIEhUVFAgcGFyc2VyIGlzIGhvb2tlZCB1cC4uLgogICAgbGV0IGJ1ZmZlcnNMZW5ndGggPSAwOwogICAgY29uc3QgYnVmZmVycyA9IFtdOwoKICAgIGZ1bmN0aW9uIHJlYWQoKSB7CiAgICAgIGNvbnN0IGIgPSBzb2NrZXQucmVhZCgpOwogICAgICBpZiAoYikgb25kYXRhKGIpOwogICAgICBlbHNlIHNvY2tldC5vbmNlKCdyZWFkYWJsZScsIHJlYWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CiAgICAgIHNvY2tldC5yZW1vdmVMaXN0ZW5lcignZW5kJywgb25lbmQpOwogICAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CiAgICAgIHNvY2tldC5yZW1vdmVMaXN0ZW5lcigncmVhZGFibGUnLCByZWFkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmVuZCgpIHsKICAgICAgY2xlYW51cCgpOwogICAgICBkZWJ1ZyQxKCdvbmVuZCcpOwogICAgICByZWplY3QobmV3IEVycm9yKCdQcm94eSBjb25uZWN0aW9uIGVuZGVkIGJlZm9yZSByZWNlaXZpbmcgQ09OTkVDVCByZXNwb25zZScpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmVycm9yKGVycikgewogICAgICBjbGVhbnVwKCk7CiAgICAgIGRlYnVnJDEoJ29uZXJyb3IgJW8nLCBlcnIpOwogICAgICByZWplY3QoZXJyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmRhdGEoYikgewogICAgICBidWZmZXJzLnB1c2goYik7CiAgICAgIGJ1ZmZlcnNMZW5ndGggKz0gYi5sZW5ndGg7CgogICAgICBjb25zdCBidWZmZXJlZCA9IEJ1ZmZlci5jb25jYXQoYnVmZmVycywgYnVmZmVyc0xlbmd0aCk7CiAgICAgIGNvbnN0IGVuZE9mSGVhZGVycyA9IGJ1ZmZlcmVkLmluZGV4T2YoJ1xyXG5cclxuJyk7CgogICAgICBpZiAoZW5kT2ZIZWFkZXJzID09PSAtMSkgewogICAgICAgIC8vIGtlZXAgYnVmZmVyaW5nCiAgICAgICAgZGVidWckMSgnaGF2ZSBub3QgcmVjZWl2ZWQgZW5kIG9mIEhUVFAgaGVhZGVycyB5ZXQuLi4nKTsKICAgICAgICByZWFkKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBoZWFkZXJQYXJ0cyA9IGJ1ZmZlcmVkLnNsaWNlKDAsIGVuZE9mSGVhZGVycykudG9TdHJpbmcoJ2FzY2lpJykuc3BsaXQoJ1xyXG4nKTsKICAgICAgY29uc3QgZmlyc3RMaW5lID0gaGVhZGVyUGFydHMuc2hpZnQoKTsKICAgICAgaWYgKCFmaXJzdExpbmUpIHsKICAgICAgICBzb2NrZXQuZGVzdHJveSgpOwogICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdObyBoZWFkZXIgcmVjZWl2ZWQgZnJvbSBwcm94eSBDT05ORUNUIHJlc3BvbnNlJykpOwogICAgICB9CiAgICAgIGNvbnN0IGZpcnN0TGluZVBhcnRzID0gZmlyc3RMaW5lLnNwbGl0KCcgJyk7CiAgICAgIGNvbnN0IHN0YXR1c0NvZGUgPSArZmlyc3RMaW5lUGFydHNbMV07CiAgICAgIGNvbnN0IHN0YXR1c1RleHQgPSBmaXJzdExpbmVQYXJ0cy5zbGljZSgyKS5qb2luKCcgJyk7CiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTsKICAgICAgZm9yIChjb25zdCBoZWFkZXIgb2YgaGVhZGVyUGFydHMpIHsKICAgICAgICBpZiAoIWhlYWRlcikgY29udGludWU7CiAgICAgICAgY29uc3QgZmlyc3RDb2xvbiA9IGhlYWRlci5pbmRleE9mKCc6Jyk7CiAgICAgICAgaWYgKGZpcnN0Q29sb24gPT09IC0xKSB7CiAgICAgICAgICBzb2NrZXQuZGVzdHJveSgpOwogICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoYEludmFsaWQgaGVhZGVyIGZyb20gcHJveHkgQ09OTkVDVCByZXNwb25zZTogIiR7aGVhZGVyfSJgKSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGtleSA9IGhlYWRlci5zbGljZSgwLCBmaXJzdENvbG9uKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGNvbnN0IHZhbHVlID0gaGVhZGVyLnNsaWNlKGZpcnN0Q29sb24gKyAxKS50cmltU3RhcnQoKTsKICAgICAgICBjb25zdCBjdXJyZW50ID0gaGVhZGVyc1trZXldOwogICAgICAgIGlmICh0eXBlb2YgY3VycmVudCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIGhlYWRlcnNba2V5XSA9IFtjdXJyZW50LCB2YWx1ZV07CiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGN1cnJlbnQpKSB7CiAgICAgICAgICBjdXJyZW50LnB1c2godmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoZWFkZXJzW2tleV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZGVidWckMSgnZ290IHByb3h5IHNlcnZlciByZXNwb25zZTogJW8gJW8nLCBmaXJzdExpbmUsIGhlYWRlcnMpOwogICAgICBjbGVhbnVwKCk7CiAgICAgIHJlc29sdmUoewogICAgICAgIGNvbm5lY3Q6IHsKICAgICAgICAgIHN0YXR1c0NvZGUsCiAgICAgICAgICBzdGF0dXNUZXh0LAogICAgICAgICAgaGVhZGVycywKICAgICAgICB9LAogICAgICAgIGJ1ZmZlcmVkLAogICAgICB9KTsKICAgIH0KCiAgICBzb2NrZXQub24oJ2Vycm9yJywgb25lcnJvcik7CiAgICBzb2NrZXQub24oJ2VuZCcsIG9uZW5kKTsKCiAgICByZWFkKCk7CiAgfSk7Cn0KCmZ1bmN0aW9uIF9udWxsaXNoQ29hbGVzY2UkMShsaHMsIHJoc0ZuKSB7IGlmIChsaHMgIT0gbnVsbCkgeyByZXR1cm4gbGhzOyB9IGVsc2UgeyByZXR1cm4gcmhzRm4oKTsgfSB9IGZ1bmN0aW9uIF9vcHRpb25hbENoYWluJDEob3BzKSB7IGxldCBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyBsZXQgdmFsdWUgPSBvcHNbMF07IGxldCBpID0gMTsgd2hpbGUgKGkgPCBvcHMubGVuZ3RoKSB7IGNvbnN0IG9wID0gb3BzW2ldOyBjb25zdCBmbiA9IG9wc1tpICsgMV07IGkgKz0gMjsgaWYgKChvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpICYmIHZhbHVlID09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBpZiAob3AgPT09ICdhY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnKSB7IGxhc3RBY2Nlc3NMSFMgPSB2YWx1ZTsgdmFsdWUgPSBmbih2YWx1ZSk7IH0gZWxzZSBpZiAob3AgPT09ICdjYWxsJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpIHsgdmFsdWUgPSBmbigoLi4uYXJncykgPT4gdmFsdWUuY2FsbChsYXN0QWNjZXNzTEhTLCAuLi5hcmdzKSk7IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IH0gfSByZXR1cm4gdmFsdWU7IH0KCmZ1bmN0aW9uIGRlYnVnKC4uLmFyZ3MpIHsKICBsb2dnZXIubG9nKCdbaHR0cHMtcHJveHktYWdlbnRdJywgLi4uYXJncyk7Cn0KCi8qKgogKiBUaGUgYEh0dHBzUHJveHlBZ2VudGAgaW1wbGVtZW50cyBhbiBIVFRQIEFnZW50IHN1YmNsYXNzIHRoYXQgY29ubmVjdHMgdG8KICogdGhlIHNwZWNpZmllZCAiSFRUUChzKSBwcm94eSBzZXJ2ZXIiIGluIG9yZGVyIHRvIHByb3h5IEhUVFBTIHJlcXVlc3RzLgogKgogKiBPdXRnb2luZyBIVFRQIHJlcXVlc3RzIGFyZSBmaXJzdCB0dW5uZWxlZCB0aHJvdWdoIHRoZSBwcm94eSBzZXJ2ZXIgdXNpbmcgdGhlCiAqIGBDT05ORUNUYCBIVFRQIHJlcXVlc3QgbWV0aG9kIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gdG8gdGhlIHByb3h5IHNlcnZlciwKICogYW5kIHRoZW4gdGhlIHByb3h5IHNlcnZlciBjb25uZWN0cyB0byB0aGUgZGVzdGluYXRpb24gdGFyZ2V0IGFuZCBpc3N1ZXMgdGhlCiAqIEhUVFAgcmVxdWVzdCBmcm9tIHRoZSBwcm94eSBzZXJ2ZXIuCiAqCiAqIGBodHRwczpgIHJlcXVlc3RzIGhhdmUgdGhlaXIgc29ja2V0IGNvbm5lY3Rpb24gdXBncmFkZWQgdG8gVExTIG9uY2UKICogdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHByb3h5IHNlcnZlciBoYXMgYmVlbiBlc3RhYmxpc2hlZC4KICovCmNsYXNzIEh0dHBzUHJveHlBZ2VudCBleHRlbmRzIEFnZW50IHsKICBzdGF0aWMgX19pbml0U3RhdGljKCkge3RoaXMucHJvdG9jb2xzID0gWydodHRwJywgJ2h0dHBzJ107IH0KCiAgY29uc3RydWN0b3IocHJveHksIG9wdHMpIHsKICAgIHN1cGVyKG9wdHMpOwogICAgdGhpcy5vcHRpb25zID0ge307CiAgICB0aGlzLnByb3h5ID0gdHlwZW9mIHByb3h5ID09PSAnc3RyaW5nJyA/IG5ldyBVUkwocHJveHkpIDogcHJveHk7CiAgICB0aGlzLnByb3h5SGVhZGVycyA9IF9udWxsaXNoQ29hbGVzY2UkMShfb3B0aW9uYWxDaGFpbiQxKFtvcHRzLCAnb3B0aW9uYWxBY2Nlc3MnLCBfMiA9PiBfMi5oZWFkZXJzXSksICgpID0+ICgge30pKTsKICAgIGRlYnVnKCdDcmVhdGluZyBuZXcgSHR0cHNQcm94eUFnZW50IGluc3RhbmNlOiAlbycsIHRoaXMucHJveHkuaHJlZik7CgogICAgLy8gVHJpbSBvZmYgdGhlIGJyYWNrZXRzIGZyb20gSVB2NiBhZGRyZXNzZXMKICAgIGNvbnN0IGhvc3QgPSAodGhpcy5wcm94eS5ob3N0bmFtZSB8fCB0aGlzLnByb3h5Lmhvc3QpLnJlcGxhY2UoL15cW3xcXSQvZywgJycpOwogICAgY29uc3QgcG9ydCA9IHRoaXMucHJveHkucG9ydCA/IHBhcnNlSW50KHRoaXMucHJveHkucG9ydCwgMTApIDogdGhpcy5wcm94eS5wcm90b2NvbCA9PT0gJ2h0dHBzOicgPyA0NDMgOiA4MDsKICAgIHRoaXMuY29ubmVjdE9wdHMgPSB7CiAgICAgIC8vIEF0dGVtcHQgdG8gbmVnb3RpYXRlIGh0dHAvMS4xIGZvciBwcm94eSBzZXJ2ZXJzIHRoYXQgc3VwcG9ydCBodHRwLzIKICAgICAgQUxQTlByb3RvY29sczogWydodHRwLzEuMSddLAogICAgICAuLi4ob3B0cyA/IG9taXQob3B0cywgJ2hlYWRlcnMnKSA6IG51bGwpLAogICAgICBob3N0LAogICAgICBwb3J0LAogICAgfTsKICB9CgogIC8qKgogICAqIENhbGxlZCB3aGVuIHRoZSBub2RlLWNvcmUgSFRUUCBjbGllbnQgbGlicmFyeSBpcyBjcmVhdGluZyBhCiAgICogbmV3IEhUVFAgcmVxdWVzdC4KICAgKi8KICBhc3luYyBjb25uZWN0KHJlcSwgb3B0cykgewogICAgY29uc3QgeyBwcm94eSB9ID0gdGhpczsKCiAgICBpZiAoIW9wdHMuaG9zdCkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdObyAiaG9zdCIgcHJvdmlkZWQnKTsKICAgIH0KCiAgICAvLyBDcmVhdGUgYSBzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgcHJveHkgc2VydmVyLgogICAgbGV0IHNvY2tldDsKICAgIGlmIChwcm94eS5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHsKICAgICAgZGVidWcoJ0NyZWF0aW5nIGB0bHMuU29ja2V0YDogJW8nLCB0aGlzLmNvbm5lY3RPcHRzKTsKICAgICAgY29uc3Qgc2VydmVybmFtZSA9IHRoaXMuY29ubmVjdE9wdHMuc2VydmVybmFtZSB8fCB0aGlzLmNvbm5lY3RPcHRzLmhvc3Q7CiAgICAgIHNvY2tldCA9IHRscy5jb25uZWN0KHsKICAgICAgICAuLi50aGlzLmNvbm5lY3RPcHRzLAogICAgICAgIHNlcnZlcm5hbWU6IHNlcnZlcm5hbWUgJiYgbmV0LmlzSVAoc2VydmVybmFtZSkgPyB1bmRlZmluZWQgOiBzZXJ2ZXJuYW1lLAogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGRlYnVnKCdDcmVhdGluZyBgbmV0LlNvY2tldGA6ICVvJywgdGhpcy5jb25uZWN0T3B0cyk7CiAgICAgIHNvY2tldCA9IG5ldC5jb25uZWN0KHRoaXMuY29ubmVjdE9wdHMpOwogICAgfQoKICAgIGNvbnN0IGhlYWRlcnMgPQogICAgICB0eXBlb2YgdGhpcy5wcm94eUhlYWRlcnMgPT09ICdmdW5jdGlvbicgPyB0aGlzLnByb3h5SGVhZGVycygpIDogeyAuLi50aGlzLnByb3h5SGVhZGVycyB9OwogICAgY29uc3QgaG9zdCA9IG5ldC5pc0lQdjYob3B0cy5ob3N0KSA/IGBbJHtvcHRzLmhvc3R9XWAgOiBvcHRzLmhvc3Q7CiAgICBsZXQgcGF5bG9hZCA9IGBDT05ORUNUICR7aG9zdH06JHtvcHRzLnBvcnR9IEhUVFAvMS4xXHJcbmA7CgogICAgLy8gSW5qZWN0IHRoZSBgUHJveHktQXV0aG9yaXphdGlvbmAgaGVhZGVyIGlmIG5lY2Vzc2FyeS4KICAgIGlmIChwcm94eS51c2VybmFtZSB8fCBwcm94eS5wYXNzd29yZCkgewogICAgICBjb25zdCBhdXRoID0gYCR7ZGVjb2RlVVJJQ29tcG9uZW50KHByb3h5LnVzZXJuYW1lKX06JHtkZWNvZGVVUklDb21wb25lbnQocHJveHkucGFzc3dvcmQpfWA7CiAgICAgIGhlYWRlcnNbJ1Byb3h5LUF1dGhvcml6YXRpb24nXSA9IGBCYXNpYyAke0J1ZmZlci5mcm9tKGF1dGgpLnRvU3RyaW5nKCdiYXNlNjQnKX1gOwogICAgfQoKICAgIGhlYWRlcnMuSG9zdCA9IGAke2hvc3R9OiR7b3B0cy5wb3J0fWA7CgogICAgaWYgKCFoZWFkZXJzWydQcm94eS1Db25uZWN0aW9uJ10pIHsKICAgICAgaGVhZGVyc1snUHJveHktQ29ubmVjdGlvbiddID0gdGhpcy5rZWVwQWxpdmUgPyAnS2VlcC1BbGl2ZScgOiAnY2xvc2UnOwogICAgfQogICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5rZXlzKGhlYWRlcnMpKSB7CiAgICAgIHBheWxvYWQgKz0gYCR7bmFtZX06ICR7aGVhZGVyc1tuYW1lXX1cclxuYDsKICAgIH0KCiAgICBjb25zdCBwcm94eVJlc3BvbnNlUHJvbWlzZSA9IHBhcnNlUHJveHlSZXNwb25zZShzb2NrZXQpOwoKICAgIHNvY2tldC53cml0ZShgJHtwYXlsb2FkfVxyXG5gKTsKCiAgICBjb25zdCB7IGNvbm5lY3QsIGJ1ZmZlcmVkIH0gPSBhd2FpdCBwcm94eVJlc3BvbnNlUHJvbWlzZTsKICAgIHJlcS5lbWl0KCdwcm94eUNvbm5lY3QnLCBjb25uZWN0KTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQKICAgIC8vIEB0cy1pZ25vcmUgTm90IEV2ZW50RW1pdHRlciBpbiBOb2RlIHR5cGVzCiAgICB0aGlzLmVtaXQoJ3Byb3h5Q29ubmVjdCcsIGNvbm5lY3QsIHJlcSk7CgogICAgaWYgKGNvbm5lY3Quc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgIHJlcS5vbmNlKCdzb2NrZXQnLCByZXN1bWUpOwoKICAgICAgaWYgKG9wdHMuc2VjdXJlRW5kcG9pbnQpIHsKICAgICAgICAvLyBUaGUgcHJveHkgaXMgY29ubmVjdGluZyB0byBhIFRMUyBzZXJ2ZXIsIHNvIHVwZ3JhZGUKICAgICAgICAvLyB0aGlzIHNvY2tldCBjb25uZWN0aW9uIHRvIGEgVExTIGNvbm5lY3Rpb24uCiAgICAgICAgZGVidWcoJ1VwZ3JhZGluZyBzb2NrZXQgY29ubmVjdGlvbiB0byBUTFMnKTsKICAgICAgICBjb25zdCBzZXJ2ZXJuYW1lID0gb3B0cy5zZXJ2ZXJuYW1lIHx8IG9wdHMuaG9zdDsKICAgICAgICByZXR1cm4gdGxzLmNvbm5lY3QoewogICAgICAgICAgLi4ub21pdChvcHRzLCAnaG9zdCcsICdwYXRoJywgJ3BvcnQnKSwKICAgICAgICAgIHNvY2tldCwKICAgICAgICAgIHNlcnZlcm5hbWU6IG5ldC5pc0lQKHNlcnZlcm5hbWUpID8gdW5kZWZpbmVkIDogc2VydmVybmFtZSwKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNvY2tldDsKICAgIH0KCiAgICAvLyBTb21lIG90aGVyIHN0YXR1cyBjb2RlIHRoYXQncyBub3QgMjAwLi4uIG5lZWQgdG8gcmUtcGxheSB0aGUgSFRUUAogICAgLy8gaGVhZGVyICJkYXRhIiBldmVudHMgb250byB0aGUgc29ja2V0IG9uY2UgdGhlIEhUVFAgbWFjaGluZXJ5IGlzCiAgICAvLyBhdHRhY2hlZCBzbyB0aGF0IHRoZSBub2RlIGNvcmUgYGh0dHBgIGNhbiBwYXJzZSBhbmQgaGFuZGxlIHRoZQogICAgLy8gZXJyb3Igc3RhdHVzIGNvZGUuCgogICAgLy8gQ2xvc2UgdGhlIG9yaWdpbmFsIHNvY2tldCwgYW5kIGEgbmV3ICJmYWtlIiBzb2NrZXQgaXMgcmV0dXJuZWQKICAgIC8vIGluc3RlYWQsIHNvIHRoYXQgdGhlIHByb3h5IGRvZXNuJ3QgZ2V0IHRoZSBIVFRQIHJlcXVlc3QKICAgIC8vIHdyaXR0ZW4gdG8gaXQgKHdoaWNoIG1heSBjb250YWluIGBBdXRob3JpemF0aW9uYCBoZWFkZXJzIG9yIG90aGVyCiAgICAvLyBzZW5zaXRpdmUgZGF0YSkuCiAgICAvLwogICAgLy8gU2VlOiBodHRwczovL2hhY2tlcm9uZS5jb20vcmVwb3J0cy81NDE1MDIKICAgIHNvY2tldC5kZXN0cm95KCk7CgogICAgY29uc3QgZmFrZVNvY2tldCA9IG5ldyBuZXQuU29ja2V0KHsgd3JpdGFibGU6IGZhbHNlIH0pOwogICAgZmFrZVNvY2tldC5yZWFkYWJsZSA9IHRydWU7CgogICAgLy8gTmVlZCB0byB3YWl0IGZvciB0aGUgInNvY2tldCIgZXZlbnQgdG8gcmUtcGxheSB0aGUgImRhdGEiIGV2ZW50cy4KICAgIHJlcS5vbmNlKCdzb2NrZXQnLCAocykgPT4gewogICAgICBkZWJ1ZygnUmVwbGF5aW5nIHByb3h5IGJ1ZmZlciBmb3IgZmFpbGVkIHJlcXVlc3QnKTsKICAgICAgLy8gUmVwbGF5IHRoZSAiYnVmZmVyZWQiIEJ1ZmZlciBvbnRvIHRoZSBmYWtlIGBzb2NrZXRgLCBzaW5jZSBhdAogICAgICAvLyB0aGlzIHBvaW50IHRoZSBIVFRQIG1vZHVsZSBtYWNoaW5lcnkgaGFzIGJlZW4gaG9va2VkIHVwIGZvcgogICAgICAvLyB0aGUgdXNlci4KICAgICAgcy5wdXNoKGJ1ZmZlcmVkKTsKICAgICAgcy5wdXNoKG51bGwpOwogICAgfSk7CgogICAgcmV0dXJuIGZha2VTb2NrZXQ7CiAgfQp9IEh0dHBzUHJveHlBZ2VudC5fX2luaXRTdGF0aWMoKTsKCmZ1bmN0aW9uIHJlc3VtZShzb2NrZXQpIHsKICBzb2NrZXQucmVzdW1lKCk7Cn0KCmZ1bmN0aW9uIG9taXQoCiAgb2JqLAogIC4uLmtleXMKKQoKIHsKICBjb25zdCByZXQgPSB7fQoKOwogIGxldCBrZXk7CiAgZm9yIChrZXkgaW4gb2JqKSB7CiAgICBpZiAoIWtleXMuaW5jbHVkZXMoa2V5KSkgewogICAgICByZXRba2V5XSA9IG9ialtrZXldOwogICAgfQogIH0KICByZXR1cm4gcmV0Owp9CgpmdW5jdGlvbiBfbnVsbGlzaENvYWxlc2NlKGxocywgcmhzRm4pIHsgaWYgKGxocyAhPSBudWxsKSB7IHJldHVybiBsaHM7IH0gZWxzZSB7IHJldHVybiByaHNGbigpOyB9IH0KLy8gRXN0aW1hdGVkIG1heGltdW0gc2l6ZSBmb3IgcmVhc29uYWJsZSBzdGFuZGFsb25lIGV2ZW50CmNvbnN0IEdaSVBfVEhSRVNIT0xEID0gMTAyNCAqIDMyOwoKLyoqCiAqIEdldHMgYSBzdHJlYW0gZnJvbSBhIFVpbnQ4QXJyYXkgb3Igc3RyaW5nCiAqIFJlYWRhYmxlLmZyb20gaXMgaWRlYWwgYnV0IHdhcyBhZGRlZCBpbiBub2RlLmpzIHYxMi4zLjAgYW5kIHYxMC4xNy4wCiAqLwpmdW5jdGlvbiBzdHJlYW1Gcm9tQm9keShib2R5KSB7CiAgcmV0dXJuIG5ldyBSZWFkYWJsZSh7CiAgICByZWFkKCkgewogICAgICB0aGlzLnB1c2goYm9keSk7CiAgICAgIHRoaXMucHVzaChudWxsKTsKICAgIH0sCiAgfSk7Cn0KCi8qKgogKiBDcmVhdGVzIGEgVHJhbnNwb3J0IHRoYXQgdXNlcyBuYXRpdmUgdGhlIG5hdGl2ZSAnaHR0cCcgYW5kICdodHRwcycgbW9kdWxlcyB0byBzZW5kIGV2ZW50cyB0byBTZW50cnkuCiAqLwpmdW5jdGlvbiBtYWtlTm9kZVRyYW5zcG9ydChvcHRpb25zKSB7CiAgbGV0IHVybFNlZ21lbnRzOwoKICB0cnkgewogICAgdXJsU2VnbWVudHMgPSBuZXcgVVJMKG9wdGlvbnMudXJsKTsKICB9IGNhdGNoIChlKSB7CiAgICBjb25zb2xlU2FuZGJveCgoKSA9PiB7CiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlCiAgICAgIGNvbnNvbGUud2FybigKICAgICAgICAnW0BzZW50cnkvbm9kZV06IEludmFsaWQgZHNuIG9yIHR1bm5lbCBvcHRpb24sIHdpbGwgbm90IHNlbmQgYW55IGV2ZW50cy4gVGhlIHR1bm5lbCBvcHRpb24gbXVzdCBiZSBhIGZ1bGwgVVJMIHdoZW4gdXNlZC4nLAogICAgICApOwogICAgfSk7CiAgICByZXR1cm4gY3JlYXRlVHJhbnNwb3J0KG9wdGlvbnMsICgpID0+IFByb21pc2UucmVzb2x2ZSh7fSkpOwogIH0KCiAgY29uc3QgaXNIdHRwcyA9IHVybFNlZ21lbnRzLnByb3RvY29sID09PSAnaHR0cHM6JzsKCiAgLy8gUHJveHkgcHJpb3JpdGl6YXRpb246IGh0dHAgPT4gYG9wdGlvbnMucHJveHlgIHwgYHByb2Nlc3MuZW52Lmh0dHBfcHJveHlgCiAgLy8gUHJveHkgcHJpb3JpdGl6YXRpb246IGh0dHBzID0+IGBvcHRpb25zLnByb3h5YCB8IGBwcm9jZXNzLmVudi5odHRwc19wcm94eWAgfCBgcHJvY2Vzcy5lbnYuaHR0cF9wcm94eWAKICBjb25zdCBwcm94eSA9IGFwcGx5Tm9Qcm94eU9wdGlvbigKICAgIHVybFNlZ21lbnRzLAogICAgb3B0aW9ucy5wcm94eSB8fCAoaXNIdHRwcyA/IHByb2Nlc3MuZW52Lmh0dHBzX3Byb3h5IDogdW5kZWZpbmVkKSB8fCBwcm9jZXNzLmVudi5odHRwX3Byb3h5LAogICk7CgogIGNvbnN0IG5hdGl2ZUh0dHBNb2R1bGUgPSBpc0h0dHBzID8gaHR0cHMgOiBodHRwOwogIGNvbnN0IGtlZXBBbGl2ZSA9IG9wdGlvbnMua2VlcEFsaXZlID09PSB1bmRlZmluZWQgPyBmYWxzZSA6IG9wdGlvbnMua2VlcEFsaXZlOwoKICAvLyBUT0RPKHY3KTogRXZhbHVhdGUgaWYgd2UgY2FuIHNldCBrZWVwQWxpdmUgdG8gdHJ1ZS4gVGhpcyB3b3VsZCBpbnZvbHZlIHRlc3RpbmcgZm9yIG1lbW9yeSBsZWFrcyBpbiBvbGRlciBub2RlCiAgLy8gdmVyc2lvbnMoPj0gOCkgYXMgdGhleSBoYWQgbWVtb3J5IGxlYWtzIHdoZW4gdXNpbmcgaXQ6ICMyNTU1CiAgY29uc3QgYWdlbnQgPSBwcm94eQogICAgPyAobmV3IEh0dHBzUHJveHlBZ2VudChwcm94eSkgKQogICAgOiBuZXcgbmF0aXZlSHR0cE1vZHVsZS5BZ2VudCh7IGtlZXBBbGl2ZSwgbWF4U29ja2V0czogMzAsIHRpbWVvdXQ6IDIwMDAgfSk7CgogIGNvbnN0IHJlcXVlc3RFeGVjdXRvciA9IGNyZWF0ZVJlcXVlc3RFeGVjdXRvcihvcHRpb25zLCBfbnVsbGlzaENvYWxlc2NlKG9wdGlvbnMuaHR0cE1vZHVsZSwgKCkgPT4gKCBuYXRpdmVIdHRwTW9kdWxlKSksIGFnZW50KTsKICByZXR1cm4gY3JlYXRlVHJhbnNwb3J0KG9wdGlvbnMsIHJlcXVlc3RFeGVjdXRvcik7Cn0KCi8qKgogKiBIb25vcnMgdGhlIGBub19wcm94eWAgZW52IHZhcmlhYmxlIHdpdGggdGhlIGhpZ2hlc3QgcHJpb3JpdHkgdG8gYWxsb3cgZm9yIGhvc3RzIGV4Y2x1c2lvbi4KICoKICogQHBhcmFtIHRyYW5zcG9ydFVybCBUaGUgVVJMIHRoZSB0cmFuc3BvcnQgaW50ZW5kcyB0byBzZW5kIGV2ZW50cyB0by4KICogQHBhcmFtIHByb3h5IFRoZSBjbGllbnQgY29uZmlndXJlZCBwcm94eS4KICogQHJldHVybnMgQSBwcm94eSB0aGUgdHJhbnNwb3J0IHNob3VsZCB1c2UuCiAqLwpmdW5jdGlvbiBhcHBseU5vUHJveHlPcHRpb24odHJhbnNwb3J0VXJsU2VnbWVudHMsIHByb3h5KSB7CiAgY29uc3QgeyBub19wcm94eSB9ID0gcHJvY2Vzcy5lbnY7CgogIGNvbnN0IHVybElzRXhlbXB0RnJvbVByb3h5ID0KICAgIG5vX3Byb3h5ICYmCiAgICBub19wcm94eQogICAgICAuc3BsaXQoJywnKQogICAgICAuc29tZSgKICAgICAgICBleGVtcHRpb24gPT4gdHJhbnNwb3J0VXJsU2VnbWVudHMuaG9zdC5lbmRzV2l0aChleGVtcHRpb24pIHx8IHRyYW5zcG9ydFVybFNlZ21lbnRzLmhvc3RuYW1lLmVuZHNXaXRoKGV4ZW1wdGlvbiksCiAgICAgICk7CgogIGlmICh1cmxJc0V4ZW1wdEZyb21Qcm94eSkgewogICAgcmV0dXJuIHVuZGVmaW5lZDsKICB9IGVsc2UgewogICAgcmV0dXJuIHByb3h5OwogIH0KfQoKLyoqCiAqIENyZWF0ZXMgYSBSZXF1ZXN0RXhlY3V0b3IgdG8gYmUgdXNlZCB3aXRoIGBjcmVhdGVUcmFuc3BvcnRgLgogKi8KZnVuY3Rpb24gY3JlYXRlUmVxdWVzdEV4ZWN1dG9yKAogIG9wdGlvbnMsCiAgaHR0cE1vZHVsZSwKICBhZ2VudCwKKSB7CiAgY29uc3QgeyBob3N0bmFtZSwgcGF0aG5hbWUsIHBvcnQsIHByb3RvY29sLCBzZWFyY2ggfSA9IG5ldyBVUkwob3B0aW9ucy51cmwpOwogIHJldHVybiBmdW5jdGlvbiBtYWtlUmVxdWVzdChyZXF1ZXN0KSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBsZXQgYm9keSA9IHN0cmVhbUZyb21Cb2R5KHJlcXVlc3QuYm9keSk7CgogICAgICBjb25zdCBoZWFkZXJzID0geyAuLi5vcHRpb25zLmhlYWRlcnMgfTsKCiAgICAgIGlmIChyZXF1ZXN0LmJvZHkubGVuZ3RoID4gR1pJUF9USFJFU0hPTEQpIHsKICAgICAgICBoZWFkZXJzWydjb250ZW50LWVuY29kaW5nJ10gPSAnZ3ppcCc7CiAgICAgICAgYm9keSA9IGJvZHkucGlwZShjcmVhdGVHemlwKCkpOwogICAgICB9CgogICAgICBjb25zdCByZXEgPSBodHRwTW9kdWxlLnJlcXVlc3QoCiAgICAgICAgewogICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICBhZ2VudCwKICAgICAgICAgIGhlYWRlcnMsCiAgICAgICAgICBob3N0bmFtZSwKICAgICAgICAgIHBhdGg6IGAke3BhdGhuYW1lfSR7c2VhcmNofWAsCiAgICAgICAgICBwb3J0LAogICAgICAgICAgcHJvdG9jb2wsCiAgICAgICAgICBjYTogb3B0aW9ucy5jYUNlcnRzLAogICAgICAgIH0sCiAgICAgICAgcmVzID0+IHsKICAgICAgICAgIHJlcy5vbignZGF0YScsICgpID0+IHsKICAgICAgICAgICAgLy8gRHJhaW4gc29ja2V0CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXMub24oJ2VuZCcsICgpID0+IHsKICAgICAgICAgICAgLy8gRHJhaW4gc29ja2V0CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXMuc2V0RW5jb2RpbmcoJ3V0ZjgnKTsKCiAgICAgICAgICAvLyAiS2V5LXZhbHVlIHBhaXJzIG9mIGhlYWRlciBuYW1lcyBhbmQgdmFsdWVzLiBIZWFkZXIgbmFtZXMgYXJlIGxvd2VyLWNhc2VkLiIKICAgICAgICAgIC8vIGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvaHR0cC5odG1sI2h0dHBfbWVzc2FnZV9oZWFkZXJzCiAgICAgICAgICBjb25zdCByZXRyeUFmdGVySGVhZGVyID0gX251bGxpc2hDb2FsZXNjZShyZXMuaGVhZGVyc1sncmV0cnktYWZ0ZXInXSwgKCkgPT4gKCBudWxsKSk7CiAgICAgICAgICBjb25zdCByYXRlTGltaXRzSGVhZGVyID0gX251bGxpc2hDb2FsZXNjZShyZXMuaGVhZGVyc1sneC1zZW50cnktcmF0ZS1saW1pdHMnXSwgKCkgPT4gKCBudWxsKSk7CgogICAgICAgICAgcmVzb2x2ZSh7CiAgICAgICAgICAgIHN0YXR1c0NvZGU6IHJlcy5zdGF0dXNDb2RlLAogICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgJ3JldHJ5LWFmdGVyJzogcmV0cnlBZnRlckhlYWRlciwKICAgICAgICAgICAgICAneC1zZW50cnktcmF0ZS1saW1pdHMnOiBBcnJheS5pc0FycmF5KHJhdGVMaW1pdHNIZWFkZXIpID8gcmF0ZUxpbWl0c0hlYWRlclswXSA6IHJhdGVMaW1pdHNIZWFkZXIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICApOwoKICAgICAgcmVxLm9uKCdlcnJvcicsIHJlamVjdCk7CiAgICAgIGJvZHkucGlwZShyZXEpOwogICAgfSk7CiAgfTsKfQoKZnVuY3Rpb24gX29wdGlvbmFsQ2hhaW4ob3BzKSB7IGxldCBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyBsZXQgdmFsdWUgPSBvcHNbMF07IGxldCBpID0gMTsgd2hpbGUgKGkgPCBvcHMubGVuZ3RoKSB7IGNvbnN0IG9wID0gb3BzW2ldOyBjb25zdCBmbiA9IG9wc1tpICsgMV07IGkgKz0gMjsgaWYgKChvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpICYmIHZhbHVlID09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBpZiAob3AgPT09ICdhY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnKSB7IGxhc3RBY2Nlc3NMSFMgPSB2YWx1ZTsgdmFsdWUgPSBmbih2YWx1ZSk7IH0gZWxzZSBpZiAob3AgPT09ICdjYWxsJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpIHsgdmFsdWUgPSBmbigoLi4uYXJncykgPT4gdmFsdWUuY2FsbChsYXN0QWNjZXNzTEhTLCAuLi5hcmdzKSk7IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IH0gfSByZXR1cm4gdmFsdWU7IH0KY29uc3Qgb3B0aW9ucyA9IHdvcmtlckRhdGE7CmxldCBzZXNzaW9uOwpsZXQgaGFzU2VudEFuckV2ZW50ID0gZmFsc2U7CgpmdW5jdGlvbiBsb2cobXNnKSB7CiAgaWYgKG9wdGlvbnMuZGVidWcpIHsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlCiAgICBjb25zb2xlLmxvZyhgW0FOUiBXb3JrZXJdICR7bXNnfWApOwogIH0KfQoKY29uc3QgdXJsID0gZ2V0RW52ZWxvcGVFbmRwb2ludFdpdGhVcmxFbmNvZGVkQXV0aChvcHRpb25zLmRzbik7CmNvbnN0IHRyYW5zcG9ydCA9IG1ha2VOb2RlVHJhbnNwb3J0KHsKICB1cmwsCiAgcmVjb3JkRHJvcHBlZEV2ZW50OiAoKSA9PiB7CiAgICAvLwogIH0sCn0pOwoKYXN5bmMgZnVuY3Rpb24gc2VuZEFibm9ybWFsU2Vzc2lvbigpIHsKICAvLyBvZiB3ZSBoYXZlIGFuIGV4aXN0aW5nIHNlc3Npb24gcGFzc2VkIGZyb20gdGhlIG1haW4gdGhyZWFkLCBzZW5kIGl0IGFzIGFibm9ybWFsCiAgaWYgKHNlc3Npb24pIHsKICAgIGxvZygnU2VuZGluZyBhYm5vcm1hbCBzZXNzaW9uJyk7CiAgICB1cGRhdGVTZXNzaW9uKHNlc3Npb24sIHsgc3RhdHVzOiAnYWJub3JtYWwnLCBhYm5vcm1hbF9tZWNoYW5pc206ICdhbnJfZm9yZWdyb3VuZCcgfSk7CgogICAgY29uc3QgZW52ZWxvcGUgPSBjcmVhdGVTZXNzaW9uRW52ZWxvcGUoc2Vzc2lvbiwgb3B0aW9ucy5kc24sIG9wdGlvbnMuc2RrTWV0YWRhdGEpOwogICAgLy8gTG9nIHRoZSBlbnZlbG9wZSBzbyB0byBhaWQgaW4gdGVzdGluZwogICAgbG9nKEpTT04uc3RyaW5naWZ5KGVudmVsb3BlKSk7CgogICAgYXdhaXQgdHJhbnNwb3J0LnNlbmQoZW52ZWxvcGUpOwoKICAgIHRyeSB7CiAgICAgIC8vIE5vdGlmeSB0aGUgbWFpbiBwcm9jZXNzIHRoYXQgdGhlIHNlc3Npb24gaGFzIGVuZGVkIHNvIHRoZSBzZXNzaW9uIGNhbiBiZSBjbGVhcmVkIGZyb20gdGhlIHNjb3BlCiAgICAgIF9vcHRpb25hbENoYWluKFtwYXJlbnRQb3J0LCAnb3B0aW9uYWxBY2Nlc3MnLCBfMiA9PiBfMi5wb3N0TWVzc2FnZSwgJ2NhbGwnLCBfMyA9PiBfMygnc2Vzc2lvbi1lbmRlZCcpXSk7CiAgICB9IGNhdGNoIChfKSB7CiAgICAgIC8vIGlnbm9yZQogICAgfQogIH0KfQoKbG9nKCdTdGFydGVkJyk7CgpmdW5jdGlvbiBwcmVwYXJlU3RhY2tGcmFtZXMoc3RhY2tGcmFtZXMpIHsKICBpZiAoIXN0YWNrRnJhbWVzKSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgLy8gU3RyaXAgU2VudHJ5IGZyYW1lcyBhbmQgcmV2ZXJzZSB0aGUgc3RhY2sgZnJhbWVzIHNvIHRoZXkgYXJlIGluIHRoZSBjb3JyZWN0IG9yZGVyCiAgY29uc3Qgc3RyaXBwZWRGcmFtZXMgPSBzdHJpcFNlbnRyeUZyYW1lc0FuZFJldmVyc2Uoc3RhY2tGcmFtZXMpOwoKICAvLyBJZiB3ZSBoYXZlIGFuIGFwcCByb290IHBhdGgsIHJld3JpdGUgdGhlIGZpbGVuYW1lcyB0byBiZSByZWxhdGl2ZSB0byB0aGUgYXBwIHJvb3QKICBpZiAob3B0aW9ucy5hcHBSb290UGF0aCkgewogICAgZm9yIChjb25zdCBmcmFtZSBvZiBzdHJpcHBlZEZyYW1lcykgewogICAgICBpZiAoIWZyYW1lLmZpbGVuYW1lKSB7CiAgICAgICAgY29udGludWU7CiAgICAgIH0KCiAgICAgIGZyYW1lLmZpbGVuYW1lID0gbm9ybWFsaXplVXJsVG9CYXNlKGZyYW1lLmZpbGVuYW1lLCBvcHRpb25zLmFwcFJvb3RQYXRoKTsKICAgIH0KICB9CgogIHJldHVybiBzdHJpcHBlZEZyYW1lczsKfQoKZnVuY3Rpb24gYXBwbHlTY29wZVRvRXZlbnQoZXZlbnQsIHNjb3BlKSB7CiAgYXBwbHlTY29wZURhdGFUb0V2ZW50KGV2ZW50LCBzY29wZSk7CgogIGlmICghX29wdGlvbmFsQ2hhaW4oW2V2ZW50LCAnYWNjZXNzJywgXzQgPT4gXzQuY29udGV4dHMsICdvcHRpb25hbEFjY2VzcycsIF81ID0+IF81LnRyYWNlXSkpIHsKICAgIGNvbnN0IHsgdHJhY2VJZCwgc3BhbklkLCBwYXJlbnRTcGFuSWQgfSA9IHNjb3BlLnByb3BhZ2F0aW9uQ29udGV4dDsKICAgIGV2ZW50LmNvbnRleHRzID0gewogICAgICB0cmFjZTogewogICAgICAgIHRyYWNlX2lkOiB0cmFjZUlkLAogICAgICAgIHNwYW5faWQ6IHNwYW5JZCwKICAgICAgICBwYXJlbnRfc3Bhbl9pZDogcGFyZW50U3BhbklkLAogICAgICB9LAogICAgICAuLi5ldmVudC5jb250ZXh0cywKICAgIH07CiAgfQp9Cgphc3luYyBmdW5jdGlvbiBzZW5kQW5yRXZlbnQoZnJhbWVzLCBzY29wZSkgewogIGlmIChoYXNTZW50QW5yRXZlbnQpIHsKICAgIHJldHVybjsKICB9CgogIGhhc1NlbnRBbnJFdmVudCA9IHRydWU7CgogIGF3YWl0IHNlbmRBYm5vcm1hbFNlc3Npb24oKTsKCiAgbG9nKCdTZW5kaW5nIGV2ZW50Jyk7CgogIGNvbnN0IGV2ZW50ID0gewogICAgZXZlbnRfaWQ6IHV1aWQ0KCksCiAgICBjb250ZXh0czogb3B0aW9ucy5jb250ZXh0cywKICAgIHJlbGVhc2U6IG9wdGlvbnMucmVsZWFzZSwKICAgIGVudmlyb25tZW50OiBvcHRpb25zLmVudmlyb25tZW50LAogICAgZGlzdDogb3B0aW9ucy5kaXN0LAogICAgcGxhdGZvcm06ICdub2RlJywKICAgIGxldmVsOiAnZXJyb3InLAogICAgZXhjZXB0aW9uOiB7CiAgICAgIHZhbHVlczogWwogICAgICAgIHsKICAgICAgICAgIHR5cGU6ICdBcHBsaWNhdGlvbk5vdFJlc3BvbmRpbmcnLAogICAgICAgICAgdmFsdWU6IGBBcHBsaWNhdGlvbiBOb3QgUmVzcG9uZGluZyBmb3IgYXQgbGVhc3QgJHtvcHRpb25zLmFuclRocmVzaG9sZH0gbXNgLAogICAgICAgICAgc3RhY2t0cmFjZTogeyBmcmFtZXM6IHByZXBhcmVTdGFja0ZyYW1lcyhmcmFtZXMpIH0sCiAgICAgICAgICAvLyBUaGlzIGVuc3VyZXMgdGhlIFVJIGRvZXNuJ3Qgc2F5ICdDcmFzaGVkIGluJyBmb3IgdGhlIHN0YWNrIHRyYWNlCiAgICAgICAgICBtZWNoYW5pc206IHsgdHlwZTogJ0FOUicgfSwKICAgICAgICB9LAogICAgICBdLAogICAgfSwKICAgIHRhZ3M6IG9wdGlvbnMuc3RhdGljVGFncywKICB9OwoKICBpZiAoc2NvcGUpIHsKICAgIGFwcGx5U2NvcGVUb0V2ZW50KGV2ZW50LCBzY29wZSk7CiAgfQoKICBjb25zdCBlbnZlbG9wZSA9IGNyZWF0ZUV2ZW50RW52ZWxvcGUoZXZlbnQsIG9wdGlvbnMuZHNuLCBvcHRpb25zLnNka01ldGFkYXRhKTsKICAvLyBMb2cgdGhlIGVudmVsb3BlIHRvIGFpZCBpbiB0ZXN0aW5nCiAgbG9nKEpTT04uc3RyaW5naWZ5KGVudmVsb3BlKSk7CgogIGF3YWl0IHRyYW5zcG9ydC5zZW5kKGVudmVsb3BlKTsKICBhd2FpdCB0cmFuc3BvcnQuZmx1c2goMjAwMCk7CgogIC8vIERlbGF5IGZvciA1IHNlY29uZHMgc28gdGhhdCBzdGRpbyBjYW4gZmx1c2ggaW4gdGhlIG1haW4gZXZlbnQgbG9vcCBldmVyIHJlc3RhcnRzLgogIC8vIFRoaXMgaXMgbWFpbmx5IGZvciB0aGUgYmVuZWZpdCBvZiBsb2dnaW5nL2RlYnVnZ2luZyBpc3N1ZXMuCiAgc2V0VGltZW91dCgoKSA9PiB7CiAgICBwcm9jZXNzLmV4aXQoMCk7CiAgfSwgNTAwMCk7Cn0KCmxldCBkZWJ1Z2dlclBhdXNlOwoKaWYgKG9wdGlvbnMuY2FwdHVyZVN0YWNrVHJhY2UpIHsKICBsb2coJ0Nvbm5lY3RpbmcgdG8gZGVidWdnZXInKTsKCiAgY29uc3Qgc2Vzc2lvbiA9IG5ldyBTZXNzaW9uKCkgOwogIHNlc3Npb24uY29ubmVjdFRvTWFpblRocmVhZCgpOwoKICBsb2coJ0Nvbm5lY3RlZCB0byBkZWJ1Z2dlcicpOwoKICAvLyBDb2xsZWN0IHNjcmlwdElkIC0+IHVybCBtYXAgc28gd2UgY2FuIGxvb2sgdXAgdGhlIGZpbGVuYW1lcyBsYXRlcgogIGNvbnN0IHNjcmlwdHMgPSBuZXcgTWFwKCk7CgogIHNlc3Npb24ub24oJ0RlYnVnZ2VyLnNjcmlwdFBhcnNlZCcsIGV2ZW50ID0+IHsKICAgIHNjcmlwdHMuc2V0KGV2ZW50LnBhcmFtcy5zY3JpcHRJZCwgZXZlbnQucGFyYW1zLnVybCk7CiAgfSk7CgogIHNlc3Npb24ub24oJ0RlYnVnZ2VyLnBhdXNlZCcsIGV2ZW50ID0+IHsKICAgIGlmIChldmVudC5wYXJhbXMucmVhc29uICE9PSAnb3RoZXInKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICB0cnkgewogICAgICBsb2coJ0RlYnVnZ2VyIHBhdXNlZCcpOwoKICAgICAgLy8gY29weSB0aGUgZnJhbWVzCiAgICAgIGNvbnN0IGNhbGxGcmFtZXMgPSBbLi4uZXZlbnQucGFyYW1zLmNhbGxGcmFtZXNdOwoKICAgICAgY29uc3QgZ2V0TW9kdWxlTmFtZSA9IG9wdGlvbnMuYXBwUm9vdFBhdGggPyBjcmVhdGVHZXRNb2R1bGVGcm9tRmlsZW5hbWUob3B0aW9ucy5hcHBSb290UGF0aCkgOiAoKSA9PiB1bmRlZmluZWQ7CiAgICAgIGNvbnN0IHN0YWNrRnJhbWVzID0gY2FsbEZyYW1lcy5tYXAoZnJhbWUgPT4KICAgICAgICBjYWxsRnJhbWVUb1N0YWNrRnJhbWUoZnJhbWUsIHNjcmlwdHMuZ2V0KGZyYW1lLmxvY2F0aW9uLnNjcmlwdElkKSwgZ2V0TW9kdWxlTmFtZSksCiAgICAgICk7CgogICAgICAvLyBFdmFsdWF0ZSBhIHNjcmlwdCBpbiB0aGUgY3VycmVudGx5IHBhdXNlZCBjb250ZXh0CiAgICAgIHNlc3Npb24ucG9zdCgKICAgICAgICAnUnVudGltZS5ldmFsdWF0ZScsCiAgICAgICAgewogICAgICAgICAgLy8gR3JhYiB0aGUgdHJhY2UgY29udGV4dCBmcm9tIHRoZSBjdXJyZW50IHNjb3BlCiAgICAgICAgICBleHByZXNzaW9uOiAnZ2xvYmFsLl9fU0VOVFJZX0dFVF9TQ09QRVNfXygpOycsCiAgICAgICAgICAvLyBEb24ndCByZS10cmlnZ2VyIHRoZSBkZWJ1Z2dlciBpZiB0aGlzIGNhdXNlcyBhbiBlcnJvcgogICAgICAgICAgc2lsZW50OiB0cnVlLAogICAgICAgICAgLy8gU2VyaWFsaXplIHRoZSByZXN1bHQgdG8ganNvbiBvdGhlcndpc2Ugb25seSBwcmltaXRpdmVzIGFyZSBzdXBwb3J0ZWQKICAgICAgICAgIHJldHVybkJ5VmFsdWU6IHRydWUsCiAgICAgICAgfSwKICAgICAgICAoZXJyLCBwYXJhbSkgPT4gewogICAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICBsb2coYEVycm9yIGV4ZWN1dGluZyBzY3JpcHQ6ICcke2Vyci5tZXNzYWdlfSdgKTsKICAgICAgICAgIH0KCiAgICAgICAgICBjb25zdCBzY29wZXMgPSBwYXJhbSAmJiBwYXJhbS5yZXN1bHQgPyAocGFyYW0ucmVzdWx0LnZhbHVlICkgOiB1bmRlZmluZWQ7CgogICAgICAgICAgc2Vzc2lvbi5wb3N0KCdEZWJ1Z2dlci5yZXN1bWUnKTsKICAgICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZGlzYWJsZScpOwoKICAgICAgICAgIHNlbmRBbnJFdmVudChzdGFja0ZyYW1lcywgc2NvcGVzKS50aGVuKG51bGwsICgpID0+IHsKICAgICAgICAgICAgbG9nKCdTZW5kaW5nIEFOUiBldmVudCBmYWlsZWQuJyk7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICApOwogICAgfSBjYXRjaCAoZSkgewogICAgICBzZXNzaW9uLnBvc3QoJ0RlYnVnZ2VyLnJlc3VtZScpOwogICAgICBzZXNzaW9uLnBvc3QoJ0RlYnVnZ2VyLmRpc2FibGUnKTsKICAgICAgdGhyb3cgZTsKICAgIH0KICB9KTsKCiAgZGVidWdnZXJQYXVzZSA9ICgpID0+IHsKICAgIHRyeSB7CiAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZW5hYmxlJywgKCkgPT4gewogICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIucGF1c2UnKTsKICAgICAgfSk7CiAgICB9IGNhdGNoIChfKSB7CiAgICAgIC8vCiAgICB9CiAgfTsKfQoKZnVuY3Rpb24gY3JlYXRlSHJUaW1lcigpIHsKICAvLyBUT0RPICh2OCk6IFdlIGNhbiB1c2UgcHJvY2Vzcy5ocnRpbWUuYmlnaW50KCkgYWZ0ZXIgd2UgZHJvcCBub2RlIHY4CiAgbGV0IGxhc3RQb2xsID0gcHJvY2Vzcy5ocnRpbWUoKTsKCiAgcmV0dXJuIHsKICAgIGdldFRpbWVNczogKCkgPT4gewogICAgICBjb25zdCBbc2Vjb25kcywgbmFub1NlY29uZHNdID0gcHJvY2Vzcy5ocnRpbWUobGFzdFBvbGwpOwogICAgICByZXR1cm4gTWF0aC5mbG9vcihzZWNvbmRzICogMWUzICsgbmFub1NlY29uZHMgLyAxZTYpOwogICAgfSwKICAgIHJlc2V0OiAoKSA9PiB7CiAgICAgIGxhc3RQb2xsID0gcHJvY2Vzcy5ocnRpbWUoKTsKICAgIH0sCiAgfTsKfQoKZnVuY3Rpb24gd2F0Y2hkb2dUaW1lb3V0KCkgewogIGxvZygnV2F0Y2hkb2cgdGltZW91dCcpOwoKICBpZiAoZGVidWdnZXJQYXVzZSkgewogICAgbG9nKCdQYXVzaW5nIGRlYnVnZ2VyIHRvIGNhcHR1cmUgc3RhY2sgdHJhY2UnKTsKICAgIGRlYnVnZ2VyUGF1c2UoKTsKICB9IGVsc2UgewogICAgbG9nKCdDYXB0dXJpbmcgZXZlbnQgd2l0aG91dCBhIHN0YWNrIHRyYWNlJyk7CiAgICBzZW5kQW5yRXZlbnQoKS50aGVuKG51bGwsICgpID0+IHsKICAgICAgbG9nKCdTZW5kaW5nIEFOUiBldmVudCBmYWlsZWQgb24gd2F0Y2hkb2cgdGltZW91dC4nKTsKICAgIH0pOwogIH0KfQoKY29uc3QgeyBwb2xsIH0gPSB3YXRjaGRvZ1RpbWVyKGNyZWF0ZUhyVGltZXIsIG9wdGlvbnMucG9sbEludGVydmFsLCBvcHRpb25zLmFuclRocmVzaG9sZCwgd2F0Y2hkb2dUaW1lb3V0KTsKCl9vcHRpb25hbENoYWluKFtwYXJlbnRQb3J0LCAnb3B0aW9uYWxBY2Nlc3MnLCBfNiA9PiBfNi5vbiwgJ2NhbGwnLCBfNyA9PiBfNygnbWVzc2FnZScsIChtc2cpID0+IHsKICBpZiAobXNnLnNlc3Npb24pIHsKICAgIHNlc3Npb24gPSBtYWtlU2Vzc2lvbihtc2cuc2Vzc2lvbik7CiAgfQoKICBwb2xsKCk7Cn0pXSk7"},48427:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(73837),o=r(17961),a=r(81277),l="Console",c=o.defineIntegration(()=>({name:l,setupOnce(){},setup(t){a.addConsoleInstrumentationHandler(({args:n,level:r})=>{o.getClient()===t&&o.addBreadcrumb({category:"console",level:a.severityLevelFromString(r),message:i.format.apply(void 0,n)},{input:[...n],level:r})})}})),g=o.convertIntegrationFnToClass(l,c);n.Console=g,n.consoleIntegration=c},15017:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(32081),a=r(57147),l=r(22037),c=r(71017),g=r(73837),d=r(17961),u=g.promisify(a.readFile),I=g.promisify(a.readdir),p="Context",m=d.defineIntegration((t={})=>{let n;let r={app:!0,os:!0,device:!0,culture:!0,cloudResource:!0,...t};async function addContext(t){var r;void 0===n&&(n=_getContexts());let o=(i([r=await n,"optionalAccess",t=>t.app,"optionalAccess",t=>t.app_memory])&&(r.app.app_memory=process.memoryUsage().rss),i([r,"optionalAccess",t=>t.device,"optionalAccess",t=>t.free_memory])&&(r.device.free_memory=l.freemem()),r);return t.contexts={...t.contexts,app:{...o.app,...i([t,"access",t=>t.contexts,"optionalAccess",t=>t.app])},os:{...o.os,...i([t,"access",t=>t.contexts,"optionalAccess",t=>t.os])},device:{...o.device,...i([t,"access",t=>t.contexts,"optionalAccess",t=>t.device])},culture:{...o.culture,...i([t,"access",t=>t.contexts,"optionalAccess",t=>t.culture])},cloud_resource:{...o.cloud_resource,...i([t,"access",t=>t.contexts,"optionalAccess",t=>t.cloud_resource])}},t}async function _getContexts(){let t={};if(r.os&&(t.os=await getOsContext()),r.app&&(t.app=function(){let t=process.memoryUsage().rss,n=new Date(Date.now()-1e3*process.uptime()).toISOString();return{app_start_time:n,app_memory:t}}()),r.device&&(t.device=getDeviceContext(r.device)),r.culture){let n=function(){try{if("string"!=typeof process.versions.icu)return;let t=new Date(9e8),n=new Intl.DateTimeFormat("es",{month:"long"});if("enero"===n.format(t)){let t=Intl.DateTimeFormat().resolvedOptions();return{locale:t.locale,timezone:t.timeZone}}}catch(t){}}();n&&(t.culture=n)}return r.cloudResource&&(t.cloud_resource=function(){if(process.env.VERCEL)return{"cloud.provider":"vercel","cloud.region":process.env.VERCEL_REGION};if(process.env.AWS_REGION)return{"cloud.provider":"aws","cloud.region":process.env.AWS_REGION,"cloud.platform":process.env.AWS_EXECUTION_ENV};if(process.env.GCP_PROJECT)return{"cloud.provider":"gcp"};if(process.env.ALIYUN_REGION_ID)return{"cloud.provider":"alibaba_cloud","cloud.region":process.env.ALIYUN_REGION_ID};if(process.env.WEBSITE_SITE_NAME&&process.env.REGION_NAME)return{"cloud.provider":"azure","cloud.region":process.env.REGION_NAME};if(process.env.IBM_CLOUD_REGION)return{"cloud.provider":"ibm_cloud","cloud.region":process.env.IBM_CLOUD_REGION};if(process.env.TENCENTCLOUD_REGION)return{"cloud.provider":"tencent_cloud","cloud.region":process.env.TENCENTCLOUD_REGION,"cloud.account.id":process.env.TENCENTCLOUD_APPID,"cloud.availability_zone":process.env.TENCENTCLOUD_ZONE};else if(process.env.NETLIFY)return{"cloud.provider":"netlify"};else if(process.env.FLY_REGION)return{"cloud.provider":"fly.io","cloud.region":process.env.FLY_REGION};else if(process.env.DYNO)return{"cloud.provider":"heroku"};else return}()),t}return{name:p,setupOnce(){},processEvent:t=>addContext(t)}}),h=d.convertIntegrationFnToClass(p,m);async function getOsContext(){let t=l.platform();switch(t){case"darwin":return getDarwinInfo();case"linux":return getLinuxInfo();default:return{name:C[t]||t,version:l.release()}}}function getDeviceContext(t){let n;let r={};try{n=l.uptime&&l.uptime()}catch(t){}if("number"==typeof n&&(r.boot_time=new Date(Date.now()-1e3*n).toISOString()),r.arch=l.arch(),(!0===t||t.memory)&&(r.memory_size=l.totalmem(),r.free_memory=l.freemem()),!0===t||t.cpu){let t=l.cpus();if(t&&t.length){let n=t[0];r.processor_count=t.length,r.cpu_description=n.model,r.processor_frequency=n.speed}}return r}let C={aix:"IBM AIX",freebsd:"FreeBSD",openbsd:"OpenBSD",sunos:"SunOS",win32:"Windows"},b=[{name:"fedora-release",distros:["Fedora"]},{name:"redhat-release",distros:["Red Hat Linux","Centos"]},{name:"redhat_version",distros:["Red Hat Linux"]},{name:"SuSE-release",distros:["SUSE Linux"]},{name:"lsb-release",distros:["Ubuntu Linux","Arch Linux"]},{name:"debian_version",distros:["Debian"]},{name:"debian_release",distros:["Debian"]},{name:"arch-release",distros:["Arch Linux"]},{name:"gentoo-release",distros:["Gentoo Linux"]},{name:"novell-release",distros:["SUSE Linux"]},{name:"alpine-release",distros:["Alpine Linux"]}],y={alpine:t=>t,arch:t=>matchFirst(/distrib_release=(.*)/,t),centos:t=>matchFirst(/release ([^ ]+)/,t),debian:t=>t,fedora:t=>matchFirst(/release (..)/,t),mint:t=>matchFirst(/distrib_release=(.*)/,t),red:t=>matchFirst(/release ([^ ]+)/,t),suse:t=>matchFirst(/VERSION = (.*)\n/,t),ubuntu:t=>matchFirst(/distrib_release=(.*)/,t)};function matchFirst(t,n){let r=t.exec(n);return r?r[1]:void 0}async function getDarwinInfo(){let t={kernel_version:l.release(),name:"Mac OS X",version:`10.${Number(l.release().split(".")[0])-4}`};try{let n=await new Promise((t,n)=>{o.execFile("/usr/bin/sw_vers",(r,i)=>{if(r){n(r);return}t(i)})});t.name=matchFirst(/^ProductName:\s+(.*)$/m,n),t.version=matchFirst(/^ProductVersion:\s+(.*)$/m,n),t.build=matchFirst(/^BuildVersion:\s+(.*)$/m,n)}catch(t){}return t}function getLinuxDistroId(t){return t.split(" ")[0].toLowerCase()}async function getLinuxInfo(){let t={kernel_version:l.release(),name:"Linux"};try{let n=await I("/etc"),r=b.find(t=>n.includes(t.name));if(!r)return t;let i=c.join("/etc",r.name),o=(await u(i,{encoding:"utf-8"})).toLowerCase(),{distros:a}=r;t.name=a.find(t=>o.indexOf(getLinuxDistroId(t))>=0)||a[0];let l=getLinuxDistroId(t.name);t.version=y[l](o)}catch(t){}return t}n.Context=h,n.getDeviceContext=getDeviceContext,n.nodeContextIntegration=m,n.readDirAsync=I,n.readFileAsync=u},48475:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(57147),a=r(17961),l=r(81277),c=new l.LRUMap(100),g="ContextLines",d=a.defineIntegration((t={})=>{let n=void 0!==t.frameContextLines?t.frameContextLines:7;return{name:g,setupOnce(){},processEvent:t=>addSourceContext(t,n)}}),u=a.convertIntegrationFnToClass(g,d);async function addSourceContext(t,n){let r={},o=[];if(n>0&&i([t,"access",t=>t.exception,"optionalAccess",t=>t.values])){for(let n of t.exception.values)if(i([n,"access",t=>t.stacktrace,"optionalAccess",t=>t.frames]))for(let t=n.stacktrace.frames.length-1;t>=0;t--){let i=n.stacktrace.frames[t];!i.filename||r[i.filename]||c.get(i.filename)||(o.push(_readSourceFile(i.filename)),r[i.filename]=1)}}if(o.length>0&&await Promise.all(o),n>0&&i([t,"access",t=>t.exception,"optionalAccess",t=>t.values]))for(let r of t.exception.values)r.stacktrace&&r.stacktrace.frames&&await function(t,n){for(let r of t)if(r.filename&&void 0===r.context_line){let t=c.get(r.filename);if(t)try{l.addContextToFrame(t,r,n)}catch(t){}}}(r.stacktrace.frames,n);return t}async function _readSourceFile(t){let n=c.get(t);if(null===n)return null;if(void 0!==n)return n;let r=null;try{let n=await new Promise((n,r)=>{o.readFile(t,"utf8",(t,i)=>{t?r(t):n(i)})});r=n.split("\n")}catch(t){}return c.set(t,r),r}n.ContextLines=u,n.contextLinesIntegration=d},3420:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277);function isResponseObject(t){return t&&void 0!==t.statusCode}let a={name:"SentryHapiErrorPlugin",version:i.SDK_VERSION,register:async function(t){t.events.on("request",(t,n)=>{var r;let o=i.getActiveTransaction();n&&void 0!==n.error&&(r=n.error,i.captureException(r,{mechanism:{type:"hapi",handled:!1,data:{function:"hapiErrorPlugin"}}})),o&&(o.setStatus("internal_error"),o.end())})}},l={name:"SentryHapiTracingPlugin",version:i.SDK_VERSION,register:async function(t){t.ext("onPreHandler",(t,n)=>{let r=i.continueTrace({sentryTrace:t.headers["sentry-trace"]||void 0,baggage:t.headers.baggage||void 0},n=>i.startTransaction({...n,op:"hapi.request",name:t.route.path,description:`${t.route.method} ${t.path}`}));return i.getCurrentScope().setSpan(r),n.continue}),t.ext("onPreResponse",(t,n)=>{let r=i.getActiveTransaction();if(t.response&&isResponseObject(t.response)&&r){let n=t.response;n.header("sentry-trace",i.spanToTraceHeader(r));let a=o.dynamicSamplingContextToSentryBaggageHeader(i.getDynamicSamplingContextFromSpan(r));a&&n.header("baggage",a)}return n.continue}),t.ext("onPostHandler",(t,n)=>{let r=i.getActiveTransaction();return r&&(t.response&&isResponseObject(t.response)&&i.setHttpStatus(r,t.response.statusCode),r.end()),n.continue})}},c="Hapi",g=i.defineIntegration((t={})=>{let n=t.server;return{name:c,setupOnce(){n&&o.fill(n,"start",t=>async function(){await this.register(l),await this.register(a);let n=t.apply(this);return n})}}}),d=i.convertIntegrationFnToClass(c,g);n.Hapi=d,n.hapiErrorPlugin=a,n.hapiIntegration=g,n.hapiTracingPlugin=l},37470:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(60037),c=r(1365),g=r(53969),d=o.defineIntegration((t={})=>{let{breadcrumbs:n,tracing:r,shouldCreateSpanForRequest:i}=t,o={breadcrumbs:n,tracing:!1!==r&&a.dropUndefinedKeys({enableIfHasTracingEnabled:!0!==r||void 0,shouldCreateSpanForRequest:i})};return new Http(o)});let Http=class Http{static __initStatic(){this.id="Http"}__init(){this.name=Http.id}constructor(t={}){Http.prototype.__init.call(this),this._breadcrumbs=void 0===t.breadcrumbs||t.breadcrumbs,this._tracing=t.tracing?!0===t.tracing?{}:t.tracing:void 0}setupOnce(t,n){let o=i([n,"call",t=>t(),"access",t=>t.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]),g=_shouldCreateSpans(this._tracing,o);if(!this._breadcrumbs&&!g)return;if(o&&"sentry"!==o.instrumenter){l.DEBUG_BUILD&&a.logger.log("HTTP Integration is skipped because of instrumenter configuration.");return}let d=_getShouldCreateSpanForRequest(g,this._tracing,o),u=i([o,"optionalAccess",t=>t.tracePropagationTargets])||i([this,"access",t=>t._tracing,"optionalAccess",t=>t.tracePropagationTargets]),I=r(13685),p=_createWrappedRequestMethodFactory(I,this._breadcrumbs,d,u);if(a.fill(I,"get",p),a.fill(I,"request",p),c.NODE_VERSION.major>8){let t=r(95687),n=_createWrappedRequestMethodFactory(t,this._breadcrumbs,d,u);a.fill(t,"get",n),a.fill(t,"request",n)}}};function _createWrappedRequestMethodFactory(t,n,r,c){let d=new a.LRUMap(100),u=new a.LRUMap(100),shouldCreateSpan=t=>{if(void 0===r)return!0;let n=d.get(t);if(void 0!==n)return n;let i=r(t);return d.set(t,i),i},shouldAttachTraceData=t=>{if(void 0===c)return!0;let n=u.get(t);if(void 0!==n)return n;let r=a.stringMatchesSomePattern(t,c);return u.set(t,r),r};function addRequestBreadcrumb(t,n,r,i){o.getCurrentHub().getIntegration(Http)&&o.addBreadcrumb({category:"http",data:{status_code:i&&i.statusCode,...n},type:"http"},{event:t,request:r,response:i})}return function(r){return function(...c){let d=g.normalizeRequestArgs(t,c),u=d[0],I=g.extractRawUrl(u),p=g.extractUrl(u),m=o.getClient();if(o.isSentryRequestUrl(p,m))return r.apply(t,d);let h=o.getCurrentScope(),C=o.getIsolationScope(),b=o.getActiveSpan(),y=function(t,n){let r=n.method||"GET",i={url:t,"http.method":r};return n.hash&&(i["http.fragment"]=n.hash.substring(1)),n.search&&(i["http.query"]=n.search.substring(1)),i}(p,u),G=shouldCreateSpan(I)?i([b,"optionalAccess",t=>t.startChild,"call",t=>t({op:"http.client",origin:"auto.http.node.http",description:`${y["http.method"]} ${y.url}`,data:y})]):void 0;if(m&&shouldAttachTraceData(I)){let{traceId:t,spanId:n,sampled:r,dsc:i}={...C.getPropagationContext(),...h.getPropagationContext()},c=G?o.spanToTraceHeader(G):a.generateSentryTraceHeader(t,n,r),g=a.dynamicSamplingContextToSentryBaggageHeader(i||(G?o.getDynamicSamplingContextFromSpan(G):o.getDynamicSamplingContextFromClient(t,m,h)));(function(t,n,r,i){let o=t.headers||{};if(!o["sentry-trace"])l.DEBUG_BUILD&&a.logger.log(`[Tracing] Adding sentry-trace header ${r} to outgoing request to "${n}": `),t.headers={...t.headers,"sentry-trace":r,...i&&i.length>0&&{baggage:t.headers&&t.headers.baggage?i?Array.isArray(t.headers.baggage)?[...t.headers.baggage,i]:[t.headers.baggage,i]:t.headers.baggage:i}}})(u,p,c,g)}else l.DEBUG_BUILD&&a.logger.log(`[Tracing] Not adding sentry-trace header to outgoing request (${p}) due to mismatching tracePropagationTargets option.`);return r.apply(t,d).once("response",function(t){n&&addRequestBreadcrumb("response",y,this,t),G&&(t.statusCode&&o.setHttpStatus(G,t.statusCode),G.updateName(g.cleanSpanDescription(o.spanToJSON(G).description||"",u,this)||""),G.end())}).once("error",function(){n&&addRequestBreadcrumb("error",y,this),G&&(o.setHttpStatus(G,500),G.updateName(g.cleanSpanDescription(o.spanToJSON(G).description||"",u,this)||""),G.end())})}}}function _shouldCreateSpans(t,n){return void 0!==t&&(!t.enableIfHasTracingEnabled||o.hasTracingEnabled(n))}function _getShouldCreateSpanForRequest(t,n,r){let o=t?i([n,"optionalAccess",t=>t.shouldCreateSpanForRequest])||i([r,"optionalAccess",t=>t.shouldCreateSpanForRequest]):()=>!1;return o}Http.__initStatic(),n.Http=Http,n._getShouldCreateSpanForRequest=_getShouldCreateSpanForRequest,n._shouldCreateSpans=_shouldCreateSpans,n.httpIntegration=d},55542:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(48427),o=r(37470),a=r(31342),l=r(61837),c=r(60208),g=r(48475),d=r(15017),u=r(17961),I=r(10127),p=r(1384),m=r(58935),h=r(51076),C=r(3420);n.Console=i.Console,n.Http=o.Http,n.OnUncaughtException=a.OnUncaughtException,n.OnUnhandledRejection=l.OnUnhandledRejection,n.Modules=c.Modules,n.ContextLines=g.ContextLines,n.Context=d.Context,n.RequestData=u.RequestData,n.LocalVariables=I.LocalVariables,n.Undici=p.Undici,n.Spotlight=m.Spotlight,n.Anr=h.Anr,n.Hapi=C.Hapi},97122:(t,n)=>{function isAnonymous(t){return void 0!==t&&(0===t.length||"?"===t||"<anonymous>"===t)}function hashFrames(t){if(void 0!==t)return t.slice(-10).reduce((t,n)=>`${t},${n.function},${n.lineno},${n.colno}`,"")}Object.defineProperty(n,"__esModule",{value:!0}),n.createRateLimiter=function(t,n,r){let i=0,o=5,a=0;return setInterval(()=>{0===a?i>t&&(r(o*=2),o>86400&&(o=86400),a=o):0==(a-=1)&&n(),i=0},1e3).unref(),()=>{i+=1}},n.functionNamesMatch=function(t,n){return t===n||isAnonymous(t)&&isAnonymous(n)},n.hashFrames=hashFrames,n.hashFromStack=function(t,n){if(void 0!==n)return hashFrames(t(n,1))},n.isAnonymous=isAnonymous},10127:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(48624),o=i.LocalVariablesSync,a=i.localVariablesSyncIntegration;n.LocalVariables=o,n.localVariablesIntegration=a},48624:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(1365),c=r(97122);function createCallbackList(t){let n=[],r=!1;function checkedComplete(i){n=[],r||(r=!0,t(i))}return n.push(checkedComplete),{add:function(t){n.push(t)},next:function(t){let r=n.pop()||checkedComplete;try{r(t)}catch(n){checkedComplete(t)}}}}let AsyncSession=class AsyncSession{constructor(){let{Session:t}=r(31405);this._session=new t}configureAndConnect(t,n){this._session.connect(),this._session.on("Debugger.paused",n=>{t(n,()=>{this._session.post("Debugger.resume")})}),this._session.post("Debugger.enable"),this._session.post("Debugger.setPauseOnExceptions",{state:n?"all":"uncaught"})}setPauseOnExceptions(t){this._session.post("Debugger.setPauseOnExceptions",{state:t?"all":"uncaught"})}getLocalVariables(t,n){this._getProperties(t,t=>{let{add:r,next:o}=createCallbackList(n);for(let n of t)if(i([n,"optionalAccess",t=>t.value,"optionalAccess",t=>t.objectId])&&"Array"===i([n,"optionalAccess",t=>t.value,"access",t=>t.className])){let t=n.value.objectId;r(r=>this._unrollArray(t,n.name,r,o))}else if(i([n,"optionalAccess",t=>t.value,"optionalAccess",t=>t.objectId])&&"Object"===i([n,"optionalAccess",t=>t.value,"optionalAccess",t=>t.className])){let t=n.value.objectId;r(r=>this._unrollObject(t,n.name,r,o))}else(null!=i([n,"optionalAccess",t=>t.value,"optionalAccess",t=>t.value])||null!=i([n,"optionalAccess",t=>t.value,"optionalAccess",t=>t.description]))&&r(t=>this._unrollOther(n,t,o));o({})})}_getProperties(t,n){this._session.post("Runtime.getProperties",{objectId:t,ownProperties:!0},(t,r)=>{t?n([]):n(r.result)})}_unrollArray(t,n,r,o){this._getProperties(t,t=>{r[n]=t.filter(t=>"length"!==t.name&&!isNaN(parseInt(t.name,10))).sort((t,n)=>parseInt(t.name,10)-parseInt(n.name,10)).map(t=>i([t,"optionalAccess",t=>t.value,"optionalAccess",t=>t.value])),o(r)})}_unrollObject(t,n,r,o){this._getProperties(t,t=>{r[n]=t.map(t=>[t.name,i([t,"optionalAccess",t=>t.value,"optionalAccess",t=>t.value])]).reduce((t,[n,r])=>(t[n]=r,t),{}),o(r)})}_unrollOther(t,n,r){null!=i([t,"optionalAccess",t=>t.value,"optionalAccess",t=>t.value])?n[t.name]=t.value.value:null!=i([t,"optionalAccess",t=>t.value,"optionalAccess",t=>t.description])&&"function"!==i([t,"optionalAccess",t=>t.value,"optionalAccess",t=>t.type])&&(n[t.name]=`<${t.value.description}>`),r(n)}};function tryNewAsyncSession(){try{return new AsyncSession}catch(t){return}}let g="LocalVariables",d=o.defineIntegration((t={},n=tryNewAsyncSession())=>{let r;let d=new a.LRUMap(20),u=!1;return{name:g,setupOnce(){let g=o.getClient(),I=i([g,"optionalAccess",t=>t.getOptions,"call",t=>t()]);if(n&&i([I,"optionalAccess",t=>t.includeLocalVariables])){let o=l.NODE_VERSION.major<18;if(o){a.logger.log("The `LocalVariables` integration is only supported on Node >= v18.");return}let g=!1!==t.captureAllExceptions;if(n.configureAndConnect((t,o)=>(function(t,{params:{reason:o,data:a,callFrames:l}},g){if("exception"!==o&&"promiseRejection"!==o){g();return}i([r,"optionalCall",t=>t()]);let u=c.hashFromStack(t,i([a,"optionalAccess",t=>t.description]));if(void 0==u){g();return}let{add:I,next:p}=createCallbackList(t=>{d.set(u,t),g()});for(let t=0;t<Math.min(l.length,5);t++){let{scopeChain:r,functionName:o,this:a}=l[t],c=r.find(t=>"local"===t.type),g="global"!==a.className&&a.className?`${a.className}.${o}`:o;if(void 0===i([c,"optionalAccess",t=>t.object,"access",t=>t.objectId]))I(n=>{n[t]={function:g},p(n)});else{let r=c.object.objectId;I(o=>i([n,"optionalAccess",t=>t.getLocalVariables,"call",n=>n(r,n=>{o[t]={function:g,vars:n},p(o)})]))}}p([])})(I.stackParser,t,o),g),g){let o=t.maxExceptionsPerSecond||50;r=c.createRateLimiter(o,()=>{a.logger.log("Local variables rate-limit lifted."),i([n,"optionalAccess",t=>t.setPauseOnExceptions,"call",t=>t(!0)])},t=>{a.logger.log(`Local variables rate-limit exceeded. Disabling capturing of caught exceptions for ${t} seconds.`),i([n,"optionalAccess",t=>t.setPauseOnExceptions,"call",t=>t(!1)])})}u=!0}},processEvent:t=>u?function(t){for(let n of i([t,"optionalAccess",t=>t.exception,"optionalAccess",t=>t.values])||[])!function(t){let n=c.hashFrames(i([t,"optionalAccess",t=>t.stacktrace,"optionalAccess",t=>t.frames]));if(void 0===n)return;let r=d.remove(n);if(void 0===r)return;let o=(i([t,"access",t=>t.stacktrace,"optionalAccess",t=>t.frames])||[]).filter(t=>"new Promise"!==t.function);for(let t=0;t<o.length;t++){let n=o.length-t-1;if(!o[n]||!r[t])break;void 0!==r[t].vars&&!1!==o[n].in_app&&c.functionNamesMatch(o[n].function,r[t].function)&&(o[n].vars=r[t].vars)}}(n);return t}(t):t,_getCachedFramesCount:()=>d.size,_getFirstCachedFrame:()=>d.values()[0]}}),u=o.convertIntegrationFnToClass(g,d);n.LocalVariablesSync=u,n.createCallbackList=createCallbackList,n.localVariablesSyncIntegration=d},60208:(t,n,r)=>{let i;Object.defineProperty(n,"__esModule",{value:!0});let o=r(57147),a=r(71017),l=r(17961),c="Modules",g=l.defineIntegration(()=>({name:c,setupOnce(){},processEvent:t=>(t.modules={...t.modules,...(i||(i=function(){let t=r.c[r.s]&&r.c[r.s].paths||[],n=function(){try{return r.c?Object.keys(r.c):[]}catch(t){return[]}}(),i={},l={};return n.forEach(n=>{let r=n,updir=()=>{let n=r;if(!(r=a.dirname(n))||n===r||l[n])return;if(0>t.indexOf(r))return updir();let c=a.join(n,"package.json");if(l[n]=!0,!o.existsSync(c))return updir();try{let t=JSON.parse(o.readFileSync(c,"utf8"));i[t.name]=t.version}catch(t){}};updir()}),i}()),i)},t)})),d=l.convertIntegrationFnToClass(c,g);n.Modules=d,n.modulesIntegration=g},31342:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(60037),l=r(36996),c="OnUncaughtException",g=i.defineIntegration((t={})=>{let n={exitEvenIfOtherHandlersAreRegistered:!0,...t};return{name:c,setupOnce(){},setup(t){global.process.on("uncaughtException",makeErrorHandler(t,n))}}}),d=i.convertIntegrationFnToClass(c,g);function makeErrorHandler(t,n){let r;let c=!1,g=!1,d=!1,u=t.getOptions();return Object.assign(I=>{let p=l.logAndExitProcess;n.onFatalError?p=n.onFatalError:u.onFatalError&&(p=u.onFatalError);let m=global.process.listeners("uncaughtException").reduce((t,n)=>"domainUncaughtExceptionClear"===n.name||n.tag&&"sentry_tracingErrorCallback"===n.tag||n._errorHandler?t:t+1,0),h=n.exitEvenIfOtherHandlersAreRegistered||0===m;c?h&&(d?(a.DEBUG_BUILD&&o.logger.warn("uncaught exception after calling fatal error shutdown callback - this is bad! forcing shutdown"),l.logAndExitProcess(I)):g||(g=!0,setTimeout(()=>{d||(d=!0,p(r,I))},2e3))):(r=I,c=!0,i.getClient()===t&&i.captureException(I,{originalException:I,captureContext:{level:"fatal"},mechanism:{handled:!1,type:"onuncaughtexception"}}),!d&&h&&(d=!0,p(I)))},{_errorHandler:!0})}n.OnUncaughtException=d,n.makeErrorHandler=makeErrorHandler,n.onUncaughtExceptionIntegration=g},61837:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(36996),l="OnUnhandledRejection",c=i.defineIntegration((t={})=>{let n=t.mode||"warn";return{name:l,setupOnce(){},setup(t){global.process.on("unhandledRejection",makeUnhandledPromiseHandler(t,{mode:n}))}}}),g=i.convertIntegrationFnToClass(l,c);function makeUnhandledPromiseHandler(t,n){return function(r,l){i.getClient()===t&&(i.captureException(r,{originalException:l,captureContext:{extra:{unhandledPromiseRejection:!0}},mechanism:{handled:!1,type:"onunhandledrejection"}}),function(t,n){let r="This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason:";"warn"===n.mode?o.consoleSandbox(()=>{console.warn(r),console.error(t&&t.stack?t.stack:t)}):"strict"===n.mode&&(o.consoleSandbox(()=>{console.warn(r)}),a.logAndExitProcess(t))}(r,n))}}n.OnUnhandledRejection=g,n.makeUnhandledPromiseHandler=makeUnhandledPromiseHandler,n.onUnhandledRejectionIntegration=c},58935:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(13685),o=r(57310),a=r(17961),l=r(81277),c="Spotlight",g=a.defineIntegration((t={})=>{let n={sidecarUrl:t.sidecarUrl||"http://localhost:8969/stream"};return{name:c,setupOnce(){},setup(t){"object"==typeof process&&process.env&&l.logger.warn("[Spotlight] It seems you're not in dev mode. Do you really want to have Spotlight enabled?"),function(t,n){let r=function(t){try{return new o.URL(`${t}`)}catch(n){l.logger.warn(`[Spotlight] Invalid sidecar URL: ${t}`);return}}(n.sidecarUrl);if(!r)return;let i=0;if("function"!=typeof t.on){l.logger.warn("[Spotlight] Cannot connect to spotlight due to missing method on SDK client (`client.on`)");return}t.on("beforeEnvelope",t=>{if(i>3){l.logger.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests");return}let n=l.serializeEnvelope(t),o=getNativeHttpRequest(),a=o({method:"POST",path:r.pathname,hostname:r.hostname,port:r.port,headers:{"Content-Type":"application/x-sentry-envelope"}},t=>{t.on("data",()=>{}),t.on("end",()=>{}),t.setEncoding("utf8")});a.on("error",()=>{i++,l.logger.warn("[Spotlight] Failed to send envelope to Spotlight Sidecar")}),a.write(n),a.end()})}(t,n)}}}),d=a.convertIntegrationFnToClass(c,g);function getNativeHttpRequest(){let{request:t}=i;return"__sentry_original__"in t?t.__sentry_original__:t}n.Spotlight=d,n.getNativeHttpRequest=getNativeHttpRequest,n.spotlightIntegration=g},1384:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(1365);n.ChannelName=void 0,function(t){t.RequestCreate="undici:request:create",t.RequestEnd="undici:request:headers",t.RequestError="undici:request:error"}(n.ChannelName||(n.ChannelName={}));let c=o.defineIntegration(t=>new Undici(t));let Undici=class Undici{static __initStatic(){this.id="Undici"}__init(){this.name=Undici.id}__init2(){this._createSpanUrlMap=new a.LRUMap(100)}__init3(){this._headersUrlMap=new a.LRUMap(100)}constructor(t={}){Undici.prototype.__init.call(this),Undici.prototype.__init2.call(this),Undici.prototype.__init3.call(this),Undici.prototype.__init4.call(this),Undici.prototype.__init5.call(this),Undici.prototype.__init6.call(this),this._options={breadcrumbs:void 0===t.breadcrumbs||t.breadcrumbs,tracing:t.tracing,shouldCreateSpanForRequest:t.shouldCreateSpanForRequest}}setupOnce(t){let i;if(!(l.NODE_VERSION.major<16)){try{i=r(67643)}catch(t){}i&&i.subscribe&&(i.subscribe(n.ChannelName.RequestCreate,this._onRequestCreate),i.subscribe(n.ChannelName.RequestEnd,this._onRequestEnd),i.subscribe(n.ChannelName.RequestError,this._onRequestError))}}_shouldCreateSpan(t){if(!1===this._options.tracing||void 0===this._options.tracing&&!o.hasTracingEnabled())return!1;if(void 0===this._options.shouldCreateSpanForRequest)return!0;let n=this._createSpanUrlMap.get(t);if(void 0!==n)return n;let r=this._options.shouldCreateSpanForRequest(t);return this._createSpanUrlMap.set(t,r),r}__init4(){this._onRequestCreate=t=>{if(!i([o.getClient,"call",t=>t(),"optionalAccess",t=>t.getIntegration,"call",t=>t(Undici)]))return;let{request:n}=t,r=n.origin?n.origin.toString()+n.path:n.path,l=o.getClient();if(!l||o.isSentryRequestUrl(r,l)||void 0!==n.__sentry_span__)return;let c=l.getOptions(),g=o.getCurrentScope(),d=o.getIsolationScope(),u=o.getActiveSpan(),I=this._shouldCreateSpan(r)?function(t,n,r){let o=a.parseUrl(r),l=n.method||"GET",c={"http.method":l};return o.search&&(c["http.query"]=o.search),o.hash&&(c["http.fragment"]=o.hash),i([t,"optionalAccess",t=>t.startChild,"call",t=>t({op:"http.client",origin:"auto.http.node.undici",description:`${l} ${a.getSanitizedUrlString(o)}`,data:c})])}(u,n,r):void 0;if(I&&(n.__sentry_span__=I),(t=>{if(void 0===c.tracePropagationTargets)return!0;let n=this._headersUrlMap.get(t);if(void 0!==n)return n;let r=a.stringMatchesSomePattern(t,c.tracePropagationTargets);return this._headersUrlMap.set(t,r),r})(r)){let{traceId:t,spanId:r,sampled:i,dsc:c}={...d.getPropagationContext(),...g.getPropagationContext()},u=I?o.spanToTraceHeader(I):a.generateSentryTraceHeader(t,r,i),p=a.dynamicSamplingContextToSentryBaggageHeader(c||(I?o.getDynamicSamplingContextFromSpan(I):o.getDynamicSamplingContextFromClient(t,l,g)));(function(t,n,r){let i;if(Array.isArray(t.headers))i=t.headers.some(t=>"sentry-trace"===t);else{let n=t.headers.split("\r\n");i=n.some(t=>t.startsWith("sentry-trace:"))}!i&&(t.addHeader("sentry-trace",n),r&&t.addHeader("baggage",r))})(n,u,p)}}}__init5(){this._onRequestEnd=t=>{if(!i([o.getClient,"call",t=>t(),"optionalAccess",t=>t.getIntegration,"call",t=>t(Undici)]))return;let{request:n,response:r}=t,a=n.origin?n.origin.toString()+n.path:n.path;if(o.isSentryRequestUrl(a,o.getClient()))return;let l=n.__sentry_span__;l&&(o.setHttpStatus(l,r.statusCode),l.end()),this._options.breadcrumbs&&o.addBreadcrumb({category:"http",data:{method:n.method,status_code:r.statusCode,url:a},type:"http"},{event:"response",request:n,response:r})}}__init6(){this._onRequestError=t=>{if(!i([o.getClient,"call",t=>t(),"optionalAccess",t=>t.getIntegration,"call",t=>t(Undici)]))return;let{request:n}=t,r=n.origin?n.origin.toString()+n.path:n.path;if(o.isSentryRequestUrl(r,o.getClient()))return;let a=n.__sentry_span__;a&&(a.setStatus("internal_error"),a.end()),this._options.breadcrumbs&&o.addBreadcrumb({category:"http",data:{method:n.method,url:r},level:"error",type:"http"},{event:"error",request:n})}}};Undici.__initStatic(),n.Undici=Undici,n.nativeNodeFetchintegration=c},36996:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(17961),o=r(81277),a=r(60037);n.logAndExitProcess=function(t){o.consoleSandbox(()=>{console.error(t)});let n=i.getClient();void 0===n&&(a.DEBUG_BUILD&&o.logger.warn("No NodeClient was defined, we are exiting the process now."),global.process.exit(1));let r=n.getOptions(),l=r&&r.shutdownTimeout&&r.shutdownTimeout>0&&r.shutdownTimeout||2e3;n.close(l).then(t=>{!t&&a.DEBUG_BUILD&&o.logger.warn("We reached the timeout for emptying the request buffer, still exiting now!"),global.process.exit(1)},t=>{a.DEBUG_BUILD&&o.logger.error(t)})}},53969:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(57310),a=r(1365);function extractUrl(t){let{protocol:n,hostname:r,port:i}=parseRequestOptions(t),o=t.pathname||"/",a=t.auth?function(t){let[n,r]=t.split(":");return`${n?"[Filtered]":""}:${r?"[Filtered]":""}@`}(t.auth):"";return`${n}//${a}${r}${i}${o}`}function urlToOptions(t){let n={protocol:t.protocol,hostname:"string"==typeof t.hostname&&t.hostname.startsWith("[")?t.hostname.slice(1,-1):t.hostname,hash:t.hash,search:t.search,pathname:t.pathname,path:`${t.pathname||""}${t.search||""}`,href:t.href};return""!==t.port&&(n.port=Number(t.port)),(t.username||t.password)&&(n.auth=`${t.username}:${t.password}`),n}function parseRequestOptions(t){let n=t.protocol||"",r=t.hostname||t.host||"",i=!t.port||80===t.port||443===t.port||/^(.*):(\d+)$/.test(r)?"":`:${t.port}`;return{protocol:n,hostname:r,port:i}}n.cleanSpanDescription=function(t,n,r){if(!t)return t;let[o,a]=t.split(" ");return n.host&&!n.protocol&&(n.protocol=i([r,"optionalAccess",t=>t.agent,"optionalAccess",t=>t.protocol]),a=extractUrl(n)),i([a,"optionalAccess",t=>t.startsWith,"call",t=>t("///")])&&(a=a.slice(2)),`${o} ${a}`},n.extractRawUrl=function(t){let{protocol:n,hostname:r,port:i}=parseRequestOptions(t),o=t.path?t.path:"/";return`${n}//${r}${i}${o}`},n.extractUrl=extractUrl,n.normalizeRequestArgs=function(t,n){let r,l;if("function"==typeof n[n.length-1]&&(r=n.pop()),"string"==typeof n[0])l=urlToOptions(new o.URL(n[0]));else if(n[0]instanceof o.URL)l=urlToOptions(n[0]);else{l=n[0];try{let t=new o.URL(l.path||"",`${l.protocol||"http:"}//${l.hostname}`);l={pathname:t.pathname,search:t.search,hash:t.hash,...l}}catch(t){}}return(2===n.length&&(l={...l,...n[1]}),void 0===l.protocol&&(a.NODE_VERSION.major>8?l.protocol=i([i([t,"optionalAccess",t=>t.globalAgent]),"optionalAccess",t=>t.protocol])||i([l.agent,"optionalAccess",t=>t.protocol])||i([l._defaultAgent,"optionalAccess",t=>t.protocol]):l.protocol=i([l.agent,"optionalAccess",t=>t.protocol])||i([l._defaultAgent,"optionalAccess",t=>t.protocol])||i([i([t,"optionalAccess",t=>t.globalAgent]),"optionalAccess",t=>t.protocol])),r)?[l,r]:[l]},n.urlToOptions=urlToOptions},53020:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71017),o=r(81277);function normalizeWindowsPath(t){return t.replace(/^[A-Z]:/,"").replace(/\\/g,"/")}n.createGetModuleFromFilename=function(t=process.argv[1]?o.dirname(process.argv[1]):process.cwd(),n="\\"===i.sep){let r=n?normalizeWindowsPath(t):t;return t=>{if(!t)return;let o=n?normalizeWindowsPath(t):t,{dir:a,base:l,ext:c}=i.posix.parse(o);(".js"===c||".mjs"===c||".cjs"===c)&&(l=l.slice(0,-1*c.length)),a||(a=".");let g=a.lastIndexOf("/node_modules");if(g>-1)return`${a.slice(g+14).replace(/\//g,".")}:${l}`;if(a.startsWith(r)){let t=a.slice(r.length+1).replace(/\//g,".");return t&&(t+=":"),t+=l}return l}}},1365:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277),o=i.parseSemver(process.versions.node);n.NODE_VERSION=o},2067:(t,n,r)=>{var{_nullishCoalesce:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(13685);r(95687);let a=Symbol("AgentBaseInternalState");let Agent=class Agent extends o.Agent{constructor(t){super(t),this[a]={}}isSecureEndpoint(t){if(t){if("boolean"==typeof t.secureEndpoint)return t.secureEndpoint;if("string"==typeof t.protocol)return"https:"===t.protocol}let{stack:n}=Error();return"string"==typeof n&&n.split("\n").some(t=>-1!==t.indexOf("(https.js:")||-1!==t.indexOf("node:https:"))}createSocket(t,n,r){let i={...n,secureEndpoint:this.isSecureEndpoint(n)};Promise.resolve().then(()=>this.connect(t,i)).then(l=>{if(l instanceof o.Agent)return l.addRequest(t,i);this[a].currentSocket=l,super.createSocket(t,n,r)},r)}createConnection(){let t=this[a].currentSocket;if(this[a].currentSocket=void 0,!t)throw Error("No socket was returned in the `connect()` function");return t}get defaultPort(){return i(this[a].defaultPort,()=>"https:"===this.protocol?443:80)}set defaultPort(t){this[a]&&(this[a].defaultPort=t)}get protocol(){return i(this[a].protocol,()=>this.isSecureEndpoint()?"https:":"http:")}set protocol(t){this[a]&&(this[a].protocol=t)}};n.Agent=Agent},39265:(t,n,r)=>{var{_nullishCoalesce:i,_optionalChain:o}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let a=r(41808),l=r(24404),c=r(57310),g=r(81277),d=r(2067),u=r(11876);function debug(...t){g.logger.log("[https-proxy-agent]",...t)}let HttpsProxyAgent=class HttpsProxyAgent extends d.Agent{static __initStatic(){this.protocols=["http","https"]}constructor(t,n){super(n),this.options={},this.proxy="string"==typeof t?new c.URL(t):t,this.proxyHeaders=i(o([n,"optionalAccess",t=>t.headers]),()=>({})),debug("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),a=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...n?omit(n,"headers"):null,host:r,port:a}}async connect(t,n){let r;let{proxy:i}=this;if(!n.host)throw TypeError('No "host" provided');if("https:"===i.protocol){debug("Creating `tls.Socket`: %o",this.connectOpts);let t=this.connectOpts.servername||this.connectOpts.host;r=l.connect({...this.connectOpts,servername:t&&a.isIP(t)?void 0:t})}else debug("Creating `net.Socket`: %o",this.connectOpts),r=a.connect(this.connectOpts);let o="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},c=a.isIPv6(n.host)?`[${n.host}]`:n.host,g=`CONNECT ${c}:${n.port} HTTP/1.1\r
`;if(i.username||i.password){let t=`${decodeURIComponent(i.username)}:${decodeURIComponent(i.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(t).toString("base64")}`}for(let t of(o.Host=`${c}:${n.port}`,o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(o)))g+=`${t}: ${o[t]}\r
`;let d=u.parseProxyResponse(r);r.write(`${g}\r
`);let{connect:I,buffered:p}=await d;if(t.emit("proxyConnect",I),this.emit("proxyConnect",I,t),200===I.statusCode){if(t.once("socket",resume),n.secureEndpoint){debug("Upgrading socket connection to TLS");let t=n.servername||n.host;return l.connect({...omit(n,"host","path","port"),socket:r,servername:a.isIP(t)?void 0:t})}return r}r.destroy();let m=new a.Socket({writable:!1});return m.readable=!0,t.once("socket",t=>{debug("Replaying proxy buffer for failed request"),t.push(p),t.push(null)}),m}};function resume(t){t.resume()}function omit(t,...n){let r;let i={};for(r in t)n.includes(r)||(i[r]=t[r]);return i}HttpsProxyAgent.__initStatic(),n.HttpsProxyAgent=HttpsProxyAgent},11876:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);function debug(...t){i.logger.log("[https-proxy-agent:parse-proxy-response]",...t)}n.parseProxyResponse=function(t){return new Promise((n,r)=>{let i=0,o=[];function read(){let a=t.read();a?function(a){o.push(a),i+=a.length;let l=Buffer.concat(o,i),c=l.indexOf("\r\n\r\n");if(-1===c){debug("have not received end of HTTP headers yet..."),read();return}let g=l.slice(0,c).toString("ascii").split("\r\n"),d=g.shift();if(!d)return t.destroy(),r(Error("No header received from proxy CONNECT response"));let u=d.split(" "),I=+u[1],p=u.slice(2).join(" "),m={};for(let n of g){if(!n)continue;let i=n.indexOf(":");if(-1===i)return t.destroy(),r(Error(`Invalid header from proxy CONNECT response: "${n}"`));let o=n.slice(0,i).toLowerCase(),a=n.slice(i+1).trimStart(),l=m[o];"string"==typeof l?m[o]=[l,a]:Array.isArray(l)?l.push(a):m[o]=a}debug("got proxy server response: %o %o",d,m),cleanup(),n({connect:{statusCode:I,statusText:p,headers:m},buffered:l})}(a):t.once("readable",read)}function cleanup(){t.removeListener("end",onend),t.removeListener("error",onerror),t.removeListener("readable",read)}function onend(){cleanup(),debug("onend"),r(Error("Proxy connection ended before receiving CONNECT response"))}function onerror(t){cleanup(),debug("onerror %o",t),r(t)}t.on("error",onerror),t.on("end",onend),read()})}},60123:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(81277);n.extractRequestData=function(t,n){return i.extractRequestData(t,{include:n})},n.parseRequest=function(t,n,r={}){return i.addRequestDataToEvent(t,n,{include:r})}},35290:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277),l=r(135),c=r(34881),g=r(48427),d=r(15017),u=r(48475),I=r(37470),p=r(10127),m=r(60208),h=r(31342),C=r(61837),b=r(58935),y=r(1384),G=r(53020),A=r(32178),B=[o.inboundFiltersIntegration(),o.functionToStringIntegration(),o.linkedErrorsIntegration(),o.requestDataIntegration(),g.consoleIntegration(),I.httpIntegration(),y.nativeNodeFetchintegration(),h.onUncaughtExceptionIntegration(),C.onUnhandledRejectionIntegration(),u.contextLinesIntegration(),p.localVariablesIntegration(),d.nodeContextIntegration(),m.modulesIntegration()];function getDefaultIntegrations(t){let n=o.getMainCarrier(),r=i([n,"access",t=>t.__SENTRY__,"optionalAccess",t=>t.integrations])||[];return[...B,...r]}function getSentryRelease(t){return process.env.SENTRY_RELEASE?process.env.SENTRY_RELEASE:a.GLOBAL_OBJ.SENTRY_RELEASE&&a.GLOBAL_OBJ.SENTRY_RELEASE.id?a.GLOBAL_OBJ.SENTRY_RELEASE.id:process.env.GITHUB_SHA||process.env.COMMIT_REF||process.env.VERCEL_GIT_COMMIT_SHA||process.env.VERCEL_GITHUB_COMMIT_SHA||process.env.VERCEL_GITLAB_COMMIT_SHA||process.env.VERCEL_BITBUCKET_COMMIT_SHA||process.env.ZEIT_GITHUB_COMMIT_SHA||process.env.ZEIT_GITLAB_COMMIT_SHA||process.env.ZEIT_BITBUCKET_COMMIT_SHA||process.env.CF_PAGES_COMMIT_SHA||t}let Z=a.createStackParser(a.nodeStackLineParser(G.createGetModuleFromFilename()));n.defaultIntegrations=B,n.defaultStackParser=Z,n.getDefaultIntegrations=getDefaultIntegrations,n.getSentryRelease=getSentryRelease,n.init=function(t={}){l.setNodeAsyncContextStrategy(),void 0===t.defaultIntegrations&&(t.defaultIntegrations=getDefaultIntegrations()),void 0===t.dsn&&process.env.SENTRY_DSN&&(t.dsn=process.env.SENTRY_DSN);let n=process.env.SENTRY_TRACES_SAMPLE_RATE;if(void 0===t.tracesSampleRate&&n){let r=parseFloat(n);isFinite(r)&&(t.tracesSampleRate=r)}if(void 0===t.release){let n=getSentryRelease();void 0!==n?t.release=n:t.autoSessionTracking=!1}void 0===t.environment&&process.env.SENTRY_ENVIRONMENT&&(t.environment=process.env.SENTRY_ENVIRONMENT),void 0===t.autoSessionTracking&&void 0!==t.dsn&&(t.autoSessionTracking=!0),void 0===t.instrumenter&&(t.instrumenter="sentry");let r={...t,stackParser:a.stackParserFromStackParserOptions(t.stackParser||Z),integrations:o.getIntegrationsToSetup(t),transport:t.transport||A.makeNodeTransport};if(o.initAndBind(t.clientClass||c.NodeClient,r),t.autoSessionTracking&&(o.startSession(),process.on("beforeExit",()=>{let t=o.getIsolationScope().getSession();t&&!["exited","crashed"].includes(t.status)&&o.endSession()})),function(){let t=(process.env.SENTRY_USE_ENVIRONMENT||"").toLowerCase();if(!["false","n","no","off","0"].includes(t)){let t=process.env.SENTRY_TRACE,n=process.env.SENTRY_BAGGAGE,r=a.propagationContextFromHeaders(t,n);o.getCurrentScope().setPropagationContext(r)}}(),t.spotlight){let n=o.getClient();if(n&&n.addIntegration){let r=n.getOptions().integrations;for(let t of r)n.addIntegration(t);n.addIntegration(b.spotlightIntegration({sidecarUrl:"string"==typeof t.spotlight?t.spotlight:void 0}))}}},n.isAutoSessionTrackingEnabled=function(t){if(void 0===t)return!1;let n=t&&t.getOptions();return!!n&&void 0!==n.autoSessionTracking&&n.autoSessionTracking}},92864:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(32798),o=r(81277);n.autoDiscoverNodePerformanceMonitoringIntegrations=function(){let t=i.lazyLoadedNodePerformanceMonitoringIntegrations.map(t=>{try{return t()}catch(t){return}}).filter(t=>!!t);return 0===t.length&&o.logger.warn("Performance monitoring integrations could not be automatically loaded."),t.filter(t=>!!t.loadDependency())}},48207:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(32798);n.Apollo=i.Apollo,n.Express=i.Express,n.GraphQL=i.GraphQL,n.Mongo=i.Mongo,n.Mysql=i.Mysql,n.Postgres=i.Postgres,n.Prisma=i.Prisma},32178:(t,n,r)=>{var{_nullishCoalesce:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(13685),a=r(95687),l=r(12781),c=r(57310),g=r(59796),d=r(17961),u=r(81277),I=r(39265);n.makeNodeTransport=function(t){let n;try{n=new c.URL(t.url)}catch(n){return u.consoleSandbox(()=>{console.warn("[@sentry/node]: Invalid dsn or tunnel option, will not send any events. The tunnel option must be a full URL when used.")}),d.createTransport(t,()=>Promise.resolve({}))}let r="https:"===n.protocol,p=function(t,n){let{no_proxy:r}=process.env,i=r&&r.split(",").some(n=>t.host.endsWith(n)||t.hostname.endsWith(n));if(!i)return n}(n,t.proxy||(r?process.env.https_proxy:void 0)||process.env.http_proxy),m=r?a:o,h=void 0!==t.keepAlive&&t.keepAlive,C=p?new I.HttpsProxyAgent(p):new m.Agent({keepAlive:h,maxSockets:30,timeout:2e3}),b=function(t,n,r){let{hostname:o,pathname:a,port:d,protocol:u,search:I}=new c.URL(t.url);return function(c){return new Promise((p,m)=>{var h;let C=(h=c.body,new l.Readable({read(){this.push(h),this.push(null)}})),b={...t.headers};c.body.length>32768&&(b["content-encoding"]="gzip",C=C.pipe(g.createGzip()));let y=n.request({method:"POST",agent:r,headers:b,hostname:o,path:`${a}${I}`,port:d,protocol:u,ca:t.caCerts},t=>{t.on("data",()=>{}),t.on("end",()=>{}),t.setEncoding("utf8");let n=i(t.headers["retry-after"],()=>null),r=i(t.headers["x-sentry-rate-limits"],()=>null);p({statusCode:t.statusCode,headers:{"retry-after":n,"x-sentry-rate-limits":Array.isArray(r)?r[0]:r}})});y.on("error",m),C.pipe(y)})}}(t,i(t.httpModule,()=>m),C);return d.createTransport(t,b)}},28485:(t,n,r)=>{var{_optionalChain:i}=r(81277);Object.defineProperty(n,"__esModule",{value:!0});let o=r(17961),a=r(81277);n.trpcMiddleware=function(t={}){return function({path:n,type:r,next:l,rawInput:c}){let g;let d=i([o.getClient,"call",t=>t(),"optionalAccess",t=>t.getOptions,"call",t=>t()]),u=o.getCurrentScope().getTransaction();if(u){u.updateName(`trpc/${n}`),u.setAttribute(o.SEMANTIC_ATTRIBUTE_SENTRY_SOURCE,"route"),u.op="rpc.server";let l={procedure_type:r};(void 0!==t.attachRpcInput?t.attachRpcInput:i([d,"optionalAccess",t=>t.sendDefaultPii]))&&(l.input=a.normalize(c)),u.setContext("trpc",l)}function captureIfError(t){t.ok||o.captureException(t.error,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})}try{g=l()}catch(t){throw o.captureException(t,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}}),t}return a.isThenable(g)?Promise.resolve(g).then(t=>{captureIfError(t)},t=>{o.captureException(t,{mechanism:{handled:!1,data:{function:"trpcMiddleware"}}})}):captureIfError(g),g}}},85422:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(57147),o=r(71017);n.deepReadDirSync=function(t){let n=o.resolve(t);if(!i.existsSync(n))throw Error(`Cannot read contents of ${n}. Directory does not exist.`);if(!i.statSync(n).isDirectory())throw Error(`Cannot read contents of ${n}, because it is not a directory.`);let deepReadCurrentDir=t=>i.readdirSync(t).reduce((n,r)=>{let a=o.join(t,r);return i.statSync(a).isDirectory()?n.concat(deepReadCurrentDir(a)):(n.push(a),n)},[]);return deepReadCurrentDir(n).map(t=>o.relative(n,t))}},69383:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(60754),o=r(34278);function applyExceptionGroupFieldsForParentException(t,n){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,..."AggregateError"===t.type&&{is_exception_group:!0},exception_id:n}}function applyExceptionGroupFieldsForChildException(t,n,r,i){t.mechanism=t.mechanism||{type:"generic",handled:!0},t.mechanism={...t.mechanism,type:"chained",source:n,exception_id:r,parent_id:i}}n.applyAggregateErrorsToEvent=function(t,n,r=250,a,l,c,g){if(!c.exception||!c.exception.values||!g||!i.isInstanceOf(g.originalException,Error))return;let d=c.exception.values.length>0?c.exception.values[c.exception.values.length-1]:void 0;d&&(c.exception.values=(function aggregateExceptionsFromError(t,n,r,o,a,l,c,g){if(l.length>=r+1)return l;let d=[...l];if(i.isInstanceOf(o[a],Error)){applyExceptionGroupFieldsForParentException(c,g);let i=t(n,o[a]),l=d.length;applyExceptionGroupFieldsForChildException(i,a,l,g),d=aggregateExceptionsFromError(t,n,r,o[a],a,[i,...d],i,l)}return Array.isArray(o.errors)&&o.errors.forEach((o,l)=>{if(i.isInstanceOf(o,Error)){applyExceptionGroupFieldsForParentException(c,g);let i=t(n,o),u=d.length;applyExceptionGroupFieldsForChildException(i,`errors[${l}]`,u,g),d=aggregateExceptionsFromError(t,n,r,o,a,[i,...d],i,u)}}),d})(t,n,l,g.originalException,a,c.exception.values,d,0).map(t=>(t.value&&(t.value=o.truncate(t.value,r)),t)))}},96382:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71131),o=r(71153);n.callFrameToStackFrame=function(t,n,r){let a=n?n.replace(/^file:\/\//,""):void 0,l=t.location.columnNumber?t.location.columnNumber+1:void 0,c=t.location.lineNumber?t.location.lineNumber+1:void 0;return i.dropUndefinedKeys({filename:a,module:r(a),function:t.functionName||"?",colno:l,lineno:c,in_app:a?o.filenameIsInApp(a):void 0})},n.watchdogTimer=function(t,n,r,i){let o=t(),a=!1,l=!0;return setInterval(()=>{let t=o.getTimeMs();!1===a&&t>n+r&&(a=!0,l&&i()),t<n+r&&(a=!1)},20),{poll:()=>{o.reset()},enabled:t=>{l=t}}}},66237:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71843),o=r(60754),a=r(61755),l="sentry-",c=/^sentry-/;function baggageHeaderToObject(t){return t.split(",").map(t=>t.split("=").map(t=>decodeURIComponent(t.trim()))).reduce((t,[n,r])=>(t[n]=r,t),{})}n.BAGGAGE_HEADER_NAME="baggage",n.MAX_BAGGAGE_STRING_LENGTH=8192,n.SENTRY_BAGGAGE_KEY_PREFIX=l,n.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=c,n.baggageHeaderToDynamicSamplingContext=function(t){if(!o.isString(t)&&!Array.isArray(t))return;let n={};if(Array.isArray(t))n=t.reduce((t,n)=>{let r=baggageHeaderToObject(n);for(let n of Object.keys(r))t[n]=r[n];return t},{});else{if(!t)return;n=baggageHeaderToObject(t)}let r=Object.entries(n).reduce((t,[n,r])=>{if(n.match(c)){let i=n.slice(l.length);t[i]=r}return t},{});return Object.keys(r).length>0?r:void 0},n.dynamicSamplingContextToSentryBaggageHeader=function(t){if(!t)return;let n=Object.entries(t).reduce((t,[n,r])=>(r&&(t[`${l}${n}`]=r),t),{});return function(t){if(0!==Object.keys(t).length)return Object.entries(t).reduce((t,[n,r],o)=>{let l=`${encodeURIComponent(n)}=${encodeURIComponent(r)}`,c=0===o?l:`${t},${l}`;return c.length>8192?(i.DEBUG_BUILD&&a.logger.warn(`Not adding key: ${n} with val: ${r} to baggage header due to exceeding baggage size limits.`),t):c},"")}(n)}},71106:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(60754),o=r(41944),a=o.getGlobalObject();n.getComponentName=function(t){if(!a.HTMLElement)return null;let n=t;for(let t=0;t<5&&n;t++){if(n instanceof HTMLElement&&n.dataset.sentryComponent)return n.dataset.sentryComponent;n=n.parentNode}return null},n.getDomElement=function(t){return a.document&&a.document.querySelector?a.document.querySelector(t):null},n.getLocationHref=function(){try{return a.document.location.href}catch(t){return""}},n.htmlTreeAsString=function(t,n={}){if(!t)return"<unknown>";try{let r,o=t,l=[],c=0,g=0,d=Array.isArray(n)?n:n.keyAttrs,u=!Array.isArray(n)&&n.maxStringLength||80;for(;o&&c++<5&&(r=function(t,n){let r,o,l,c,g;let d=[];if(!t||!t.tagName)return"";if(a.HTMLElement&&t instanceof HTMLElement&&t.dataset&&t.dataset.sentryComponent)return t.dataset.sentryComponent;d.push(t.tagName.toLowerCase());let u=n&&n.length?n.filter(n=>t.getAttribute(n)).map(n=>[n,t.getAttribute(n)]):null;if(u&&u.length)u.forEach(t=>{d.push(`[${t[0]}="${t[1]}"]`)});else if(t.id&&d.push(`#${t.id}`),(r=t.className)&&i.isString(r))for(g=0,o=r.split(/\s+/);g<o.length;g++)d.push(`.${o[g]}`);let I=["aria-label","type","name","title","alt"];for(g=0;g<I.length;g++)l=I[g],(c=t.getAttribute(l))&&d.push(`[${l}="${c}"]`);return d.join("")}(o,d),"html"!==r&&(!(c>1)||!(g+3*l.length+r.length>=u)));)l.push(r),g+=r.length,o=o.parentNode;return l.reverse().join(" > ")}catch(t){return"<unknown>"}}},35922:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(50967);async function _asyncNullishCoalesce(t,n){return i._nullishCoalesce(t,n)}n._asyncNullishCoalesce=_asyncNullishCoalesce},56064:(t,n)=>{async function _asyncOptionalChain(t){let n;let r=t[0],i=1;for(;i<t.length;){let o=t[i],a=t[i+1];if(i+=2,("optionalAccess"===o||"optionalCall"===o)&&null==r)return;"access"===o||"optionalAccess"===o?(n=r,r=await a(r)):("call"===o||"optionalCall"===o)&&(r=await a((...t)=>r.call(n,...t)),n=void 0)}return r}Object.defineProperty(n,"__esModule",{value:!0}),n._asyncOptionalChain=_asyncOptionalChain},6822:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(56064);async function _asyncOptionalChainDelete(t){let n=await i._asyncOptionalChain(t);return null==n||n}n._asyncOptionalChainDelete=_asyncOptionalChainDelete},50967:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n._nullishCoalesce=function(t,n){return null!=t?t:n()}},35674:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n._optionalChain=function(t){let n;let r=t[0],i=1;for(;i<t.length;){let o=t[i],a=t[i+1];if(i+=2,("optionalAccess"===o||"optionalCall"===o)&&null==r)return;"access"===o||"optionalAccess"===o?(n=r,r=a(r)):("call"===o||"optionalCall"===o)&&(r=a((...t)=>r.call(n,...t)),n=void 0)}return r}},6911:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(35674);n._optionalChainDelete=function(t){let n=i._optionalChain(t);return null==n||n}},97623:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.makeFifoCache=function(t){let n=[],r={};return{add(i,o){for(;n.length>=t;){let t=n.shift();void 0!==t&&delete r[t]}r[i]&&this.delete(i),n.push(i),r[i]=o},clear(){r={},n=[]},get:t=>r[t],size:()=>n.length,delete(t){if(!r[t])return!1;delete r[t];for(let r=0;r<n.length;r++)if(n[r]===t){n.splice(r,1);break}return!0}}}},989:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(30273),o=r(68405);n.createClientReportEnvelope=function(t,n,r){let a=[{type:"client_report"},{timestamp:r||o.dateTimestampInSeconds(),discarded_events:t}];return i.createEnvelope(n?{dsn:n}:{},[a])}},25361:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.parseCookie=function(t){let n={},r=0;for(;r<t.length;){let i=t.indexOf("=",r);if(-1===i)break;let o=t.indexOf(";",r);if(-1===o)o=t.length;else if(o<i){r=t.lastIndexOf(";",i-1)+1;continue}let a=t.slice(r,i).trim();if(void 0===n[a]){let r=t.slice(i+1,o).trim();34===r.charCodeAt(0)&&(r=r.slice(1,-1));try{n[a]=-1!==r.indexOf("%")?decodeURIComponent(r):r}catch(t){n[a]=r}}r=o+1}return n}},71843:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r="undefined"==typeof __SENTRY_DEBUG__||__SENTRY_DEBUG__;n.DEBUG_BUILD=r},2426:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71843),o=r(61755),a=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function dsnFromString(t){let n=a.exec(t);if(!n){o.consoleSandbox(()=>{console.error(`Invalid Sentry Dsn: ${t}`)});return}let[r,i,l="",c,g="",d]=n.slice(1),u="",I=d,p=I.split("/");if(p.length>1&&(u=p.slice(0,-1).join("/"),I=p.pop()),I){let t=I.match(/^\d+/);t&&(I=t[0])}return dsnFromComponents({host:c,pass:l,path:u,projectId:I,port:g,protocol:r,publicKey:i})}function dsnFromComponents(t){return{protocol:t.protocol,publicKey:t.publicKey||"",pass:t.pass||"",host:t.host,port:t.port||"",path:t.path||"",projectId:t.projectId}}n.dsnFromString=dsnFromString,n.dsnToString=function(t,n=!1){let{host:r,path:i,pass:o,port:a,projectId:l,protocol:c,publicKey:g}=t;return`${c}://${g}${n&&o?`:${o}`:""}@${r}${a?`:${a}`:""}/${i?`${i}/`:i}${l}`},n.makeDsn=function(t){let n="string"==typeof t?dsnFromString(t):dsnFromComponents(t);if(n&&function(t){if(!i.DEBUG_BUILD)return!0;let{port:n,projectId:r,protocol:a}=t,l=["protocol","publicKey","host","projectId"].find(n=>!t[n]&&(o.logger.error(`Invalid Sentry Dsn: ${n} missing`),!0));return!l&&(r.match(/^\d+$/)?"http"===a||"https"===a?!(n&&isNaN(parseInt(n,10)))||(o.logger.error(`Invalid Sentry Dsn: Invalid port ${n}`),!1):(o.logger.error(`Invalid Sentry Dsn: Invalid protocol ${a}`),!1):(o.logger.error(`Invalid Sentry Dsn: Invalid projectId ${r}`),!1))}(n))return n}},56860:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getSDKSource=function(){return"npm"},n.isBrowserBundle=function(){return"undefined"!=typeof __SENTRY_BROWSER_BUNDLE__&&!!__SENTRY_BROWSER_BUNDLE__}},30273:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(2426),o=r(65672),a=r(71131);function forEachEnvelopeItem(t,n){let r=t[1];for(let t of r){let r=t[0].type,i=n(t,r);if(i)return!0}return!1}function encodeUTF8(t,n){let r=n||new TextEncoder;return r.encode(t)}let l={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"metric_bucket"};n.addItemToEnvelope=function(t,n){let[r,i]=t;return[r,[...i,n]]},n.createAttachmentEnvelopeItem=function(t,n){let r="string"==typeof t.data?encodeUTF8(t.data,n):t.data;return[a.dropUndefinedKeys({type:"attachment",length:r.length,filename:t.filename,content_type:t.contentType,attachment_type:t.attachmentType}),r]},n.createEnvelope=function(t,n=[]){return[t,n]},n.createEventEnvelopeHeaders=function(t,n,r,o){let l=t.sdkProcessingMetadata&&t.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:t.event_id,sent_at:new Date().toISOString(),...n&&{sdk:n},...!!r&&o&&{dsn:i.dsnToString(o)},...l&&{trace:a.dropUndefinedKeys({...l})}}},n.envelopeContainsItemType=function(t,n){return forEachEnvelopeItem(t,(t,r)=>n.includes(r))},n.envelopeItemTypeToDataCategory=function(t){return l[t]},n.forEachEnvelopeItem=forEachEnvelopeItem,n.getSdkMetadataForEnvelopeHeader=function(t){if(!t||!t.sdk)return;let{name:n,version:r}=t.sdk;return{name:n,version:r}},n.parseEnvelope=function(t,n,r){let i="string"==typeof t?n.encode(t):t;function readBinary(t){let n=i.subarray(0,t);return i=i.subarray(t+1),n}function readJson(){let t=i.indexOf(10);return t<0&&(t=i.length),JSON.parse(r.decode(readBinary(t)))}let o=readJson(),a=[];for(;i.length;){let t=readJson(),n="number"==typeof t.length?t.length:void 0;a.push([t,n?readBinary(n):readJson()])}return[o,a]},n.serializeEnvelope=function(t,n){let[r,i]=t,a=JSON.stringify(r);function append(t){"string"==typeof a?a="string"==typeof t?a+t:[encodeUTF8(a,n),t]:a.push("string"==typeof t?encodeUTF8(t,n):t)}for(let t of i){let[n,r]=t;if(append(`
${JSON.stringify(n)}
`),"string"==typeof r||r instanceof Uint8Array)append(r);else{let t;try{t=JSON.stringify(r)}catch(n){t=JSON.stringify(o.normalize(r))}append(t)}}return"string"==typeof a?a:function(t){let n=t.reduce((t,n)=>t+n.length,0),r=new Uint8Array(n),i=0;for(let n of t)r.set(n,i),i+=n.length;return r}(a)}},53004:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SentryError=class extends Error{constructor(t,n="warn"){super(t),this.message=t,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=n}}},45041:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(60754),o=r(19589),a=r(65672),l=r(71131);function parseStackFrames(t,n){return t(n.stack||"",1)}function exceptionFromError(t,n){let r={type:n.name||n.constructor.name,value:n.message},i=parseStackFrames(t,n);return i.length&&(r.stacktrace={frames:i}),r}n.eventFromMessage=function(t,n,r="info",o,a){let l={event_id:o&&o.event_id,level:r};if(a&&o&&o.syntheticException){let r=parseStackFrames(t,o.syntheticException);r.length&&(l.exception={values:[{value:n,stacktrace:{frames:r}}]})}if(i.isParameterizedString(n)){let{__sentry_template_string__:t,__sentry_template_values__:r}=n;return l.logentry={message:t,params:r},l}return l.message=n,l},n.eventFromUnknownInput=function(t,n,r,c){let g;let d="function"==typeof t?t().getClient():t,u=r,I=c&&c.data&&c.data.mechanism,p=I||{handled:!0,type:"generic"};if(!i.isError(r)){if(i.isPlainObject(r)){let t=d&&d.getOptions().normalizeDepth;g={__serialized__:a.normalizeToSize(r,t)};let n=function(t){if("name"in t&&"string"==typeof t.name){let n=`'${t.name}' captured as exception`;return"message"in t&&"string"==typeof t.message&&(n+=` with message '${t.message}'`),n}return"message"in t&&"string"==typeof t.message?t.message:`Object captured as exception with keys: ${l.extractExceptionKeysForMessage(t)}`}(r);(u=c&&c.syntheticException||Error(n)).message=n}else(u=c&&c.syntheticException||Error(r)).message=r;p.synthetic=!0}let m={exception:{values:[exceptionFromError(n,u)]}};return g&&(m.extra=g),o.addExceptionTypeValue(m,void 0,void 0),o.addExceptionMechanism(m,p),{...m,event_id:c&&c.event_id}},n.exceptionFromError=exceptionFromError,n.parseStackFrames=parseStackFrames},81277:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(69383),o=r(71106),a=r(2426),l=r(53004),c=r(41944),g=r(65585),d=r(60754),u=r(55503),I=r(61755),p=r(71616),m=r(19589),h=r(32626),C=r(65672),b=r(71131),y=r(45295),G=r(35941),A=r(69749),B=r(30672),Z=r(37188),f=r(34278),v=r(34587),W=r(33265),S=r(68405),R=r(36776),V=r(56860),H=r(30273),N=r(989),Y=r(17984),X=r(66237),E=r(80766),T=r(53041),_=r(97623),w=r(45041),F=r(96382),K=r(96399),x=r(35922),k=r(56064),U=r(6822),J=r(50967),L=r(35674),z=r(6911),P=r(68502),M=r(24239),O=r(70243),j=r(56503),D=r(58969),Q=r(36252),q=r(51706),$=r(76734),ee=r(71153),et=r(99273),en=r(80497);n.applyAggregateErrorsToEvent=i.applyAggregateErrorsToEvent,n.getComponentName=o.getComponentName,n.getDomElement=o.getDomElement,n.getLocationHref=o.getLocationHref,n.htmlTreeAsString=o.htmlTreeAsString,n.dsnFromString=a.dsnFromString,n.dsnToString=a.dsnToString,n.makeDsn=a.makeDsn,n.SentryError=l.SentryError,n.GLOBAL_OBJ=c.GLOBAL_OBJ,n.getGlobalObject=c.getGlobalObject,n.getGlobalSingleton=c.getGlobalSingleton,n.addInstrumentationHandler=g.addInstrumentationHandler,n.isDOMError=d.isDOMError,n.isDOMException=d.isDOMException,n.isElement=d.isElement,n.isError=d.isError,n.isErrorEvent=d.isErrorEvent,n.isEvent=d.isEvent,n.isInstanceOf=d.isInstanceOf,n.isNaN=d.isNaN,n.isParameterizedString=d.isParameterizedString,n.isPlainObject=d.isPlainObject,n.isPrimitive=d.isPrimitive,n.isRegExp=d.isRegExp,n.isString=d.isString,n.isSyntheticEvent=d.isSyntheticEvent,n.isThenable=d.isThenable,n.isVueViewModel=d.isVueViewModel,n.isBrowser=u.isBrowser,n.CONSOLE_LEVELS=I.CONSOLE_LEVELS,n.consoleSandbox=I.consoleSandbox,n.logger=I.logger,n.originalConsoleMethods=I.originalConsoleMethods,n.memoBuilder=p.memoBuilder,n.addContextToFrame=m.addContextToFrame,n.addExceptionMechanism=m.addExceptionMechanism,n.addExceptionTypeValue=m.addExceptionTypeValue,n.arrayify=m.arrayify,n.checkOrSetAlreadyCaught=m.checkOrSetAlreadyCaught,n.getEventDescription=m.getEventDescription,n.parseSemver=m.parseSemver,n.uuid4=m.uuid4,n.dynamicRequire=h.dynamicRequire,n.isNodeEnv=h.isNodeEnv,n.loadModule=h.loadModule,n.normalize=C.normalize,n.normalizeToSize=C.normalizeToSize,n.normalizeUrlToBase=C.normalizeUrlToBase,n.walk=C.walk,n.addNonEnumerableProperty=b.addNonEnumerableProperty,n.convertToPlainObject=b.convertToPlainObject,n.dropUndefinedKeys=b.dropUndefinedKeys,n.extractExceptionKeysForMessage=b.extractExceptionKeysForMessage,n.fill=b.fill,n.getOriginalFunction=b.getOriginalFunction,n.markFunctionWrapped=b.markFunctionWrapped,n.objectify=b.objectify,n.urlEncode=b.urlEncode,n.basename=y.basename,n.dirname=y.dirname,n.isAbsolute=y.isAbsolute,n.join=y.join,n.normalizePath=y.normalizePath,n.relative=y.relative,n.resolve=y.resolve,n.makePromiseBuffer=G.makePromiseBuffer,n.DEFAULT_USER_INCLUDES=A.DEFAULT_USER_INCLUDES,n.addRequestDataToEvent=A.addRequestDataToEvent,n.addRequestDataToTransaction=A.addRequestDataToTransaction,n.extractPathForTransaction=A.extractPathForTransaction,n.extractRequestData=A.extractRequestData,n.winterCGHeadersToDict=A.winterCGHeadersToDict,n.winterCGRequestToRequestData=A.winterCGRequestToRequestData,n.severityFromString=B.severityFromString,n.severityLevelFromString=B.severityLevelFromString,n.validSeverityLevels=B.validSeverityLevels,n.createStackParser=Z.createStackParser,n.getFunctionName=Z.getFunctionName,n.nodeStackLineParser=Z.nodeStackLineParser,n.stackParserFromStackParserOptions=Z.stackParserFromStackParserOptions,n.stripSentryFramesAndReverse=Z.stripSentryFramesAndReverse,n.isMatchingPattern=f.isMatchingPattern,n.safeJoin=f.safeJoin,n.snipLine=f.snipLine,n.stringMatchesSomePattern=f.stringMatchesSomePattern,n.truncate=f.truncate,n.isNativeFetch=v.isNativeFetch,n.supportsDOMError=v.supportsDOMError,n.supportsDOMException=v.supportsDOMException,n.supportsErrorEvent=v.supportsErrorEvent,n.supportsFetch=v.supportsFetch,n.supportsNativeFetch=v.supportsNativeFetch,n.supportsReferrerPolicy=v.supportsReferrerPolicy,n.supportsReportingObserver=v.supportsReportingObserver,n.SyncPromise=W.SyncPromise,n.rejectedSyncPromise=W.rejectedSyncPromise,n.resolvedSyncPromise=W.resolvedSyncPromise,Object.defineProperty(n,"_browserPerformanceTimeOriginMode",{enumerable:!0,get:()=>S._browserPerformanceTimeOriginMode}),n.browserPerformanceTimeOrigin=S.browserPerformanceTimeOrigin,n.dateTimestampInSeconds=S.dateTimestampInSeconds,n.timestampInSeconds=S.timestampInSeconds,n.timestampWithMs=S.timestampWithMs,n.TRACEPARENT_REGEXP=R.TRACEPARENT_REGEXP,n.extractTraceparentData=R.extractTraceparentData,n.generateSentryTraceHeader=R.generateSentryTraceHeader,n.propagationContextFromHeaders=R.propagationContextFromHeaders,n.tracingContextFromHeaders=R.tracingContextFromHeaders,n.getSDKSource=V.getSDKSource,n.isBrowserBundle=V.isBrowserBundle,n.addItemToEnvelope=H.addItemToEnvelope,n.createAttachmentEnvelopeItem=H.createAttachmentEnvelopeItem,n.createEnvelope=H.createEnvelope,n.createEventEnvelopeHeaders=H.createEventEnvelopeHeaders,n.envelopeContainsItemType=H.envelopeContainsItemType,n.envelopeItemTypeToDataCategory=H.envelopeItemTypeToDataCategory,n.forEachEnvelopeItem=H.forEachEnvelopeItem,n.getSdkMetadataForEnvelopeHeader=H.getSdkMetadataForEnvelopeHeader,n.parseEnvelope=H.parseEnvelope,n.serializeEnvelope=H.serializeEnvelope,n.createClientReportEnvelope=N.createClientReportEnvelope,n.DEFAULT_RETRY_AFTER=Y.DEFAULT_RETRY_AFTER,n.disabledUntil=Y.disabledUntil,n.isRateLimited=Y.isRateLimited,n.parseRetryAfterHeader=Y.parseRetryAfterHeader,n.updateRateLimits=Y.updateRateLimits,n.BAGGAGE_HEADER_NAME=X.BAGGAGE_HEADER_NAME,n.MAX_BAGGAGE_STRING_LENGTH=X.MAX_BAGGAGE_STRING_LENGTH,n.SENTRY_BAGGAGE_KEY_PREFIX=X.SENTRY_BAGGAGE_KEY_PREFIX,n.SENTRY_BAGGAGE_KEY_PREFIX_REGEX=X.SENTRY_BAGGAGE_KEY_PREFIX_REGEX,n.baggageHeaderToDynamicSamplingContext=X.baggageHeaderToDynamicSamplingContext,n.dynamicSamplingContextToSentryBaggageHeader=X.dynamicSamplingContextToSentryBaggageHeader,n.getNumberOfUrlSegments=E.getNumberOfUrlSegments,n.getSanitizedUrlString=E.getSanitizedUrlString,n.parseUrl=E.parseUrl,n.stripUrlQueryAndFragment=E.stripUrlQueryAndFragment,n.addOrUpdateIntegration=T.addOrUpdateIntegration,n.makeFifoCache=_.makeFifoCache,n.eventFromMessage=w.eventFromMessage,n.eventFromUnknownInput=w.eventFromUnknownInput,n.exceptionFromError=w.exceptionFromError,n.parseStackFrames=w.parseStackFrames,n.callFrameToStackFrame=F.callFrameToStackFrame,n.watchdogTimer=F.watchdogTimer,n.LRUMap=K.LRUMap,n._asyncNullishCoalesce=x._asyncNullishCoalesce,n._asyncOptionalChain=k._asyncOptionalChain,n._asyncOptionalChainDelete=U._asyncOptionalChainDelete,n._nullishCoalesce=J._nullishCoalesce,n._optionalChain=L._optionalChain,n._optionalChainDelete=z._optionalChainDelete,n.addConsoleInstrumentationHandler=P.addConsoleInstrumentationHandler,n.addClickKeypressInstrumentationHandler=M.addClickKeypressInstrumentationHandler,n.SENTRY_XHR_DATA_KEY=O.SENTRY_XHR_DATA_KEY,n.addXhrInstrumentationHandler=O.addXhrInstrumentationHandler,n.addFetchInstrumentationHandler=j.addFetchInstrumentationHandler,n.addHistoryInstrumentationHandler=D.addHistoryInstrumentationHandler,n.addGlobalErrorInstrumentationHandler=Q.addGlobalErrorInstrumentationHandler,n.addGlobalUnhandledRejectionInstrumentationHandler=q.addGlobalUnhandledRejectionInstrumentationHandler,n.resetInstrumentationHandlers=$.resetInstrumentationHandlers,n.filenameIsInApp=ee.filenameIsInApp,n.escapeStringForRegex=et.escapeStringForRegex,n.supportsHistory=en.supportsHistory},76734:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71843),o=r(61755),a=r(37188),l={},c={};n.addHandler=function(t,n){l[t]=l[t]||[],l[t].push(n)},n.maybeInstrument=function(t,n){c[t]||(n(),c[t]=!0)},n.resetInstrumentationHandlers=function(){Object.keys(l).forEach(t=>{l[t]=void 0})},n.triggerHandlers=function(t,n){let r=t&&l[t];if(r)for(let l of r)try{l(n)}catch(n){i.DEBUG_BUILD&&o.logger.error(`Error while triggering instrumentation handler.
Type: ${t}
Name: ${a.getFunctionName(l)}
Error:`,n)}}},68502:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(61755),o=r(71131),a=r(41944),l=r(76734);function instrumentConsole(){"console"in a.GLOBAL_OBJ&&i.CONSOLE_LEVELS.forEach(function(t){t in a.GLOBAL_OBJ.console&&o.fill(a.GLOBAL_OBJ.console,t,function(n){return i.originalConsoleMethods[t]=n,function(...n){l.triggerHandlers("console",{args:n,level:t});let r=i.originalConsoleMethods[t];r&&r.apply(a.GLOBAL_OBJ.console,n)}})})}n.addConsoleInstrumentationHandler=function(t){let n="console";l.addHandler(n,t),l.maybeInstrument(n,instrumentConsole)}},24239:(t,n,r)=>{let i,o,a;Object.defineProperty(n,"__esModule",{value:!0});let l=r(19589),c=r(71131),g=r(41944),d=r(76734),u=g.GLOBAL_OBJ;function instrumentDOM(){if(!u.document)return;let t=d.triggerHandlers.bind(null,"dom"),n=makeDOMEventHandler(t,!0);u.document.addEventListener("click",n,!1),u.document.addEventListener("keypress",n,!1),["EventTarget","Node"].forEach(n=>{let r=u[n]&&u[n].prototype;r&&r.hasOwnProperty&&r.hasOwnProperty("addEventListener")&&(c.fill(r,"addEventListener",function(n){return function(r,i,o){if("click"===r||"keypress"==r)try{let i=this.__sentry_instrumentation_handlers__=this.__sentry_instrumentation_handlers__||{},a=i[r]=i[r]||{refCount:0};if(!a.handler){let i=makeDOMEventHandler(t);a.handler=i,n.call(this,r,i,o)}a.refCount++}catch(t){}return n.call(this,r,i,o)}}),c.fill(r,"removeEventListener",function(t){return function(n,r,i){if("click"===n||"keypress"==n)try{let r=this.__sentry_instrumentation_handlers__||{},o=r[n];o&&(o.refCount--,o.refCount<=0&&(t.call(this,n,o.handler,i),o.handler=void 0,delete r[n]),0===Object.keys(r).length&&delete this.__sentry_instrumentation_handlers__)}catch(t){}return t.call(this,n,r,i)}}))})}function makeDOMEventHandler(t,n=!1){return r=>{if(!r||r._sentryCaptured)return;let g=function(t){try{return t.target}catch(t){return null}}(r);if("keypress"===r.type&&(!g||!g.tagName||"INPUT"!==g.tagName&&"TEXTAREA"!==g.tagName&&!g.isContentEditable))return;c.addNonEnumerableProperty(r,"_sentryCaptured",!0),g&&!g._sentryId&&c.addNonEnumerableProperty(g,"_sentryId",l.uuid4());let d="keypress"===r.type?"input":r.type;!function(t){if(t.type!==o)return!1;try{if(!t.target||t.target._sentryId!==a)return!1}catch(t){}return!0}(r)&&(t({event:r,name:d,global:n}),o=r.type,a=g?g._sentryId:void 0),clearTimeout(i),i=u.setTimeout(()=>{a=void 0,o=void 0},1e3)}}n.addClickKeypressInstrumentationHandler=function(t){d.addHandler("dom",t),d.maybeInstrument("dom",instrumentDOM)},n.instrumentDOM=instrumentDOM},56503:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71131),o=r(34587),a=r(41944),l=r(76734);function instrumentFetch(){o.supportsNativeFetch()&&i.fill(a.GLOBAL_OBJ,"fetch",function(t){return function(...n){let{method:r,url:i}=parseFetchArgs(n),o={args:n,fetchData:{method:r,url:i},startTimestamp:Date.now()};return l.triggerHandlers("fetch",{...o}),t.apply(a.GLOBAL_OBJ,n).then(t=>{let n={...o,endTimestamp:Date.now(),response:t};return l.triggerHandlers("fetch",n),t},t=>{let n={...o,endTimestamp:Date.now(),error:t};throw l.triggerHandlers("fetch",n),t})}})}function hasProp(t,n){return!!t&&"object"==typeof t&&!!t[n]}function getUrlFromResource(t){return"string"==typeof t?t:t?hasProp(t,"url")?t.url:t.toString?t.toString():"":""}function parseFetchArgs(t){if(0===t.length)return{method:"GET",url:""};if(2===t.length){let[n,r]=t;return{url:getUrlFromResource(n),method:hasProp(r,"method")?String(r.method).toUpperCase():"GET"}}let n=t[0];return{url:getUrlFromResource(n),method:hasProp(n,"method")?String(n.method).toUpperCase():"GET"}}n.addFetchInstrumentationHandler=function(t){let n="fetch";l.addHandler(n,t),l.maybeInstrument(n,instrumentFetch)},n.parseFetchArgs=parseFetchArgs},36252:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(41944),o=r(76734),a=null;function instrumentError(){a=i.GLOBAL_OBJ.onerror,i.GLOBAL_OBJ.onerror=function(t,n,r,i,l){return o.triggerHandlers("error",{column:i,error:l,line:r,msg:t,url:n}),!!a&&!a.__SENTRY_LOADER__&&a.apply(this,arguments)},i.GLOBAL_OBJ.onerror.__SENTRY_INSTRUMENTED__=!0}n.addGlobalErrorInstrumentationHandler=function(t){let n="error";o.addHandler(n,t),o.maybeInstrument(n,instrumentError)}},51706:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(41944),o=r(76734),a=null;function instrumentUnhandledRejection(){a=i.GLOBAL_OBJ.onunhandledrejection,i.GLOBAL_OBJ.onunhandledrejection=function(t){return o.triggerHandlers("unhandledrejection",t),!a||!!a.__SENTRY_LOADER__||a.apply(this,arguments)},i.GLOBAL_OBJ.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}n.addGlobalUnhandledRejectionInstrumentationHandler=function(t){let n="unhandledrejection";o.addHandler(n,t),o.maybeInstrument(n,instrumentUnhandledRejection)}},58969:(t,n,r)=>{let i;Object.defineProperty(n,"__esModule",{value:!0});let o=r(71131);r(71843),r(61755);let a=r(41944),l=r(80497),c=r(76734),g=a.GLOBAL_OBJ;function instrumentHistory(){if(!l.supportsHistory())return;let t=g.onpopstate;function historyReplacementFunction(t){return function(...n){let r=n.length>2?n[2]:void 0;if(r){let t=i,n=String(r);i=n,c.triggerHandlers("history",{from:t,to:n})}return t.apply(this,n)}}g.onpopstate=function(...n){let r=g.location.href,o=i;if(i=r,c.triggerHandlers("history",{from:o,to:r}),t)try{return t.apply(this,n)}catch(t){}},o.fill(g.history,"pushState",historyReplacementFunction),o.fill(g.history,"replaceState",historyReplacementFunction)}n.addHistoryInstrumentationHandler=function(t){let n="history";c.addHandler(n,t),c.maybeInstrument(n,instrumentHistory)}},65585:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71843),o=r(61755),a=r(68502),l=r(24239),c=r(56503),g=r(36252),d=r(51706),u=r(58969),I=r(70243);n.addConsoleInstrumentationHandler=a.addConsoleInstrumentationHandler,n.addClickKeypressInstrumentationHandler=l.addClickKeypressInstrumentationHandler,n.addFetchInstrumentationHandler=c.addFetchInstrumentationHandler,n.addGlobalErrorInstrumentationHandler=g.addGlobalErrorInstrumentationHandler,n.addGlobalUnhandledRejectionInstrumentationHandler=d.addGlobalUnhandledRejectionInstrumentationHandler,n.addHistoryInstrumentationHandler=u.addHistoryInstrumentationHandler,n.SENTRY_XHR_DATA_KEY=I.SENTRY_XHR_DATA_KEY,n.addXhrInstrumentationHandler=I.addXhrInstrumentationHandler,n.addInstrumentationHandler=function(t,n){switch(t){case"console":return a.addConsoleInstrumentationHandler(n);case"dom":return l.addClickKeypressInstrumentationHandler(n);case"xhr":return I.addXhrInstrumentationHandler(n);case"fetch":return c.addFetchInstrumentationHandler(n);case"history":return u.addHistoryInstrumentationHandler(n);case"error":return g.addGlobalErrorInstrumentationHandler(n);case"unhandledrejection":return d.addGlobalUnhandledRejectionInstrumentationHandler(n);default:i.DEBUG_BUILD&&o.logger.warn("unknown instrumentation type:",t)}}},70243:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(60754),o=r(71131),a=r(41944),l=r(76734),c=a.GLOBAL_OBJ,g="__sentry_xhr_v3__";function instrumentXHR(){if(!c.XMLHttpRequest)return;let t=XMLHttpRequest.prototype;o.fill(t,"open",function(t){return function(...n){let r=Date.now(),a=i.isString(n[0])?n[0].toUpperCase():void 0,c=function(t){if(i.isString(t))return t;try{return t.toString()}catch(t){}}(n[1]);if(!a||!c)return t.apply(this,n);this[g]={method:a,url:c,request_headers:{}},"POST"===a&&c.match(/sentry_key/)&&(this.__sentry_own_request__=!0);let onreadystatechangeHandler=()=>{let t=this[g];if(t&&4===this.readyState){try{t.status_code=this.status}catch(t){}let n={args:[a,c],endTimestamp:Date.now(),startTimestamp:r,xhr:this};l.triggerHandlers("xhr",n)}};return"onreadystatechange"in this&&"function"==typeof this.onreadystatechange?o.fill(this,"onreadystatechange",function(t){return function(...n){return onreadystatechangeHandler(),t.apply(this,n)}}):this.addEventListener("readystatechange",onreadystatechangeHandler),o.fill(this,"setRequestHeader",function(t){return function(...n){let[r,o]=n,a=this[g];return a&&i.isString(r)&&i.isString(o)&&(a.request_headers[r.toLowerCase()]=o),t.apply(this,n)}}),t.apply(this,n)}}),o.fill(t,"send",function(t){return function(...n){let r=this[g];if(!r)return t.apply(this,n);void 0!==n[0]&&(r.body=n[0]);let i={args:[r.method,r.url],startTimestamp:Date.now(),xhr:this};return l.triggerHandlers("xhr",i),t.apply(this,n)}})}n.SENTRY_XHR_DATA_KEY=g,n.addXhrInstrumentationHandler=function(t){l.addHandler("xhr",t),l.maybeInstrument("xhr",instrumentXHR)},n.instrumentXHR=instrumentXHR},60754:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r=Object.prototype.toString;function isBuiltin(t,n){return r.call(t)===`[object ${n}]`}function isParameterizedString(t){return"object"==typeof t&&null!==t&&"__sentry_template_string__"in t&&"__sentry_template_values__"in t}function isPlainObject(t){return isBuiltin(t,"Object")}function isInstanceOf(t,n){try{return t instanceof n}catch(t){return!1}}n.isDOMError=function(t){return isBuiltin(t,"DOMError")},n.isDOMException=function(t){return isBuiltin(t,"DOMException")},n.isElement=function(t){return"undefined"!=typeof Element&&isInstanceOf(t,Element)},n.isError=function(t){switch(r.call(t)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return isInstanceOf(t,Error)}},n.isErrorEvent=function(t){return isBuiltin(t,"ErrorEvent")},n.isEvent=function(t){return"undefined"!=typeof Event&&isInstanceOf(t,Event)},n.isInstanceOf=isInstanceOf,n.isNaN=function(t){return"number"==typeof t&&t!=t},n.isParameterizedString=isParameterizedString,n.isPlainObject=isPlainObject,n.isPrimitive=function(t){return null===t||isParameterizedString(t)||"object"!=typeof t&&"function"!=typeof t},n.isRegExp=function(t){return isBuiltin(t,"RegExp")},n.isString=function(t){return isBuiltin(t,"String")},n.isSyntheticEvent=function(t){return isPlainObject(t)&&"nativeEvent"in t&&"preventDefault"in t&&"stopPropagation"in t},n.isThenable=function(t){return!!(t&&t.then&&"function"==typeof t.then)},n.isVueViewModel=function(t){return!!("object"==typeof t&&null!==t&&(t.__isVue||t._isVue))}},55503:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(32626),o=r(41944);n.isBrowser=function(){return"undefined"!=typeof window&&(!i.isNodeEnv()||void 0!==o.GLOBAL_OBJ.process&&"renderer"===o.GLOBAL_OBJ.process.type)}},61755:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71843),o=r(41944),a=["debug","info","warn","error","log","assert","trace"],l={};function consoleSandbox(t){if(!("console"in o.GLOBAL_OBJ))return t();let n=o.GLOBAL_OBJ.console,r={},i=Object.keys(l);i.forEach(t=>{let i=l[t];r[t]=n[t],n[t]=i});try{return t()}finally{i.forEach(t=>{n[t]=r[t]})}}let c=function(){let t=!1,n={enable:()=>{t=!0},disable:()=>{t=!1},isEnabled:()=>t};return i.DEBUG_BUILD?a.forEach(r=>{n[r]=(...n)=>{t&&consoleSandbox(()=>{o.GLOBAL_OBJ.console[r](`Sentry Logger [${r}]:`,...n)})}}):a.forEach(t=>{n[t]=()=>void 0}),n}();n.CONSOLE_LEVELS=a,n.consoleSandbox=consoleSandbox,n.logger=c,n.originalConsoleMethods=l},96399:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.LRUMap=class{constructor(t){this._maxSize=t,this._cache=new Map}get size(){return this._cache.size}get(t){let n=this._cache.get(t);if(void 0!==n)return this._cache.delete(t),this._cache.set(t,n),n}set(t,n){this._cache.size>=this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(t,n)}remove(t){let n=this._cache.get(t);return n&&this._cache.delete(t),n}clear(){this._cache.clear()}keys(){return Array.from(this._cache.keys())}values(){let t=[];return this._cache.forEach(n=>t.push(n)),t}}},71616:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.memoBuilder=function(){let t="function"==typeof WeakSet,n=t?new WeakSet:[];return[function(r){if(t)return!!n.has(r)||(n.add(r),!1);for(let t=0;t<n.length;t++){let i=n[t];if(i===r)return!0}return n.push(r),!1},function(r){if(t)n.delete(r);else for(let t=0;t<n.length;t++)if(n[t]===r){n.splice(t,1);break}}]}},19589:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71131),o=r(34278),a=r(41944);function getFirstException(t){return t.exception&&t.exception.values?t.exception.values[0]:void 0}let l=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;n.addContextToFrame=function(t,n,r=5){if(void 0===n.lineno)return;let i=t.length,a=Math.max(Math.min(i-1,n.lineno-1),0);n.pre_context=t.slice(Math.max(0,a-r),a).map(t=>o.snipLine(t,0)),n.context_line=o.snipLine(t[Math.min(i-1,a)],n.colno||0),n.post_context=t.slice(Math.min(a+1,i),a+1+r).map(t=>o.snipLine(t,0))},n.addExceptionMechanism=function(t,n){let r=getFirstException(t);if(!r)return;let i=r.mechanism;if(r.mechanism={type:"generic",handled:!0,...i,...n},n&&"data"in n){let t={...i&&i.data,...n.data};r.mechanism.data=t}},n.addExceptionTypeValue=function(t,n,r){let i=t.exception=t.exception||{},o=i.values=i.values||[],a=o[0]=o[0]||{};a.value||(a.value=n||""),a.type||(a.type=r||"Error")},n.arrayify=function(t){return Array.isArray(t)?t:[t]},n.checkOrSetAlreadyCaught=function(t){if(t&&t.__sentry_captured__)return!0;try{i.addNonEnumerableProperty(t,"__sentry_captured__",!0)}catch(t){}return!1},n.getEventDescription=function(t){let{message:n,event_id:r}=t;if(n)return n;let i=getFirstException(t);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||r||"<unknown>":r||"<unknown>"},n.parseSemver=function(t){let n=t.match(l)||[],r=parseInt(n[1],10),i=parseInt(n[2],10),o=parseInt(n[3],10);return{buildmetadata:n[5],major:isNaN(r)?void 0:r,minor:isNaN(i)?void 0:i,patch:isNaN(o)?void 0:o,prerelease:n[4]}},n.uuid4=function(){let t=a.GLOBAL_OBJ,n=t.crypto||t.msCrypto,getRandomByte=()=>16*Math.random();try{if(n&&n.randomUUID)return n.randomUUID().replace(/-/g,"");n&&n.getRandomValues&&(getRandomByte=()=>{let t=new Uint8Array(1);return n.getRandomValues(t),t[0]})}catch(t){}return"10000000100040008000100000000000".replace(/[018]/g,t=>(t^(15&getRandomByte())>>t/4).toString(16))}},71153:(t,n)=>{function filenameIsInApp(t,n=!1){let r=n||t&&!t.startsWith("/")&&!t.match(/^[A-Z]:/)&&!t.startsWith(".")&&!t.match(/^[a-zA-Z]([a-zA-Z0-9.\-+])*:\/\//);return!r&&void 0!==t&&!t.includes("node_modules/")}Object.defineProperty(n,"__esModule",{value:!0}),n.filenameIsInApp=filenameIsInApp,n.node=function(t){let n=/^\s*[-]{4,}$/,r=/at (?:async )?(?:(.+?)\s+\()?(?:(.+):(\d+):(\d+)?|([^)]+))\)?/;return i=>{let o=i.match(r);if(o){let n,r,i,a,l;if(o[1]){let t=(i=o[1]).lastIndexOf(".");if("."===i[t-1]&&t--,t>0){n=i.slice(0,t),r=i.slice(t+1);let o=n.indexOf(".Module");o>0&&(i=i.slice(o+1),n=n.slice(0,o))}a=void 0}r&&(a=n,l=r),"<anonymous>"===r&&(l=void 0,i=void 0),void 0===i&&(l=l||"<anonymous>",i=a?`${a}.${l}`:l);let c=o[2]&&o[2].startsWith("file://")?o[2].slice(7):o[2],g="native"===o[5];return c&&c.match(/\/[A-Z]:/)&&(c=c.slice(1)),c||!o[5]||g||(c=o[5]),{filename:c,module:t?t(c):void 0,function:i,lineno:parseInt(o[3],10)||void 0,colno:parseInt(o[4],10)||void 0,in_app:filenameIsInApp(c,g)}}if(i.match(n))return{filename:i}}}},32626:(t,n,r)=>{t=r.nmd(t),Object.defineProperty(n,"__esModule",{value:!0});let i=r(56860);function dynamicRequire(t,n){return t.require(n)}n.dynamicRequire=dynamicRequire,n.isNodeEnv=function(){return!i.isBrowserBundle()&&"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)},n.loadModule=function(n){let r;try{r=dynamicRequire(t,n)}catch(t){}try{let{cwd:i}=dynamicRequire(t,"process");r=dynamicRequire(t,`${i()}/node_modules/${n}`)}catch(t){}return r}},65672:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(60754),o=r(71616),a=r(71131),l=r(37188);function normalize(t,n=100,r=Infinity){try{return visit("",t,n,r)}catch(t){return{ERROR:`**non-serializable** (${t})`}}}function visit(t,n,r=Infinity,c=Infinity,g=o.memoBuilder()){let[d,u]=g;if(null==n||["number","boolean","string"].includes(typeof n)&&!i.isNaN(n))return n;let I=function(t,n){try{if("domain"===t&&n&&"object"==typeof n&&n._events)return"[Domain]";if("domainEmitter"===t)return"[DomainEmitter]";if("undefined"!=typeof global&&n===global)return"[Global]";if("undefined"!=typeof window&&n===window)return"[Window]";if("undefined"!=typeof document&&n===document)return"[Document]";if(i.isVueViewModel(n))return"[VueViewModel]";if(i.isSyntheticEvent(n))return"[SyntheticEvent]";if("number"==typeof n&&n!=n)return"[NaN]";if("function"==typeof n)return`[Function: ${l.getFunctionName(n)}]`;if("symbol"==typeof n)return`[${String(n)}]`;if("bigint"==typeof n)return`[BigInt: ${String(n)}]`;let r=function(t){let n=Object.getPrototypeOf(t);return n?n.constructor.name:"null prototype"}(n);if(/^HTML(\w*)Element$/.test(r))return`[HTMLElement: ${r}]`;return`[object ${r}]`}catch(t){return`**non-serializable** (${t})`}}(t,n);if(!I.startsWith("[object "))return I;if(n.__sentry_skip_normalization__)return n;let p="number"==typeof n.__sentry_override_normalization_depth__?n.__sentry_override_normalization_depth__:r;if(0===p)return I.replace("object ","");if(d(n))return"[Circular ~]";if(n&&"function"==typeof n.toJSON)try{let t=n.toJSON();return visit("",t,p-1,c,g)}catch(t){}let m=Array.isArray(n)?[]:{},h=0,C=a.convertToPlainObject(n);for(let t in C){if(!Object.prototype.hasOwnProperty.call(C,t))continue;if(h>=c){m[t]="[MaxProperties ~]";break}let n=C[t];m[t]=visit(t,n,p-1,c,g),h++}return u(n),m}n.normalize=normalize,n.normalizeToSize=function normalizeToSize(t,n=3,r=102400){let i=normalize(t,n);return~-encodeURI(JSON.stringify(i)).split(/%..|./).length>r?normalizeToSize(t,n-1,r):i},n.normalizeUrlToBase=function(t,n){let r=n.replace(/\\/g,"/").replace(/[|\\{}()[\]^$+*?.]/g,"\\$&"),i=t;try{i=decodeURI(t)}catch(t){}return i.replace(/\\/g,"/").replace(/webpack:\/?/g,"").replace(RegExp(`(file://)?/*${r}/*`,"ig"),"app:///")},n.walk=visit},71131:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71106),o=r(71843),a=r(60754),l=r(61755),c=r(34278);function addNonEnumerableProperty(t,n,r){try{Object.defineProperty(t,n,{value:r,writable:!0,configurable:!0})}catch(r){o.DEBUG_BUILD&&l.logger.log(`Failed to add non-enumerable property "${n}" to object`,t)}}function markFunctionWrapped(t,n){try{let r=n.prototype||{};t.prototype=n.prototype=r,addNonEnumerableProperty(t,"__sentry_original__",n)}catch(t){}}function convertToPlainObject(t){if(a.isError(t))return{message:t.message,name:t.name,stack:t.stack,...getOwnProperties(t)};if(!a.isEvent(t))return t;{let n={type:t.type,target:serializeEventTarget(t.target),currentTarget:serializeEventTarget(t.currentTarget),...getOwnProperties(t)};return"undefined"!=typeof CustomEvent&&a.isInstanceOf(t,CustomEvent)&&(n.detail=t.detail),n}}function serializeEventTarget(t){try{return a.isElement(t)?i.htmlTreeAsString(t):Object.prototype.toString.call(t)}catch(t){return"<unknown>"}}function getOwnProperties(t){if("object"!=typeof t||null===t)return{};{let n={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}}n.addNonEnumerableProperty=addNonEnumerableProperty,n.convertToPlainObject=convertToPlainObject,n.dropUndefinedKeys=function(t){let n=new Map;return function _dropUndefinedKeys(t,n){if(function(t){if(!a.isPlainObject(t))return!1;try{let n=Object.getPrototypeOf(t).constructor.name;return!n||"Object"===n}catch(t){return!0}}(t)){let r=n.get(t);if(void 0!==r)return r;let i={};for(let r of(n.set(t,i),Object.keys(t)))void 0!==t[r]&&(i[r]=_dropUndefinedKeys(t[r],n));return i}if(Array.isArray(t)){let r=n.get(t);if(void 0!==r)return r;let i=[];return n.set(t,i),t.forEach(t=>{i.push(_dropUndefinedKeys(t,n))}),i}return t}(t,n)},n.extractExceptionKeysForMessage=function(t,n=40){let r=Object.keys(convertToPlainObject(t));if(r.sort(),!r.length)return"[object has no keys]";if(r[0].length>=n)return c.truncate(r[0],n);for(let t=r.length;t>0;t--){let i=r.slice(0,t).join(", ");if(!(i.length>n)){if(t===r.length)return i;return c.truncate(i,n)}}return""},n.fill=function(t,n,r){if(!(n in t))return;let i=t[n],o=r(i);"function"==typeof o&&markFunctionWrapped(o,i),t[n]=o},n.getOriginalFunction=function(t){return t.__sentry_original__},n.markFunctionWrapped=markFunctionWrapped,n.objectify=function(t){let n;switch(!0){case null==t:n=new String(t);break;case"symbol"==typeof t||"bigint"==typeof t:n=Object(t);break;case a.isPrimitive(t):n=new t.constructor(t);break;default:n=t}return n},n.urlEncode=function(t){return Object.keys(t).map(n=>`${encodeURIComponent(n)}=${encodeURIComponent(t[n])}`).join("&")}},45295:(t,n)=>{function normalizeArray(t,n){let r=0;for(let n=t.length-1;n>=0;n--){let i=t[n];"."===i?t.splice(n,1):".."===i?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(n)for(;r--;r)t.unshift("..");return t}Object.defineProperty(n,"__esModule",{value:!0});let r=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function splitPath(t){let n=t.length>1024?`<truncated>${t.slice(-1024)}`:t,i=r.exec(n);return i?i.slice(1):[]}function resolve(...t){let n="",r=!1;for(let i=t.length-1;i>=-1&&!r;i--){let o=i>=0?t[i]:"/";o&&(n=`${o}/${n}`,r="/"===o.charAt(0))}return n=normalizeArray(n.split("/").filter(t=>!!t),!r).join("/"),(r?"/":"")+n||"."}function trim(t){let n=0;for(;n<t.length&&""===t[n];n++);let r=t.length-1;for(;r>=0&&""===t[r];r--);return n>r?[]:t.slice(n,r-n+1)}function normalizePath(t){let n=isAbsolute(t),r="/"===t.slice(-1),i=normalizeArray(t.split("/").filter(t=>!!t),!n).join("/");return i||n||(i="."),i&&r&&(i+="/"),(n?"/":"")+i}function isAbsolute(t){return"/"===t.charAt(0)}n.basename=function(t,n){let r=splitPath(t)[2];return n&&r.slice(-1*n.length)===n&&(r=r.slice(0,r.length-n.length)),r},n.dirname=function(t){let n=splitPath(t),r=n[0],i=n[1];return r||i?(i&&(i=i.slice(0,i.length-1)),r+i):"."},n.isAbsolute=isAbsolute,n.join=function(...t){return normalizePath(t.join("/"))},n.normalizePath=normalizePath,n.relative=function(t,n){t=resolve(t).slice(1),n=resolve(n).slice(1);let r=trim(t.split("/")),i=trim(n.split("/")),o=Math.min(r.length,i.length),a=o;for(let t=0;t<o;t++)if(r[t]!==i[t]){a=t;break}let l=[];for(let t=a;t<r.length;t++)l.push("..");return(l=l.concat(i.slice(a))).join("/")},n.resolve=resolve},35941:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(53004),o=r(33265);n.makePromiseBuffer=function(t){let n=[];function remove(t){return n.splice(n.indexOf(t),1)[0]}return{$:n,add:function(r){if(!(void 0===t||n.length<t))return o.rejectedSyncPromise(new i.SentryError("Not adding Promise because buffer limit was reached."));let a=r();return -1===n.indexOf(a)&&n.push(a),a.then(()=>remove(a)).then(null,()=>remove(a).then(null,()=>{})),a},drain:function(t){return new o.SyncPromise((r,i)=>{let a=n.length;if(!a)return r(!0);let l=setTimeout(()=>{t&&t>0&&r(!1)},t);n.forEach(t=>{o.resolvedSyncPromise(t).then(()=>{--a||(clearTimeout(l),r(!0))},i)})})}}}},17984:(t,n)=>{function parseRetryAfterHeader(t,n=Date.now()){let r=parseInt(`${t}`,10);if(!isNaN(r))return 1e3*r;let i=Date.parse(`${t}`);return isNaN(i)?6e4:i-n}function disabledUntil(t,n){return t[n]||t.all||0}Object.defineProperty(n,"__esModule",{value:!0}),n.DEFAULT_RETRY_AFTER=6e4,n.disabledUntil=disabledUntil,n.isRateLimited=function(t,n,r=Date.now()){return disabledUntil(t,n)>r},n.parseRetryAfterHeader=parseRetryAfterHeader,n.updateRateLimits=function(t,{statusCode:n,headers:r},i=Date.now()){let o={...t},a=r&&r["x-sentry-rate-limits"],l=r&&r["retry-after"];if(a)for(let t of a.trim().split(",")){let[n,r,,,a]=t.split(":",5),l=parseInt(n,10),c=(isNaN(l)?60:l)*1e3;if(r)for(let t of r.split(";"))"metric_bucket"===t?(!a||a.split(";").includes("custom"))&&(o[t]=i+c):o[t]=i+c;else o.all=i+c}else l?o.all=i+parseRetryAfterHeader(l,i):429===n&&(o.all=i+6e4);return o}},69749:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(25361),o=r(71843),a=r(60754),l=r(61755),c=r(65672),g=r(80766),d={ip:!1,request:!0,transaction:!0,user:!0},u=["cookies","data","headers","method","query_string","url"],I=["id","username","email"];function extractPathForTransaction(t,n={}){let r=t.method&&t.method.toUpperCase(),i="",o="url";n.customRoute||t.route?(i=n.customRoute||`${t.baseUrl||""}${t.route&&t.route.path}`,o="route"):(t.originalUrl||t.url)&&(i=g.stripUrlQueryAndFragment(t.originalUrl||t.url||""));let a="";return n.method&&r&&(a+=r),n.method&&n.path&&(a+=" "),n.path&&i&&(a+=i),[a,o]}function extractRequestData(t,n){let{include:r=u,deps:o}=n||{},l={},g=t.headers||{},d=t.method,I=g.host||t.hostname||t.host||"<no host>",p="https"===t.protocol||t.socket&&t.socket.encrypted?"https":"http",m=t.originalUrl||t.url||"",h=m.startsWith(p)?m:`${p}://${I}${m}`;return r.forEach(n=>{switch(n){case"headers":l.headers=g,r.includes("cookies")||delete l.headers.cookie;break;case"method":l.method=d;break;case"url":l.url=h;break;case"cookies":l.cookies=t.cookies||g.cookie&&i.parseCookie(g.cookie)||{};break;case"query_string":l.query_string=extractQueryParams(t,o);break;case"data":if("GET"===d||"HEAD"===d)break;void 0!==t.body&&(l.data=a.isString(t.body)?t.body:JSON.stringify(c.normalize(t.body)));break;default:({}).hasOwnProperty.call(t,n)&&(l[n]=t[n])}}),l}function extractQueryParams(t,n){let r=t.originalUrl||t.url||"";if(r){r.startsWith("/")&&(r=`http://dogs.are.great${r}`);try{return t.query||"undefined"!=typeof URL&&new URL(r).search.slice(1)||n&&n.url&&n.url.parse(r).query||void 0}catch(t){return}}}function winterCGHeadersToDict(t){let n={};try{t.forEach((t,r)=>{"string"==typeof t&&(n[r]=t)})}catch(t){o.DEBUG_BUILD&&l.logger.warn("Sentry failed extracting headers from a request object. If you see this, please file an issue.")}return n}n.DEFAULT_USER_INCLUDES=I,n.addRequestDataToEvent=function(t,n,r){let i={...d,...r&&r.include};if(i.request){let o=Array.isArray(i.request)?extractRequestData(n,{include:i.request,deps:r&&r.deps}):extractRequestData(n,{deps:r&&r.deps});t.request={...t.request,...o}}if(i.user){let r=n.user&&a.isPlainObject(n.user)?function(t,n){let r={},i=Array.isArray(n)?n:I;return i.forEach(n=>{t&&n in t&&(r[n]=t[n])}),r}(n.user,i.user):{};Object.keys(r).length&&(t.user={...t.user,...r})}if(i.ip){let r=n.ip||n.socket&&n.socket.remoteAddress;r&&(t.user={...t.user,ip_address:r})}return i.transaction&&!t.transaction&&(t.transaction=function(t,n){switch(n){case"path":return extractPathForTransaction(t,{path:!0})[0];case"handler":return t.route&&t.route.stack&&t.route.stack[0]&&t.route.stack[0].name||"<anonymous>";default:{let n=t._reconstructedRoute?t._reconstructedRoute:void 0;return extractPathForTransaction(t,{path:!0,method:!0,customRoute:n})[0]}}}(n,i.transaction)),t},n.addRequestDataToTransaction=function(t,n,r){if(t){if(!t.metadata.source||"url"===t.metadata.source){let[r,i]=extractPathForTransaction(n,{path:!0,method:!0});t.updateName(r),t.setMetadata({source:i})}t.setAttribute("url",n.originalUrl||n.url),n.baseUrl&&t.setAttribute("baseUrl",n.baseUrl),t.setData("query",extractQueryParams(n,r))}},n.extractPathForTransaction=extractPathForTransaction,n.extractRequestData=extractRequestData,n.winterCGHeadersToDict=winterCGHeadersToDict,n.winterCGRequestToRequestData=function(t){let n=winterCGHeadersToDict(t.headers);return{method:t.method,url:t.url,headers:n}}},30672:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0});let r=["fatal","error","warning","log","info","debug"];function severityLevelFromString(t){return"warn"===t?"warning":r.includes(t)?t:"log"}n.severityFromString=function(t){return severityLevelFromString(t)},n.severityLevelFromString=severityLevelFromString,n.validSeverityLevels=r},37188:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71153),o=/\(error: (.*)\)/,a=/captureMessage|captureException/;function createStackParser(...t){let n=t.sort((t,n)=>t[0]-n[0]).map(t=>t[1]);return(t,r=0)=>{let i=[],a=t.split("\n");for(let t=r;t<a.length;t++){let r=a[t];if(r.length>1024)continue;let l=o.test(r)?r.replace(o,"$1"):r;if(!l.match(/\S*Error: /)){for(let t of n){let n=t(l);if(n){i.push(n);break}}if(i.length>=50)break}}return stripSentryFramesAndReverse(i)}}function stripSentryFramesAndReverse(t){if(!t.length)return[];let n=Array.from(t);return/sentryWrapped/.test(n[n.length-1].function||"")&&n.pop(),n.reverse(),a.test(n[n.length-1].function||"")&&(n.pop(),a.test(n[n.length-1].function||"")&&n.pop()),n.slice(0,50).map(t=>({...t,filename:t.filename||n[n.length-1].filename,function:t.function||"?"}))}let l="<anonymous>";n.filenameIsInApp=i.filenameIsInApp,n.createStackParser=createStackParser,n.getFunctionName=function(t){try{if(!t||"function"!=typeof t)return l;return t.name||l}catch(t){return l}},n.nodeStackLineParser=function(t){return[90,i.node(t)]},n.stackParserFromStackParserOptions=function(t){return Array.isArray(t)?createStackParser(...t):t},n.stripSentryFramesAndReverse=stripSentryFramesAndReverse},34278:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(60754);function isMatchingPattern(t,n,r=!1){return!!i.isString(t)&&(i.isRegExp(n)?n.test(t):!!i.isString(n)&&(r?t===n:t.includes(n)))}n.isMatchingPattern=isMatchingPattern,n.safeJoin=function(t,n){if(!Array.isArray(t))return"";let r=[];for(let n=0;n<t.length;n++){let o=t[n];try{i.isVueViewModel(o)?r.push("[VueViewModel]"):r.push(String(o))}catch(t){r.push("[value cannot be serialized]")}}return r.join(n)},n.snipLine=function(t,n){let r=t,i=r.length;if(i<=150)return r;n>i&&(n=i);let o=Math.max(n-60,0);o<5&&(o=0);let a=Math.min(o+140,i);return a>i-5&&(a=i),a===i&&(o=Math.max(a-140,0)),r=r.slice(o,a),o>0&&(r=`'{snip} ${r}`),a<i&&(r+=" {snip}"),r},n.stringMatchesSomePattern=function(t,n=[],r=!1){return n.some(n=>isMatchingPattern(t,n,r))},n.truncate=function(t,n=0){return"string"!=typeof t||0===n?t:t.length<=n?t:`${t.slice(0,n)}...`}},34587:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(71843),o=r(61755),a=r(41944),l=a.getGlobalObject();function supportsFetch(){if(!("fetch"in l))return!1;try{return new Headers,new Request("http://www.example.com"),new Response,!0}catch(t){return!1}}function isNativeFetch(t){return t&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(t.toString())}n.isNativeFetch=isNativeFetch,n.supportsDOMError=function(){try{return new DOMError(""),!0}catch(t){return!1}},n.supportsDOMException=function(){try{return new DOMException(""),!0}catch(t){return!1}},n.supportsErrorEvent=function(){try{return new ErrorEvent(""),!0}catch(t){return!1}},n.supportsFetch=supportsFetch,n.supportsNativeFetch=function(){if("string"==typeof EdgeRuntime)return!0;if(!supportsFetch())return!1;if(isNativeFetch(l.fetch))return!0;let t=!1,n=l.document;if(n&&"function"==typeof n.createElement)try{let r=n.createElement("iframe");r.hidden=!0,n.head.appendChild(r),r.contentWindow&&r.contentWindow.fetch&&(t=isNativeFetch(r.contentWindow.fetch)),n.head.removeChild(r)}catch(t){i.DEBUG_BUILD&&o.logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",t)}return t},n.supportsReferrerPolicy=function(){if(!supportsFetch())return!1;try{return new Request("_",{referrerPolicy:"origin"}),!0}catch(t){return!1}},n.supportsReportingObserver=function(){return"ReportingObserver"in l}},33265:(t,n,r)=>{var i;Object.defineProperty(n,"__esModule",{value:!0});let o=r(60754);!function(t){t[t.PENDING=0]="PENDING",t[t.RESOLVED=1]="RESOLVED",t[t.REJECTED=2]="REJECTED"}(i||(i={}));let SyncPromise=class SyncPromise{constructor(t){SyncPromise.prototype.__init.call(this),SyncPromise.prototype.__init2.call(this),SyncPromise.prototype.__init3.call(this),SyncPromise.prototype.__init4.call(this),this._state=i.PENDING,this._handlers=[];try{t(this._resolve,this._reject)}catch(t){this._reject(t)}}then(t,n){return new SyncPromise((r,i)=>{this._handlers.push([!1,n=>{if(t)try{r(t(n))}catch(t){i(t)}else r(n)},t=>{if(n)try{r(n(t))}catch(t){i(t)}else i(t)}]),this._executeHandlers()})}catch(t){return this.then(t=>t,t)}finally(t){return new SyncPromise((n,r)=>{let i,o;return this.then(n=>{o=!1,i=n,t&&t()},n=>{o=!0,i=n,t&&t()}).then(()=>{if(o){r(i);return}n(i)})})}__init(){this._resolve=t=>{this._setResult(i.RESOLVED,t)}}__init2(){this._reject=t=>{this._setResult(i.REJECTED,t)}}__init3(){this._setResult=(t,n)=>{if(this._state===i.PENDING){if(o.isThenable(n)){n.then(this._resolve,this._reject);return}this._state=t,this._value=n,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===i.PENDING)return;let t=this._handlers.slice();this._handlers=[],t.forEach(t=>{t[0]||(this._state===i.RESOLVED&&t[1](this._value),this._state===i.REJECTED&&t[2](this._value),t[0]=!0)})}}};n.SyncPromise=SyncPromise,n.rejectedSyncPromise=function(t){return new SyncPromise((n,r)=>{r(t)})},n.resolvedSyncPromise=function(t){return new SyncPromise(n=>{n(t)})}},68405:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(41944);function dateTimestampInSeconds(){return Date.now()/1e3}let o=function(){let{performance:t}=i.GLOBAL_OBJ;if(!t||!t.now)return dateTimestampInSeconds;let n=Date.now()-t.now(),r=void 0==t.timeOrigin?n:t.timeOrigin;return()=>(r+t.now())/1e3}();n._browserPerformanceTimeOriginMode=void 0;let a=(()=>{let{performance:t}=i.GLOBAL_OBJ;if(!t||!t.now){n._browserPerformanceTimeOriginMode="none";return}let r=t.now(),o=Date.now(),a=t.timeOrigin?Math.abs(t.timeOrigin+r-o):36e5,l=t.timing&&t.timing.navigationStart,c="number"==typeof l?Math.abs(l+r-o):36e5;return a<36e5||c<36e5?a<=c?(n._browserPerformanceTimeOriginMode="timeOrigin",t.timeOrigin):(n._browserPerformanceTimeOriginMode="navigationStart",l):(n._browserPerformanceTimeOriginMode="dateNow",o)})();n.browserPerformanceTimeOrigin=a,n.dateTimestampInSeconds=dateTimestampInSeconds,n.timestampInSeconds=o,n.timestampWithMs=o},36776:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(66237),o=r(19589),a=RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function extractTraceparentData(t){let n;if(!t)return;let r=t.match(a);if(r)return"1"===r[3]?n=!0:"0"===r[3]&&(n=!1),{traceId:r[1],parentSampled:n,parentSpanId:r[2]}}n.TRACEPARENT_REGEXP=a,n.extractTraceparentData=extractTraceparentData,n.generateSentryTraceHeader=function(t=o.uuid4(),n=o.uuid4().substring(16),r){let i="";return void 0!==r&&(i=r?"-1":"-0"),`${t}-${n}${i}`},n.propagationContextFromHeaders=function(t,n){let r=extractTraceparentData(t),a=i.baggageHeaderToDynamicSamplingContext(n),{traceId:l,parentSpanId:c,parentSampled:g}=r||{};return r?{traceId:l||o.uuid4(),parentSpanId:c||o.uuid4().substring(16),spanId:o.uuid4().substring(16),sampled:g,dsc:a||{}}:{traceId:l||o.uuid4(),spanId:o.uuid4().substring(16)}},n.tracingContextFromHeaders=function(t,n){let r=extractTraceparentData(t),a=i.baggageHeaderToDynamicSamplingContext(n),{traceId:l,parentSpanId:c,parentSampled:g}=r||{};return r?{traceparentData:r,dynamicSamplingContext:a||{},propagationContext:{traceId:l||o.uuid4(),parentSpanId:c||o.uuid4().substring(16),spanId:o.uuid4().substring(16),sampled:g,dsc:a||{}}}:{traceparentData:r,dynamicSamplingContext:void 0,propagationContext:{traceId:l||o.uuid4(),spanId:o.uuid4().substring(16)}}}},80766:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getNumberOfUrlSegments=function(t){return t.split(/\\?\//).filter(t=>t.length>0&&","!==t).length},n.getSanitizedUrlString=function(t){let{protocol:n,host:r,path:i}=t,o=r&&r.replace(/^.*@/,"[filtered]:[filtered]@").replace(/(:80)$/,"").replace(/(:443)$/,"")||"";return`${n?`${n}://`:""}${o}${i}`},n.parseUrl=function(t){if(!t)return{};let n=t.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!n)return{};let r=n[6]||"",i=n[8]||"";return{host:n[4],path:n[5],protocol:n[2],search:r,hash:i,relative:n[5]+r+i}},n.stripUrlQueryAndFragment=function(t){return t.split(/[\?#]/,1)[0]}},53041:(t,n)=>{function addOrUpdateIntegrationInArray(t,n,r){let i=n.find(n=>n.name===t.name);if(i){for(let[t,n]of Object.entries(r))!function setNestedKey(t,n,r){let i=n.match(/([a-z_]+)\.(.*)/i);if(null===i)t[n]=r;else{let n=t[i[1]];setNestedKey(n,i[2],r)}}(i,t,n);return n}return[...n,t]}Object.defineProperty(n,"__esModule",{value:!0}),n.addOrUpdateIntegration=function(t,n,r={}){return Array.isArray(n)?addOrUpdateIntegrationInArray(t,n,r):i=>{let o=n(i);if(t.allowExclusionByUser){let n=o.find(n=>n.name===t.name);if(!n)return o}return addOrUpdateIntegrationInArray(t,o,r)}}},99273:(t,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.escapeStringForRegex=function(t){return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}},80497:(t,n,r)=>{Object.defineProperty(n,"__esModule",{value:!0});let i=r(41944),o=i.getGlobalObject();n.supportsHistory=function(){let t=o.chrome,n=t&&t.app&&t.app.runtime,r="history"in o&&!!o.history.pushState&&!!o.history.replaceState;return!n&&r}},41944:(t,n)=>{function isGlobalObj(t){return t&&t.Math==Math?t:void 0}Object.defineProperty(n,"__esModule",{value:!0});let r="object"==typeof globalThis&&isGlobalObj(globalThis)||"object"==typeof window&&isGlobalObj(window)||"object"==typeof self&&isGlobalObj(self)||"object"==typeof global&&isGlobalObj(global)||function(){return this}()||{};n.GLOBAL_OBJ=r,n.getGlobalObject=function(){return r},n.getGlobalSingleton=function(t,n,i){let o=i||r,a=o.__SENTRY__=o.__SENTRY__||{},l=a[t]||(a[t]=n());return l}},32967:t=>{/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/t.exports=(function e(t,n,r){function s(o,a){if(!n[o]){if(!t[o]){if(i)return i(o,!0);var l=Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(n){return s(t[o][1][n]||n)},c,c.exports,e,t,n,r)}return n[o].exports}for(var i=void 0,o=0;o<r.length;o++)s(r[o]);return s})({1:[function(t,n,r){(function(t){"use strict";var r,i,o=t.MutationObserver||t.WebKitMutationObserver;if(o){var a=0,l=new o(nextTick),c=t.document.createTextNode("");l.observe(c,{characterData:!0}),r=function(){c.data=a=++a%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var n=t.document.createElement("script");n.onreadystatechange=function(){nextTick(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n)}:function(){setTimeout(nextTick,0)};else{var g=new t.MessageChannel;g.port1.onmessage=nextTick,r=function(){g.port2.postMessage(0)}}var d=[];function nextTick(){i=!0;for(var t,n,r=d.length;r;){for(n=d,d=[],t=-1;++t<r;)n[t]();r=d.length}i=!1}n.exports=function(t){1!==d.push(t)||i||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,n,r){"use strict";var i=t(1);function INTERNAL(){}var o={},a=["REJECTED"],l=["FULFILLED"],c=["PENDING"];function Promise(t){if("function"!=typeof t)throw TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,t!==INTERNAL&&safelyResolveThenable(this,t)}function QueueItem(t,n,r){this.promise=t,"function"==typeof n&&(this.onFulfilled=n,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function unwrap(t,n,r){i(function(){var i;try{i=n(r)}catch(n){return o.reject(t,n)}i===t?o.reject(t,TypeError("Cannot resolve promise with itself")):o.resolve(t,i)})}function getThen(t){var n=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof n)return function(){n.apply(t,arguments)}}function safelyResolveThenable(t,n){var r=!1;function onError(n){r||(r=!0,o.reject(t,n))}function onSuccess(n){r||(r=!0,o.resolve(t,n))}var i=tryCatch(function(){n(onSuccess,onError)});"error"===i.status&&onError(i.value)}function tryCatch(t,n){var r={};try{r.value=t(n),r.status="success"}catch(t){r.status="error",r.value=t}return r}n.exports=Promise,Promise.prototype.catch=function(t){return this.then(null,t)},Promise.prototype.then=function(t,n){if("function"!=typeof t&&this.state===l||"function"!=typeof n&&this.state===a)return this;var r=new this.constructor(INTERNAL);return this.state!==c?unwrap(r,this.state===l?t:n,this.outcome):this.queue.push(new QueueItem(r,t,n)),r},QueueItem.prototype.callFulfilled=function(t){o.resolve(this.promise,t)},QueueItem.prototype.otherCallFulfilled=function(t){unwrap(this.promise,this.onFulfilled,t)},QueueItem.prototype.callRejected=function(t){o.reject(this.promise,t)},QueueItem.prototype.otherCallRejected=function(t){unwrap(this.promise,this.onRejected,t)},o.resolve=function(t,n){var r=tryCatch(getThen,n);if("error"===r.status)return o.reject(t,r.value);var i=r.value;if(i)safelyResolveThenable(t,i);else{t.state=l,t.outcome=n;for(var a=-1,c=t.queue.length;++a<c;)t.queue[a].callFulfilled(n)}return t},o.reject=function(t,n){t.state=a,t.outcome=n;for(var r=-1,i=t.queue.length;++r<i;)t.queue[r].callRejected(n);return t},Promise.resolve=function(t){return t instanceof this?t:o.resolve(new this(INTERNAL),t)},Promise.reject=function(t){var n=new this(INTERNAL);return o.reject(n,t)},Promise.all=function(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);for(var a=Array(r),l=0,c=-1,g=new this(INTERNAL);++c<r;)(function(t,c){n.resolve(t).then(function(t){a[c]=t,++l!==r||i||(i=!0,o.resolve(g,a))},function(t){i||(i=!0,o.reject(g,t))})})(t[c],c);return g},Promise.race=function(t){var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(TypeError("must be an array"));var r=t.length,i=!1;if(!r)return this.resolve([]);for(var a=-1,l=new this(INTERNAL);++a<r;)(function(t){n.resolve(t).then(function(t){i||(i=!0,o.resolve(l,t))},function(t){i||(i=!0,o.reject(l,t))})})(t[a]);return l}},{1:1}],3:[function(t,n,r){(function(n){"use strict";"function"!=typeof n.Promise&&(n.Promise=t(2))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,n,r){"use strict";var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){return}}();function createBlob(t,n){t=t||[],n=n||{};try{return new Blob(t,n)}catch(o){if("TypeError"!==o.name)throw o;for(var r=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<t.length;i+=1)r.append(t[i]);return r.getBlob(n.type)}}"undefined"==typeof Promise&&t(3);var a=Promise;function executeCallback(t,n){n&&t.then(function(t){n(null,t)},function(t){n(t)})}function executeTwoCallbacks(t,n,r){"function"==typeof n&&t.then(n),"function"==typeof r&&t.catch(r)}function normalizeKey(t){return"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t)),t}function getCallback(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var l="local-forage-detect-blob-support",c=void 0,g={},d=Object.prototype.toString,u="readonly",I="readwrite";function _deferReadiness(t){var n=g[t.name],r={};r.promise=new a(function(t,n){r.resolve=t,r.reject=n}),n.deferredOperations.push(r),n.dbReady?n.dbReady=n.dbReady.then(function(){return r.promise}):n.dbReady=r.promise}function _advanceReadiness(t){var n=g[t.name].deferredOperations.pop();if(n)return n.resolve(),n.promise}function _rejectReadiness(t,n){var r=g[t.name].deferredOperations.pop();if(r)return r.reject(n),r.promise}function _getConnection(t,n){return new a(function(r,i){if(g[t.name]=g[t.name]||createDbContext(),t.db){if(!n)return r(t.db);_deferReadiness(t),t.db.close()}var a=[t.name];n&&a.push(t.version);var c=o.open.apply(o,a);n&&(c.onupgradeneeded=function(n){var r=c.result;try{r.createObjectStore(t.storeName),n.oldVersion<=1&&r.createObjectStore(l)}catch(r){if("ConstraintError"===r.name)console.warn('The database "'+t.name+'" has been upgraded from version '+n.oldVersion+" to version "+n.newVersion+', but the storage "'+t.storeName+'" already exists.');else throw r}}),c.onerror=function(t){t.preventDefault(),i(c.error)},c.onsuccess=function(){var n=c.result;n.onversionchange=function(t){t.target.close()},r(n),_advanceReadiness(t)}})}function _isUpgradeNeeded(t,n){if(!t.db)return!0;var r=!t.db.objectStoreNames.contains(t.storeName),i=t.version<t.db.version,o=t.version>t.db.version;if(i&&(t.version!==n&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),o||r){if(r){var a=t.db.version+1;a>t.version&&(t.version=a)}return!0}return!1}function _decodeBlob(t){return createBlob([function(t){for(var n=t.length,r=new ArrayBuffer(n),i=new Uint8Array(r),o=0;o<n;o++)i[o]=t.charCodeAt(o);return r}(atob(t.data))],{type:t.type})}function _isEncodedBlob(t){return t&&t.__local_forage_encoded_blob}function _fullyReady(t){var n=this,r=n._initReady().then(function(){var t=g[n._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return executeTwoCallbacks(r,t,t),r}function createTransaction(t,n,r,i){void 0===i&&(i=1);try{var o=t.db.transaction(t.storeName,n);r(null,o)}catch(o){if(i>0&&(!t.db||"InvalidStateError"===o.name||"NotFoundError"===o.name))return a.resolve().then(function(){if(!t.db||"NotFoundError"===o.name&&!t.db.objectStoreNames.contains(t.storeName)&&t.version<=t.db.version)return t.db&&(t.version=t.db.version+1),_getConnection(t,!0)}).then(function(){return(function(t){_deferReadiness(t);for(var n=g[t.name],r=n.forages,i=0;i<r.length;i++){var o=r[i];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return t.db=null,_getConnection(t,!1).then(function(n){return(t.db=n,_isUpgradeNeeded(t))?_getConnection(t,!0):n}).then(function(i){t.db=n.db=i;for(var o=0;o<r.length;o++)r[o]._dbInfo.db=i}).catch(function(n){throw _rejectReadiness(t,n),n})})(t).then(function(){createTransaction(t,n,r,i-1)})}).catch(r);r(o)}}function createDbContext(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}var p={_driver:"asyncStorage",_initStorage:function(t){var n=this,r={db:null};if(t)for(var i in t)r[i]=t[i];var o=g[r.name];o||(o=createDbContext(),g[r.name]=o),o.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=_fullyReady);var l=[];function ignoreErrors(){return a.resolve()}for(var c=0;c<o.forages.length;c++){var d=o.forages[c];d!==n&&l.push(d._initReady().catch(ignoreErrors))}var u=o.forages.slice(0);return a.all(l).then(function(){return r.db=o.db,_getConnection(r,!1)}).then(function(t){return(r.db=t,_isUpgradeNeeded(r,n._defaultConfig.version))?_getConnection(r,!0):t}).then(function(t){r.db=o.db=t,n._dbInfo=r;for(var i=0;i<u.length;i++){var a=u[i];a!==n&&(a._dbInfo.db=r.db,a._dbInfo.version=r.version)}})},_support:function(){try{if(!o||!o.open)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!t||n)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}(),iterate:function(t,n){var r=this,i=new a(function(n,i){r.ready().then(function(){createTransaction(r._dbInfo,u,function(o,a){if(o)return i(o);try{var l=a.objectStore(r._dbInfo.storeName).openCursor(),c=1;l.onsuccess=function(){var r=l.result;if(r){var i=r.value;_isEncodedBlob(i)&&(i=_decodeBlob(i));var o=t(i,r.key,c++);void 0!==o?n(o):r.continue()}else n()},l.onerror=function(){i(l.error)}}catch(t){i(t)}})}).catch(i)});return executeCallback(i,n),i},getItem:function(t,n){var r=this;t=normalizeKey(t);var i=new a(function(n,i){r.ready().then(function(){createTransaction(r._dbInfo,u,function(o,a){if(o)return i(o);try{var l=a.objectStore(r._dbInfo.storeName).get(t);l.onsuccess=function(){var t=l.result;void 0===t&&(t=null),_isEncodedBlob(t)&&(t=_decodeBlob(t)),n(t)},l.onerror=function(){i(l.error)}}catch(t){i(t)}})}).catch(i)});return executeCallback(i,n),i},setItem:function(t,n,r){var i=this;t=normalizeKey(t);var o=new a(function(r,o){var g;i.ready().then(function(){var t;return(g=i._dbInfo,"[object Blob]"===d.call(n))?(t=g.db,"boolean"==typeof c?a.resolve(c):new a(function(n){var r=t.transaction(l,I),i=createBlob([""]);r.objectStore(l).put(i,"key"),r.onabort=function(t){t.preventDefault(),t.stopPropagation(),n(!1)},r.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/);n(navigator.userAgent.match(/Edge\//)||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1}).then(function(t){return c=t})).then(function(t){return t?n:new a(function(t,r){var i=new FileReader;i.onerror=r,i.onloadend=function(r){t({__local_forage_encoded_blob:!0,data:btoa(r.target.result||""),type:n.type})},i.readAsBinaryString(n)})}):n}).then(function(n){createTransaction(i._dbInfo,I,function(a,l){if(a)return o(a);try{var c=l.objectStore(i._dbInfo.storeName);null===n&&(n=void 0);var g=c.put(n,t);l.oncomplete=function(){void 0===n&&(n=null),r(n)},l.onabort=l.onerror=function(){var t=g.error?g.error:g.transaction.error;o(t)}}catch(t){o(t)}})}).catch(o)});return executeCallback(o,r),o},removeItem:function(t,n){var r=this;t=normalizeKey(t);var i=new a(function(n,i){r.ready().then(function(){createTransaction(r._dbInfo,I,function(o,a){if(o)return i(o);try{var l=a.objectStore(r._dbInfo.storeName).delete(t);a.oncomplete=function(){n()},a.onerror=function(){i(l.error)},a.onabort=function(){var t=l.error?l.error:l.transaction.error;i(t)}}catch(t){i(t)}})}).catch(i)});return executeCallback(i,n),i},clear:function(t){var n=this,r=new a(function(t,r){n.ready().then(function(){createTransaction(n._dbInfo,I,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=a.error?a.error:a.transaction.error;r(t)}}catch(t){r(t)}})}).catch(r)});return executeCallback(r,t),r},length:function(t){var n=this,r=new a(function(t,r){n.ready().then(function(){createTransaction(n._dbInfo,u,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).count();a.onsuccess=function(){t(a.result)},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return executeCallback(r,t),r},key:function(t,n){var r=this,i=new a(function(n,i){if(t<0){n(null);return}r.ready().then(function(){createTransaction(r._dbInfo,u,function(o,a){if(o)return i(o);try{var l=a.objectStore(r._dbInfo.storeName),c=!1,g=l.openKeyCursor();g.onsuccess=function(){var r=g.result;if(!r){n(null);return}0===t?n(r.key):c?n(r.key):(c=!0,r.advance(t))},g.onerror=function(){i(g.error)}}catch(t){i(t)}})}).catch(i)});return executeCallback(i,n),i},keys:function(t){var n=this,r=new a(function(t,r){n.ready().then(function(){createTransaction(n._dbInfo,u,function(i,o){if(i)return r(i);try{var a=o.objectStore(n._dbInfo.storeName).openKeyCursor(),l=[];a.onsuccess=function(){var n=a.result;if(!n){t(l);return}l.push(n.key),n.continue()},a.onerror=function(){r(a.error)}}catch(t){r(t)}})}).catch(r)});return executeCallback(r,t),r},dropInstance:function(t,n){n=getCallback.apply(this,arguments);var r,i=this.config();if((t="function"!=typeof t&&t||{}).name||(t.name=t.name||i.name,t.storeName=t.storeName||i.storeName),t.name){var l=t.name===i.name&&this._dbInfo.db?a.resolve(this._dbInfo.db):_getConnection(t,!1).then(function(n){var r=g[t.name],i=r.forages;r.db=n;for(var o=0;o<i.length;o++)i[o]._dbInfo.db=n;return n});r=t.storeName?l.then(function(n){if(n.objectStoreNames.contains(t.storeName)){var r=n.version+1;_deferReadiness(t);var i=g[t.name],l=i.forages;n.close();for(var c=0;c<l.length;c++){var d=l[c];d._dbInfo.db=null,d._dbInfo.version=r}return new a(function(n,i){var a=o.open(t.name,r);a.onerror=function(t){a.result.close(),i(t)},a.onupgradeneeded=function(){a.result.deleteObjectStore(t.storeName)},a.onsuccess=function(){var t=a.result;t.close(),n(t)}}).then(function(t){i.db=t;for(var n=0;n<l.length;n++){var r=l[n];r._dbInfo.db=t,_advanceReadiness(r._dbInfo)}}).catch(function(n){throw(_rejectReadiness(t,n)||a.resolve()).catch(function(){}),n})}}):l.then(function(n){_deferReadiness(t);var r=g[t.name],i=r.forages;n.close();for(var l=0;l<i.length;l++)i[l]._dbInfo.db=null;return new a(function(n,r){var i=o.deleteDatabase(t.name);i.onerror=function(){var t=i.result;t&&t.close(),r(i.error)},i.onblocked=function(){console.warn('dropInstance blocked for database "'+t.name+'" until all open connections are closed')},i.onsuccess=function(){var t=i.result;t&&t.close(),n(t)}}).then(function(t){r.db=t;for(var n=0;n<i.length;n++)_advanceReadiness(i[n]._dbInfo)}).catch(function(n){throw(_rejectReadiness(t,n)||a.resolve()).catch(function(){}),n})})}else r=a.reject("Invalid arguments");return executeCallback(r,n),r}},m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=/^~~local_forage_type~([^~]+)~/,C="__lfsc__:",b=C.length,y="arbf",G="blob",A="si08",B="ui08",Z="uic8",f="si16",v="si32",W="ur16",S="ui32",R="fl32",V="fl64",H=b+y.length,N=Object.prototype.toString;function stringToBuffer(t){var n,r,i,o,a,l=.75*t.length,c=t.length,g=0;"="===t[t.length-1]&&(l--,"="===t[t.length-2]&&l--);var d=new ArrayBuffer(l),u=new Uint8Array(d);for(n=0;n<c;n+=4)r=m.indexOf(t[n]),i=m.indexOf(t[n+1]),o=m.indexOf(t[n+2]),a=m.indexOf(t[n+3]),u[g++]=r<<2|i>>4,u[g++]=(15&i)<<4|o>>2,u[g++]=(3&o)<<6|63&a;return d}function bufferToString(t){var n,r=new Uint8Array(t),i="";for(n=0;n<r.length;n+=3)i+=m[r[n]>>2]+m[(3&r[n])<<4|r[n+1]>>4]+m[(15&r[n+1])<<2|r[n+2]>>6]+m[63&r[n+2]];return r.length%3==2?i=i.substring(0,i.length-1)+"=":r.length%3==1&&(i=i.substring(0,i.length-2)+"=="),i}var Y={serialize:function(t,n){var r="";if(t&&(r=N.call(t)),t&&("[object ArrayBuffer]"===r||t.buffer&&"[object ArrayBuffer]"===N.call(t.buffer))){var i,o=C;t instanceof ArrayBuffer?(i=t,o+=y):(i=t.buffer,"[object Int8Array]"===r?o+=A:"[object Uint8Array]"===r?o+=B:"[object Uint8ClampedArray]"===r?o+=Z:"[object Int16Array]"===r?o+=f:"[object Uint16Array]"===r?o+=W:"[object Int32Array]"===r?o+=v:"[object Uint32Array]"===r?o+=S:"[object Float32Array]"===r?o+=R:"[object Float64Array]"===r?o+=V:n(Error("Failed to get type for BinaryArray"))),n(o+bufferToString(i))}else if("[object Blob]"===r){var a=new FileReader;a.onload=function(){n(C+G+("~~local_forage_type~"+t.type)+"~"+bufferToString(this.result))},a.readAsArrayBuffer(t)}else try{n(JSON.stringify(t))}catch(r){console.error("Couldn't convert value into a JSON string: ",t),n(null,r)}},deserialize:function(t){if(t.substring(0,b)!==C)return JSON.parse(t);var n,r=t.substring(H),i=t.substring(b,H);if(i===G&&h.test(r)){var o=r.match(h);n=o[1],r=r.substring(o[0].length)}var a=stringToBuffer(r);switch(i){case y:return a;case G:return createBlob([a],{type:n});case A:return new Int8Array(a);case B:return new Uint8Array(a);case Z:return new Uint8ClampedArray(a);case f:return new Int16Array(a);case W:return new Uint16Array(a);case v:return new Int32Array(a);case S:return new Uint32Array(a);case R:return new Float32Array(a);case V:return new Float64Array(a);default:throw Error("Unkown type: "+i)}},stringToBuffer:stringToBuffer,bufferToString:bufferToString};function createDbTable(t,n,r,i){t.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],r,i)}function tryExecuteSql(t,n,r,i,o,a){t.executeSql(r,i,o,function(t,l){l.code===l.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(t,c){c.rows.length?a(t,l):createDbTable(t,n,function(){t.executeSql(r,i,o,a)},a)},a):a(t,l)},a)}function _setItem(t,n,r,i){var o=this;t=normalizeKey(t);var l=new a(function(a,l){o.ready().then(function(){void 0===n&&(n=null);var c=n,g=o._dbInfo;g.serializer.serialize(n,function(n,d){d?l(d):g.db.transaction(function(r){tryExecuteSql(r,g,"INSERT OR REPLACE INTO "+g.storeName+" (key, value) VALUES (?, ?)",[t,n],function(){a(c)},function(t,n){l(n)})},function(n){if(n.code===n.QUOTA_ERR){if(i>0){a(_setItem.apply(o,[t,c,r,i-1]));return}l(n)}})})}).catch(l)});return executeCallback(l,r),l}var X={_driver:"webSQLStorage",_initStorage:function(t){var n=this,r={db:null};if(t)for(var i in t)r[i]="string"!=typeof t[i]?t[i].toString():t[i];var o=new a(function(t,i){try{r.db=openDatabase(r.name,String(r.version),r.description,r.size)}catch(t){return i(t)}r.db.transaction(function(o){createDbTable(o,r,function(){n._dbInfo=r,t()},function(t,n){i(n)})},i)});return r.serializer=Y,o},_support:"function"==typeof openDatabase,iterate:function(t,n){var r=this,i=new a(function(n,i){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){tryExecuteSql(r,o,"SELECT * FROM "+o.storeName,[],function(r,i){for(var a=i.rows,l=a.length,c=0;c<l;c++){var g=a.item(c),d=g.value;if(d&&(d=o.serializer.deserialize(d)),void 0!==(d=t(d,g.key,c+1))){n(d);return}}n()},function(t,n){i(n)})})}).catch(i)});return executeCallback(i,n),i},getItem:function(t,n){var r=this;t=normalizeKey(t);var i=new a(function(n,i){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){tryExecuteSql(r,o,"SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],function(t,r){var i=r.rows.length?r.rows.item(0).value:null;i&&(i=o.serializer.deserialize(i)),n(i)},function(t,n){i(n)})})}).catch(i)});return executeCallback(i,n),i},setItem:function(t,n,r){return _setItem.apply(this,[t,n,r,1])},removeItem:function(t,n){var r=this;t=normalizeKey(t);var i=new a(function(n,i){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){tryExecuteSql(r,o,"DELETE FROM "+o.storeName+" WHERE key = ?",[t],function(){n()},function(t,n){i(n)})})}).catch(i)});return executeCallback(i,n),i},clear:function(t){var n=this,r=new a(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){tryExecuteSql(n,i,"DELETE FROM "+i.storeName,[],function(){t()},function(t,n){r(n)})})}).catch(r)});return executeCallback(r,t),r},length:function(t){var n=this,r=new a(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){tryExecuteSql(n,i,"SELECT COUNT(key) as c FROM "+i.storeName,[],function(n,r){t(r.rows.item(0).c)},function(t,n){r(n)})})}).catch(r)});return executeCallback(r,t),r},key:function(t,n){var r=this,i=new a(function(n,i){r.ready().then(function(){var o=r._dbInfo;o.db.transaction(function(r){tryExecuteSql(r,o,"SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,r){n(r.rows.length?r.rows.item(0).key:null)},function(t,n){i(n)})})}).catch(i)});return executeCallback(i,n),i},keys:function(t){var n=this,r=new a(function(t,r){n.ready().then(function(){var i=n._dbInfo;i.db.transaction(function(n){tryExecuteSql(n,i,"SELECT key FROM "+i.storeName,[],function(n,r){for(var i=[],o=0;o<r.rows.length;o++)i.push(r.rows.item(o).key);t(i)},function(t,n){r(n)})})}).catch(r)});return executeCallback(r,t),r},dropInstance:function(t,n){n=getCallback.apply(this,arguments);var r,i=this.config();(t="function"!=typeof t&&t||{}).name||(t.name=t.name||i.name,t.storeName=t.storeName||i.storeName);var o=this;return executeCallback(r=t.name?new a(function(n){var r;n((r=t.name===i.name?o._dbInfo.db:openDatabase(t.name,"","",0),t.storeName)?{db:r,storeNames:[t.storeName]}:new a(function(t,n){r.transaction(function(i){i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(n,i){for(var o=[],a=0;a<i.rows.length;a++)o.push(i.rows.item(a).name);t({db:r,storeNames:o})},function(t,r){n(r)})},function(t){n(t)})}))}).then(function(t){return new a(function(n,r){t.db.transaction(function(i){for(var o=[],l=0,c=t.storeNames.length;l<c;l++)o.push(function(t){return new a(function(n,r){i.executeSql("DROP TABLE IF EXISTS "+t,[],function(){n()},function(t,n){r(n)})})}(t.storeNames[l]));a.all(o).then(function(){n()}).catch(function(t){r(t)})},function(t){r(t)})})}):a.reject("Invalid arguments"),n),r}};function _getKeyPrefix(t,n){var r=t.name+"/";return t.storeName!==n.storeName&&(r+=t.storeName+"/"),r}var E={_driver:"localStorageWrapper",_initStorage:function(t){var n={};if(t)for(var r in t)n[r]=t[r];return(n.keyPrefix=_getKeyPrefix(t,this._defaultConfig),!function(){var t="_localforage_support_test";try{return localStorage.setItem(t,!0),localStorage.removeItem(t),!1}catch(t){return!0}}()||localStorage.length>0)?(this._dbInfo=n,n.serializer=Y,a.resolve()):a.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(t){return!1}}(),iterate:function(t,n){var r=this,i=r.ready().then(function(){for(var n=r._dbInfo,i=n.keyPrefix,o=i.length,a=localStorage.length,l=1,c=0;c<a;c++){var g=localStorage.key(c);if(0===g.indexOf(i)){var d=localStorage.getItem(g);if(d&&(d=n.serializer.deserialize(d)),void 0!==(d=t(d,g.substring(o),l++)))return d}}});return executeCallback(i,n),i},getItem:function(t,n){var r=this;t=normalizeKey(t);var i=r.ready().then(function(){var n=r._dbInfo,i=localStorage.getItem(n.keyPrefix+t);return i&&(i=n.serializer.deserialize(i)),i});return executeCallback(i,n),i},setItem:function(t,n,r){var i=this;t=normalizeKey(t);var o=i.ready().then(function(){void 0===n&&(n=null);var r=n;return new a(function(o,a){var l=i._dbInfo;l.serializer.serialize(n,function(n,i){if(i)a(i);else try{localStorage.setItem(l.keyPrefix+t,n),o(r)}catch(t){("QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&a(t),a(t)}})})});return executeCallback(o,r),o},removeItem:function(t,n){var r=this;t=normalizeKey(t);var i=r.ready().then(function(){var n=r._dbInfo;localStorage.removeItem(n.keyPrefix+t)});return executeCallback(i,n),i},clear:function(t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo.keyPrefix,r=localStorage.length-1;r>=0;r--){var i=localStorage.key(r);0===i.indexOf(t)&&localStorage.removeItem(i)}});return executeCallback(r,t),r},length:function(t){var n=this.keys().then(function(t){return t.length});return executeCallback(n,t),n},key:function(t,n){var r=this,i=r.ready().then(function(){var n,i=r._dbInfo;try{n=localStorage.key(t)}catch(t){n=null}return n&&(n=n.substring(i.keyPrefix.length)),n});return executeCallback(i,n),i},keys:function(t){var n=this,r=n.ready().then(function(){for(var t=n._dbInfo,r=localStorage.length,i=[],o=0;o<r;o++){var a=localStorage.key(o);0===a.indexOf(t.keyPrefix)&&i.push(a.substring(t.keyPrefix.length))}return i});return executeCallback(r,t),r},dropInstance:function(t,n){if(n=getCallback.apply(this,arguments),!(t="function"!=typeof t&&t||{}).name){var r,i=this.config();t.name=t.name||i.name,t.storeName=t.storeName||i.storeName}var o=this;return executeCallback(r=t.name?new a(function(n){n(t.storeName?_getKeyPrefix(t,o._defaultConfig):t.name+"/")}).then(function(t){for(var n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}}):a.reject("Invalid arguments"),n),r}},includes=function(t,n){for(var r,i=t.length,o=0;o<i;){if((r=t[o])===n||"number"==typeof r&&"number"==typeof n&&isNaN(r)&&isNaN(n))return!0;o++}return!1},T=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},_={},w={},F={INDEXEDDB:p,WEBSQL:X,LOCALSTORAGE:E},K=[F.INDEXEDDB._driver,F.WEBSQL._driver,F.LOCALSTORAGE._driver],x=["dropInstance"],k=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(x),U={description:"",driver:K.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function extend(){for(var t=1;t<arguments.length;t++){var n=arguments[t];if(n)for(var r in n)n.hasOwnProperty(r)&&(T(n[r])?arguments[0][r]=n[r].slice():arguments[0][r]=n[r])}return arguments[0]}var J=new(function(){function LocalForage(t){for(var n in function(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}(this,LocalForage),F)if(F.hasOwnProperty(n)){var r=F[n],i=r._driver;this[n]=i,_[i]||this.defineDriver(r)}this._defaultConfig=extend({},U),this._config=extend({},this._defaultConfig,t),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return LocalForage.prototype.config=function(t){if((void 0===t?"undefined":i(t))==="object"){if(this._ready)return Error("Can't call config() after localforage has been used.");for(var n in t){if("storeName"===n&&(t[n]=t[n].replace(/\W/g,"_")),"version"===n&&"number"!=typeof t[n])return Error("Database version must be a number.");this._config[n]=t[n]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},LocalForage.prototype.defineDriver=function(t,n,r){var i=new a(function(n,r){try{var i=t._driver,o=Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){r(o);return}for(var l=k.concat("_initStorage"),c=0,g=l.length;c<g;c++){var d=l[c];if((!includes(x,d)||t[d])&&"function"!=typeof t[d]){r(o);return}}!function(){for(var methodNotImplementedFactory=function(t){return function(){var n=Error("Method "+t+" is not implemented by the current driver"),r=a.reject(n);return executeCallback(r,arguments[arguments.length-1]),r}},n=0,r=x.length;n<r;n++){var i=x[n];t[i]||(t[i]=methodNotImplementedFactory(i))}}();var setDriverSupport=function(r){_[i]&&console.info("Redefining LocalForage driver: "+i),_[i]=t,w[i]=r,n()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(setDriverSupport,r):setDriverSupport(!!t._support):setDriverSupport(!0)}catch(t){r(t)}});return executeTwoCallbacks(i,n,r),i},LocalForage.prototype.driver=function(){return this._driver||null},LocalForage.prototype.getDriver=function(t,n,r){var i=_[t]?a.resolve(_[t]):a.reject(Error("Driver not found."));return executeTwoCallbacks(i,n,r),i},LocalForage.prototype.getSerializer=function(t){var n=a.resolve(Y);return executeTwoCallbacks(n,t),n},LocalForage.prototype.ready=function(t){var n=this,r=n._driverSet.then(function(){return null===n._ready&&(n._ready=n._initDriver()),n._ready});return executeTwoCallbacks(r,t,t),r},LocalForage.prototype.setDriver=function(t,n,r){var i=this;T(t)||(t=[t]);var o=this._getSupportedDrivers(t);function setDriverToConfig(){i._config.driver=i.driver()}function extendSelfWithDriver(t){return i._extend(t),setDriverToConfig(),i._ready=i._initStorage(i._config),i._ready}var l=null!==this._driverSet?this._driverSet.catch(function(){return a.resolve()}):a.resolve();return this._driverSet=l.then(function(){var t=o[0];return i._dbInfo=null,i._ready=null,i.getDriver(t).then(function(t){i._driver=t._driver,setDriverToConfig(),i._wrapLibraryMethodsWithReady(),i._initDriver=function(){var t=0;return function driverPromiseLoop(){for(;t<o.length;){var n=o[t];return t++,i._dbInfo=null,i._ready=null,i.getDriver(n).then(extendSelfWithDriver).catch(driverPromiseLoop)}setDriverToConfig();var r=Error("No available storage method found.");return i._driverSet=a.reject(r),i._driverSet}()}})}).catch(function(){setDriverToConfig();var t=Error("No available storage method found.");return i._driverSet=a.reject(t),i._driverSet}),executeTwoCallbacks(this._driverSet,n,r),this._driverSet},LocalForage.prototype.supports=function(t){return!!w[t]},LocalForage.prototype._extend=function(t){extend(this,t)},LocalForage.prototype._getSupportedDrivers=function(t){for(var n=[],r=0,i=t.length;r<i;r++){var o=t[r];this.supports(o)&&n.push(o)}return n},LocalForage.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,n=k.length;t<n;t++)!function(t,n){t[n]=function(){var r=arguments;return t.ready().then(function(){return t[n].apply(t,r)})}}(this,k[t])},LocalForage.prototype.createInstance=function(t){return new LocalForage(t)},LocalForage}());n.exports=J},{3:3}]},{},[4])(4)},40636:(t,n,r)=>{var i=r(90191).Symbol;t.exports=i},92931:(t,n,r)=>{var i=r(40636),o=r(34995),a=r(3637),l=i?i.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":l&&l in Object(t)?o(t):a(t)}},68220:(t,n,r)=>{var i=r(15599),o=/^\s+/;t.exports=function(t){return t?t.slice(0,i(t)+1).replace(o,""):t}},66356:t=>{var n="object"==typeof global&&global&&global.Object===Object&&global;t.exports=n},34995:(t,n,r)=>{var i=r(40636),o=Object.prototype,a=o.hasOwnProperty,l=o.toString,c=i?i.toStringTag:void 0;t.exports=function(t){var n=a.call(t,c),r=t[c];try{t[c]=void 0;var i=!0}catch(t){}var o=l.call(t);return i&&(n?t[c]=r:delete t[c]),o}},3637:t=>{var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},90191:(t,n,r)=>{var i=r(66356),o="object"==typeof self&&self&&self.Object===Object&&self,a=i||o||Function("return this")();t.exports=a},15599:t=>{var n=/\s/;t.exports=function(t){for(var r=t.length;r--&&n.test(t.charAt(r)););return r}},27487:(t,n,r)=>{var i=r(99224),o=r(86145),a=r(5922),l=Math.max,c=Math.min;t.exports=function(t,n,r){var g,d,u,I,p,m,h=0,C=!1,b=!1,y=!0;if("function"!=typeof t)throw TypeError("Expected a function");function invokeFunc(n){var r=g,i=d;return g=d=void 0,h=n,I=t.apply(i,r)}function shouldInvoke(t){var r=t-m,i=t-h;return void 0===m||r>=n||r<0||b&&i>=u}function timerExpired(){var t,r,i,a=o();if(shouldInvoke(a))return trailingEdge(a);p=setTimeout(timerExpired,(t=a-m,r=a-h,i=n-t,b?c(i,u-r):i))}function trailingEdge(t){return(p=void 0,y&&g)?invokeFunc(t):(g=d=void 0,I)}function debounced(){var t,r=o(),i=shouldInvoke(r);if(g=arguments,d=this,m=r,i){if(void 0===p)return h=t=m,p=setTimeout(timerExpired,n),C?invokeFunc(t):I;if(b)return clearTimeout(p),p=setTimeout(timerExpired,n),invokeFunc(m)}return void 0===p&&(p=setTimeout(timerExpired,n)),I}return n=a(n)||0,i(r)&&(C=!!r.leading,u=(b="maxWait"in r)?l(a(r.maxWait)||0,n):u,y="trailing"in r?!!r.trailing:y),debounced.cancel=function(){void 0!==p&&clearTimeout(p),h=0,g=m=d=p=void 0},debounced.flush=function(){return void 0===p?I:trailingEdge(o())},debounced}},99224:t=>{t.exports=function(t){var n=typeof t;return null!=t&&("object"==n||"function"==n)}},71338:t=>{t.exports=function(t){return null!=t&&"object"==typeof t}},79910:(t,n,r)=>{var i=r(92931),o=r(71338);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==i(t)}},86145:(t,n,r)=>{var i=r(90191);t.exports=function(){return i.Date.now()}},5922:(t,n,r)=>{var i=r(68220),o=r(99224),a=r(79910),l=0/0,c=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,d=/^0o[0-7]+$/i,u=parseInt;t.exports=function(t){if("number"==typeof t)return t;if(a(t))return l;if(o(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=o(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=i(t);var r=g.test(t);return r||d.test(t)?u(t.slice(2),r?2:8):c.test(t)?l:+t}},20502:(t,n,r)=>{t.exports=r(39068)},78756:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Image",{enumerable:!0,get:function(){return C}});let i=r(82147),o=r(4009),a=o._(r(9885)),l=i._(r(88908)),c=i._(r(60150)),g=r(60135),d=r(45709),u=r(87927);r(61976);let I=r(10713),p=i._(r(63517)),m={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0};function handleLoading(t,n,r,i,o,a){let l=null==t?void 0:t.src;if(!t||t["data-loaded-src"]===l)return;t["data-loaded-src"]=l;let c="decode"in t?t.decode():Promise.resolve();c.catch(()=>{}).then(()=>{if(t.parentElement&&t.isConnected){if("empty"!==n&&o(!0),null==r?void 0:r.current){let n=new Event("load");Object.defineProperty(n,"target",{writable:!1,value:t});let i=!1,o=!1;r.current({...n,nativeEvent:n,currentTarget:t,target:t,isDefaultPrevented:()=>i,isPropagationStopped:()=>o,persist:()=>{},preventDefault:()=>{i=!0,n.preventDefault()},stopPropagation:()=>{o=!0,n.stopPropagation()}})}(null==i?void 0:i.current)&&i.current(t)}})}function getDynamicProps(t){let[n,r]=a.version.split("."),i=parseInt(n,10),o=parseInt(r,10);return i>18||18===i&&o>=3?{fetchPriority:t}:{fetchpriority:t}}globalThis.__NEXT_IMAGE_IMPORTED=!0;let h=(0,a.forwardRef)((t,n)=>{let{src:r,srcSet:i,sizes:o,height:l,width:c,decoding:g,className:d,style:u,fetchPriority:I,placeholder:p,loading:m,unoptimized:h,fill:C,onLoadRef:b,onLoadingCompleteRef:y,setBlurComplete:G,setShowAltText:A,onLoad:B,onError:Z,...f}=t;return a.default.createElement("img",{...f,...getDynamicProps(I),loading:m,width:c,height:l,decoding:g,"data-nimg":C?"fill":"1",className:d,style:u,sizes:o,srcSet:i,src:r,ref:(0,a.useCallback)(t=>{n&&("function"==typeof n?n(t):"object"==typeof n&&(n.current=t)),t&&(Z&&(t.src=t.src),t.complete&&handleLoading(t,p,b,y,G,h))},[r,p,b,y,G,Z,h,n]),onLoad:t=>{let n=t.currentTarget;handleLoading(n,p,b,y,G,h)},onError:t=>{A(!0),"empty"!==p&&G(!0),Z&&Z(t)}})});function ImagePreload(t){let{isAppRouter:n,imgAttributes:r}=t,i={as:"image",imageSrcSet:r.srcSet,imageSizes:r.sizes,crossOrigin:r.crossOrigin,referrerPolicy:r.referrerPolicy,...getDynamicProps(r.fetchPriority)};return n&&l.default.preload?(l.default.preload(r.src,i),null):a.default.createElement(c.default,null,a.default.createElement("link",{key:"__nimg-"+r.src+r.srcSet+r.sizes,rel:"preload",href:r.srcSet?void 0:r.src,...i}))}let C=(0,a.forwardRef)((t,n)=>{let r=(0,a.useContext)(I.RouterContext),i=(0,a.useContext)(u.ImageConfigContext),o=(0,a.useMemo)(()=>{let t=m||i||d.imageConfigDefault,n=[...t.deviceSizes,...t.imageSizes].sort((t,n)=>t-n),r=t.deviceSizes.sort((t,n)=>t-n);return{...t,allSizes:n,deviceSizes:r}},[i]),{onLoad:l,onLoadingComplete:c}=t,C=(0,a.useRef)(l);(0,a.useEffect)(()=>{C.current=l},[l]);let b=(0,a.useRef)(c);(0,a.useEffect)(()=>{b.current=c},[c]);let[y,G]=(0,a.useState)(!1),[A,B]=(0,a.useState)(!1),{props:Z,meta:f}=(0,g.getImgProps)(t,{defaultLoader:p.default,imgConf:o,blurComplete:y,showAltText:A});return a.default.createElement(a.default.Fragment,null,a.default.createElement(h,{...Z,unoptimized:f.unoptimized,placeholder:f.placeholder,fill:f.fill,onLoadRef:C,onLoadingCompleteRef:b,setBlurComplete:G,setShowAltText:B,ref:n}),f.priority?a.default.createElement(ImagePreload,{isAppRouter:!r,imgAttributes:Z}):null)});("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),t.exports=n.default)},66545:(t,n)=>{"use strict";function isInAmpMode(t){let{ampFirst:n=!1,hybrid:r=!1,hasQuery:i=!1}=void 0===t?{}:t;return n||r&&i}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"isInAmpMode",{enumerable:!0,get:function(){return isInAmpMode}})},39068:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{MODERN_BROWSERSLIST_TARGET:function(){return o.default},COMPILER_NAMES:function(){return a},INTERNAL_HEADERS:function(){return l},COMPILER_INDEXES:function(){return c},PHASE_EXPORT:function(){return g},PHASE_PRODUCTION_BUILD:function(){return d},PHASE_PRODUCTION_SERVER:function(){return u},PHASE_DEVELOPMENT_SERVER:function(){return I},PHASE_TEST:function(){return p},PHASE_INFO:function(){return m},PAGES_MANIFEST:function(){return h},APP_PATHS_MANIFEST:function(){return C},APP_PATH_ROUTES_MANIFEST:function(){return b},BUILD_MANIFEST:function(){return y},APP_BUILD_MANIFEST:function(){return G},FUNCTIONS_CONFIG_MANIFEST:function(){return A},SUBRESOURCE_INTEGRITY_MANIFEST:function(){return B},NEXT_FONT_MANIFEST:function(){return Z},EXPORT_MARKER:function(){return f},EXPORT_DETAIL:function(){return v},PRERENDER_MANIFEST:function(){return W},ROUTES_MANIFEST:function(){return S},IMAGES_MANIFEST:function(){return R},SERVER_FILES_MANIFEST:function(){return V},DEV_CLIENT_PAGES_MANIFEST:function(){return H},MIDDLEWARE_MANIFEST:function(){return N},DEV_MIDDLEWARE_MANIFEST:function(){return Y},REACT_LOADABLE_MANIFEST:function(){return X},FONT_MANIFEST:function(){return E},SERVER_DIRECTORY:function(){return T},CONFIG_FILES:function(){return _},BUILD_ID_FILE:function(){return w},BLOCKED_PAGES:function(){return F},CLIENT_PUBLIC_FILES_PATH:function(){return K},CLIENT_STATIC_FILES_PATH:function(){return x},STRING_LITERAL_DROP_BUNDLE:function(){return k},NEXT_BUILTIN_DOCUMENT:function(){return U},BARREL_OPTIMIZATION_PREFIX:function(){return J},CLIENT_REFERENCE_MANIFEST:function(){return L},SERVER_REFERENCE_MANIFEST:function(){return z},MIDDLEWARE_BUILD_MANIFEST:function(){return P},MIDDLEWARE_REACT_LOADABLE_MANIFEST:function(){return M},CLIENT_STATIC_FILES_RUNTIME_MAIN:function(){return O},CLIENT_STATIC_FILES_RUNTIME_MAIN_APP:function(){return j},APP_CLIENT_INTERNALS:function(){return D},CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH:function(){return Q},CLIENT_STATIC_FILES_RUNTIME_AMP:function(){return q},CLIENT_STATIC_FILES_RUNTIME_WEBPACK:function(){return $},CLIENT_STATIC_FILES_RUNTIME_POLYFILLS:function(){return ee},CLIENT_STATIC_FILES_RUNTIME_POLYFILLS_SYMBOL:function(){return et},EDGE_RUNTIME_WEBPACK:function(){return en},TEMPORARY_REDIRECT_STATUS:function(){return er},PERMANENT_REDIRECT_STATUS:function(){return ei},STATIC_PROPS_ID:function(){return eo},SERVER_PROPS_ID:function(){return ea},PAGE_SEGMENT_KEY:function(){return es},GOOGLE_FONT_PROVIDER:function(){return el},OPTIMIZED_FONT_PROVIDERS:function(){return ec},DEFAULT_SERIF_FONT:function(){return eg},DEFAULT_SANS_SERIF_FONT:function(){return ed},STATIC_STATUS_PAGES:function(){return eu},TRACE_OUTPUT_VERSION:function(){return eI},TURBO_TRACE_DEFAULT_MEMORY_LIMIT:function(){return ep},RSC_MODULE_TYPES:function(){return em},EDGE_UNSUPPORTED_NODE_APIS:function(){return eh},SYSTEM_ENTRYPOINTS:function(){return eC}});let i=r(82147),o=i._(r(62070)),a={client:"client",server:"server",edgeServer:"edge-server"},l=["x-invoke-path","x-invoke-status","x-invoke-error","x-invoke-query","x-middleware-invoke"],c={[a.client]:0,[a.server]:1,[a.edgeServer]:2},g="phase-export",d="phase-production-build",u="phase-production-server",I="phase-development-server",p="phase-test",m="phase-info",h="pages-manifest.json",C="app-paths-manifest.json",b="app-path-routes-manifest.json",y="build-manifest.json",G="app-build-manifest.json",A="functions-config-manifest.json",B="subresource-integrity-manifest",Z="next-font-manifest",f="export-marker.json",v="export-detail.json",W="prerender-manifest.json",S="routes-manifest.json",R="images-manifest.json",V="required-server-files.json",H="_devPagesManifest.json",N="middleware-manifest.json",Y="_devMiddlewareManifest.json",X="react-loadable-manifest.json",E="font-manifest.json",T="server",_=["next.config.js","next.config.mjs"],w="BUILD_ID",F=["/_document","/_app","/_error"],K="public",x="static",k="__NEXT_DROP_CLIENT_FILE__",U="__NEXT_BUILTIN_DOCUMENT__",J="__barrel_optimize__",L="client-reference-manifest",z="server-reference-manifest",P="middleware-build-manifest",M="middleware-react-loadable-manifest",O="main",j=""+O+"-app",D="app-pages-internals",Q="react-refresh",q="amp",$="webpack",ee="polyfills",et=Symbol(ee),en="edge-runtime-webpack",er=307,ei=308,eo="__N_SSG",ea="__N_SSP",es="__PAGE__",el="https://fonts.googleapis.com/",ec=[{url:el,preconnect:"https://fonts.gstatic.com"},{url:"https://use.typekit.net",preconnect:"https://use.typekit.net"}],eg={name:"Times New Roman",xAvgCharWidth:821,azAvgWidth:854.3953488372093,unitsPerEm:2048},ed={name:"Arial",xAvgCharWidth:904,azAvgWidth:934.5116279069767,unitsPerEm:2048},eu=["/500"],eI=1,ep=6e3,em={client:"client",server:"server"},eh=["clearImmediate","setImmediate","BroadcastChannel","ByteLengthQueuingStrategy","CompressionStream","CountQueuingStrategy","DecompressionStream","DomException","MessageChannel","MessageEvent","MessagePort","ReadableByteStreamController","ReadableStreamBYOBRequest","ReadableStreamDefaultController","TransformStreamDefaultController","WritableStreamDefaultController"],eC=new Set([O,Q,q,j]);("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),t.exports=n.default)},60135:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getImgProps",{enumerable:!0,get:function(){return getImgProps}}),r(61976);let i=r(35418),o=r(45709);function isStaticRequire(t){return void 0!==t.default}function getInt(t){return void 0===t?t:"number"==typeof t?Number.isFinite(t)?t:NaN:"string"==typeof t&&/^[0-9]+$/.test(t)?parseInt(t,10):NaN}function getImgProps(t,n){var r;let a,l,c,{src:g,sizes:d,unoptimized:u=!1,priority:I=!1,loading:p,className:m,quality:h,width:C,height:b,fill:y=!1,style:G,onLoad:A,onLoadingComplete:B,placeholder:Z="empty",blurDataURL:f,fetchPriority:v,layout:W,objectFit:S,objectPosition:R,lazyBoundary:V,lazyRoot:H,...N}=t,{imgConf:Y,showAltText:X,blurComplete:E,defaultLoader:T}=n,_=Y||o.imageConfigDefault;if("allSizes"in _)a=_;else{let t=[..._.deviceSizes,..._.imageSizes].sort((t,n)=>t-n),n=_.deviceSizes.sort((t,n)=>t-n);a={..._,allSizes:t,deviceSizes:n}}let w=N.loader||T;delete N.loader,delete N.srcSet;let F="__next_img_default"in w;if(F){if("custom"===a.loader)throw Error('Image with src "'+g+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let t=w;w=n=>{let{config:r,...i}=n;return t(i)}}if(W){"fill"===W&&(y=!0);let t={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[W];t&&(G={...G,...t});let n={responsive:"100vw",fill:"100vw"}[W];n&&!d&&(d=n)}let K="",x=getInt(C),k=getInt(b);if("object"==typeof(r=g)&&(isStaticRequire(r)||void 0!==r.src)){let t=isStaticRequire(g)?g.default:g;if(!t.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(t));if(!t.height||!t.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(t));if(l=t.blurWidth,c=t.blurHeight,f=f||t.blurDataURL,K=t.src,!y){if(x||k){if(x&&!k){let n=x/t.width;k=Math.round(t.height*n)}else if(!x&&k){let n=k/t.height;x=Math.round(t.width*n)}}else x=t.width,k=t.height}}let U=!I&&("lazy"===p||void 0===p);(!(g="string"==typeof g?g:K)||g.startsWith("data:")||g.startsWith("blob:"))&&(u=!0,U=!1),a.unoptimized&&(u=!0),F&&g.endsWith(".svg")&&!a.dangerouslyAllowSVG&&(u=!0),I&&(v="high");let J=getInt(h),L=Object.assign(y?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:S,objectPosition:R}:{},X?{}:{color:"transparent"},G),z=E||"empty"===Z?null:"blur"===Z?'url("data:image/svg+xml;charset=utf-8,'+(0,i.getImageBlurSvg)({widthInt:x,heightInt:k,blurWidth:l,blurHeight:c,blurDataURL:f||"",objectFit:L.objectFit})+'")':'url("'+Z+'")',P=z?{backgroundSize:L.objectFit||"cover",backgroundPosition:L.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:z}:{},M=function(t){let{config:n,src:r,unoptimized:i,width:o,quality:a,sizes:l,loader:c}=t;if(i)return{src:r,srcSet:void 0,sizes:void 0};let{widths:g,kind:d}=function(t,n,r){let{deviceSizes:i,allSizes:o}=t;if(r){let t=/(^|\s)(1?\d?\d)vw/g,n=[];for(let i;i=t.exec(r);i)n.push(parseInt(i[2]));if(n.length){let t=.01*Math.min(...n);return{widths:o.filter(n=>n>=i[0]*t),kind:"w"}}return{widths:o,kind:"w"}}if("number"!=typeof n)return{widths:i,kind:"w"};let a=[...new Set([n,2*n].map(t=>o.find(n=>n>=t)||o[o.length-1]))];return{widths:a,kind:"x"}}(n,o,l),u=g.length-1;return{sizes:l||"w"!==d?l:"100vw",srcSet:g.map((t,i)=>c({config:n,src:r,quality:a,width:t})+" "+("w"===d?t:i+1)+d).join(", "),src:c({config:n,src:r,quality:a,width:g[u]})}}({config:a,src:g,unoptimized:u,width:x,quality:J,sizes:d,loader:w}),O={...N,loading:U?"lazy":p,fetchPriority:v,width:x,height:k,decoding:"async",className:m,style:{...L,...P},sizes:M.sizes,srcSet:M.srcSet,src:M.src},j={unoptimized:u,priority:I,placeholder:Z,fill:y};return{props:O,meta:j}}},60150:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{defaultHead:function(){return defaultHead},default:function(){return _default}});let i=r(82147),o=r(4009),a=o._(r(9885)),l=i._(r(77975)),c=r(12999),g=r(75851),d=r(66545);function defaultHead(t){void 0===t&&(t=!1);let n=[a.default.createElement("meta",{charSet:"utf-8"})];return t||n.push(a.default.createElement("meta",{name:"viewport",content:"width=device-width"})),n}function onlyReactElement(t,n){return"string"==typeof n||"number"==typeof n?t:n.type===a.default.Fragment?t.concat(a.default.Children.toArray(n.props.children).reduce((t,n)=>"string"==typeof n||"number"==typeof n?t:t.concat(n),[])):t.concat(n)}r(61976);let u=["name","httpEquiv","charSet","itemProp"];function reduceComponents(t,n){let{inAmpMode:r}=n;return t.reduce(onlyReactElement,[]).reverse().concat(defaultHead(r).reverse()).filter(function(){let t=new Set,n=new Set,r=new Set,i={};return o=>{let a=!0,l=!1;if(o.key&&"number"!=typeof o.key&&o.key.indexOf("$")>0){l=!0;let n=o.key.slice(o.key.indexOf("$")+1);t.has(n)?a=!1:t.add(n)}switch(o.type){case"title":case"base":n.has(o.type)?a=!1:n.add(o.type);break;case"meta":for(let t=0,n=u.length;t<n;t++){let n=u[t];if(o.props.hasOwnProperty(n)){if("charSet"===n)r.has(n)?a=!1:r.add(n);else{let t=o.props[n],r=i[n]||new Set;("name"!==n||!l)&&r.has(t)?a=!1:(r.add(t),i[n]=r)}}}}return a}}()).reverse().map((t,n)=>{let i=t.key||n;if(!r&&"link"===t.type&&t.props.href&&["https://fonts.googleapis.com/css","https://use.typekit.net/"].some(n=>t.props.href.startsWith(n))){let n={...t.props||{}};return n["data-href"]=n.href,n.href=void 0,n["data-optimized-fonts"]=!0,a.default.cloneElement(t,n)}return a.default.cloneElement(t,{key:i})})}let _default=function(t){let{children:n}=t,r=(0,a.useContext)(c.AmpStateContext),i=(0,a.useContext)(g.HeadManagerContext);return a.default.createElement(l.default,{reduceComponentsToState:reduceComponents,headManager:i,inAmpMode:(0,d.isInAmpMode)(r)},n)};("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),t.exports=n.default)},35418:(t,n)=>{"use strict";function getImageBlurSvg(t){let{widthInt:n,heightInt:r,blurWidth:i,blurHeight:o,blurDataURL:a,objectFit:l}=t,c=i?40*i:n,g=o?40*o:r,d=c&&g?"viewBox='0 0 "+c+" "+g+"'":"";return"%3Csvg xmlns='http://www.w3.org/2000/svg' "+d+"%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3CfeColorMatrix values='1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 100 -1' result='s'/%3E%3CfeFlood x='0' y='0' width='100%25' height='100%25'/%3E%3CfeComposite operator='out' in='s'/%3E%3CfeComposite in2='SourceGraphic'/%3E%3CfeGaussianBlur stdDeviation='20'/%3E%3C/filter%3E%3Cimage width='100%25' height='100%25' x='0' y='0' preserveAspectRatio='"+(d?"none":"contain"===l?"xMidYMid":"cover"===l?"xMidYMid slice":"none")+"' style='filter: url(%23b);' href='"+a+"'/%3E%3C/svg%3E"}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getImageBlurSvg",{enumerable:!0,get:function(){return getImageBlurSvg}})},45709:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{VALID_LOADERS:function(){return r},imageConfigDefault:function(){return i}});let r=["default","imgix","cloudinary","akamai","custom"],i={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",loaderFile:"",domains:[],disableStaticImages:!1,minimumCacheTTL:60,formats:["image/webp"],dangerouslyAllowSVG:!1,contentSecurityPolicy:"script-src 'none'; frame-src 'none'; sandbox;",contentDispositionType:"inline",remotePatterns:[],unoptimized:!1}},21538:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{unstable_getImgProps:function(){return unstable_getImgProps},default:function(){return g}});let i=r(82147),o=r(60135),a=r(61976),l=r(78756),c=i._(r(63517)),unstable_getImgProps=t=>{(0,a.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:n}=(0,o.getImgProps)(t,{defaultLoader:c.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!0}});for(let[t,r]of Object.entries(n))void 0===r&&delete n[t];return{props:n}},g=l.Image},63517:(t,n)=>{"use strict";function defaultLoader(t){let{config:n,src:r,width:i,quality:o}=t;return n.path+"?url="+encodeURIComponent(r)+"&w="+i+"&q="+(o||75)}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return r}}),defaultLoader.__next_img_default=!0;let r=defaultLoader},62070:t=>{"use strict";t.exports=["chrome 64","edge 79","firefox 67","opera 51","safari 12"]},77975:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"default",{enumerable:!0,get:function(){return SideEffect}});let i=r(9885),useClientOnlyLayoutEffect=()=>{},useClientOnlyEffect=()=>{};function SideEffect(t){var n;let{headManager:r,reduceComponentsToState:o}=t;function emitChange(){if(r&&r.mountedInstances){let n=i.Children.toArray(Array.from(r.mountedInstances).filter(Boolean));r.updateHead(o(n,t))}}return null==r||null==(n=r.mountedInstances)||n.add(t.children),emitChange(),useClientOnlyLayoutEffect(()=>{var n;return null==r||null==(n=r.mountedInstances)||n.add(t.children),()=>{var n;null==r||null==(n=r.mountedInstances)||n.delete(t.children)}}),useClientOnlyLayoutEffect(()=>(r&&(r._pendingUpdate=emitChange),()=>{r&&(r._pendingUpdate=emitChange)})),useClientOnlyEffect(()=>(r&&r._pendingUpdate&&(r._pendingUpdate(),r._pendingUpdate=null),()=>{r&&r._pendingUpdate&&(r._pendingUpdate(),r._pendingUpdate=null)})),null}},61976:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"warnOnce",{enumerable:!0,get:function(){return warnOnce}});let warnOnce=t=>{}},12664:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{RSC:function(){return r},ACTION:function(){return i},NEXT_ROUTER_STATE_TREE:function(){return o},NEXT_ROUTER_PREFETCH:function(){return a},NEXT_URL:function(){return l},RSC_CONTENT_TYPE_HEADER:function(){return c},RSC_VARY_HEADER:function(){return g},FLIGHT_PARAMETERS:function(){return d},NEXT_RSC_UNION_QUERY:function(){return u}});let r="RSC",i="Next-Action",o="Next-Router-State-Tree",a="Next-Router-Prefetch",l="Next-Url",c="text/x-component",g=r+", "+o+", "+a+", "+l,d=[[r],[o],[a]],u="_rsc";("function"==typeof n.default||"object"==typeof n.default&&null!==n.default)&&void 0===n.default.__esModule&&(Object.defineProperty(n.default,"__esModule",{value:!0}),Object.assign(n.default,n),t.exports=n.default)},62693:t=>{"use strict";(()=>{"undefined"!=typeof __nccwpck_require__&&(__nccwpck_require__.ab=__dirname+"/");var n={};(()=>{/*!
 * cookie
 * Copyright(c) 2012-2014 Roman Shtylman
 * Copyright(c) 2015 Douglas Christopher Wilson
 * MIT Licensed
 */n.parse=function(n,r){if("string"!=typeof n)throw TypeError("argument str must be a string");for(var o={},a=n.split(i),l=(r||{}).decode||t,c=0;c<a.length;c++){var g=a[c],d=g.indexOf("=");if(!(d<0)){var u=g.substr(0,d).trim(),I=g.substr(++d,g.length).trim();'"'==I[0]&&(I=I.slice(1,-1)),void 0==o[u]&&(o[u]=function(t,n){try{return n(t)}catch(n){return t}}(I,l))}}return o},n.serialize=function(t,n,i){var a=i||{},l=a.encode||r;if("function"!=typeof l)throw TypeError("option encode is invalid");if(!o.test(t))throw TypeError("argument name is invalid");var c=l(n);if(c&&!o.test(c))throw TypeError("argument val is invalid");var g=t+"="+c;if(null!=a.maxAge){var d=a.maxAge-0;if(isNaN(d)||!isFinite(d))throw TypeError("option maxAge is invalid");g+="; Max-Age="+Math.floor(d)}if(a.domain){if(!o.test(a.domain))throw TypeError("option domain is invalid");g+="; Domain="+a.domain}if(a.path){if(!o.test(a.path))throw TypeError("option path is invalid");g+="; Path="+a.path}if(a.expires){if("function"!=typeof a.expires.toUTCString)throw TypeError("option expires is invalid");g+="; Expires="+a.expires.toUTCString()}if(a.httpOnly&&(g+="; HttpOnly"),a.secure&&(g+="; Secure"),a.sameSite)switch("string"==typeof a.sameSite?a.sameSite.toLowerCase():a.sameSite){case!0:case"strict":g+="; SameSite=Strict";break;case"lax":g+="; SameSite=Lax";break;case"none":g+="; SameSite=None";break;default:throw TypeError("option sameSite is invalid")}return g};var t=decodeURIComponent,r=encodeURIComponent,i=/; */,o=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/})(),t.exports=n})()},9985:(t,n)=>{"use strict";function parse(t,n){void 0===n&&(n={});for(var r=function(t){for(var n=[],r=0;r<t.length;){var i=t[r];if("*"===i||"+"===i||"?"===i){n.push({type:"MODIFIER",index:r,value:t[r++]});continue}if("\\"===i){n.push({type:"ESCAPED_CHAR",index:r++,value:t[r++]});continue}if("{"===i){n.push({type:"OPEN",index:r,value:t[r++]});continue}if("}"===i){n.push({type:"CLOSE",index:r,value:t[r++]});continue}if(":"===i){for(var o="",a=r+1;a<t.length;){var l=t.charCodeAt(a);if(l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||95===l){o+=t[a++];continue}break}if(!o)throw TypeError("Missing parameter name at "+r);n.push({type:"NAME",index:r,value:o}),r=a;continue}if("("===i){var c=1,g="",a=r+1;if("?"===t[a])throw TypeError('Pattern cannot start with "?" at '+a);for(;a<t.length;){if("\\"===t[a]){g+=t[a++]+t[a++];continue}if(")"===t[a]){if(0==--c){a++;break}}else if("("===t[a]&&(c++,"?"!==t[a+1]))throw TypeError("Capturing groups are not allowed at "+a);g+=t[a++]}if(c)throw TypeError("Unbalanced pattern at "+r);if(!g)throw TypeError("Missing pattern at "+r);n.push({type:"PATTERN",index:r,value:g}),r=a;continue}n.push({type:"CHAR",index:r,value:t[r++]})}return n.push({type:"END",index:r,value:""}),n}(t),i=n.prefixes,o=void 0===i?"./":i,a="[^"+escapeString(n.delimiter||"/#?")+"]+?",l=[],c=0,g=0,d="",tryConsume=function(t){if(g<r.length&&r[g].type===t)return r[g++].value},mustConsume=function(t){var n=tryConsume(t);if(void 0!==n)return n;var i=r[g];throw TypeError("Unexpected "+i.type+" at "+i.index+", expected "+t)},consumeText=function(){for(var t,n="";t=tryConsume("CHAR")||tryConsume("ESCAPED_CHAR");)n+=t;return n};g<r.length;){var u=tryConsume("CHAR"),I=tryConsume("NAME"),p=tryConsume("PATTERN");if(I||p){var m=u||"";-1===o.indexOf(m)&&(d+=m,m=""),d&&(l.push(d),d=""),l.push({name:I||c++,prefix:m,suffix:"",pattern:p||a,modifier:tryConsume("MODIFIER")||""});continue}var h=u||tryConsume("ESCAPED_CHAR");if(h){d+=h;continue}if(d&&(l.push(d),d=""),tryConsume("OPEN")){var m=consumeText(),C=tryConsume("NAME")||"",b=tryConsume("PATTERN")||"",y=consumeText();mustConsume("CLOSE"),l.push({name:C||(b?c++:""),pattern:C&&!b?a:b,prefix:m,suffix:y,modifier:tryConsume("MODIFIER")||""});continue}mustConsume("END")}return l}function tokensToFunction(t,n){void 0===n&&(n={});var r=flags(n),i=n.encode,o=void 0===i?function(t){return t}:i,a=n.validate,l=void 0===a||a,c=t.map(function(t){if("object"==typeof t)return RegExp("^(?:"+t.pattern+")$",r)});return function(n){for(var r="",i=0;i<t.length;i++){var a=t[i];if("string"==typeof a){r+=a;continue}var g=n?n[a.name]:void 0,d="?"===a.modifier||"*"===a.modifier,u="*"===a.modifier||"+"===a.modifier;if(Array.isArray(g)){if(!u)throw TypeError('Expected "'+a.name+'" to not repeat, but got an array');if(0===g.length){if(d)continue;throw TypeError('Expected "'+a.name+'" to not be empty')}for(var I=0;I<g.length;I++){var p=o(g[I],a);if(l&&!c[i].test(p))throw TypeError('Expected all "'+a.name+'" to match "'+a.pattern+'", but got "'+p+'"');r+=a.prefix+p+a.suffix}continue}if("string"==typeof g||"number"==typeof g){var p=o(String(g),a);if(l&&!c[i].test(p))throw TypeError('Expected "'+a.name+'" to match "'+a.pattern+'", but got "'+p+'"');r+=a.prefix+p+a.suffix;continue}if(!d){var m=u?"an array":"a string";throw TypeError('Expected "'+a.name+'" to be '+m)}}return r}}function regexpToFunction(t,n,r){void 0===r&&(r={});var i=r.decode,o=void 0===i?function(t){return t}:i;return function(r){var i=t.exec(r);if(!i)return!1;for(var a=i[0],l=i.index,c=Object.create(null),g=1;g<i.length;g++)!function(t){if(void 0!==i[t]){var r=n[t-1];"*"===r.modifier||"+"===r.modifier?c[r.name]=i[t].split(r.prefix+r.suffix).map(function(t){return o(t,r)}):c[r.name]=o(i[t],r)}}(g);return{path:a,index:l,params:c}}}function escapeString(t){return t.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1")}function flags(t){return t&&t.sensitive?"":"i"}function tokensToRegexp(t,n,r){void 0===r&&(r={});for(var i=r.strict,o=void 0!==i&&i,a=r.start,l=r.end,c=r.encode,g=void 0===c?function(t){return t}:c,d="["+escapeString(r.endsWith||"")+"]|$",u="["+escapeString(r.delimiter||"/#?")+"]",I=void 0===a||a?"^":"",p=0;p<t.length;p++){var m=t[p];if("string"==typeof m)I+=escapeString(g(m));else{var h=escapeString(g(m.prefix)),C=escapeString(g(m.suffix));if(m.pattern){if(n&&n.push(m),h||C){if("+"===m.modifier||"*"===m.modifier){var b="*"===m.modifier?"?":"";I+="(?:"+h+"((?:"+m.pattern+")(?:"+C+h+"(?:"+m.pattern+"))*)"+C+")"+b}else I+="(?:"+h+"("+m.pattern+")"+C+")"+m.modifier}else I+="("+m.pattern+")"+m.modifier}else I+="(?:"+h+C+")"+m.modifier}}if(void 0===l||l)o||(I+=u+"?"),I+=r.endsWith?"(?="+d+")":"$";else{var y=t[t.length-1],G="string"==typeof y?u.indexOf(y[y.length-1])>-1:void 0===y;o||(I+="(?:"+u+"(?="+d+"))?"),G||(I+="(?="+u+"|"+d+")")}return new RegExp(I,flags(r))}function pathToRegexp(t,n,r){return t instanceof RegExp?function(t,n){if(!n)return t;var r=t.source.match(/\((?!\?)/g);if(r)for(var i=0;i<r.length;i++)n.push({name:i,prefix:"",suffix:"",modifier:"",pattern:""});return t}(t,n):Array.isArray(t)?RegExp("(?:"+t.map(function(t){return pathToRegexp(t,n,r).source}).join("|")+")",flags(r)):tokensToRegexp(parse(t,r),n,r)}Object.defineProperty(n,"__esModule",{value:!0}),n.parse=parse,n.compile=function(t,n){return tokensToFunction(parse(t,n),n)},n.tokensToFunction=tokensToFunction,n.match=function(t,n){var r=[];return regexpToFunction(pathToRegexp(t,r,n),r,n)},n.regexpToFunction=regexpToFunction,n.tokensToRegexp=tokensToRegexp,n.pathToRegexp=pathToRegexp},57800:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{NEXT_QUERY_PARAM_PREFIX:function(){return r},PRERENDER_REVALIDATE_HEADER:function(){return i},PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER:function(){return o},NEXT_CACHE_TAGS_HEADER:function(){return a},NEXT_CACHE_SOFT_TAGS_HEADER:function(){return l},NEXT_CACHE_REVALIDATED_TAGS_HEADER:function(){return c},NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER:function(){return g},NEXT_CACHE_TAG_MAX_LENGTH:function(){return d},NEXT_CACHE_SOFT_TAG_MAX_LENGTH:function(){return u},NEXT_CACHE_IMPLICIT_TAG_ID:function(){return I},CACHE_ONE_YEAR:function(){return p},MIDDLEWARE_FILENAME:function(){return m},MIDDLEWARE_LOCATION_REGEXP:function(){return h},INSTRUMENTATION_HOOK_FILENAME:function(){return C},PAGES_DIR_ALIAS:function(){return b},DOT_NEXT_ALIAS:function(){return y},ROOT_DIR_ALIAS:function(){return G},APP_DIR_ALIAS:function(){return A},RSC_MOD_REF_PROXY_ALIAS:function(){return B},RSC_ACTION_VALIDATE_ALIAS:function(){return Z},RSC_ACTION_PROXY_ALIAS:function(){return f},RSC_ACTION_CLIENT_WRAPPER_ALIAS:function(){return v},PUBLIC_DIR_MIDDLEWARE_CONFLICT:function(){return W},SSG_GET_INITIAL_PROPS_CONFLICT:function(){return S},SERVER_PROPS_GET_INIT_PROPS_CONFLICT:function(){return R},SERVER_PROPS_SSG_CONFLICT:function(){return V},STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR:function(){return H},SERVER_PROPS_EXPORT_ERROR:function(){return N},GSP_NO_RETURNED_VALUE:function(){return Y},GSSP_NO_RETURNED_VALUE:function(){return X},UNSTABLE_REVALIDATE_RENAME_ERROR:function(){return E},GSSP_COMPONENT_MEMBER_ERROR:function(){return T},NON_STANDARD_NODE_ENV:function(){return _},SSG_FALLBACK_EXPORT_ERROR:function(){return w},ESLINT_DEFAULT_DIRS:function(){return F},ESLINT_PROMPT_VALUES:function(){return K},SERVER_RUNTIME:function(){return x},WEBPACK_LAYERS:function(){return U},WEBPACK_RESOURCE_QUERIES:function(){return J}});let r="nxtP",i="x-prerender-revalidate",o="x-prerender-revalidate-if-generated",a="x-next-cache-tags",l="x-next-cache-soft-tags",c="x-next-revalidated-tags",g="x-next-revalidate-tag-token",d=256,u=1024,I="_N_T_",p=31536e3,m="middleware",h=`(?:src/)?${m}`,C="instrumentation",b="private-next-pages",y="private-dot-next",G="private-next-root-dir",A="private-next-app-dir",B="next/dist/build/webpack/loaders/next-flight-loader/module-proxy",Z="private-next-rsc-action-validate",f="private-next-rsc-action-proxy",v="private-next-rsc-action-client-wrapper",W="You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict",S="You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps",R="You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.",V="You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps",H="can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props",N="pages with `getServerSideProps` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export",Y="Your `getStaticProps` function did not return an object. Did you forget to add a `return`?",X="Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?",E="The `unstable_revalidate` property is available for general use.\nPlease use `revalidate` instead.",T="can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member",_='You are using a non-standard "NODE_ENV" value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env',w="Pages with `fallback` enabled in `getStaticPaths` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export",F=["app","pages","components","lib","src"],K=[{title:"Strict",recommended:!0,config:{extends:"next/core-web-vitals"}},{title:"Base",config:{extends:"next"}},{title:"Cancel",config:null}],x={edge:"edge",experimentalEdge:"experimental-edge",nodejs:"nodejs"},k={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",api:"api",middleware:"middleware",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",appMetadataRoute:"app-metadata-route",appRouteHandler:"app-route-handler"},U={...k,GROUP:{server:[k.reactServerComponents,k.actionBrowser,k.appMetadataRoute,k.appRouteHandler],nonClientServerTarget:[k.middleware,k.api],app:[k.reactServerComponents,k.actionBrowser,k.appMetadataRoute,k.appRouteHandler,k.serverSideRendering,k.appPagesBrowser]}},J={edgeSSREntry:"__next_edge_ssr_entry__",metadata:"__next_metadata__",metadataRoute:"__next_metadata_route__",metadataImageMeta:"__next_metadata_image_meta__"}},59556:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{fillMetadataSegment:function(){return fillMetadataSegment},normalizeMetadataRoute:function(){return normalizeMetadataRoute}});let i=r(40525),o=function(t){return t&&t.__esModule?t:{default:t}}(r(48074)),a=r(64899),l=r(17927),c=r(23041),g=r(93901),d=r(32688);function getMetadataRouteSuffix(t){let n="";return(t.includes("(")&&t.includes(")")||t.includes("@"))&&(n=(0,c.djb2Hash)(t).toString(36).slice(0,6)),n}function fillMetadataSegment(t,n,r){let i=(0,g.normalizeAppPath)(t),c=(0,l.getNamedRouteRegex)(i,!1),u=(0,a.interpolateDynamicPath)(i,n,c),I=getMetadataRouteSuffix(t),p=I?`-${I}`:"",{name:m,ext:h}=o.default.parse(r);return(0,d.normalizePathSep)(o.default.join(u,`${m}${p}${h}`))}function normalizeMetadataRoute(t){if(!(0,i.isMetadataRoute)(t))return t;let n=t,r="";if("/robots"===t)n+=".txt";else if("/manifest"===t)n+=".webmanifest";else if(t.endsWith("/sitemap"))n+=".xml";else{let n=t.slice(0,-(o.default.basename(t).length+1));r=getMetadataRouteSuffix(n)}if(!n.endsWith("/route")){let{dir:a,name:l,ext:c}=o.default.parse(n),g=(0,i.isStaticMetadataRoute)(t);n=o.default.posix.join(a,`${l}${r?`-${r}`:""}${c}`,g?"":"[[...__metadata_id__]]","route")}return n}},40525:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{STATIC_METADATA_IMAGES:function(){return o},isMetadataRouteFile:function(){return isMetadataRouteFile},isStaticMetadataRouteFile:function(){return isStaticMetadataRouteFile},isStaticMetadataRoute:function(){return isStaticMetadataRoute},isMetadataRoute:function(){return isMetadataRoute}});let i=r(32688),o={icon:{filename:"icon",extensions:["ico","jpg","jpeg","png","svg"]},apple:{filename:"apple-icon",extensions:["jpg","jpeg","png"]},favicon:{filename:"favicon",extensions:["ico"]},openGraph:{filename:"opengraph-image",extensions:["jpg","jpeg","png","gif"]},twitter:{filename:"twitter-image",extensions:["jpg","jpeg","png","gif"]}},a=["js","jsx","ts","tsx"],getExtensionRegexString=t=>`(?:${t.join("|")})`;function isMetadataRouteFile(t,n,r){let a=[RegExp(`^[\\\\/]robots${r?`\\.${getExtensionRegexString(n.concat("txt"))}$`:""}`),RegExp(`^[\\\\/]manifest${r?`\\.${getExtensionRegexString(n.concat("webmanifest","json"))}$`:""}`),RegExp("^[\\\\/]favicon\\.ico$"),RegExp(`[\\\\/]sitemap${r?`\\.${getExtensionRegexString(n.concat("xml"))}$`:""}`),RegExp(`[\\\\/]${o.icon.filename}\\d?${r?`\\.${getExtensionRegexString(n.concat(o.icon.extensions))}$`:""}`),RegExp(`[\\\\/]${o.apple.filename}\\d?${r?`\\.${getExtensionRegexString(n.concat(o.apple.extensions))}$`:""}`),RegExp(`[\\\\/]${o.openGraph.filename}\\d?${r?`\\.${getExtensionRegexString(n.concat(o.openGraph.extensions))}$`:""}`),RegExp(`[\\\\/]${o.twitter.filename}\\d?${r?`\\.${getExtensionRegexString(n.concat(o.twitter.extensions))}$`:""}`)],l=(0,i.normalizePathSep)(t);return a.some(t=>t.test(l))}function isStaticMetadataRouteFile(t){return isMetadataRouteFile(t,[],!0)}function isStaticMetadataRoute(t){return"/robots"===t||"/manifest"===t||isStaticMetadataRouteFile(t)}function isMetadataRoute(t){let n=t.replace(/^\/?app\//,"").replace(/\/route$/,"");return"/"!==n[0]&&(n="/"+n),!n.endsWith("/page")&&isMetadataRouteFile(n,a,!1)}},55191:(t,n,r)=>{"use strict";function getCookieParser(t){return function(){let{cookie:n}=t;if(!n)return{};let{parse:i}=r(62693);return i(Array.isArray(n)?n.join("; "):n)}}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getCookieParser",{enumerable:!0,get:function(){return getCookieParser}})},4053:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{INTERCEPTION_ROUTE_MARKERS:function(){return o},isInterceptionRouteAppPath:function(){return isInterceptionRouteAppPath},extractInterceptionRouteInformation:function(){return extractInterceptionRouteInformation}});let i=r(93901),o=["(..)(..)","(.)","(..)","(...)"];function isInterceptionRouteAppPath(t){return void 0!==t.split("/").find(t=>o.find(n=>t.startsWith(n)))}function extractInterceptionRouteInformation(t){let n,r,a;for(let i of t.split("/"))if(r=o.find(t=>i.startsWith(t))){[n,a]=t.split(r,2);break}if(!n||!r||!a)throw Error(`Invalid interception route: ${t}. Must be in the format /<intercepting route>/(..|...|..)(..)/<intercepted route>`);switch(n=(0,i.normalizeAppPath)(n),r){case"(.)":a="/"===n?`/${a}`:n+"/"+a;break;case"(..)":if("/"===n)throw Error(`Invalid interception route: ${t}. Cannot use (..) marker at the root level, use (.) instead.`);a=n.split("/").slice(0,-1).concat(a).join("/");break;case"(...)":a="/"+a;break;case"(..)(..)":let l=n.split("/");if(l.length<=2)throw Error(`Invalid interception route: ${t}. Cannot use (..)(..) marker at the root level or one level up.`);a=l.slice(0,-2).concat(a).join("/");break;default:throw Error("Invariant: unexpected marker")}return{interceptingRoute:n,interceptedRoute:a}}},64899:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{normalizeVercelUrl:function(){return normalizeVercelUrl},interpolateDynamicPath:function(){return interpolateDynamicPath},getUtils:function(){return getUtils}});let i=r(57310),o=r(36737),a=r(75556),l=r(17927),c=r(83859),g=r(22594),d=r(52810),u=r(93901),I=r(57800);function normalizeVercelUrl(t,n,r,o,a){if(o&&n&&a){let n=(0,i.parse)(t.url,!0);for(let t of(delete n.search,Object.keys(n.query)))(t!==I.NEXT_QUERY_PARAM_PREFIX&&t.startsWith(I.NEXT_QUERY_PARAM_PREFIX)||(r||Object.keys(a.groups)).includes(t))&&delete n.query[t];t.url=(0,i.format)(n)}}function interpolateDynamicPath(t,n,r){if(!r)return t;for(let i of Object.keys(r.groups)){let{optional:o,repeat:a}=r.groups[i],l=`[${a?"...":""}${i}]`;o&&(l=`[${l}]`);let c=t.indexOf(l);if(c>-1){let r;let o=n[i];r=Array.isArray(o)?o.map(t=>t&&encodeURIComponent(t)).join("/"):o?encodeURIComponent(o):"",t=t.slice(0,c)+r+t.slice(c+l.length)}}return t}function getUtils({page:t,i18n:n,basePath:r,rewrites:i,pageIsDynamic:p,trailingSlash:m,caseSensitive:h}){let C,b,y;return p&&(C=(0,l.getNamedRouteRegex)(t,!1),y=(b=(0,c.getRouteMatcher)(C))(t)),{handleRewrites:function(l,c){let u={},I=c.pathname,checkRewrite=i=>{let d=(0,a.getPathMatch)(i.source+(m?"(/)?":""),{removeUnnamedParams:!0,strict:!0,sensitive:!!h}),C=d(c.pathname);if((i.has||i.missing)&&C){let t=(0,g.matchHas)(l,c.query,i.has,i.missing);t?Object.assign(C,t):C=!1}if(C){let{parsedDestination:a,destQuery:l}=(0,g.prepareDestination)({appendParamsToQuery:!0,destination:i.destination,params:C,query:c.query});if(a.protocol)return!0;if(Object.assign(u,l,C),Object.assign(c.query,a.query),delete a.query,Object.assign(c,a),I=c.pathname,r&&(I=I.replace(RegExp(`^${r}`),"")||"/"),n){let t=(0,o.normalizeLocalePath)(I,n.locales);I=t.pathname,c.query.nextInternalLocale=t.detectedLocale||C.nextInternalLocale}if(I===t)return!0;if(p&&b){let t=b(I);if(t)return c.query={...c.query,...t},!0}}return!1};for(let t of i.beforeFiles||[])checkRewrite(t);if(I!==t){let n=!1;for(let t of i.afterFiles||[])if(n=checkRewrite(t))break;if(!n&&!(()=>{let n=(0,d.removeTrailingSlash)(I||"");return n===(0,d.removeTrailingSlash)(t)||(null==b?void 0:b(n))})()){for(let t of i.fallback||[])if(n=checkRewrite(t))break}}return u},defaultRouteRegex:C,dynamicRouteMatcher:b,defaultRouteMatches:y,getParamsFromRouteMatches:function(t,r,i){return(0,c.getRouteMatcher)(function(){let{groups:t,routeKeys:o}=C;return{re:{exec:a=>{let l=Object.fromEntries(new URLSearchParams(a)),c=n&&i&&l["1"]===i;for(let t of Object.keys(l)){let n=l[t];if(t!==I.NEXT_QUERY_PARAM_PREFIX&&t.startsWith(I.NEXT_QUERY_PARAM_PREFIX)){let r=t.substring(I.NEXT_QUERY_PARAM_PREFIX.length);l[r]=n,delete l[t]}}let g=Object.keys(o||{}),filterLocaleItem=t=>{if(n){let o=Array.isArray(t),a=o?t[0]:t;if("string"==typeof a&&n.locales.some(t=>t.toLowerCase()===a.toLowerCase()&&(i=t,r.locale=i,!0)))return o&&t.splice(0,1),!o||0===t.length}return!1};return g.every(t=>l[t])?g.reduce((n,r)=>{let i=null==o?void 0:o[r];return i&&!filterLocaleItem(l[r])&&(n[t[i].pos]=l[r]),n},{}):Object.keys(l).reduce((t,n)=>{if(!filterLocaleItem(l[n])){let r=n;return c&&(r=parseInt(n,10)-1+""),Object.assign(t,{[r]:l[n]})}return t},{})}},groups:t}}())(t.headers["x-now-route-matches"])},normalizeDynamicRouteParams:function(t,n){let r=!0;return C?{params:t=Object.keys(C.groups).reduce((i,o)=>{let a=t[o];"string"==typeof a&&(a=(0,u.normalizeRscPath)(a,!0)),Array.isArray(a)&&(a=a.map(t=>("string"==typeof t&&(t=(0,u.normalizeRscPath)(t,!0)),t)));let l=y[o],c=C.groups[o].optional,g=Array.isArray(l)?l.some(t=>Array.isArray(a)?a.some(n=>n.includes(t)):null==a?void 0:a.includes(t)):null==a?void 0:a.includes(l);return(g||void 0===a&&!(c&&n))&&(r=!1),c&&(!a||Array.isArray(a)&&1===a.length&&("index"===a[0]||a[0]===`[[...${o}]]`))&&(a=void 0,delete t[o]),a&&"string"==typeof a&&C.groups[o].repeat&&(a=a.split("/")),a&&(i[o]=a),i},{}),hasValidParams:r}:{params:t,hasValidParams:!1}},normalizeVercelUrl:(t,n,r)=>normalizeVercelUrl(t,n,r,p,C),interpolateDynamicPath:(t,n)=>interpolateDynamicPath(t,n,C)}}},22948:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"escapeStringRegexp",{enumerable:!0,get:function(){return escapeStringRegexp}});let r=/[|\\{}()[\]^$+*?.-]/,i=/[|\\{}()[\]^$+*?.-]/g;function escapeStringRegexp(t){return r.test(t)?t.replace(i,"\\$&"):t}},23041:(t,n)=>{"use strict";function djb2Hash(t){let n=5381;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);n=(n<<5)+n+i}return Math.abs(n)}function hexHash(t){return djb2Hash(t).toString(36).slice(0,5)}Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{djb2Hash:function(){return djb2Hash},hexHash:function(){return hexHash}})},48074:(t,n,r)=>{"use strict";let i;i=r(71017),t.exports=i},39705:(t,n)=>{"use strict";function ensureLeadingSlash(t){return t.startsWith("/")?t:"/"+t}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"ensureLeadingSlash",{enumerable:!0,get:function(){return ensureLeadingSlash}})},32688:(t,n)=>{"use strict";function normalizePathSep(t){return t.replace(/\\/g,"/")}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"normalizePathSep",{enumerable:!0,get:function(){return normalizePathSep}})},93901:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{normalizeAppPath:function(){return normalizeAppPath},normalizeRscPath:function(){return normalizeRscPath}});let i=r(39705),o=r(17155);function normalizeAppPath(t){return(0,i.ensureLeadingSlash)(t.split("/").reduce((t,n,r,i)=>!n||(0,o.isGroupSegment)(n)||"@"===n[0]||("page"===n||"route"===n)&&r===i.length-1?t:t+"/"+n,""))}function normalizeRscPath(t,n){return n?t.replace(/\.rsc($|\?)/,"$1"):t}},57249:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"parseRelativeUrl",{enumerable:!0,get:function(){return parseRelativeUrl}}),r(3010);let i=r(61275);function parseRelativeUrl(t,n){let r=new URL("http://n"),o=n?new URL(n,r):t.startsWith(".")?new URL("http://n"):r,{pathname:a,searchParams:l,search:c,hash:g,href:d,origin:u}=new URL(t,o);if(u!==r.origin)throw Error("invariant: invalid relative URL, router received "+t);return{pathname:a,query:(0,i.searchParamsToUrlQuery)(l),search:c,hash:g,href:d.slice(r.origin.length)}}},74749:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"parseUrl",{enumerable:!0,get:function(){return parseUrl}});let i=r(61275),o=r(57249);function parseUrl(t){if(t.startsWith("/"))return(0,o.parseRelativeUrl)(t);let n=new URL(t);return{hash:n.hash,hostname:n.hostname,href:n.href,pathname:n.pathname,port:n.port,protocol:n.protocol,query:(0,i.searchParamsToUrlQuery)(n.searchParams),search:n.search}}},75556:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getPathMatch",{enumerable:!0,get:function(){return getPathMatch}});let i=r(9985);function getPathMatch(t,n){let r=[],o=(0,i.pathToRegexp)(t,r,{delimiter:"/",sensitive:"boolean"==typeof(null==n?void 0:n.sensitive)&&n.sensitive,strict:null==n?void 0:n.strict}),a=(0,i.regexpToFunction)((null==n?void 0:n.regexModifier)?new RegExp(n.regexModifier(o.source),o.flags):o,r);return(t,i)=>{if("string"!=typeof t)return!1;let o=a(t);if(!o)return!1;if(null==n?void 0:n.removeUnnamedParams)for(let t of r)"number"==typeof t.name&&delete o.params[t.name];return{...i,...o.params}}}},22594:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{matchHas:function(){return matchHas},compileNonPath:function(){return compileNonPath},prepareDestination:function(){return prepareDestination}});let i=r(9985),o=r(22948),a=r(74749),l=r(4053),c=r(12664),g=r(55191);function unescapeSegments(t){return t.replace(/__ESC_COLON_/gi,":")}function matchHas(t,n,r,i){void 0===r&&(r=[]),void 0===i&&(i=[]);let o={},hasMatch=r=>{let i;let a=r.key;switch(r.type){case"header":a=a.toLowerCase(),i=t.headers[a];break;case"cookie":if("cookies"in t)i=t.cookies[r.key];else{let n=(0,g.getCookieParser)(t.headers)();i=n[r.key]}break;case"query":i=n[a];break;case"host":{let{host:n}=(null==t?void 0:t.headers)||{},r=null==n?void 0:n.split(":")[0].toLowerCase();i=r}}if(!r.value&&i)return o[function(t){let n="";for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);(i>64&&i<91||i>96&&i<123)&&(n+=t[r])}return n}(a)]=i,!0;if(i){let t=RegExp("^"+r.value+"$"),n=Array.isArray(i)?i.slice(-1)[0].match(t):i.match(t);if(n)return Array.isArray(n)&&(n.groups?Object.keys(n.groups).forEach(t=>{o[t]=n.groups[t]}):"host"===r.type&&n[0]&&(o.host=n[0])),!0}return!1},a=r.every(t=>hasMatch(t))&&!i.some(t=>hasMatch(t));return!!a&&o}function compileNonPath(t,n){if(!t.includes(":"))return t;for(let r of Object.keys(n))t.includes(":"+r)&&(t=t.replace(RegExp(":"+r+"\\*","g"),":"+r+"--ESCAPED_PARAM_ASTERISKS").replace(RegExp(":"+r+"\\?","g"),":"+r+"--ESCAPED_PARAM_QUESTION").replace(RegExp(":"+r+"\\+","g"),":"+r+"--ESCAPED_PARAM_PLUS").replace(RegExp(":"+r+"(?!\\w)","g"),"--ESCAPED_PARAM_COLON"+r));return t=t.replace(/(:|\*|\?|\+|\(|\)|\{|\})/g,"\\$1").replace(/--ESCAPED_PARAM_PLUS/g,"+").replace(/--ESCAPED_PARAM_COLON/g,":").replace(/--ESCAPED_PARAM_QUESTION/g,"?").replace(/--ESCAPED_PARAM_ASTERISKS/g,"*"),(0,i.compile)("/"+t,{validate:!1})(n).slice(1)}function prepareDestination(t){let n;let r=Object.assign({},t.query);delete r.__nextLocale,delete r.__nextDefaultLocale,delete r.__nextDataReq,delete r.__nextInferredLocaleFromDefault,delete r[c.NEXT_RSC_UNION_QUERY];let g=t.destination;for(let n of Object.keys({...t.params,...r}))g=g.replace(RegExp(":"+(0,o.escapeStringRegexp)(n),"g"),"__ESC_COLON_"+n);let d=(0,a.parseUrl)(g),u=d.query,I=unescapeSegments(""+d.pathname+(d.hash||"")),p=unescapeSegments(d.hostname||""),m=[],h=[];(0,i.pathToRegexp)(I,m),(0,i.pathToRegexp)(p,h);let C=[];m.forEach(t=>C.push(t.name)),h.forEach(t=>C.push(t.name));let b=(0,i.compile)(I,{validate:!1}),y=(0,i.compile)(p,{validate:!1});for(let[n,r]of Object.entries(u))Array.isArray(r)?u[n]=r.map(n=>compileNonPath(unescapeSegments(n),t.params)):"string"==typeof r&&(u[n]=compileNonPath(unescapeSegments(r),t.params));let G=Object.keys(t.params).filter(t=>"nextInternalLocale"!==t);if(t.appendParamsToQuery&&!G.some(t=>C.includes(t)))for(let n of G)n in u||(u[n]=t.params[n]);if((0,l.isInterceptionRouteAppPath)(I))for(let n of I.split("/")){let r=l.INTERCEPTION_ROUTE_MARKERS.find(t=>n.startsWith(t));if(r){t.params["0"]=r;break}}try{n=b(t.params);let[r,i]=n.split("#");d.hostname=y(t.params),d.pathname=r,d.hash=(i?"#":"")+(i||""),delete d.search}catch(t){if(t.message.match(/Expected .*? to not repeat, but got an array/))throw Error("To use a multi-match in the destination you must add `*` at the end of the param name to signify it should repeat. https://nextjs.org/docs/messages/invalid-multi-match");throw t}return d.query={...r,...d.query},{newUrl:n,destQuery:u,parsedDestination:d}}},61275:(t,n)=>{"use strict";function searchParamsToUrlQuery(t){let n={};return t.forEach((t,r)=>{void 0===n[r]?n[r]=t:Array.isArray(n[r])?n[r].push(t):n[r]=[n[r],t]}),n}function stringifyUrlQueryParam(t){return"string"!=typeof t&&("number"!=typeof t||isNaN(t))&&"boolean"!=typeof t?"":String(t)}function urlQueryToSearchParams(t){let n=new URLSearchParams;return Object.entries(t).forEach(t=>{let[r,i]=t;Array.isArray(i)?i.forEach(t=>n.append(r,stringifyUrlQueryParam(t))):n.set(r,stringifyUrlQueryParam(i))}),n}function assign(t){for(var n=arguments.length,r=Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(n=>{Array.from(n.keys()).forEach(n=>t.delete(n)),n.forEach((n,r)=>t.append(r,n))}),t}Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{searchParamsToUrlQuery:function(){return searchParamsToUrlQuery},urlQueryToSearchParams:function(){return urlQueryToSearchParams},assign:function(){return assign}})},83859:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"getRouteMatcher",{enumerable:!0,get:function(){return getRouteMatcher}});let i=r(3010);function getRouteMatcher(t){let{re:n,groups:r}=t;return t=>{let o=n.exec(t);if(!o)return!1;let decode=t=>{try{return decodeURIComponent(t)}catch(t){throw new i.DecodeError("failed to decode param")}},a={};return Object.keys(r).forEach(t=>{let n=r[t],i=o[n.pos];void 0!==i&&(a[t]=~i.indexOf("/")?i.split("/").map(t=>decode(t)):n.repeat?[decode(i)]:decode(i))}),a}}},17927:(t,n,r)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{getRouteRegex:function(){return getRouteRegex},getNamedRouteRegex:function(){return getNamedRouteRegex},getNamedMiddlewareRegex:function(){return getNamedMiddlewareRegex}});let i=r(4053),o=r(22948),a=r(52810);function parseParameter(t){let n=t.startsWith("[")&&t.endsWith("]");n&&(t=t.slice(1,-1));let r=t.startsWith("...");return r&&(t=t.slice(3)),{key:t,repeat:r,optional:n}}function getParametrizedRoute(t){let n=(0,a.removeTrailingSlash)(t).slice(1).split("/"),r={},l=1;return{parameterizedRoute:n.map(t=>{let n=i.INTERCEPTION_ROUTE_MARKERS.find(n=>t.startsWith(n)),a=t.match(/\[((?:\[.*\])|.+)\]/);if(n&&a){let{key:t,optional:i,repeat:c}=parseParameter(a[1]);return r[t]={pos:l++,repeat:c,optional:i},"/"+(0,o.escapeStringRegexp)(n)+"([^/]+?)"}if(!a)return"/"+(0,o.escapeStringRegexp)(t);{let{key:t,repeat:n,optional:i}=parseParameter(a[1]);return r[t]={pos:l++,repeat:n,optional:i},n?i?"(?:/(.+?))?":"/(.+?)":"/([^/]+?)"}}).join(""),groups:r}}function getRouteRegex(t){let{parameterizedRoute:n,groups:r}=getParametrizedRoute(t);return{re:RegExp("^"+n+"(?:/)?$"),groups:r}}function getSafeKeyFromSegment(t){let{getSafeRouteKey:n,segment:r,routeKeys:i,keyPrefix:o}=t,{key:a,optional:l,repeat:c}=parseParameter(r),g=a.replace(/\W/g,"");o&&(g=""+o+g);let d=!1;return(0===g.length||g.length>30)&&(d=!0),isNaN(parseInt(g.slice(0,1)))||(d=!0),d&&(g=n()),o?i[g]=""+o+a:i[g]=""+a,c?l?"(?:/(?<"+g+">.+?))?":"/(?<"+g+">.+?)":"/(?<"+g+">[^/]+?)"}function getNamedParametrizedRoute(t,n){let r;let l=(0,a.removeTrailingSlash)(t).slice(1).split("/"),c=(r=0,()=>{let t="",n=++r;for(;n>0;)t+=String.fromCharCode(97+(n-1)%26),n=Math.floor((n-1)/26);return t}),g={};return{namedParameterizedRoute:l.map(t=>{let r=i.INTERCEPTION_ROUTE_MARKERS.some(n=>t.startsWith(n)),a=t.match(/\[((?:\[.*\])|.+)\]/);return r&&a?getSafeKeyFromSegment({getSafeRouteKey:c,segment:a[1],routeKeys:g,keyPrefix:n?"nxtI":void 0}):a?getSafeKeyFromSegment({getSafeRouteKey:c,segment:a[1],routeKeys:g,keyPrefix:n?"nxtP":void 0}):"/"+(0,o.escapeStringRegexp)(t)}).join(""),routeKeys:g}}function getNamedRouteRegex(t,n){let r=getNamedParametrizedRoute(t,n);return{...getRouteRegex(t),namedRegex:"^"+r.namedParameterizedRoute+"(?:/)?$",routeKeys:r.routeKeys}}function getNamedMiddlewareRegex(t,n){let{parameterizedRoute:r}=getParametrizedRoute(t),{catchAll:i=!0}=n;if("/"===r)return{namedRegex:"^/"+(i?".*":"")+"$"};let{namedParameterizedRoute:o}=getNamedParametrizedRoute(t,!1);return{namedRegex:"^"+o+(i?"(?:(/.*)?)":"")+"$"}}},17155:(t,n)=>{"use strict";function isGroupSegment(t){return"("===t[0]&&t.endsWith(")")}Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"isGroupSegment",{enumerable:!0,get:function(){return isGroupSegment}})},3010:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0}),function(t,n){for(var r in n)Object.defineProperty(t,r,{enumerable:!0,get:n[r]})}(n,{WEB_VITALS:function(){return r},execOnce:function(){return execOnce},isAbsoluteUrl:function(){return isAbsoluteUrl},getLocationOrigin:function(){return getLocationOrigin},getURL:function(){return getURL},getDisplayName:function(){return getDisplayName},isResSent:function(){return isResSent},normalizeRepeatedSlashes:function(){return normalizeRepeatedSlashes},loadGetInitialProps:function(){return loadGetInitialProps},SP:function(){return o},ST:function(){return a},DecodeError:function(){return DecodeError},NormalizeError:function(){return NormalizeError},PageNotFoundError:function(){return PageNotFoundError},MissingStaticPage:function(){return MissingStaticPage},MiddlewareNotFoundError:function(){return MiddlewareNotFoundError},stringifyError:function(){return stringifyError}});let r=["CLS","FCP","FID","INP","LCP","TTFB"];function execOnce(t){let n,r=!1;return function(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return r||(r=!0,n=t(...o)),n}}let i=/^[a-zA-Z][a-zA-Z\d+\-.]*?:/,isAbsoluteUrl=t=>i.test(t);function getLocationOrigin(){let{protocol:t,hostname:n,port:r}=window.location;return t+"//"+n+(r?":"+r:"")}function getURL(){let{href:t}=window.location,n=getLocationOrigin();return t.substring(n.length)}function getDisplayName(t){return"string"==typeof t?t:t.displayName||t.name||"Unknown"}function isResSent(t){return t.finished||t.headersSent}function normalizeRepeatedSlashes(t){let n=t.split("?"),r=n[0];return r.replace(/\\/g,"/").replace(/\/\/+/g,"/")+(n[1]?"?"+n.slice(1).join("?"):"")}async function loadGetInitialProps(t,n){let r=n.res||n.ctx&&n.ctx.res;if(!t.getInitialProps)return n.ctx&&n.Component?{pageProps:await loadGetInitialProps(n.Component,n.ctx)}:{};let i=await t.getInitialProps(n);if(r&&isResSent(r))return i;if(!i){let n='"'+getDisplayName(t)+'.getInitialProps()" should resolve to an object. But found "'+i+'" instead.';throw Error(n)}return i}let o="undefined"!=typeof performance,a=o&&["mark","measure","getEntriesByName"].every(t=>"function"==typeof performance[t]);let DecodeError=class DecodeError extends Error{};let NormalizeError=class NormalizeError extends Error{};let PageNotFoundError=class PageNotFoundError extends Error{constructor(t){super(),this.code="ENOENT",this.name="PageNotFoundError",this.message="Cannot find module for page: "+t}};let MissingStaticPage=class MissingStaticPage extends Error{constructor(t,n){super(),this.message="Failed to load static file for page: "+t+" "+n}};let MiddlewareNotFoundError=class MiddlewareNotFoundError extends Error{constructor(){super(),this.code="ENOENT",this.message="Cannot find the middleware module"}};function stringifyError(t){return JSON.stringify({message:t.message,stack:t.stack})}},12999:(t,n,r)=>{"use strict";t.exports=r(10316).vendored.contexts.AmpContext},75851:(t,n,r)=>{"use strict";t.exports=r(10316).vendored.contexts.HeadManagerContext},87927:(t,n,r)=>{"use strict";t.exports=r(10316).vendored.contexts.ImageConfigContext},10713:(t,n,r)=>{"use strict";t.exports=r(10316).vendored.contexts.RouterContext},52451:(t,n,r)=>{t.exports=r(21538)},1462:(t,n)=>{"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r="<unknown>",i=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/|[a-z]:\\|\\\\).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/\((\S*)(?::(\d+))(?::(\d+))\)/,a=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,l=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i,c=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,g=/^\s*(?:([^@]*)(?:\((.*?)\))?@)?(\S.*?):(\d+)(?::(\d+))?\s*$/i,d=/^\s*at (?:((?:\[object object\])?[^\\/]+(?: \[as \S+\])?) )?\(?(.*?):(\d+)(?::(\d+))?\)?\s*$/i;n.parse=function(t){return t.split("\n").reduce(function(t,n){var u,I,p,m=function(t){var n=i.exec(t);if(!n)return null;var a=n[2]&&0===n[2].indexOf("native"),l=n[2]&&0===n[2].indexOf("eval"),c=o.exec(n[2]);return l&&null!=c&&(n[2]=c[1],n[3]=c[2],n[4]=c[3]),{file:a?null:n[2],methodName:n[1]||r,arguments:a?[n[2]]:[],lineNumber:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}(n)||((u=a.exec(n))?{file:u[2],methodName:u[1]||r,arguments:[],lineNumber:+u[3],column:u[4]?+u[4]:null}:null)||function(t){var n=l.exec(t);if(!n)return null;var i=n[3]&&n[3].indexOf(" > eval")>-1,o=c.exec(n[3]);return i&&null!=o&&(n[3]=o[1],n[4]=o[2],n[5]=null),{file:n[3],methodName:n[1]||r,arguments:n[2]?n[2].split(","):[],lineNumber:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}(n)||((I=d.exec(n))?{file:I[2],methodName:I[1]||r,arguments:[],lineNumber:+I[3],column:I[4]?+I[4]:null}:null)||((p=g.exec(n))?{file:p[3],methodName:p[1]||r,arguments:[],lineNumber:+p[4],column:p[5]?+p[5]:null}:null);return m&&t.push(m),t},[])}},30569:(t,n,r)=>{"use strict";r.d(n,{M:()=>AnimatePresence});var i=r(9885),o=r(60381);function useIsMounted(){let t=(0,i.useRef)(!1);return(0,o.L)(()=>(t.current=!0,()=>{t.current=!1}),[]),t}var a=r(89195),l=r(19386),c=r(34349);let PopChildMeasure=class PopChildMeasure extends i.Component{getSnapshotBeforeUpdate(t){let n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){let t=this.props.sizeRef.current;t.height=n.offsetHeight||0,t.width=n.offsetWidth||0,t.top=n.offsetTop,t.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}};function PopChild({children:t,isPresent:n}){let r=(0,i.useId)(),o=(0,i.useRef)(null),a=(0,i.useRef)({width:0,height:0,top:0,left:0});return(0,i.useInsertionEffect)(()=>{let{width:t,height:i,top:l,left:c}=a.current;if(n||!o.current||!t||!i)return;o.current.dataset.motionPopId=r;let g=document.createElement("style");return document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${t}px !important;
            height: ${i}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(g)}},[n]),i.createElement(PopChildMeasure,{isPresent:n,childRef:o,sizeRef:a},i.cloneElement(t,{ref:o}))}let PresenceChild=({children:t,initial:n,isPresent:r,onExitComplete:o,custom:a,presenceAffectsLayout:g,mode:d})=>{let u=(0,c.h)(newChildrenMap),I=(0,i.useId)(),p=(0,i.useMemo)(()=>({id:I,initial:n,isPresent:r,custom:a,onExitComplete:t=>{for(let n of(u.set(t,!0),u.values()))if(!n)return;o&&o()},register:t=>(u.set(t,!1),()=>u.delete(t))}),g?void 0:[r]);return(0,i.useMemo)(()=>{u.forEach((t,n)=>u.set(n,!1))},[r]),i.useEffect(()=>{r||u.size||!o||o()},[r]),"popLayout"===d&&(t=i.createElement(PopChild,{isPresent:r},t)),i.createElement(l.O.Provider,{value:p},t)};function newChildrenMap(){return new Map}var g=r(78549),d=r(47279);let getChildKey=t=>t.key||"",AnimatePresence=({children:t,custom:n,initial:r=!0,onExitComplete:l,exitBeforeEnter:c,presenceAffectsLayout:u=!0,mode:I="sync"})=>{var p;(0,d.k)(!c,"Replace exitBeforeEnter with mode='wait'");let m=(0,i.useContext)(g.p).forceRender||function(){let t=useIsMounted(),[n,r]=(0,i.useState)(0),o=(0,i.useCallback)(()=>{t.current&&r(n+1)},[n]),l=(0,i.useCallback)(()=>a.Wi.postRender(o),[o]);return[l,n]}()[0],h=useIsMounted(),C=function(t){let n=[];return i.Children.forEach(t,t=>{(0,i.isValidElement)(t)&&n.push(t)}),n}(t),b=C,y=(0,i.useRef)(new Map).current,G=(0,i.useRef)(b),A=(0,i.useRef)(new Map).current,B=(0,i.useRef)(!0);if((0,o.L)(()=>{B.current=!1,function(t,n){t.forEach(t=>{let r=getChildKey(t);n.set(r,t)})}(C,A),G.current=b}),p=()=>{B.current=!0,A.clear(),y.clear()},(0,i.useEffect)(()=>()=>p(),[]),B.current)return i.createElement(i.Fragment,null,b.map(t=>i.createElement(PresenceChild,{key:getChildKey(t),isPresent:!0,initial:!!r&&void 0,presenceAffectsLayout:u,mode:I},t)));b=[...b];let Z=G.current.map(getChildKey),f=C.map(getChildKey),v=Z.length;for(let t=0;t<v;t++){let n=Z[t];-1!==f.indexOf(n)||y.has(n)||y.set(n,void 0)}return"wait"===I&&y.size&&(b=[]),y.forEach((t,r)=>{if(-1!==f.indexOf(r))return;let o=A.get(r);if(!o)return;let a=Z.indexOf(r),c=t;c||(c=i.createElement(PresenceChild,{key:getChildKey(o),isPresent:!1,onExitComplete:()=>{y.delete(r);let t=Array.from(A.keys()).filter(t=>!f.includes(t));if(t.forEach(t=>A.delete(t)),G.current=C.filter(n=>{let i=getChildKey(n);return i===r||t.includes(i)}),!y.size){if(!1===h.current)return;m(),l&&l()}},custom:n,presenceAffectsLayout:u,mode:I},o),y.set(r,c)),b.splice(a,0,c)}),b=b.map(t=>{let n=t.key;return y.has(n)?t:i.createElement(PresenceChild,{key:getChildKey(t),isPresent:!0,presenceAffectsLayout:u,mode:I},t)}),i.createElement(i.Fragment,null,y.size?b:b.map(t=>(0,i.cloneElement)(t)))}},78549:(t,n,r)=>{"use strict";r.d(n,{p:()=>o});var i=r(9885);let o=(0,i.createContext)({})},19386:(t,n,r)=>{"use strict";r.d(n,{O:()=>o});var i=r(9885);let o=(0,i.createContext)(null)},89195:(t,n,r)=>{"use strict";r.d(n,{Pn:()=>l,Wi:()=>a,frameData:()=>c,S6:()=>g});var i=r(41279);let Queue=class Queue{constructor(){this.order=[],this.scheduled=new Set}add(t){if(!this.scheduled.has(t))return this.scheduled.add(t),this.order.push(t),!0}remove(t){let n=this.order.indexOf(t);-1!==n&&(this.order.splice(n,1),this.scheduled.delete(t))}clear(){this.order.length=0,this.scheduled.clear()}};let o=["prepare","read","update","preRender","render","postRender"],{schedule:a,cancel:l,state:c,steps:g}=function(t,n){let r=!1,i=!0,a={delta:0,timestamp:0,isProcessing:!1},l=o.reduce((t,n)=>(t[n]=function(t){let n=new Queue,r=new Queue,i=0,o=!1,a=!1,l=new WeakSet,c={schedule:(t,a=!1,c=!1)=>{let g=c&&o,d=g?n:r;return a&&l.add(t),d.add(t)&&g&&o&&(i=n.order.length),t},cancel:t=>{r.remove(t),l.delete(t)},process:g=>{if(o){a=!0;return}if(o=!0,[n,r]=[r,n],r.clear(),i=n.order.length)for(let r=0;r<i;r++){let i=n.order[r];i(g),l.has(i)&&(c.schedule(i),t())}o=!1,a&&(a=!1,c.process(g))}};return c}(()=>r=!0),t),{}),processStep=t=>l[t].process(a),processBatch=()=>{let l=performance.now();r=!1,a.delta=i?1e3/60:Math.max(Math.min(l-a.timestamp,40),1),a.timestamp=l,a.isProcessing=!0,o.forEach(processStep),a.isProcessing=!1,r&&n&&(i=!1,t(processBatch))},wake=()=>{r=!0,i=!0,a.isProcessing||t(processBatch)},c=o.reduce((t,n)=>{let i=l[n];return t[n]=(t,n=!1,o=!1)=>(r||wake(),i.schedule(t,n,o)),t},{});return{schedule:c,cancel:t=>o.forEach(n=>l[n].cancel(t)),state:a,steps:l}}("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:i.Z,!0)},94571:(t,n,r)=>{"use strict";r.d(n,{E:()=>tI});var i=r(9885);let o=(0,i.createContext)({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),a=(0,i.createContext)({});var l=r(19386),c=r(60381);let g=(0,i.createContext)({strict:!1}),camelToDash=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),d="data-"+camelToDash("framerAppearId");function isRefObject(t){return t&&"object"==typeof t&&Object.prototype.hasOwnProperty.call(t,"current")}function isVariantLabel(t){return"string"==typeof t||Array.isArray(t)}function isAnimationControls(t){return null!==t&&"object"==typeof t&&"function"==typeof t.start}let u=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],I=["initial",...u];function isControllingVariants(t){return isAnimationControls(t.animate)||I.some(n=>isVariantLabel(t[n]))}function isVariantNode(t){return!!(isControllingVariants(t)||t.variants)}function variantLabelsAsDependency(t){return Array.isArray(t)?t.join(" "):t}let p={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},m={};for(let t in p)m[t]={isEnabled:n=>p[t].some(t=>!!n[t])};var h=r(58066),C=r(78549);let b=(0,i.createContext)({}),y=Symbol.for("motionComponentSymbol"),G=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function isSVGComponent(t){if("string"!=typeof t||t.includes("-"));else if(G.indexOf(t)>-1||/[A-Z]/.test(t))return!0;return!1}let A={},B=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Z=new Set(B);function isForcedMotionValue(t,{layout:n,layoutId:r}){return Z.has(t)||t.startsWith("origin")||(n||void 0!==r)&&(!!A[t]||"opacity"===t)}let isMotionValue=t=>!!(t&&t.getVelocity),f={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},v=B.length,checkStringStartsWith=t=>n=>"string"==typeof n&&n.startsWith(t),W=checkStringStartsWith("--"),S=checkStringStartsWith("var(--"),getValueAsType=(t,n)=>n&&"number"==typeof t?n.transform(t):t,clamp=(t,n,r)=>Math.min(Math.max(r,t),n),R={test:t=>"number"==typeof t,parse:parseFloat,transform:t=>t},V={...R,transform:t=>clamp(0,1,t)},H={...R,default:1},sanitize=t=>Math.round(1e5*t)/1e5,N=/(-)?([\d]*\.?[\d])+/g,Y=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,X=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function isString(t){return"string"==typeof t}let createUnitType=t=>({test:n=>isString(n)&&n.endsWith(t)&&1===n.split(" ").length,parse:parseFloat,transform:n=>`${n}${t}`}),E=createUnitType("deg"),T=createUnitType("%"),_=createUnitType("px"),w=createUnitType("vh"),F=createUnitType("vw"),K={...T,parse:t=>T.parse(t)/100,transform:t=>T.transform(100*t)},x={...R,transform:Math.round},k={borderWidth:_,borderTopWidth:_,borderRightWidth:_,borderBottomWidth:_,borderLeftWidth:_,borderRadius:_,radius:_,borderTopLeftRadius:_,borderTopRightRadius:_,borderBottomRightRadius:_,borderBottomLeftRadius:_,width:_,maxWidth:_,height:_,maxHeight:_,size:_,top:_,right:_,bottom:_,left:_,padding:_,paddingTop:_,paddingRight:_,paddingBottom:_,paddingLeft:_,margin:_,marginTop:_,marginRight:_,marginBottom:_,marginLeft:_,rotate:E,rotateX:E,rotateY:E,rotateZ:E,scale:H,scaleX:H,scaleY:H,scaleZ:H,skew:E,skewX:E,skewY:E,distance:_,translateX:_,translateY:_,translateZ:_,x:_,y:_,z:_,perspective:_,transformPerspective:_,opacity:V,originX:K,originY:K,originZ:_,zIndex:x,fillOpacity:V,strokeOpacity:V,numOctaves:x};function buildHTMLStyles(t,n,r,i){let{style:o,vars:a,transform:l,transformOrigin:c}=t,g=!1,d=!1,u=!0;for(let t in n){let r=n[t];if(W(t)){a[t]=r;continue}let i=k[t],I=getValueAsType(r,i);if(Z.has(t)){if(g=!0,l[t]=I,!u)continue;r!==(i.default||0)&&(u=!1)}else t.startsWith("origin")?(d=!0,c[t]=I):o[t]=I}if(!n.transform&&(g||i?o.transform=function(t,{enableHardwareAcceleration:n=!0,allowTransformNone:r=!0},i,o){let a="";for(let n=0;n<v;n++){let r=B[n];if(void 0!==t[r]){let n=f[r]||r;a+=`${n}(${t[r]}) `}}return n&&!t.z&&(a+="translateZ(0)"),a=a.trim(),o?a=o(t,i?"":a):r&&i&&(a="none"),a}(t.transform,r,u,i):o.transform&&(o.transform="none")),d){let{originX:t="50%",originY:n="50%",originZ:r=0}=c;o.transformOrigin=`${t} ${n} ${r}`}}let createHtmlRenderState=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function copyRawValuesOnly(t,n,r){for(let i in n)isMotionValue(n[i])||isForcedMotionValue(i,r)||(t[i]=n[i])}function useHTMLProps(t,n,r){let o={},a=function(t,n,r){let o=t.style||{},a={};return copyRawValuesOnly(a,o,t),Object.assign(a,function({transformTemplate:t},n,r){return(0,i.useMemo)(()=>{let i=createHtmlRenderState();return buildHTMLStyles(i,n,{enableHardwareAcceleration:!r},t),Object.assign({},i.vars,i.style)},[n])}(t,n,r)),t.transformValues?t.transformValues(a):a}(t,n,r);return t.drag&&!1!==t.dragListener&&(o.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=!0===t.drag?"none":`pan-${"x"===t.drag?"y":"x"}`),void 0===t.tabIndex&&(t.onTap||t.onTapStart||t.whileTap)&&(o.tabIndex=0),o.style=a,o}let U=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function isValidMotionProp(t){return t.startsWith("while")||t.startsWith("drag")&&"draggable"!==t||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||U.has(t)}let shouldForward=t=>!isValidMotionProp(t);try{!function(t){t&&(shouldForward=n=>n.startsWith("on")?!isValidMotionProp(n):t(n))}(require("@emotion/is-prop-valid").default)}catch(t){}function calcOrigin(t,n,r){return"string"==typeof t?t:_.transform(n+r*t)}let J={offset:"stroke-dashoffset",array:"stroke-dasharray"},L={offset:"strokeDashoffset",array:"strokeDasharray"};function buildSVGAttrs(t,{attrX:n,attrY:r,attrScale:i,originX:o,originY:a,pathLength:l,pathSpacing:c=1,pathOffset:g=0,...d},u,I,p){if(buildHTMLStyles(t,d,u,p),I){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};let{attrs:m,style:h,dimensions:C}=t;m.transform&&(C&&(h.transform=m.transform),delete m.transform),C&&(void 0!==o||void 0!==a||h.transform)&&(h.transformOrigin=function(t,n,r){let i=calcOrigin(n,t.x,t.width),o=calcOrigin(r,t.y,t.height);return`${i} ${o}`}(C,void 0!==o?o:.5,void 0!==a?a:.5)),void 0!==n&&(m.x=n),void 0!==r&&(m.y=r),void 0!==i&&(m.scale=i),void 0!==l&&function(t,n,r=1,i=0,o=!0){t.pathLength=1;let a=o?J:L;t[a.offset]=_.transform(-i);let l=_.transform(n),c=_.transform(r);t[a.array]=`${l} ${c}`}(m,l,c,g,!1)}let createSvgRenderState=()=>({...createHtmlRenderState(),attrs:{}}),isSVGTag=t=>"string"==typeof t&&"svg"===t.toLowerCase();function useSVGProps(t,n,r,o){let a=(0,i.useMemo)(()=>{let r=createSvgRenderState();return buildSVGAttrs(r,n,{enableHardwareAcceleration:!1},isSVGTag(o),t.transformTemplate),{...r.attrs,style:{...r.style}}},[n]);if(t.style){let n={};copyRawValuesOnly(n,t.style,t),a.style={...n,...a.style}}return a}function renderHTML(t,{style:n,vars:r},i,o){for(let a in Object.assign(t.style,n,o&&o.getProjectionStyles(i)),r)t.style.setProperty(a,r[a])}let z=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function renderSVG(t,n,r,i){for(let r in renderHTML(t,n,void 0,i),n.attrs)t.setAttribute(z.has(r)?r:camelToDash(r),n.attrs[r])}function scrapeMotionValuesFromProps(t,n){let{style:r}=t,i={};for(let o in r)(isMotionValue(r[o])||n.style&&isMotionValue(n.style[o])||isForcedMotionValue(o,t))&&(i[o]=r[o]);return i}function scrape_motion_values_scrapeMotionValuesFromProps(t,n){let r=scrapeMotionValuesFromProps(t,n);for(let i in t)if(isMotionValue(t[i])||isMotionValue(n[i])){let n=-1!==B.indexOf(i)?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[n]=t[i]}return r}function resolveVariantFromProps(t,n,r,i={},o={}){return"function"==typeof n&&(n=n(void 0!==r?r:t.custom,i,o)),"string"==typeof n&&(n=t.variants&&t.variants[n]),"function"==typeof n&&(n=n(void 0!==r?r:t.custom,i,o)),n}var P=r(34349);let isKeyframesTarget=t=>Array.isArray(t),isCustomValue=t=>!!(t&&"object"==typeof t&&t.mix&&t.toValue),resolveFinalValueInKeyframes=t=>isKeyframesTarget(t)?t[t.length-1]||0:t;function resolveMotionValue(t){let n=isMotionValue(t)?t.get():t;return isCustomValue(n)?n.toValue():n}let makeUseVisualState=t=>(n,r)=>{let o=(0,i.useContext)(a),c=(0,i.useContext)(l.O),make=()=>(function({scrapeMotionValuesFromProps:t,createRenderState:n,onMount:r},i,o,a){let l={latestValues:function(t,n,r,i){let o={},a=i(t,{});for(let t in a)o[t]=resolveMotionValue(a[t]);let{initial:l,animate:c}=t,g=isControllingVariants(t),d=isVariantNode(t);n&&d&&!g&&!1!==t.inherit&&(void 0===l&&(l=n.initial),void 0===c&&(c=n.animate));let u=!!r&&!1===r.initial;u=u||!1===l;let I=u?c:l;if(I&&"boolean"!=typeof I&&!isAnimationControls(I)){let n=Array.isArray(I)?I:[I];n.forEach(n=>{let r=resolveVariantFromProps(t,n);if(!r)return;let{transitionEnd:i,transition:a,...l}=r;for(let t in l){let n=l[t];if(Array.isArray(n)){let t=u?n.length-1:0;n=n[t]}null!==n&&(o[t]=n)}for(let t in i)o[t]=i[t]})}return o}(i,o,a,t),renderState:n()};return r&&(l.mount=t=>r(i,t,l)),l})(t,n,o,c);return r?make():(0,P.h)(make)};var M=r(89195);let O={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrape_motion_values_scrapeMotionValuesFromProps,createRenderState:createSvgRenderState,onMount:(t,n,{renderState:r,latestValues:i})=>{M.Wi.read(()=>{try{r.dimensions="function"==typeof n.getBBox?n.getBBox():n.getBoundingClientRect()}catch(t){r.dimensions={x:0,y:0,width:0,height:0}}}),M.Wi.render(()=>{buildSVGAttrs(r,i,{enableHardwareAcceleration:!1},isSVGTag(n.tagName),t.transformTemplate),renderSVG(n,r)})}})},j={useVisualState:makeUseVisualState({scrapeMotionValuesFromProps:scrapeMotionValuesFromProps,createRenderState:createHtmlRenderState})};function addDomEvent(t,n,r,i={passive:!0}){return t.addEventListener(n,r,i),()=>t.removeEventListener(n,r)}let isPrimaryPointer=t=>"mouse"===t.pointerType?"number"!=typeof t.button||t.button<=0:!1!==t.isPrimary;function extractEventInfo(t,n="page"){return{point:{x:t[n+"X"],y:t[n+"Y"]}}}let addPointerInfo=t=>n=>isPrimaryPointer(n)&&t(n,extractEventInfo(n));function addPointerEvent(t,n,r,i){return addDomEvent(t,n,addPointerInfo(r),i)}let combineFunctions=(t,n)=>r=>n(t(r)),pipe=(...t)=>t.reduce(combineFunctions);function createLock(t){let n=null;return()=>null===n&&(n=t,()=>{n=null})}let D=createLock("dragHorizontal"),Q=createLock("dragVertical");function getGlobalLock(t){let n=!1;if("y"===t)n=Q();else if("x"===t)n=D();else{let t=D(),r=Q();t&&r?n=()=>{t(),r()}:(t&&t(),r&&r())}return n}function isDragActive(){let t=getGlobalLock(!0);return!t||(t(),!1)}let Feature=class Feature{constructor(t){this.isMounted=!1,this.node=t}update(){}};function addHoverEvent(t,n){let r="pointer"+(n?"enter":"leave"),i="onHover"+(n?"Start":"End");return addPointerEvent(t.current,r,(r,o)=>{if("touch"===r.pointerType||isDragActive())return;let a=t.getProps();t.animationState&&a.whileHover&&t.animationState.setActive("whileHover",n),a[i]&&M.Wi.update(()=>a[i](r,o))},{passive:!t.getProps()[i]})}let isNodeOrChild=(t,n)=>!!n&&(t===n||isNodeOrChild(t,n.parentElement));var q=r(41279);function fireSyntheticPointerEvent(t,n){if(!n)return;let r=new PointerEvent("pointer"+t);n(r,extractEventInfo(r))}let $=new WeakMap,ee=new WeakMap,fireObserverCallback=t=>{let n=$.get(t.target);n&&n(t)},fireAllObserverCallbacks=t=>{t.forEach(fireObserverCallback)},et={some:0,all:1};function shallowCompare(t,n){if(!Array.isArray(n))return!1;let r=n.length;if(r!==t.length)return!1;for(let i=0;i<r;i++)if(n[i]!==t[i])return!1;return!0}function resolveVariant(t,n,r){let i=t.getProps();return resolveVariantFromProps(i,n,void 0!==r?r:i.custom,function(t){let n={};return t.values.forEach((t,r)=>n[r]=t.get()),n}(t),function(t){let n={};return t.values.forEach((t,r)=>n[r]=t.getVelocity()),n}(t))}var en=r(47279);let secondsToMilliseconds=t=>1e3*t,millisecondsToSeconds=t=>t/1e3,er={current:!1},isBezierDefinition=t=>Array.isArray(t)&&"number"==typeof t[0],cubicBezierAsString=([t,n,r,i])=>`cubic-bezier(${t}, ${n}, ${r}, ${i})`,ei={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cubicBezierAsString([0,.65,.55,1]),circOut:cubicBezierAsString([.55,0,1,.45]),backIn:cubicBezierAsString([.31,.01,.66,-.59]),backOut:cubicBezierAsString([.33,1.53,.69,.99])},calcBezier=(t,n,r)=>(((1-3*r+3*n)*t+(3*r-6*n))*t+3*n)*t;function cubicBezier(t,n,r,i){if(t===n&&r===i)return q.Z;let getTForX=n=>(function(t,n,r,i,o){let a,l;let c=0;do(a=calcBezier(l=n+(r-n)/2,i,o)-t)>0?r=l:n=l;while(Math.abs(a)>1e-7&&++c<12);return l})(n,0,1,t,r);return t=>0===t||1===t?t:calcBezier(getTForX(t),n,i)}let eo=cubicBezier(.42,0,1,1),ea=cubicBezier(0,0,.58,1),es=cubicBezier(.42,0,.58,1),isEasingArray=t=>Array.isArray(t)&&"number"!=typeof t[0],mirrorEasing=t=>n=>n<=.5?t(2*n)/2:(2-t(2*(1-n)))/2,reverseEasing=t=>n=>1-t(1-n),circIn=t=>1-Math.sin(Math.acos(t)),el=reverseEasing(circIn),ec=mirrorEasing(circIn),eg=cubicBezier(.33,1.53,.69,.99),ed=reverseEasing(eg),eu=mirrorEasing(ed),eI={linear:q.Z,easeIn:eo,easeInOut:es,easeOut:ea,circIn:circIn,circInOut:ec,circOut:el,backIn:ed,backInOut:eu,backOut:eg,anticipate:t=>(t*=2)<1?.5*ed(t):.5*(2-Math.pow(2,-10*(t-1)))},easingDefinitionToFunction=t=>{if(Array.isArray(t)){(0,en.k)(4===t.length,"Cubic bezier arrays must contain four numerical values.");let[n,r,i,o]=t;return cubicBezier(n,r,i,o)}return"string"==typeof t?((0,en.k)(void 0!==eI[t],`Invalid easing type '${t}'`),eI[t]):t},isColorString=(t,n)=>r=>!!(isString(r)&&X.test(r)&&r.startsWith(t)||n&&Object.prototype.hasOwnProperty.call(r,n)),splitColor=(t,n,r)=>i=>{if(!isString(i))return i;let[o,a,l,c]=i.match(N);return{[t]:parseFloat(o),[n]:parseFloat(a),[r]:parseFloat(l),alpha:void 0!==c?parseFloat(c):1}},clampRgbUnit=t=>clamp(0,255,t),ep={...R,transform:t=>Math.round(clampRgbUnit(t))},em={test:isColorString("rgb","red"),parse:splitColor("red","green","blue"),transform:({red:t,green:n,blue:r,alpha:i=1})=>"rgba("+ep.transform(t)+", "+ep.transform(n)+", "+ep.transform(r)+", "+sanitize(V.transform(i))+")"},eh={test:isColorString("#"),parse:function(t){let n="",r="",i="",o="";return t.length>5?(n=t.substring(1,3),r=t.substring(3,5),i=t.substring(5,7),o=t.substring(7,9)):(n=t.substring(1,2),r=t.substring(2,3),i=t.substring(3,4),o=t.substring(4,5),n+=n,r+=r,i+=i,o+=o),{red:parseInt(n,16),green:parseInt(r,16),blue:parseInt(i,16),alpha:o?parseInt(o,16)/255:1}},transform:em.transform},eC={test:isColorString("hsl","hue"),parse:splitColor("hue","saturation","lightness"),transform:({hue:t,saturation:n,lightness:r,alpha:i=1})=>"hsla("+Math.round(t)+", "+T.transform(sanitize(n))+", "+T.transform(sanitize(r))+", "+sanitize(V.transform(i))+")"},eb={test:t=>em.test(t)||eh.test(t)||eC.test(t),parse:t=>em.test(t)?em.parse(t):eC.test(t)?eC.parse(t):eh.parse(t),transform:t=>isString(t)?t:t.hasOwnProperty("red")?em.transform(t):eC.transform(t)},mix=(t,n,r)=>-r*t+r*n+t;function hueToRgb(t,n,r){return(r<0&&(r+=1),r>1&&(r-=1),r<1/6)?t+(n-t)*6*r:r<.5?n:r<2/3?t+(n-t)*(2/3-r)*6:t}let mixLinearColor=(t,n,r)=>{let i=t*t;return Math.sqrt(Math.max(0,r*(n*n-i)+i))},ey=[eh,em,eC],getColorType=t=>ey.find(n=>n.test(t));function asRGBA(t){let n=getColorType(t);(0,en.k)(!!n,`'${t}' is not an animatable color. Use the equivalent color code instead.`);let r=n.parse(t);return n===eC&&(r=function({hue:t,saturation:n,lightness:r,alpha:i}){t/=360,r/=100;let o=0,a=0,l=0;if(n/=100){let i=r<.5?r*(1+n):r+n-r*n,c=2*r-i;o=hueToRgb(c,i,t+1/3),a=hueToRgb(c,i,t),l=hueToRgb(c,i,t-1/3)}else o=a=l=r;return{red:Math.round(255*o),green:Math.round(255*a),blue:Math.round(255*l),alpha:i}}(r)),r}let mixColor=(t,n)=>{let r=asRGBA(t),i=asRGBA(n),o={...r};return t=>(o.red=mixLinearColor(r.red,i.red,t),o.green=mixLinearColor(r.green,i.green,t),o.blue=mixLinearColor(r.blue,i.blue,t),o.alpha=mix(r.alpha,i.alpha,t),em.transform(o))},eG={regex:/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,countKey:"Vars",token:"${v}",parse:q.Z},eA={regex:Y,countKey:"Colors",token:"${c}",parse:eb.parse},eB={regex:N,countKey:"Numbers",token:"${n}",parse:R.parse};function tokenise(t,{regex:n,countKey:r,token:i,parse:o}){let a=t.tokenised.match(n);a&&(t["num"+r]=a.length,t.tokenised=t.tokenised.replace(n,i),t.values.push(...a.map(o)))}function analyseComplexValue(t){let n=t.toString(),r={value:n,tokenised:n,values:[],numVars:0,numColors:0,numNumbers:0};return r.value.includes("var(--")&&tokenise(r,eG),tokenise(r,eA),tokenise(r,eB),r}function parseComplexValue(t){return analyseComplexValue(t).values}function createTransformer(t){let{values:n,numColors:r,numVars:i,tokenised:o}=analyseComplexValue(t),a=n.length;return t=>{let n=o;for(let o=0;o<a;o++)n=o<i?n.replace(eG.token,t[o]):o<i+r?n.replace(eA.token,eb.transform(t[o])):n.replace(eB.token,sanitize(t[o]));return n}}let convertNumbersToZero=t=>"number"==typeof t?0:t,eZ={test:function(t){var n,r;return isNaN(t)&&isString(t)&&((null===(n=t.match(N))||void 0===n?void 0:n.length)||0)+((null===(r=t.match(Y))||void 0===r?void 0:r.length)||0)>0},parse:parseComplexValue,createTransformer,getAnimatableNone:function(t){let n=parseComplexValue(t),r=createTransformer(t);return r(n.map(convertNumbersToZero))}},mixImmediate=(t,n)=>r=>`${r>0?n:t}`;function getMixer(t,n){return"number"==typeof t?r=>mix(t,n,r):eb.test(t)?mixColor(t,n):t.startsWith("var(")?mixImmediate(t,n):mixComplex(t,n)}let mixArray=(t,n)=>{let r=[...t],i=r.length,o=t.map((t,r)=>getMixer(t,n[r]));return t=>{for(let n=0;n<i;n++)r[n]=o[n](t);return r}},mixObject=(t,n)=>{let r={...t,...n},i={};for(let o in r)void 0!==t[o]&&void 0!==n[o]&&(i[o]=getMixer(t[o],n[o]));return t=>{for(let n in i)r[n]=i[n](t);return r}},mixComplex=(t,n)=>{let r=eZ.createTransformer(n),i=analyseComplexValue(t),o=analyseComplexValue(n),a=i.numVars===o.numVars&&i.numColors===o.numColors&&i.numNumbers>=o.numNumbers;return a?pipe(mixArray(i.values,o.values),r):((0,en.K)(!0,`Complex values '${t}' and '${n}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),mixImmediate(t,n))},progress=(t,n,r)=>{let i=n-t;return 0===i?1:(r-t)/i},mixNumber=(t,n)=>r=>mix(t,n,r);function interpolate(t,n,{clamp:r=!0,ease:i,mixer:o}={}){let a=t.length;if((0,en.k)(a===n.length,"Both input and output ranges must be the same length"),1===a)return()=>n[0];t[0]>t[a-1]&&(t=[...t].reverse(),n=[...n].reverse());let l=function(t,n,r){let i=[],o=r||function(t){if("number"==typeof t);else if("string"==typeof t)return eb.test(t)?mixColor:mixComplex;else if(Array.isArray(t))return mixArray;else if("object"==typeof t)return mixObject;return mixNumber}(t[0]),a=t.length-1;for(let r=0;r<a;r++){let a=o(t[r],t[r+1]);if(n){let t=Array.isArray(n)?n[r]||q.Z:n;a=pipe(t,a)}i.push(a)}return i}(n,i,o),c=l.length,interpolator=n=>{let r=0;if(c>1)for(;r<t.length-2&&!(n<t[r+1]);r++);let i=progress(t[r],t[r+1],n);return l[r](i)};return r?n=>interpolator(clamp(t[0],t[a-1],n)):interpolator}function keyframes({duration:t=300,keyframes:n,times:r,ease:i="easeInOut"}){let o=isEasingArray(i)?i.map(easingDefinitionToFunction):easingDefinitionToFunction(i),a={done:!1,value:n[0]},l=(r&&r.length===n.length?r:function(t){let n=[0];return function(t,n){let r=t[t.length-1];for(let i=1;i<=n;i++){let o=progress(0,n,i);t.push(mix(r,1,o))}}(n,t.length-1),n}(n)).map(n=>n*t),c=interpolate(l,n,{ease:Array.isArray(o)?o:n.map(()=>o||es).splice(0,n.length-1)});return{calculatedDuration:t,next:n=>(a.value=c(n),a.done=n>=t,a)}}function calcGeneratorVelocity(t,n,r){var i,o;let a=Math.max(n-5,0);return i=r-t(a),(o=n-a)?i*(1e3/o):0}function calcAngularFreq(t,n){return t*Math.sqrt(1-n*n)}let ef=["duration","bounce"],ev=["stiffness","damping","mass"];function isSpringType(t,n){return n.some(n=>void 0!==t[n])}function spring({keyframes:t,restDelta:n,restSpeed:r,...i}){let o;let a=t[0],l=t[t.length-1],c={done:!1,value:a},{stiffness:g,damping:d,mass:u,duration:I,velocity:p,isResolvedFromDuration:m}=function(t){let n={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!isSpringType(t,ev)&&isSpringType(t,ef)){let r=function({duration:t=800,bounce:n=.25,velocity:r=0,mass:i=1}){let o,a;(0,en.K)(t<=secondsToMilliseconds(10),"Spring duration must be 10 seconds or less");let l=1-n;l=clamp(.05,1,l),t=clamp(.01,10,millisecondsToSeconds(t)),l<1?(o=n=>{let i=n*l,o=i*t,a=calcAngularFreq(n,l);return .001-(i-r)/a*Math.exp(-o)},a=n=>{let i=n*l,a=i*t,c=Math.pow(l,2)*Math.pow(n,2)*t,g=calcAngularFreq(Math.pow(n,2),l),d=-o(n)+.001>0?-1:1;return d*((a*r+r-c)*Math.exp(-a))/g}):(o=n=>{let i=Math.exp(-n*t),o=(n-r)*t+1;return -.001+i*o},a=n=>{let i=Math.exp(-n*t),o=(r-n)*(t*t);return i*o});let c=5/t,g=function(t,n,r){let i=r;for(let r=1;r<12;r++)i-=t(i)/n(i);return i}(o,a,c);if(t=secondsToMilliseconds(t),isNaN(g))return{stiffness:100,damping:10,duration:t};{let n=Math.pow(g,2)*i;return{stiffness:n,damping:2*l*Math.sqrt(i*n),duration:t}}}(t);(n={...n,...r,mass:1}).isResolvedFromDuration=!0}return n}({...i,velocity:-millisecondsToSeconds(i.velocity||0)}),h=p||0,C=d/(2*Math.sqrt(g*u)),b=l-a,y=millisecondsToSeconds(Math.sqrt(g/u)),G=5>Math.abs(b);if(r||(r=G?.01:2),n||(n=G?.005:.5),C<1){let t=calcAngularFreq(y,C);o=n=>{let r=Math.exp(-C*y*n);return l-r*((h+C*y*b)/t*Math.sin(t*n)+b*Math.cos(t*n))}}else if(1===C)o=t=>l-Math.exp(-y*t)*(b+(h+y*b)*t);else{let t=y*Math.sqrt(C*C-1);o=n=>{let r=Math.exp(-C*y*n),i=Math.min(t*n,300);return l-r*((h+C*y*b)*Math.sinh(i)+t*b*Math.cosh(i))/t}}return{calculatedDuration:m&&I||null,next:t=>{let i=o(t);if(m)c.done=t>=I;else{let a=h;0!==t&&(a=C<1?calcGeneratorVelocity(o,t,i):0);let g=Math.abs(a)<=r,d=Math.abs(l-i)<=n;c.done=g&&d}return c.value=c.done?l:i,c}}}function inertia({keyframes:t,velocity:n=0,power:r=.8,timeConstant:i=325,bounceDamping:o=10,bounceStiffness:a=500,modifyTarget:l,min:c,max:g,restDelta:d=.5,restSpeed:u}){let I,p;let m=t[0],h={done:!1,value:m},isOutOfBounds=t=>void 0!==c&&t<c||void 0!==g&&t>g,nearestBoundary=t=>void 0===c?g:void 0===g?c:Math.abs(c-t)<Math.abs(g-t)?c:g,C=r*n,b=m+C,y=void 0===l?b:l(b);y!==b&&(C=y-m);let calcDelta=t=>-C*Math.exp(-t/i),calcLatest=t=>y+calcDelta(t),applyFriction=t=>{let n=calcDelta(t),r=calcLatest(t);h.done=Math.abs(n)<=d,h.value=h.done?y:r},checkCatchBoundary=t=>{isOutOfBounds(h.value)&&(I=t,p=spring({keyframes:[h.value,nearestBoundary(h.value)],velocity:calcGeneratorVelocity(calcLatest,t,h.value),damping:o,stiffness:a,restDelta:d,restSpeed:u}))};return checkCatchBoundary(0),{calculatedDuration:null,next:t=>{let n=!1;return(p||void 0!==I||(n=!0,applyFriction(t),checkCatchBoundary(t)),void 0!==I&&t>I)?p.next(t-I):(n||applyFriction(t),h)}}}let frameloopDriver=t=>{let passTimestamp=({timestamp:n})=>t(n);return{start:()=>M.Wi.update(passTimestamp,!0),stop:()=>(0,M.Pn)(passTimestamp),now:()=>M.frameData.isProcessing?M.frameData.timestamp:performance.now()}};function calcGeneratorDuration(t){let n=0,r=t.next(n);for(;!r.done&&n<2e4;)n+=50,r=t.next(n);return n>=2e4?1/0:n}let eW={decay:inertia,inertia:inertia,tween:keyframes,keyframes:keyframes,spring:spring};function animateValue({autoplay:t=!0,delay:n=0,driver:r=frameloopDriver,keyframes:i,type:o="keyframes",repeat:a=0,repeatDelay:l=0,repeatType:c="loop",onPlay:g,onStop:d,onComplete:u,onUpdate:I,...p}){let m,h,C,b,y,G=1,A=!1,updateFinishedPromise=()=>{h=new Promise(t=>{m=t})};updateFinishedPromise();let B=eW[o]||keyframes;B!==keyframes&&"number"!=typeof i[0]&&(b=interpolate([0,100],i,{clamp:!1}),i=[0,100]);let Z=B({...p,keyframes:i});"mirror"===c&&(y=B({...p,keyframes:[...i].reverse(),velocity:-(p.velocity||0)}));let f="idle",v=null,W=null,S=null;null===Z.calculatedDuration&&a&&(Z.calculatedDuration=calcGeneratorDuration(Z));let{calculatedDuration:R}=Z,V=1/0,H=1/0;null!==R&&(H=(V=R+l)*(a+1)-l);let N=0,tick=t=>{if(null===W)return;G>0&&(W=Math.min(W,t)),G<0&&(W=Math.min(t-H/G,W)),N=null!==v?v:Math.round(t-W)*G;let r=N-n*(G>=0?1:-1),o=G>=0?r<0:r>H;N=Math.max(r,0),"finished"===f&&null===v&&(N=H);let g=N,d=Z;if(a){let t=Math.min(N,H)/V,n=Math.floor(t),r=t%1;!r&&t>=1&&(r=1),1===r&&n--,n=Math.min(n,a+1);let i=!!(n%2);i&&("reverse"===c?(r=1-r,l&&(r-=l/V)):"mirror"===c&&(d=y)),g=clamp(0,1,r)*V}let u=o?{done:!1,value:i[0]}:d.next(g);b&&(u.value=b(u.value));let{done:p}=u;o||null===R||(p=G>=0?N>=H:N<=0);let m=null===v&&("finished"===f||"running"===f&&p);return I&&I(u.value),m&&finish(),u},stopAnimationDriver=()=>{C&&C.stop(),C=void 0},cancel=()=>{f="idle",stopAnimationDriver(),m(),updateFinishedPromise(),W=S=null},finish=()=>{f="finished",u&&u(),stopAnimationDriver(),m()},play=()=>{if(A)return;C||(C=r(tick));let t=C.now();g&&g(),null!==v?W=t-v:W&&"finished"!==f||(W=t),"finished"===f&&updateFinishedPromise(),S=W,v=null,f="running",C.start()};t&&play();let Y={then:(t,n)=>h.then(t,n),get time(){return millisecondsToSeconds(N)},set time(newTime){N=newTime=secondsToMilliseconds(newTime),null===v&&C&&0!==G?W=C.now()-newTime/G:v=newTime},get duration(){let t=null===Z.calculatedDuration?calcGeneratorDuration(Z):Z.calculatedDuration;return millisecondsToSeconds(t)},get speed(){return G},set speed(newSpeed){if(newSpeed===G||!C)return;G=newSpeed,Y.time=millisecondsToSeconds(N)},get state(){return f},play,pause:()=>{f="paused",v=N},stop:()=>{A=!0,"idle"!==f&&(f="idle",d&&d(),cancel())},cancel:()=>{null!==S&&tick(S),cancel()},complete:()=>{f="finished"},sample:t=>(W=0,tick(t))};return Y}let eS=function(t){let n;return()=>(void 0===n&&(n=t()),n)}(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),eR=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),requiresPregeneratedKeyframes=(t,n)=>"spring"===n.type||"backgroundColor"===t||!function isWaapiSupportedEasing(t){return!!(!t||"string"==typeof t&&ei[t]||isBezierDefinition(t)||Array.isArray(t)&&t.every(isWaapiSupportedEasing))}(n.ease),eV={type:"spring",stiffness:500,damping:25,restSpeed:10},criticallyDampedSpring=t=>({type:"spring",stiffness:550,damping:0===t?2*Math.sqrt(550):30,restSpeed:10}),eH={type:"keyframes",duration:.8},eN={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},getDefaultTransition=(t,{keyframes:n})=>n.length>2?eH:Z.has(t)?t.startsWith("scale")?criticallyDampedSpring(n[1]):eV:eN,isAnimatable=(t,n)=>"zIndex"!==t&&!!("number"==typeof n||Array.isArray(n)||"string"==typeof n&&(eZ.test(n)||"0"===n)&&!n.startsWith("url(")),eY=new Set(["brightness","contrast","saturate","opacity"]);function applyDefaultFilter(t){let[n,r]=t.slice(0,-1).split("(");if("drop-shadow"===n)return t;let[i]=r.match(N)||[];if(!i)return t;let o=r.replace(i,""),a=eY.has(n)?1:0;return i!==r&&(a*=100),n+"("+a+o+")"}let eX=/([a-z-]*)\(.*?\)/g,eE={...eZ,getAnimatableNone:t=>{let n=t.match(eX);return n?n.map(applyDefaultFilter).join(" "):t}},eT={...k,color:eb,backgroundColor:eb,outlineColor:eb,fill:eb,stroke:eb,borderColor:eb,borderTopColor:eb,borderRightColor:eb,borderBottomColor:eb,borderLeftColor:eb,filter:eE,WebkitFilter:eE},getDefaultValueType=t=>eT[t];function animatable_none_getAnimatableNone(t,n){let r=getDefaultValueType(t);return r!==eE&&(r=eZ),r.getAnimatableNone?r.getAnimatableNone(n):void 0}let isZeroValueString=t=>/^0[^.\s]+$/.test(t);function getValueTransition(t,n){return t[n]||t.default||t}let e_={skipAnimations:!1},animateMotionValue=(t,n,r,i={})=>o=>{let a=getValueTransition(i,t)||{},l=a.delay||i.delay||0,{elapsed:c=0}=i;c-=secondsToMilliseconds(l);let g=function(t,n,r,i){let o,a;let l=isAnimatable(n,r);o=Array.isArray(r)?[...r]:[null,r];let c=void 0!==i.from?i.from:t.get(),g=[];for(let t=0;t<o.length;t++){var d;null===o[t]&&(o[t]=0===t?c:o[t-1]),("number"==typeof(d=o[t])?0===d:null!==d?"none"===d||"0"===d||isZeroValueString(d):void 0)&&g.push(t),"string"==typeof o[t]&&"none"!==o[t]&&"0"!==o[t]&&(a=o[t])}if(l&&g.length&&a)for(let t=0;t<g.length;t++){let r=g[t];o[r]=animatable_none_getAnimatableNone(n,a)}return o}(n,t,r,a),d=g[0],u=g[g.length-1],I=isAnimatable(t,d),p=isAnimatable(t,u);(0,en.K)(I===p,`You are trying to animate ${t} from "${d}" to "${u}". ${d} is not an animatable value - to enable this animation set ${d} to a value animatable to ${u} via the \`style\` property.`);let m={keyframes:g,velocity:n.getVelocity(),ease:"easeOut",...a,delay:-c,onUpdate:t=>{n.set(t),a.onUpdate&&a.onUpdate(t)},onComplete:()=>{o(),a.onComplete&&a.onComplete()}};if(!function({when:t,delay:n,delayChildren:r,staggerChildren:i,staggerDirection:o,repeat:a,repeatType:l,repeatDelay:c,from:g,elapsed:d,...u}){return!!Object.keys(u).length}(a)&&(m={...m,...getDefaultTransition(t,m)}),m.duration&&(m.duration=secondsToMilliseconds(m.duration)),m.repeatDelay&&(m.repeatDelay=secondsToMilliseconds(m.repeatDelay)),!I||!p||er.current||!1===a.type||e_.skipAnimations)return function({keyframes:t,delay:n,onUpdate:r,onComplete:i}){let setValue=()=>(r&&r(t[t.length-1]),i&&i(),{time:0,speed:1,duration:0,play:q.Z,pause:q.Z,stop:q.Z,then:t=>(t(),Promise.resolve()),cancel:q.Z,complete:q.Z});return n?animateValue({keyframes:[0,1],duration:0,delay:n,onComplete:setValue}):setValue()}(er.current?{...m,delay:0}:m);if(!i.isHandoff&&n.owner&&n.owner.current instanceof HTMLElement&&!n.owner.getProps().onUpdate){let r=function(t,n,{onUpdate:r,onComplete:i,...o}){let a,l;let c=eS()&&eR.has(n)&&!o.repeatDelay&&"mirror"!==o.repeatType&&0!==o.damping&&"inertia"!==o.type;if(!c)return!1;let g=!1,d=!1,updateFinishedPromise=()=>{l=new Promise(t=>{a=t})};updateFinishedPromise();let{keyframes:u,duration:I=300,ease:p,times:m}=o;if(requiresPregeneratedKeyframes(n,o)){let t=animateValue({...o,repeat:0,delay:0}),n={done:!1,value:u[0]},r=[],i=0;for(;!n.done&&i<2e4;)n=t.sample(i),r.push(n.value),i+=10;m=void 0,u=r,I=i-10,p="linear"}let h=function(t,n,r,{delay:i=0,duration:o,repeat:a=0,repeatType:l="loop",ease:c,times:g}={}){let d={[n]:r};g&&(d.offset=g);let u=function mapEasingToNativeEasing(t){if(t)return isBezierDefinition(t)?cubicBezierAsString(t):Array.isArray(t)?t.map(mapEasingToNativeEasing):ei[t]}(c);return Array.isArray(u)&&(d.easing=u),t.animate(d,{delay:i,duration:o,easing:Array.isArray(u)?"linear":u,fill:"both",iterations:a+1,direction:"reverse"===l?"alternate":"normal"})}(t.owner.current,n,u,{...o,duration:I,ease:p,times:m}),cancelAnimation=()=>{d=!1,h.cancel()},safeCancel=()=>{d=!0,M.Wi.update(cancelAnimation),a(),updateFinishedPromise()};return h.onfinish=()=>{d||(t.set(function(t,{repeat:n,repeatType:r="loop"}){let i=n&&"loop"!==r&&n%2==1?0:t.length-1;return t[i]}(u,o)),i&&i(),safeCancel())},{then:(t,n)=>l.then(t,n),attachTimeline:t=>(h.timeline=t,h.onfinish=null,q.Z),get time(){return millisecondsToSeconds(h.currentTime||0)},set time(newTime){h.currentTime=secondsToMilliseconds(newTime)},get speed(){return h.playbackRate},set speed(newSpeed){h.playbackRate=newSpeed},get duration(){return millisecondsToSeconds(I)},play:()=>{g||(h.play(),(0,M.Pn)(cancelAnimation))},pause:()=>h.pause(),stop:()=>{if(g=!0,"idle"===h.playState)return;let{currentTime:n}=h;if(n){let r=animateValue({...o,autoplay:!1});t.setWithVelocity(r.sample(n-10).value,r.sample(n).value,10)}safeCancel()},complete:()=>{d||h.finish()},cancel:safeCancel}}(n,t,m);if(r)return r}return animateValue(m)};function isWillChangeMotionValue(t){return!!(isMotionValue(t)&&t.add)}let isNumericalString=t=>/^\-?\d*\.?\d+$/.test(t);function addUniqueItem(t,n){-1===t.indexOf(n)&&t.push(n)}function removeItem(t,n){let r=t.indexOf(n);r>-1&&t.splice(r,1)}let SubscriptionManager=class SubscriptionManager{constructor(){this.subscriptions=[]}add(t){return addUniqueItem(this.subscriptions,t),()=>removeItem(this.subscriptions,t)}notify(t,n,r){let i=this.subscriptions.length;if(i){if(1===i)this.subscriptions[0](t,n,r);else for(let o=0;o<i;o++){let i=this.subscriptions[o];i&&i(t,n,r)}}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}};let isFloat=t=>!isNaN(parseFloat(t)),ew={current:void 0};let MotionValue=class MotionValue{constructor(t,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(t,n=!0)=>{this.prev=this.current,this.current=t;let{delta:r,timestamp:i}=M.frameData;this.lastUpdated!==i&&(this.timeDelta=r,this.lastUpdated=i,M.Wi.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>M.Wi.postRender(this.velocityCheck),this.velocityCheck=({timestamp:t})=>{t!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=t,this.canTrackVelocity=isFloat(this.current),this.owner=n.owner}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new SubscriptionManager);let r=this.events[t].add(n);return"change"===t?()=>{r(),M.Wi.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(let t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){n&&this.passiveEffect?this.passiveEffect(t,this.updateAndNotify):this.updateAndNotify(t,n)}setWithVelocity(t,n,r){this.set(n),this.prev=t,this.timeDelta=r}jump(t){this.updateAndNotify(t),this.prev=t,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return ew.current&&ew.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){var t,n;return this.canTrackVelocity?(t=parseFloat(this.current)-parseFloat(this.prev),(n=this.timeDelta)?t*(1e3/n):0):0}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}};function motionValue(t,n){return new MotionValue(t,n)}let testValueType=t=>n=>n.test(t),eF=[R,_,T,E,F,w,{test:t=>"auto"===t,parse:t=>t}],findDimensionValueType=t=>eF.find(testValueType(t)),eK=[...eF,eb,eZ],findValueType=t=>eK.find(testValueType(t));function animateTarget(t,n,{delay:r=0,transitionOverride:i,type:o}={}){let{transition:a=t.getDefaultTransition(),transitionEnd:l,...c}=t.makeTargetAnimatable(n),g=t.getValue("willChange");i&&(a=i);let u=[],I=o&&t.animationState&&t.animationState.getState()[o];for(let n in c){let i=t.getValue(n),o=c[n];if(!i||void 0===o||I&&function({protectedKeys:t,needsAnimating:n},r){let i=t.hasOwnProperty(r)&&!0!==n[r];return n[r]=!1,i}(I,n))continue;let l={delay:r,elapsed:0,...getValueTransition(a||{},n)};if(window.HandoffAppearAnimations){let r=t.getProps()[d];if(r){let t=window.HandoffAppearAnimations(r,n,i,M.Wi);null!==t&&(l.elapsed=t,l.isHandoff=!0)}}let p=!l.isHandoff&&!function(t,n){let r=t.get();if(!Array.isArray(n))return r!==n;for(let t=0;t<n.length;t++)if(n[t]!==r)return!0}(i,o);if("spring"===l.type&&(i.getVelocity()||l.velocity)&&(p=!1),i.animation&&(p=!1),p)continue;i.start(animateMotionValue(n,i,o,t.shouldReduceMotion&&Z.has(n)?{type:!1}:l));let m=i.animation;isWillChangeMotionValue(g)&&(g.add(n),m.then(()=>g.remove(n))),u.push(m)}return l&&Promise.all(u).then(()=>{l&&function(t,n){let r=resolveVariant(t,n),{transitionEnd:i={},transition:o={},...a}=r?t.makeTargetAnimatable(r,!1):{};for(let n in a={...a,...i}){let r=resolveFinalValueInKeyframes(a[n]);t.hasValue(n)?t.getValue(n).set(r):t.addValue(n,motionValue(r))}}(t,l)}),u}function animateVariant(t,n,r={}){let i=resolveVariant(t,n,r.custom),{transition:o=t.getDefaultTransition()||{}}=i||{};r.transitionOverride&&(o=r.transitionOverride);let a=i?()=>Promise.all(animateTarget(t,i,r)):()=>Promise.resolve(),l=t.variantChildren&&t.variantChildren.size?(i=0)=>{let{delayChildren:a=0,staggerChildren:l,staggerDirection:c}=o;return function(t,n,r=0,i=0,o=1,a){let l=[],c=(t.variantChildren.size-1)*i,g=1===o?(t=0)=>t*i:(t=0)=>c-t*i;return Array.from(t.variantChildren).sort(sortByTreeOrder).forEach((t,i)=>{t.notify("AnimationStart",n),l.push(animateVariant(t,n,{...a,delay:r+g(i)}).then(()=>t.notify("AnimationComplete",n)))}),Promise.all(l)}(t,n,a+i,l,c,r)}:()=>Promise.resolve(),{when:c}=o;if(!c)return Promise.all([a(),l(r.delay)]);{let[t,n]="beforeChildren"===c?[a,l]:[l,a];return t().then(()=>n())}}function sortByTreeOrder(t,n){return t.sortNodePosition(n)}let ex=[...u].reverse(),ek=u.length;function createTypeState(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}let eU=0,distance=(t,n)=>Math.abs(t-n);let PanSession=class PanSession{constructor(t,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:o=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let t=getPanInfo(this.lastMoveEventInfo,this.history),n=null!==this.startEvent,r=function(t,n){let r=distance(t.x,n.x),i=distance(t.y,n.y);return Math.sqrt(r**2+i**2)}(t.offset,{x:0,y:0})>=3;if(!n&&!r)return;let{point:i}=t,{timestamp:o}=M.frameData;this.history.push({...i,timestamp:o});let{onStart:a,onMove:l}=this.handlers;n||(a&&a(this.lastMoveEvent,t),this.startEvent=this.lastMoveEvent),l&&l(this.lastMoveEvent,t)},this.handlePointerMove=(t,n)=>{this.lastMoveEvent=t,this.lastMoveEventInfo=transformPoint(n,this.transformPagePoint),M.Wi.update(this.updatePoint,!0)},this.handlePointerUp=(t,n)=>{this.end();let{onEnd:r,onSessionEnd:i,resumeAnimation:o}=this.handlers;if(this.dragSnapToOrigin&&o&&o(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let a=getPanInfo("pointercancel"===t.type?this.lastMoveEventInfo:transformPoint(n,this.transformPagePoint),this.history);this.startEvent&&r&&r(t,a),i&&i(t,a)},!isPrimaryPointer(t))return;this.dragSnapToOrigin=o,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;let a=extractEventInfo(t),l=transformPoint(a,this.transformPagePoint),{point:c}=l,{timestamp:g}=M.frameData;this.history=[{...c,timestamp:g}];let{onSessionStart:d}=n;d&&d(t,getPanInfo(l,this.history)),this.removeListeners=pipe(addPointerEvent(this.contextWindow,"pointermove",this.handlePointerMove),addPointerEvent(this.contextWindow,"pointerup",this.handlePointerUp),addPointerEvent(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),(0,M.Pn)(this.updatePoint)}};function transformPoint(t,n){return n?{point:n(t.point)}:t}function subtractPoint(t,n){return{x:t.x-n.x,y:t.y-n.y}}function getPanInfo({point:t},n){return{point:t,delta:subtractPoint(t,lastDevicePoint(n)),offset:subtractPoint(t,n[0]),velocity:function(t,n){if(t.length<2)return{x:0,y:0};let r=t.length-1,i=null,o=lastDevicePoint(t);for(;r>=0&&(i=t[r],!(o.timestamp-i.timestamp>secondsToMilliseconds(.1)));)r--;if(!i)return{x:0,y:0};let a=millisecondsToSeconds(o.timestamp-i.timestamp);if(0===a)return{x:0,y:0};let l={x:(o.x-i.x)/a,y:(o.y-i.y)/a};return l.x===1/0&&(l.x=0),l.y===1/0&&(l.y=0),l}(n,0)}}function lastDevicePoint(t){return t[t.length-1]}function calcLength(t){return t.max-t.min}function isNear(t,n=0,r=.01){return Math.abs(t-n)<=r}function calcAxisDelta(t,n,r,i=.5){t.origin=i,t.originPoint=mix(n.min,n.max,t.origin),t.scale=calcLength(r)/calcLength(n),(isNear(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=mix(r.min,r.max,t.origin)-t.originPoint,(isNear(t.translate)||isNaN(t.translate))&&(t.translate=0)}function calcBoxDelta(t,n,r,i){calcAxisDelta(t.x,n.x,r.x,i?i.originX:void 0),calcAxisDelta(t.y,n.y,r.y,i?i.originY:void 0)}function calcRelativeAxis(t,n,r){t.min=r.min+n.min,t.max=t.min+calcLength(n)}function calcRelativeAxisPosition(t,n,r){t.min=n.min-r.min,t.max=t.min+calcLength(n)}function calcRelativePosition(t,n,r){calcRelativeAxisPosition(t.x,n.x,r.x),calcRelativeAxisPosition(t.y,n.y,r.y)}function calcRelativeAxisConstraints(t,n,r){return{min:void 0!==n?t.min+n:void 0,max:void 0!==r?t.max+r-(t.max-t.min):void 0}}function calcViewportAxisConstraints(t,n){let r=n.min-t.min,i=n.max-t.max;return n.max-n.min<t.max-t.min&&([r,i]=[i,r]),{min:r,max:i}}function resolveAxisElastic(t,n,r){return{min:resolvePointElastic(t,n),max:resolvePointElastic(t,r)}}function resolvePointElastic(t,n){return"number"==typeof t?t:t[n]||0}let createAxisDelta=()=>({translate:0,scale:1,origin:0,originPoint:0}),createDelta=()=>({x:createAxisDelta(),y:createAxisDelta()}),createAxis=()=>({min:0,max:0}),createBox=()=>({x:createAxis(),y:createAxis()});function eachAxis(t){return[t("x"),t("y")]}function convertBoundingBoxToBox({top:t,left:n,right:r,bottom:i}){return{x:{min:n,max:r},y:{min:t,max:i}}}function isIdentityScale(t){return void 0===t||1===t}function hasScale({scale:t,scaleX:n,scaleY:r}){return!isIdentityScale(t)||!isIdentityScale(n)||!isIdentityScale(r)}function hasTransform(t){return hasScale(t)||has2DTranslate(t)||t.z||t.rotate||t.rotateX||t.rotateY}function has2DTranslate(t){var n,r;return(n=t.x)&&"0%"!==n||(r=t.y)&&"0%"!==r}function applyPointDelta(t,n,r,i,o){return void 0!==o&&(t=i+o*(t-i)),i+r*(t-i)+n}function applyAxisDelta(t,n=0,r=1,i,o){t.min=applyPointDelta(t.min,n,r,i,o),t.max=applyPointDelta(t.max,n,r,i,o)}function applyBoxDelta(t,{x:n,y:r}){applyAxisDelta(t.x,n.translate,n.scale,n.originPoint),applyAxisDelta(t.y,r.translate,r.scale,r.originPoint)}function snapToDefault(t){return Number.isInteger(t)?t:t>1.0000000000001||t<.999999999999?t:1}function translateAxis(t,n){t.min=t.min+n,t.max=t.max+n}function transformAxis(t,n,[r,i,o]){let a=void 0!==n[o]?n[o]:.5,l=mix(t.min,t.max,a);applyAxisDelta(t,n[r],n[i],l,n.scale)}let eJ=["x","scaleX","originX"],eL=["y","scaleY","originY"];function transformBox(t,n){transformAxis(t.x,n,eJ),transformAxis(t.y,n,eL)}function measureViewportBox(t,n){return convertBoundingBoxToBox(function(t,n){if(!n)return t;let r=n({x:t.left,y:t.top}),i=n({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:i.y,right:i.x}}(t.getBoundingClientRect(),n))}let getContextWindow=({current:t})=>t?t.ownerDocument.defaultView:null,ez=new WeakMap;let VisualElementDragControls=class VisualElementDragControls{constructor(t){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=createBox(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){let{presenceContext:r}=this.visualElement;if(r&&!1===r.isPresent)return;let{dragSnapToOrigin:i}=this.getProps();this.panSession=new PanSession(t,{onSessionStart:t=>{let{dragSnapToOrigin:r}=this.getProps();r?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(extractEventInfo(t,"page").point)},onStart:(t,n)=>{let{drag:r,dragPropagation:i,onDragStart:o}=this.getProps();if(r&&!i&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=getGlobalLock(r),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),eachAxis(t=>{let n=this.getAxisMotionValue(t).get()||0;if(T.test(n)){let{projection:r}=this.visualElement;if(r&&r.layout){let i=r.layout.layoutBox[t];if(i){let t=calcLength(i);n=t*(parseFloat(n)/100)}}}this.originPoint[t]=n}),o&&M.Wi.update(()=>o(t,n),!1,!0);let{animationState:a}=this.visualElement;a&&a.setActive("whileDrag",!0)},onMove:(t,n)=>{let{dragPropagation:r,dragDirectionLock:i,onDirectionLock:o,onDrag:a}=this.getProps();if(!r&&!this.openGlobalLock)return;let{offset:l}=n;if(i&&null===this.currentDirection){this.currentDirection=function(t,n=10){let r=null;return Math.abs(t.y)>n?r="y":Math.abs(t.x)>n&&(r="x"),r}(l),null!==this.currentDirection&&o&&o(this.currentDirection);return}this.updateAxis("x",n.point,l),this.updateAxis("y",n.point,l),this.visualElement.render(),a&&a(t,n)},onSessionEnd:(t,n)=>this.stop(t,n),resumeAnimation:()=>eachAxis(t=>{var n;return"paused"===this.getAnimationState(t)&&(null===(n=this.getAxisMotionValue(t).animation)||void 0===n?void 0:n.play())})},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:i,contextWindow:getContextWindow(this.visualElement)})}stop(t,n){let r=this.isDragging;if(this.cancel(),!r)return;let{velocity:i}=n;this.startAnimation(i);let{onDragEnd:o}=this.getProps();o&&M.Wi.update(()=>o(t,n))}cancel(){this.isDragging=!1;let{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){let{drag:i}=this.getProps();if(!r||!shouldDrag(t,i,this.currentDirection))return;let o=this.getAxisMotionValue(t),a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=function(t,{min:n,max:r},i){return void 0!==n&&t<n?t=i?mix(n,t,i.min):Math.max(t,n):void 0!==r&&t>r&&(t=i?mix(r,t,i.max):Math.min(t,r)),t}(a,this.constraints[t],this.elastic[t])),o.set(a)}resolveConstraints(){var t;let{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):null===(t=this.visualElement.projection)||void 0===t?void 0:t.layout,o=this.constraints;n&&isRefObject(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=function(t,{top:n,left:r,bottom:i,right:o}){return{x:calcRelativeAxisConstraints(t.x,r,o),y:calcRelativeAxisConstraints(t.y,n,i)}}(i.layoutBox,n):this.constraints=!1,this.elastic=function(t=.35){return!1===t?t=0:!0===t&&(t=.35),{x:resolveAxisElastic(t,"left","right"),y:resolveAxisElastic(t,"top","bottom")}}(r),o!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&eachAxis(t=>{this.getAxisMotionValue(t)&&(this.constraints[t]=function(t,n){let r={};return void 0!==n.min&&(r.min=n.min-t.min),void 0!==n.max&&(r.max=n.max-t.min),r}(i.layoutBox[t],this.constraints[t]))})}resolveRefConstraints(){var t;let{dragConstraints:n,onMeasureDragConstraints:r}=this.getProps();if(!n||!isRefObject(n))return!1;let i=n.current;(0,en.k)(null!==i,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:o}=this.visualElement;if(!o||!o.layout)return!1;let a=function(t,n,r){let i=measureViewportBox(t,r),{scroll:o}=n;return o&&(translateAxis(i.x,o.offset.x),translateAxis(i.y,o.offset.y)),i}(i,o.root,this.visualElement.getTransformPagePoint()),l={x:calcViewportAxisConstraints((t=o.layout.layoutBox).x,a.x),y:calcViewportAxisConstraints(t.y,a.y)};if(r){let t=r(function({x:t,y:n}){return{top:n.min,right:t.max,bottom:n.max,left:t.min}}(l));this.hasMutatedConstraints=!!t,t&&(l=convertBoundingBoxToBox(t))}return l}startAnimation(t){let{drag:n,dragMomentum:r,dragElastic:i,dragTransition:o,dragSnapToOrigin:a,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},g=eachAxis(l=>{if(!shouldDrag(l,n,this.currentDirection))return;let g=c&&c[l]||{};a&&(g={min:0,max:0});let d={type:"inertia",velocity:r?t[l]:0,bounceStiffness:i?200:1e6,bounceDamping:i?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...o,...g};return this.startAxisValueAnimation(l,d)});return Promise.all(g).then(l)}startAxisValueAnimation(t,n){let r=this.getAxisMotionValue(t);return r.start(animateMotionValue(t,r,0,n))}stopAnimation(){eachAxis(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){eachAxis(t=>{var n;return null===(n=this.getAxisMotionValue(t).animation)||void 0===n?void 0:n.pause()})}getAnimationState(t){var n;return null===(n=this.getAxisMotionValue(t).animation)||void 0===n?void 0:n.state}getAxisMotionValue(t){let n="_drag"+t.toUpperCase(),r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){eachAxis(n=>{let{drag:r}=this.getProps();if(!shouldDrag(n,r,this.currentDirection))return;let{projection:i}=this.visualElement,o=this.getAxisMotionValue(n);if(i&&i.layout){let{min:r,max:a}=i.layout.layoutBox[n];o.set(t[n]-mix(r,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!isRefObject(n)||!r||!this.constraints)return;this.stopAnimation();let i={x:0,y:0};eachAxis(t=>{let n=this.getAxisMotionValue(t);if(n){let r=n.get();i[t]=function(t,n){let r=.5,i=calcLength(t),o=calcLength(n);return o>i?r=progress(n.min,n.max-i,t.min):i>o&&(r=progress(t.min,t.max-o,n.min)),clamp(0,1,r)}({min:r,max:r},this.constraints[t])}});let{transformTemplate:o}=this.visualElement.getProps();this.visualElement.current.style.transform=o?o({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),eachAxis(n=>{if(!shouldDrag(n,t,null))return;let r=this.getAxisMotionValue(n),{min:o,max:a}=this.constraints[n];r.set(mix(o,a,i[n]))})}addListeners(){if(!this.visualElement.current)return;ez.set(this.visualElement,this);let t=this.visualElement.current,n=addPointerEvent(t,"pointerdown",t=>{let{drag:n,dragListener:r=!0}=this.getProps();n&&r&&this.start(t)}),measureDragConstraints=()=>{let{dragConstraints:t}=this.getProps();isRefObject(t)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",measureDragConstraints);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),measureDragConstraints();let o=addDomEvent(window,"resize",()=>this.scalePositionWithinConstraints()),a=r.addEventListener("didUpdate",({delta:t,hasLayoutChanged:n})=>{this.isDragging&&n&&(eachAxis(n=>{let r=this.getAxisMotionValue(n);r&&(this.originPoint[n]+=t[n].translate,r.set(r.get()+t[n].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),a&&a()}}getProps(){let t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:o=!1,dragElastic:a=.35,dragMomentum:l=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:o,dragElastic:a,dragMomentum:l}}};function shouldDrag(t,n,r){return(!0===n||n===t)&&(null===r||r===t)}let asyncHandler=t=>(n,r)=>{t&&M.Wi.update(()=>t(n,r))},eP={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function pixelsToPercent(t,n){return n.max===n.min?0:t/(n.max-n.min)*100}let eM={correct:(t,n)=>{if(!n.target)return t;if("string"==typeof t){if(!_.test(t))return t;t=parseFloat(t)}let r=pixelsToPercent(t,n.target.x),i=pixelsToPercent(t,n.target.y);return`${r}% ${i}%`}};let MeasureLayoutWithContext=class MeasureLayoutWithContext extends i.Component{componentDidMount(){let{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:o}=t;Object.assign(A,eO),o&&(n.group&&n.group.add(o),r&&r.register&&i&&r.register(o),o.root.didUpdate(),o.addEventListener("animationComplete",()=>{this.safeToRemove()}),o.setOptions({...o.options,onExitComplete:()=>this.safeToRemove()})),eP.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){let{layoutDependency:n,visualElement:r,drag:i,isPresent:o}=this.props,a=r.projection;return a&&(a.isPresent=o,i||t.layoutDependency!==n||void 0===n?a.willUpdate():this.safeToRemove(),t.isPresent===o||(o?a.promote():a.relegate()||M.Wi.postRender(()=>{let t=a.getStack();t&&t.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),queueMicrotask(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){let{safeToRemove:t}=this.props;t&&t()}render(){return null}};function MeasureLayout(t){let[n,r]=function(){let t=(0,i.useContext)(l.O);if(null===t)return[!0,null];let{isPresent:n,onExitComplete:r,register:o}=t,a=(0,i.useId)();return(0,i.useEffect)(()=>o(a),[]),!n&&r?[!1,()=>r&&r(a)]:[!0]}(),o=(0,i.useContext)(C.p);return i.createElement(MeasureLayoutWithContext,{...t,layoutGroup:o,switchLayoutGroup:(0,i.useContext)(b),isPresent:n,safeToRemove:r})}let eO={borderRadius:{...eM,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:eM,borderTopRightRadius:eM,borderBottomLeftRadius:eM,borderBottomRightRadius:eM,boxShadow:{correct:(t,{treeScale:n,projectionDelta:r})=>{let i=eZ.parse(t);if(i.length>5)return t;let o=eZ.createTransformer(t),a="number"!=typeof i[0]?1:0,l=r.x.scale*n.x,c=r.y.scale*n.y;i[0+a]/=l,i[1+a]/=c;let g=mix(l,c,.5);return"number"==typeof i[2+a]&&(i[2+a]/=g),"number"==typeof i[3+a]&&(i[3+a]/=g),o(i)}}},ej=["TopLeft","TopRight","BottomLeft","BottomRight"],eD=ej.length,asNumber=t=>"string"==typeof t?parseFloat(t):t,isPx=t=>"number"==typeof t||_.test(t);function getRadius(t,n){return void 0!==t[n]?t[n]:t.borderRadius}let eQ=compress(0,.5,el),eq=compress(.5,.95,q.Z);function compress(t,n,r){return i=>i<t?0:i>n?1:r(progress(t,n,i))}function copyAxisInto(t,n){t.min=n.min,t.max=n.max}function copyBoxInto(t,n){copyAxisInto(t.x,n.x),copyAxisInto(t.y,n.y)}function removePointDelta(t,n,r,i,o){return t-=n,t=i+1/r*(t-i),void 0!==o&&(t=i+1/o*(t-i)),t}function removeAxisTransforms(t,n,[r,i,o],a,l){!function(t,n=0,r=1,i=.5,o,a=t,l=t){if(T.test(n)){n=parseFloat(n);let t=mix(l.min,l.max,n/100);n=t-l.min}if("number"!=typeof n)return;let c=mix(a.min,a.max,i);t===a&&(c-=n),t.min=removePointDelta(t.min,n,r,c,o),t.max=removePointDelta(t.max,n,r,c,o)}(t,n[r],n[i],n[o],n.scale,a,l)}let e$=["x","scaleX","originX"],e0=["y","scaleY","originY"];function removeBoxTransforms(t,n,r,i){removeAxisTransforms(t.x,n,e$,r?r.x:void 0,i?i.x:void 0),removeAxisTransforms(t.y,n,e0,r?r.y:void 0,i?i.y:void 0)}function isAxisDeltaZero(t){return 0===t.translate&&1===t.scale}function isDeltaZero(t){return isAxisDeltaZero(t.x)&&isAxisDeltaZero(t.y)}function boxEqualsRounded(t,n){return Math.round(t.x.min)===Math.round(n.x.min)&&Math.round(t.x.max)===Math.round(n.x.max)&&Math.round(t.y.min)===Math.round(n.y.min)&&Math.round(t.y.max)===Math.round(n.y.max)}function aspectRatio(t){return calcLength(t.x)/calcLength(t.y)}let NodeStack=class NodeStack{constructor(){this.members=[]}add(t){addUniqueItem(this.members,t),t.scheduleRender()}remove(t){if(removeItem(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){let t=this.members[this.members.length-1];t&&this.promote(t)}}relegate(t){let n;let r=this.members.findIndex(n=>t===n);if(0===r)return!1;for(let t=r;t>=0;t--){let r=this.members[t];if(!1!==r.isPresent){n=r;break}}return!!n&&(this.promote(n),!0)}promote(t,n){let r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);let{crossfade:i}=t.options;!1===i&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{let{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}};function buildProjectionTransform(t,n,r){let i="",o=t.x.translate/n.x,a=t.y.translate/n.y;if((o||a)&&(i=`translate3d(${o}px, ${a}px, 0) `),(1!==n.x||1!==n.y)&&(i+=`scale(${1/n.x}, ${1/n.y}) `),r){let{rotate:t,rotateX:n,rotateY:o}=r;t&&(i+=`rotate(${t}deg) `),n&&(i+=`rotateX(${n}deg) `),o&&(i+=`rotateY(${o}deg) `)}let l=t.x.scale*n.x,c=t.y.scale*n.y;return(1!==l||1!==c)&&(i+=`scale(${l}, ${c})`),i||"none"}let compareByDepth=(t,n)=>t.depth-n.depth;let FlatTree=class FlatTree{constructor(){this.children=[],this.isDirty=!1}add(t){addUniqueItem(this.children,t),this.isDirty=!0}remove(t){removeItem(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(compareByDepth),this.isDirty=!1,this.children.forEach(t)}};let e2=["","X","Y","Z"],e1={visibility:"hidden"},e5=0,e9={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function createProjectionNode({attachResizeListener:t,defaultParent:n,measureScroll:r,checkIsScrollRoot:i,resetTransform:o}){return class{constructor(t={},r=null==n?void 0:n()){this.id=e5++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,e9.totalNodes=e9.resolvedTargetDeltas=e9.recalculatedProjection=0,this.nodes.forEach(propagateDirtyNodes),this.nodes.forEach(resolveTargetDelta),this.nodes.forEach(calcProjection),this.nodes.forEach(cleanDirtyNodes),window.MotionDebug&&window.MotionDebug.record(e9)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=t,this.root=r?r.root||r:this,this.path=r?[...r.path,r]:[],this.parent=r,this.depth=r?r.depth+1:0;for(let t=0;t<this.path.length;t++)this.path[t].shouldResetTransform=!0;this.root===this&&(this.nodes=new FlatTree)}addEventListener(t,n){return this.eventHandlers.has(t)||this.eventHandlers.set(t,new SubscriptionManager),this.eventHandlers.get(t).add(n)}notifyListeners(t,...n){let r=this.eventHandlers.get(t);r&&r.notify(...n)}hasListeners(t){return this.eventHandlers.has(t)}mount(n,r=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=n instanceof SVGElement&&"svg"!==n.tagName,this.instance=n;let{layoutId:i,layout:o,visualElement:a}=this.options;if(a&&!a.current&&a.mount(n),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),r&&(o||i)&&(this.isLayoutDirty=!0),t){let r;let resizeUnblockUpdate=()=>this.root.updateBlockedByResize=!1;t(n,()=>{this.root.updateBlockedByResize=!0,r&&r(),r=function(t,n){let r=performance.now(),checkElapsed=({timestamp:i})=>{let o=i-r;o>=n&&((0,M.Pn)(checkElapsed),t(o-n))};return M.Wi.read(checkElapsed,!0),()=>(0,M.Pn)(checkElapsed)}(resizeUnblockUpdate,250),eP.hasAnimatedSinceResize&&(eP.hasAnimatedSinceResize=!1,this.nodes.forEach(finishAnimation))})}i&&this.root.registerSharedNode(i,this),!1!==this.options.animate&&a&&(i||o)&&this.addEventListener("didUpdate",({delta:t,hasLayoutChanged:n,hasRelativeTargetChanged:r,layout:i})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let o=this.options.transition||a.getDefaultTransition()||e3,{onLayoutAnimationStart:l,onLayoutAnimationComplete:c}=a.getProps(),g=!this.targetLayout||!boxEqualsRounded(this.targetLayout,i)||r,d=!n&&r;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||d||n&&(g||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(t,d);let n={...getValueTransition(o,"layout"),onPlay:l,onComplete:c};(a.shouldReduceMotion||this.options.layoutRoot)&&(n.delay=0,n.type=!1),this.startAnimation(n)}else n||finishAnimation(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=i})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let t=this.getStack();t&&t.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,(0,M.Pn)(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(resetRotation),this.animationId++)}getTransformTemplate(){let{visualElement:t}=this.options;return t&&t.getProps().transformTemplate}willUpdate(t=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let t=0;t<this.path.length;t++){let n=this.path[t];n.shouldResetTransform=!0,n.updateScroll("snapshot"),n.options.layoutRoot&&n.willUpdate(!1)}let{layoutId:n,layout:r}=this.options;if(void 0===n&&!r)return;let i=this.getTransformTemplate();this.prevTransformTemplateValue=i?i(this.latestValues,""):void 0,this.updateSnapshot(),t&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;let t=this.isUpdateBlocked();if(t){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(clearMeasurements);return}this.isUpdating||this.nodes.forEach(clearIsLayoutDirty),this.isUpdating=!1,this.nodes.forEach(resetTransformStyle),this.nodes.forEach(updateLayout),this.nodes.forEach(notifyLayoutUpdate),this.clearAllSnapshots();let n=performance.now();M.frameData.delta=clamp(0,1e3/60,n-M.frameData.timestamp),M.frameData.timestamp=n,M.frameData.isProcessing=!0,M.S6.update.process(M.frameData),M.S6.preRender.process(M.frameData),M.S6.render.process(M.frameData),M.frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(clearSnapshot),this.sharedNodes.forEach(removeLeadSnapshots)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,M.Wi.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){M.Wi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let t=0;t<this.path.length;t++){let n=this.path[t];n.updateScroll()}let t=this.layout;this.layout=this.measure(!1),this.layoutCorrected=createBox(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:n}=this.options;n&&n.notify("LayoutMeasure",this.layout.layoutBox,t?t.layoutBox:void 0)}updateScroll(t="measure"){let n=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===t&&(n=!1),n&&(this.scroll={animationId:this.root.animationId,phase:t,isRoot:i(this.instance),offset:r(this.instance)})}resetTransform(){if(!o)return;let t=this.isLayoutDirty||this.shouldResetTransform,n=this.projectionDelta&&!isDeltaZero(this.projectionDelta),r=this.getTransformTemplate(),i=r?r(this.latestValues,""):void 0,a=i!==this.prevTransformTemplateValue;t&&(n||hasTransform(this.latestValues)||a)&&(o(this.instance,i),this.shouldResetTransform=!1,this.scheduleRender())}measure(t=!0){var n;let r=this.measurePageBox(),i=this.removeElementScroll(r);return t&&(i=this.removeTransform(i)),roundAxis((n=i).x),roundAxis(n.y),{animationId:this.root.animationId,measuredBox:r,layoutBox:i,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:t}=this.options;if(!t)return createBox();let n=t.measureViewportBox(),{scroll:r}=this.root;return r&&(translateAxis(n.x,r.offset.x),translateAxis(n.y,r.offset.y)),n}removeElementScroll(t){let n=createBox();copyBoxInto(n,t);for(let r=0;r<this.path.length;r++){let i=this.path[r],{scroll:o,options:a}=i;if(i!==this.root&&o&&a.layoutScroll){if(o.isRoot){copyBoxInto(n,t);let{scroll:r}=this.root;r&&(translateAxis(n.x,-r.offset.x),translateAxis(n.y,-r.offset.y))}translateAxis(n.x,o.offset.x),translateAxis(n.y,o.offset.y)}}return n}applyTransform(t,n=!1){let r=createBox();copyBoxInto(r,t);for(let t=0;t<this.path.length;t++){let i=this.path[t];!n&&i.options.layoutScroll&&i.scroll&&i!==i.root&&transformBox(r,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),hasTransform(i.latestValues)&&transformBox(r,i.latestValues)}return hasTransform(this.latestValues)&&transformBox(r,this.latestValues),r}removeTransform(t){let n=createBox();copyBoxInto(n,t);for(let t=0;t<this.path.length;t++){let r=this.path[t];if(!r.instance||!hasTransform(r.latestValues))continue;hasScale(r.latestValues)&&r.updateSnapshot();let i=createBox(),o=r.measurePageBox();copyBoxInto(i,o),removeBoxTransforms(n,r.latestValues,r.snapshot?r.snapshot.layoutBox:void 0,i)}return hasTransform(this.latestValues)&&removeBoxTransforms(n,this.latestValues),n}setTargetDelta(t){this.targetDelta=t,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(t){this.options={...this.options,...t,crossfade:void 0===t.crossfade||t.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==M.frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(t=!1){var n,r,i,o;let a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);let l=!!this.resumingFrom||this!==a,c=!(t||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(n=this.parent)||void 0===n?void 0:n.isProjectionDirty)||this.attemptToResolveRelativeTarget);if(c)return;let{layout:g,layoutId:d}=this.options;if(this.layout&&(g||d)){if(this.resolvedRelativeTargetAt=M.frameData.timestamp,!this.targetDelta&&!this.relativeTarget){let t=this.getClosestProjectingParent();t&&t.layout&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.layout.layoutBox,t.layout.layoutBox),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if((this.target||(this.target=createBox(),this.targetWithTransforms=createBox()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target)?(this.forceRelativeParentToResolveTarget(),r=this.target,i=this.relativeTarget,o=this.relativeParent.target,calcRelativeAxis(r.x,i.x,o.x),calcRelativeAxis(r.y,i.y,o.y)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):copyBoxInto(this.target,this.layout.layoutBox),applyBoxDelta(this.target,this.targetDelta)):copyBoxInto(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let t=this.getClosestProjectingParent();t&&!!t.resumingFrom==!!this.resumingFrom&&!t.options.layoutScroll&&t.target&&1!==this.animationProgress?(this.relativeParent=t,this.forceRelativeParentToResolveTarget(),this.relativeTarget=createBox(),this.relativeTargetOrigin=createBox(),calcRelativePosition(this.relativeTargetOrigin,this.target,t.target),copyBoxInto(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}e9.resolvedTargetDeltas++}}}getClosestProjectingParent(){return!this.parent||hasScale(this.parent.latestValues)||has2DTranslate(this.parent.latestValues)?void 0:this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var t;let n=this.getLead(),r=!!this.resumingFrom||this!==n,i=!0;if((this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty))&&(i=!1),r&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(i=!1),this.resolvedRelativeTargetAt===M.frameData.timestamp&&(i=!1),i)return;let{layout:o,layoutId:a}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(o||a))return;copyBoxInto(this.layoutCorrected,this.layout.layoutBox);let l=this.treeScale.x,c=this.treeScale.y;(function(t,n,r,i=!1){let o,a;let l=r.length;if(l){n.x=n.y=1;for(let c=0;c<l;c++){a=(o=r[c]).projectionDelta;let l=o.instance;(!l||!l.style||"contents"!==l.style.display)&&(i&&o.options.layoutScroll&&o.scroll&&o!==o.root&&transformBox(t,{x:-o.scroll.offset.x,y:-o.scroll.offset.y}),a&&(n.x*=a.x.scale,n.y*=a.y.scale,applyBoxDelta(t,a)),i&&hasTransform(o.latestValues)&&transformBox(t,o.latestValues))}n.x=snapToDefault(n.x),n.y=snapToDefault(n.y)}})(this.layoutCorrected,this.treeScale,this.path,r),n.layout&&!n.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(n.target=n.layout.layoutBox);let{target:g}=n;if(!g){this.projectionTransform&&(this.projectionDelta=createDelta(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=createDelta(),this.projectionDeltaWithTransform=createDelta());let d=this.projectionTransform;calcBoxDelta(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=buildProjectionTransform(this.projectionDelta,this.treeScale),(this.projectionTransform!==d||this.treeScale.x!==l||this.treeScale.y!==c)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),e9.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(t=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),t){let t=this.getStack();t&&t.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(t,n=!1){let r;let i=this.snapshot,o=i?i.latestValues:{},a={...this.latestValues},l=createDelta();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!n;let c=createBox(),g=i?i.source:void 0,d=this.layout?this.layout.source:void 0,u=g!==d,I=this.getStack(),p=!I||I.members.length<=1,m=!!(u&&!p&&!0===this.options.crossfade&&!this.path.some(hasOpacityCrossfade));this.animationProgress=0,this.mixTargetDelta=n=>{let i=n/1e3;if(mixAxisDelta(l.x,t.x,i),mixAxisDelta(l.y,t.y,i),this.setTargetDelta(l),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout){var g,d,I,h;calcRelativePosition(c,this.layout.layoutBox,this.relativeParent.layout.layoutBox),I=this.relativeTarget,h=this.relativeTargetOrigin,mixAxis(I.x,h.x,c.x,i),mixAxis(I.y,h.y,c.y,i),r&&(g=this.relativeTarget,d=r,g.x.min===d.x.min&&g.x.max===d.x.max&&g.y.min===d.y.min&&g.y.max===d.y.max)&&(this.isProjectionDirty=!1),r||(r=createBox()),copyBoxInto(r,this.relativeTarget)}u&&(this.animationValues=a,function(t,n,r,i,o,a){o?(t.opacity=mix(0,void 0!==r.opacity?r.opacity:1,eQ(i)),t.opacityExit=mix(void 0!==n.opacity?n.opacity:1,0,eq(i))):a&&(t.opacity=mix(void 0!==n.opacity?n.opacity:1,void 0!==r.opacity?r.opacity:1,i));for(let o=0;o<eD;o++){let a=`border${ej[o]}Radius`,l=getRadius(n,a),c=getRadius(r,a);if(void 0===l&&void 0===c)continue;l||(l=0),c||(c=0);let g=0===l||0===c||isPx(l)===isPx(c);g?(t[a]=Math.max(mix(asNumber(l),asNumber(c),i),0),(T.test(c)||T.test(l))&&(t[a]+="%")):t[a]=c}(n.rotate||r.rotate)&&(t.rotate=mix(n.rotate||0,r.rotate||0,i))}(a,o,this.latestValues,i,m,p)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=i},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(t){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&((0,M.Pn)(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=M.Wi.update(()=>{eP.hasAnimatedSinceResize=!0,this.currentAnimation=function(t,n,r){let i=isMotionValue(t)?t:motionValue(t);return i.start(animateMotionValue("",i,1e3,r)),i.animation}(0,0,{...t,onUpdate:n=>{this.mixTargetDelta(n),t.onUpdate&&t.onUpdate(n)},onComplete:()=>{t.onComplete&&t.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let t=this.getStack();t&&t.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let t=this.getLead(),{targetWithTransforms:n,target:r,layout:i,latestValues:o}=t;if(n&&r&&i){if(this!==t&&this.layout&&i&&shouldAnimatePositionOnly(this.options.animationType,this.layout.layoutBox,i.layoutBox)){r=this.target||createBox();let n=calcLength(this.layout.layoutBox.x);r.x.min=t.target.x.min,r.x.max=r.x.min+n;let i=calcLength(this.layout.layoutBox.y);r.y.min=t.target.y.min,r.y.max=r.y.min+i}copyBoxInto(n,r),transformBox(n,o),calcBoxDelta(this.projectionDeltaWithTransform,this.layoutCorrected,n,o)}}registerSharedNode(t,n){this.sharedNodes.has(t)||this.sharedNodes.set(t,new NodeStack);let r=this.sharedNodes.get(t);r.add(n);let i=n.options.initialPromotionConfig;n.promote({transition:i?i.transition:void 0,preserveFollowOpacity:i&&i.shouldPreserveFollowOpacity?i.shouldPreserveFollowOpacity(n):void 0})}isLead(){let t=this.getStack();return!t||t.lead===this}getLead(){var t;let{layoutId:n}=this.options;return n&&(null===(t=this.getStack())||void 0===t?void 0:t.lead)||this}getPrevLead(){var t;let{layoutId:n}=this.options;return n?null===(t=this.getStack())||void 0===t?void 0:t.prevLead:void 0}getStack(){let{layoutId:t}=this.options;if(t)return this.root.sharedNodes.get(t)}promote({needsReset:t,transition:n,preserveFollowOpacity:r}={}){let i=this.getStack();i&&i.promote(this,r),t&&(this.projectionDelta=void 0,this.needsReset=!0),n&&this.setOptions({transition:n})}relegate(){let t=this.getStack();return!!t&&t.relegate(this)}resetRotation(){let{visualElement:t}=this.options;if(!t)return;let n=!1,{latestValues:r}=t;if((r.rotate||r.rotateX||r.rotateY||r.rotateZ)&&(n=!0),!n)return;let i={};for(let n=0;n<e2.length;n++){let o="rotate"+e2[n];r[o]&&(i[o]=r[o],t.setStaticValue(o,0))}for(let n in t.render(),i)t.setStaticValue(n,i[n]);t.scheduleRender()}getProjectionStyles(t){var n,r;if(!this.instance||this.isSVG)return;if(!this.isVisible)return e1;let i={visibility:""},o=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,i.opacity="",i.pointerEvents=resolveMotionValue(null==t?void 0:t.pointerEvents)||"",i.transform=o?o(this.latestValues,""):"none",i;let a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target){let n={};return this.options.layoutId&&(n.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,n.pointerEvents=resolveMotionValue(null==t?void 0:t.pointerEvents)||""),this.hasProjected&&!hasTransform(this.latestValues)&&(n.transform=o?o({},""):"none",this.hasProjected=!1),n}let l=a.animationValues||a.latestValues;this.applyTransformsToTarget(),i.transform=buildProjectionTransform(this.projectionDeltaWithTransform,this.treeScale,l),o&&(i.transform=o(l,i.transform));let{x:c,y:g}=this.projectionDelta;for(let t in i.transformOrigin=`${100*c.origin}% ${100*g.origin}% 0`,a.animationValues?i.opacity=a===this?null!==(r=null!==(n=l.opacity)&&void 0!==n?n:this.latestValues.opacity)&&void 0!==r?r:1:this.preserveOpacity?this.latestValues.opacity:l.opacityExit:i.opacity=a===this?void 0!==l.opacity?l.opacity:"":void 0!==l.opacityExit?l.opacityExit:0,A){if(void 0===l[t])continue;let{correct:n,applyTo:r}=A[t],o="none"===i.transform?l[t]:n(l[t],a);if(r){let t=r.length;for(let n=0;n<t;n++)i[r[n]]=o}else i[t]=o}return this.options.layoutId&&(i.pointerEvents=a===this?resolveMotionValue(null==t?void 0:t.pointerEvents)||"":"none"),i}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(t=>{var n;return null===(n=t.currentAnimation)||void 0===n?void 0:n.stop()}),this.root.nodes.forEach(clearMeasurements),this.root.sharedNodes.clear()}}}function updateLayout(t){t.updateLayout()}function notifyLayoutUpdate(t){var n;let r=(null===(n=t.resumeFrom)||void 0===n?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&r&&t.hasListeners("didUpdate")){let{layoutBox:n,measuredBox:i}=t.layout,{animationType:o}=t.options,a=r.source!==t.layout.source;"size"===o?eachAxis(t=>{let i=a?r.measuredBox[t]:r.layoutBox[t],o=calcLength(i);i.min=n[t].min,i.max=i.min+o}):shouldAnimatePositionOnly(o,r.layoutBox,n)&&eachAxis(i=>{let o=a?r.measuredBox[i]:r.layoutBox[i],l=calcLength(n[i]);o.max=o.min+l,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[i].max=t.relativeTarget[i].min+l)});let l=createDelta();calcBoxDelta(l,n,r.layoutBox);let c=createDelta();a?calcBoxDelta(c,t.applyTransform(i,!0),r.measuredBox):calcBoxDelta(c,n,r.layoutBox);let g=!isDeltaZero(l),d=!1;if(!t.resumeFrom){let i=t.getClosestProjectingParent();if(i&&!i.resumeFrom){let{snapshot:o,layout:a}=i;if(o&&a){let l=createBox();calcRelativePosition(l,r.layoutBox,o.layoutBox);let c=createBox();calcRelativePosition(c,n,a.layoutBox),boxEqualsRounded(l,c)||(d=!0),i.options.layoutRoot&&(t.relativeTarget=c,t.relativeTargetOrigin=l,t.relativeParent=i)}}}t.notifyListeners("didUpdate",{layout:n,snapshot:r,delta:c,layoutDelta:l,hasLayoutChanged:g,hasRelativeTargetChanged:d})}else if(t.isLead()){let{onExitComplete:n}=t.options;n&&n()}t.options.transition=void 0}function propagateDirtyNodes(t){e9.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function cleanDirtyNodes(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function clearSnapshot(t){t.clearSnapshot()}function clearMeasurements(t){t.clearMeasurements()}function clearIsLayoutDirty(t){t.isLayoutDirty=!1}function resetTransformStyle(t){let{visualElement:n}=t.options;n&&n.getProps().onBeforeLayoutMeasure&&n.notify("BeforeLayoutMeasure"),t.resetTransform()}function finishAnimation(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function resolveTargetDelta(t){t.resolveTargetDelta()}function calcProjection(t){t.calcProjection()}function resetRotation(t){t.resetRotation()}function removeLeadSnapshots(t){t.removeLeadSnapshot()}function mixAxisDelta(t,n,r){t.translate=mix(n.translate,0,r),t.scale=mix(n.scale,1,r),t.origin=n.origin,t.originPoint=n.originPoint}function mixAxis(t,n,r,i){t.min=mix(n.min,r.min,i),t.max=mix(n.max,r.max,i)}function hasOpacityCrossfade(t){return t.animationValues&&void 0!==t.animationValues.opacityExit}let e3={duration:.45,ease:[.4,0,.1,1]},userAgentContains=t=>"undefined"!=typeof navigator&&navigator.userAgent.toLowerCase().includes(t),e4=userAgentContains("applewebkit/")&&!userAgentContains("chrome/")?Math.round:q.Z;function roundAxis(t){t.min=e4(t.min),t.max=e4(t.max)}function shouldAnimatePositionOnly(t,n,r){return"position"===t||"preserve-aspect"===t&&!isNear(aspectRatio(n),aspectRatio(r),.2)}let e7=createProjectionNode({attachResizeListener:(t,n)=>addDomEvent(t,"resize",n),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),e8={current:void 0},e6=createProjectionNode({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!e8.current){let t=new e7({});t.mount(window),t.setOptions({layoutScroll:!0}),e8.current=t}return e8.current},resetTransform:(t,n)=>{t.style.transform=void 0!==n?n:"none"},checkIsScrollRoot:t=>"fixed"===window.getComputedStyle(t).position}),te=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function getVariableValue(t,n,r=1){(0,en.k)(r<=4,`Max CSS variable fallback depth detected in property "${t}". This may indicate a circular fallback dependency.`);let[i,o]=function(t){let n=te.exec(t);if(!n)return[,];let[,r,i]=n;return[r,i]}(t);if(!i)return;let a=window.getComputedStyle(n).getPropertyValue(i);if(a){let t=a.trim();return isNumericalString(t)?parseFloat(t):t}return S(o)?getVariableValue(o,n,r+1):o}let tt=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),isPositionalKey=t=>tt.has(t),hasPositionalKey=t=>Object.keys(t).some(isPositionalKey),isNumOrPxType=t=>t===R||t===_,getPosFromMatrix=(t,n)=>parseFloat(t.split(", ")[n]),getTranslateFromMatrix=(t,n)=>(r,{transform:i})=>{if("none"===i||!i)return 0;let o=i.match(/^matrix3d\((.+)\)$/);if(o)return getPosFromMatrix(o[1],n);{let n=i.match(/^matrix\((.+)\)$/);return n?getPosFromMatrix(n[1],t):0}},tn=new Set(["x","y","z"]),tr=B.filter(t=>!tn.has(t)),ti={width:({x:t},{paddingLeft:n="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(n)-parseFloat(r),height:({y:t},{paddingTop:n="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(n)-parseFloat(r),top:(t,{top:n})=>parseFloat(n),left:(t,{left:n})=>parseFloat(n),bottom:({y:t},{top:n})=>parseFloat(n)+(t.max-t.min),right:({x:t},{left:n})=>parseFloat(n)+(t.max-t.min),x:getTranslateFromMatrix(4,13),y:getTranslateFromMatrix(5,14)};ti.translateX=ti.x,ti.translateY=ti.y;let convertChangedValueTypes=(t,n,r)=>{let i=n.measureViewportBox(),o=n.current,a=getComputedStyle(o),{display:l}=a,c={};"none"===l&&n.setStaticValue("display",t.display||"block"),r.forEach(t=>{c[t]=ti[t](i,a)}),n.render();let g=n.measureViewportBox();return r.forEach(r=>{let i=n.getValue(r);i&&i.jump(c[r]),t[r]=ti[r](g,a)}),t},checkAndConvertChangedValueTypes=(t,n,r={},i={})=>{n={...n},i={...i};let o=Object.keys(n).filter(isPositionalKey),a=[],l=!1,c=[];if(o.forEach(o=>{let g;let d=t.getValue(o);if(!t.hasValue(o))return;let u=r[o],I=findDimensionValueType(u),p=n[o];if(isKeyframesTarget(p)){let t=p.length,n=null===p[0]?1:0;I=findDimensionValueType(u=p[n]);for(let r=n;r<t&&null!==p[r];r++)g?(0,en.k)(findDimensionValueType(p[r])===g,"All keyframes must be of the same type"):(g=findDimensionValueType(p[r]),(0,en.k)(g===I||isNumOrPxType(I)&&isNumOrPxType(g),"Keyframes must be of the same dimension as the current value"))}else g=findDimensionValueType(p);if(I!==g){if(isNumOrPxType(I)&&isNumOrPxType(g)){let t=d.get();"string"==typeof t&&d.set(parseFloat(t)),"string"==typeof p?n[o]=parseFloat(p):Array.isArray(p)&&g===_&&(n[o]=p.map(parseFloat))}else(null==I?void 0:I.transform)&&(null==g?void 0:g.transform)&&(0===u||0===p)?0===u?d.set(g.transform(u)):n[o]=I.transform(p):(l||(a=function(t){let n=[];return tr.forEach(r=>{let i=t.getValue(r);void 0!==i&&(n.push([r,i.get()]),i.set(r.startsWith("scale")?1:0))}),n.length&&t.render(),n}(t),l=!0),c.push(o),i[o]=void 0!==i[o]?i[o]:n[o],d.jump(p))}}),!c.length)return{target:n,transitionEnd:i};{let r=c.indexOf("height")>=0?window.pageYOffset:null,o=convertChangedValueTypes(n,t,c);return a.length&&a.forEach(([n,r])=>{t.getValue(n).set(r)}),t.render(),h.j&&null!==r&&window.scrollTo({top:r}),{target:o,transitionEnd:i}}},parseDomVariant=(t,n,r,i)=>{let o=function(t,{...n},r){let i=t.current;if(!(i instanceof Element))return{target:n,transitionEnd:r};for(let o in r&&(r={...r}),t.values.forEach(t=>{let n=t.get();if(!S(n))return;let r=getVariableValue(n,i);r&&t.set(r)}),n){let t=n[o];if(!S(t))continue;let a=getVariableValue(t,i);a&&(n[o]=a,r||(r={}),void 0===r[o]&&(r[o]=t))}return{target:n,transitionEnd:r}}(t,n,i);return function(t,n,r,i){return hasPositionalKey(n)?checkAndConvertChangedValueTypes(t,n,r,i):{target:n,transitionEnd:i}}(t,n=o.target,r,i=o.transitionEnd)},to={current:null},ta={current:!1},ts=new WeakMap,tl=Object.keys(m),tc=tl.length,tg=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],td=I.length;let VisualElement=class VisualElement{constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:i,visualState:o},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>M.Wi.render(this.render,!1,!0);let{latestValues:l,renderState:c}=o;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=a,this.isControllingVariants=isControllingVariants(n),this.isVariantNode=isVariantNode(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);let{willChange:g,...d}=this.scrapeMotionValuesFromProps(n,{});for(let t in d){let n=d[t];void 0!==l[t]&&isMotionValue(n)&&(n.set(l[t],!1),isWillChangeMotionValue(g)&&g.add(t))}}scrapeMotionValuesFromProps(t,n){return{}}mount(t){this.current=t,ts.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((t,n)=>this.bindToMotionValue(n,t)),ta.current||function(){if(ta.current=!0,h.j){if(window.matchMedia){let t=window.matchMedia("(prefers-reduced-motion)"),setReducedMotionPreferences=()=>to.current=t.matches;t.addListener(setReducedMotionPreferences),setReducedMotionPreferences()}else to.current=!1}}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||to.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let t in ts.delete(this.current),this.projection&&this.projection.unmount(),(0,M.Pn)(this.notifyUpdate),(0,M.Pn)(this.render),this.valueSubscriptions.forEach(t=>t()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[t].clear();for(let t in this.features)this.features[t].unmount();this.current=null}bindToMotionValue(t,n){let r=Z.has(t),i=n.on("change",n=>{this.latestValues[t]=n,this.props.onUpdate&&M.Wi.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),o=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(t,()=>{i(),o()})}sortNodePosition(t){return this.current&&this.sortInstanceNodePosition&&this.type===t.type?this.sortInstanceNodePosition(this.current,t.current):0}loadFeatures({children:t,...n},r,i,o){let a,l;for(let t=0;t<tc;t++){let r=tl[t],{isEnabled:i,Feature:o,ProjectionNode:c,MeasureLayout:g}=m[r];c&&(a=c),i(n)&&(!this.features[r]&&o&&(this.features[r]=new o(this)),g&&(l=g))}if(("html"===this.type||"svg"===this.type)&&!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);let{layoutId:t,layout:r,drag:i,dragConstraints:l,layoutScroll:c,layoutRoot:g}=n;this.projection.setOptions({layoutId:t,layout:r,alwaysMeasureLayout:!!i||l&&isRefObject(l),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"==typeof r?r:"both",initialPromotionConfig:o,layoutScroll:c,layoutRoot:g})}return l}updateFeatures(){for(let t in this.features){let n=this.features[t];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):createBox()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}makeTargetAnimatable(t,n=!0){return this.makeTargetAnimatableFromInstance(t,this.props,n)}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let n=0;n<tg.length;n++){let r=tg[n];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);let i=t["on"+r];i&&(this.propEventSubscriptions[r]=this.on(r,i))}this.prevMotionValues=function(t,n,r){let{willChange:i}=n;for(let o in n){let a=n[o],l=r[o];if(isMotionValue(a))t.addValue(o,a),isWillChangeMotionValue(i)&&i.add(o);else if(isMotionValue(l))t.addValue(o,motionValue(a,{owner:t})),isWillChangeMotionValue(i)&&i.remove(o);else if(l!==a){if(t.hasValue(o)){let n=t.getValue(o);n.hasAnimated||n.set(a)}else{let n=t.getStaticValue(o);t.addValue(o,motionValue(void 0!==n?n:a,{owner:t}))}}}for(let i in r)void 0===n[i]&&t.removeValue(i);return n}(this,this.scrapeMotionValuesFromProps(t,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(t=!1){if(t)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){let t=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(t.initial=this.props.initial),t}let n={};for(let t=0;t<td;t++){let r=I[t],i=this.props[r];(isVariantLabel(i)||!1===i)&&(n[r]=i)}return n}addVariantChild(t){let n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){n!==this.values.get(t)&&(this.removeValue(t),this.bindToMotionValue(t,n)),this.values.set(t,n),this.latestValues[t]=n.get()}removeValue(t){this.values.delete(t);let n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return void 0===r&&void 0!==n&&(r=motionValue(n,{owner:this}),this.addValue(t,r)),r}readValue(t){var n;return void 0===this.latestValues[t]&&this.current?null!==(n=this.getBaseTargetFromProps(this.props,t))&&void 0!==n?n:this.readValueFromInstance(this.current,t,this.options):this.latestValues[t]}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;let{initial:r}=this.props,i="string"==typeof r||"object"==typeof r?null===(n=resolveVariantFromProps(this.props,r))||void 0===n?void 0:n[t]:void 0;if(r&&void 0!==i)return i;let o=this.getBaseTargetFromProps(this.props,t);return void 0===o||isMotionValue(o)?void 0!==this.initialValues[t]&&void 0===i?void 0:this.baseTarget[t]:o}on(t,n){return this.events[t]||(this.events[t]=new SubscriptionManager),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}};let DOMVisualElement=class DOMVisualElement extends VisualElement{sortInstanceNodePosition(t,n){return 2&t.compareDocumentPosition(n)?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}makeTargetAnimatableFromInstance({transition:t,transitionEnd:n,...r},{transformValues:i},o){let a=function(t,n,r){let i={};for(let o in t){let t=function(t,n){if(!n)return;let r=n[t]||n.default||n;return r.from}(o,n);if(void 0!==t)i[o]=t;else{let t=r.getValue(o);t&&(i[o]=t.get())}}return i}(r,t||{},this);if(i&&(n&&(n=i(n)),r&&(r=i(r)),a&&(a=i(a))),o){!function(t,n,r){var i,o;let a=Object.keys(n).filter(n=>!t.hasValue(n)),l=a.length;if(l)for(let c=0;c<l;c++){let l=a[c],g=n[l],d=null;Array.isArray(g)&&(d=g[0]),null===d&&(d=null!==(o=null!==(i=r[l])&&void 0!==i?i:t.readValue(l))&&void 0!==o?o:n[l]),null!=d&&("string"==typeof d&&(isNumericalString(d)||isZeroValueString(d))?d=parseFloat(d):!findValueType(d)&&eZ.test(g)&&(d=animatable_none_getAnimatableNone(l,g)),t.addValue(l,motionValue(d,{owner:t})),void 0===r[l]&&(r[l]=d),null!==d&&t.setBaseTarget(l,d))}}(this,r,a);let t=parseDomVariant(this,r,a,n);n=t.transitionEnd,r=t.target}return{transition:t,transitionEnd:n,...r}}};let HTMLVisualElement=class HTMLVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="html"}readValueFromInstance(t,n){if(Z.has(n)){let t=getDefaultValueType(n);return t&&t.default||0}{let r=window.getComputedStyle(t),i=(W(n)?r.getPropertyValue(n):r[n])||0;return"string"==typeof i?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:n}){return measureViewportBox(t,n)}build(t,n,r,i){buildHTMLStyles(t,n,r,i.transformTemplate)}scrapeMotionValuesFromProps(t,n){return scrapeMotionValuesFromProps(t,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:t}=this.props;isMotionValue(t)&&(this.childSubscription=t.on("change",t=>{this.current&&(this.current.textContent=`${t}`)}))}renderInstance(t,n,r,i){renderHTML(t,n,r,i)}};let SVGVisualElement=class SVGVisualElement extends DOMVisualElement{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Z.has(n)){let t=getDefaultValueType(n);return t&&t.default||0}return n=z.has(n)?n:camelToDash(n),t.getAttribute(n)}measureInstanceViewportBox(){return createBox()}scrapeMotionValuesFromProps(t,n){return scrape_motion_values_scrapeMotionValuesFromProps(t,n)}build(t,n,r,i){buildSVGAttrs(t,n,r,this.isSVGTag,i.transformTemplate)}renderInstance(t,n,r,i){renderSVG(t,n,r,i)}mount(t){this.isSVGTag=isSVGTag(t.tagName),super.mount(t)}};let create_visual_element_createDomVisualElement=(t,n)=>isSVGComponent(t)?new SVGVisualElement(n,{enableHardwareAcceleration:!1}):new HTMLVisualElement(n,{enableHardwareAcceleration:!0}),tu={animation:{Feature:class extends Feature{constructor(t){super(t),t.animationState||(t.animationState=function(t){let animate=n=>Promise.all(n.map(({animation:n,options:r})=>(function(t,n,r={}){let i;if(t.notify("AnimationStart",n),Array.isArray(n)){let o=n.map(n=>animateVariant(t,n,r));i=Promise.all(o)}else if("string"==typeof n)i=animateVariant(t,n,r);else{let o="function"==typeof n?resolveVariant(t,n,r.custom):n;i=Promise.all(animateTarget(t,o,r))}return i.then(()=>t.notify("AnimationComplete",n))})(t,n,r))),n={animate:createTypeState(!0),whileInView:createTypeState(),whileHover:createTypeState(),whileTap:createTypeState(),whileDrag:createTypeState(),whileFocus:createTypeState(),exit:createTypeState()},r=!0,buildResolvedTypeValues=(n,r)=>{let i=resolveVariant(t,r);if(i){let{transition:t,transitionEnd:r,...o}=i;n={...n,...o,...r}}return n};function animateChanges(i,o){let a=t.getProps(),l=t.getVariantContext(!0)||{},c=[],g=new Set,d={},u=1/0;for(let p=0;p<ek;p++){var I;let m=ex[p],h=n[m],C=void 0!==a[m]?a[m]:l[m],b=isVariantLabel(C),y=m===o?h.isActive:null;!1===y&&(u=p);let G=C===l[m]&&C!==a[m]&&b;if(G&&r&&t.manuallyAnimateOnMount&&(G=!1),h.protectedKeys={...d},!h.isActive&&null===y||!C&&!h.prevProp||isAnimationControls(C)||"boolean"==typeof C)continue;let A=(I=h.prevProp,"string"==typeof C?C!==I:!!Array.isArray(C)&&!shallowCompare(C,I)),B=A||m===o&&h.isActive&&!G&&b||p>u&&b,Z=!1,f=Array.isArray(C)?C:[C],v=f.reduce(buildResolvedTypeValues,{});!1===y&&(v={});let{prevResolvedValues:W={}}=h,S={...W,...v},markToAnimate=t=>{B=!0,g.has(t)&&(Z=!0,g.delete(t)),h.needsAnimating[t]=!0};for(let t in S){let n=v[t],r=W[t];if(!d.hasOwnProperty(t))(isKeyframesTarget(n)&&isKeyframesTarget(r)?shallowCompare(n,r):n===r)?void 0!==n&&g.has(t)?markToAnimate(t):h.protectedKeys[t]=!0:void 0!==n?markToAnimate(t):g.add(t)}h.prevProp=C,h.prevResolvedValues=v,h.isActive&&(d={...d,...v}),r&&t.blockInitialAnimation&&(B=!1),B&&(!G||Z)&&c.push(...f.map(t=>({animation:t,options:{type:m,...i}})))}if(g.size){let n={};g.forEach(r=>{let i=t.getBaseTarget(r);void 0!==i&&(n[r]=i)}),c.push({animation:n})}let p=!!c.length;return r&&(!1===a.initial||a.initial===a.animate)&&!t.manuallyAnimateOnMount&&(p=!1),r=!1,p?animate(c):Promise.resolve()}return{animateChanges,setActive:function(r,i,o){var a;if(n[r].isActive===i)return Promise.resolve();null===(a=t.variantChildren)||void 0===a||a.forEach(t=>{var n;return null===(n=t.animationState)||void 0===n?void 0:n.setActive(r,i)}),n[r].isActive=i;let l=animateChanges(o,r);for(let t in n)n[t].protectedKeys={};return l},setAnimateFunction:function(n){animate=n(t)},getState:()=>n}}(t))}updateAnimationControlsSubscription(){let{animate:t}=this.node.getProps();this.unmount(),isAnimationControls(t)&&(this.unmount=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){}}},exit:{Feature:class extends Feature{constructor(){super(...arguments),this.id=eU++}update(){if(!this.node.presenceContext)return;let{isPresent:t,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:i}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===i)return;let o=this.node.animationState.setActive("exit",!t,{custom:null!=r?r:this.node.getProps().custom});n&&!t&&o.then(()=>n(this.id))}mount(){let{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}},inView:{Feature:class extends Feature{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:o}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:"number"==typeof i?i:et[i]};return function(t,n,r){let i=function({root:t,...n}){let r=t||document;ee.has(r)||ee.set(r,{});let i=ee.get(r),o=JSON.stringify(n);return i[o]||(i[o]=new IntersectionObserver(fireAllObserverCallbacks,{root:t,...n})),i[o]}(n);return $.set(t,r),i.observe(t),()=>{$.delete(t),i.unobserve(t)}}(this.node.current,a,t=>{let{isIntersecting:n}=t;if(this.isInView===n||(this.isInView=n,o&&!n&&this.hasEnteredView))return;n&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",n);let{onViewportEnter:r,onViewportLeave:i}=this.node.getProps(),a=n?r:i;a&&a(t)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:t,prevProps:n}=this.node,r=["amount","margin","root"].some(function({viewport:t={}},{viewport:n={}}={}){return r=>t[r]!==n[r]}(t,n));r&&this.startObserver()}unmount(){}}},tap:{Feature:class extends Feature{constructor(){super(...arguments),this.removeStartListeners=q.Z,this.removeEndListeners=q.Z,this.removeAccessibleListeners=q.Z,this.startPointerPress=(t,n)=>{if(this.isPressing)return;this.removeEndListeners();let r=this.node.getProps(),i=addPointerEvent(window,"pointerup",(t,n)=>{if(!this.checkPressEnd())return;let{onTap:r,onTapCancel:i,globalTapTarget:o}=this.node.getProps();M.Wi.update(()=>{o||isNodeOrChild(this.node.current,t.target)?r&&r(t,n):i&&i(t,n)})},{passive:!(r.onTap||r.onPointerUp)}),o=addPointerEvent(window,"pointercancel",(t,n)=>this.cancelPress(t,n),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=pipe(i,o),this.startPress(t,n)},this.startAccessiblePress=()=>{let t=addDomEvent(this.node.current,"keydown",t=>{"Enter"!==t.key||this.isPressing||(this.removeEndListeners(),this.removeEndListeners=addDomEvent(this.node.current,"keyup",t=>{"Enter"===t.key&&this.checkPressEnd()&&fireSyntheticPointerEvent("up",(t,n)=>{let{onTap:r}=this.node.getProps();r&&M.Wi.update(()=>r(t,n))})}),fireSyntheticPointerEvent("down",(t,n)=>{this.startPress(t,n)}))}),n=addDomEvent(this.node.current,"blur",()=>{this.isPressing&&fireSyntheticPointerEvent("cancel",(t,n)=>this.cancelPress(t,n))});this.removeAccessibleListeners=pipe(t,n)}}startPress(t,n){this.isPressing=!0;let{onTapStart:r,whileTap:i}=this.node.getProps();i&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&M.Wi.update(()=>r(t,n))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;let t=this.node.getProps();return t.whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!isDragActive()}cancelPress(t,n){if(!this.checkPressEnd())return;let{onTapCancel:r}=this.node.getProps();r&&M.Wi.update(()=>r(t,n))}mount(){let t=this.node.getProps(),n=addPointerEvent(t.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(t.onTapStart||t.onPointerStart)}),r=addDomEvent(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=pipe(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends Feature{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch(n){t=!0}t&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pipe(addDomEvent(this.node.current,"focus",()=>this.onFocus()),addDomEvent(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends Feature{mount(){this.unmount=pipe(addHoverEvent(this.node,!0),addHoverEvent(this.node,!1))}unmount(){}}},pan:{Feature:class extends Feature{constructor(){super(...arguments),this.removePointerDownListener=q.Z}onPointerDown(t){this.session=new PanSession(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:getContextWindow(this.node)})}createPanHandlers(){let{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:asyncHandler(t),onStart:asyncHandler(n),onMove:r,onEnd:(t,n)=>{delete this.session,i&&M.Wi.update(()=>i(t,n))}}}mount(){this.removePointerDownListener=addPointerEvent(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends Feature{constructor(t){super(t),this.removeGroupControls=q.Z,this.removeListeners=q.Z,this.controls=new VisualElementDragControls(t)}mount(){let{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||q.Z}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:e6,MeasureLayout:MeasureLayout},layout:{ProjectionNode:e6,MeasureLayout:MeasureLayout}},tI=function(t){function custom(n,r={}){return function({preloadedFeatures:t,createVisualElement:n,useRender:r,useVisualState:u,Component:I}){t&&function(t){for(let n in t)m[n]={...m[n],...t[n]}}(t);let p=(0,i.forwardRef)(function(p,m){var y;let G;let A={...(0,i.useContext)(o),...p,layoutId:function({layoutId:t}){let n=(0,i.useContext)(C.p).id;return n&&void 0!==t?n+"-"+t:t}(p)},{isStatic:B}=A,Z=function(t){let{initial:n,animate:r}=function(t,n){if(isControllingVariants(t)){let{initial:n,animate:r}=t;return{initial:!1===n||isVariantLabel(n)?n:void 0,animate:isVariantLabel(r)?r:void 0}}return!1!==t.inherit?n:{}}(t,(0,i.useContext)(a));return(0,i.useMemo)(()=>({initial:n,animate:r}),[variantLabelsAsDependency(n),variantLabelsAsDependency(r)])}(p),f=u(p,B);if(!B&&h.j){Z.visualElement=function(t,n,r,u){let{visualElement:I}=(0,i.useContext)(a),p=(0,i.useContext)(g),m=(0,i.useContext)(l.O),h=(0,i.useContext)(o).reducedMotion,C=(0,i.useRef)();u=u||p.renderer,!C.current&&u&&(C.current=u(t,{visualState:n,parent:I,props:r,presenceContext:m,blockInitialAnimation:!!m&&!1===m.initial,reducedMotionConfig:h}));let b=C.current;(0,i.useInsertionEffect)(()=>{b&&b.update(r,m)});let y=(0,i.useRef)(!!(r[d]&&!window.HandoffComplete));return(0,c.L)(()=>{b&&(b.render(),y.current&&b.animationState&&b.animationState.animateChanges())}),(0,i.useEffect)(()=>{b&&(b.updateFeatures(),!y.current&&b.animationState&&b.animationState.animateChanges(),y.current&&(y.current=!1,window.HandoffComplete=!0))}),b}(I,f,A,n);let r=(0,i.useContext)(b),u=(0,i.useContext)(g).strict;Z.visualElement&&(G=Z.visualElement.loadFeatures(A,u,t,r))}return i.createElement(a.Provider,{value:Z},G&&Z.visualElement?i.createElement(G,{visualElement:Z.visualElement,...A}):null,r(I,p,(y=Z.visualElement,(0,i.useCallback)(t=>{t&&f.mount&&f.mount(t),y&&(t?y.mount(t):y.unmount()),m&&("function"==typeof m?m(t):isRefObject(m)&&(m.current=t))},[y])),f,B,Z.visualElement))});return p[y]=I,p}(t(n,r))}if("undefined"==typeof Proxy)return custom;let n=new Map;return new Proxy(custom,{get:(t,r)=>(n.has(r)||n.set(r,custom(r)),n.get(r))})}((t,n)=>(function(t,{forwardMotionProps:n=!1},r,o){let a=isSVGComponent(t)?O:j;return{...a,preloadedFeatures:r,useRender:function(t=!1){return(n,r,o,{latestValues:a},l)=>{let c=isSVGComponent(n)?useSVGProps:useHTMLProps,g=c(r,a,l,n),d=function(t,n,r){let i={};for(let o in t)("values"!==o||"object"!=typeof t.values)&&(shouldForward(o)||!0===r&&isValidMotionProp(o)||!n&&!isValidMotionProp(o)||t.draggable&&o.startsWith("onDrag"))&&(i[o]=t[o]);return i}(r,"string"==typeof n,t),u={...d,...g,ref:o},{children:I}=r,p=(0,i.useMemo)(()=>isMotionValue(I)?I.get():I,[I]);return(0,i.createElement)(n,{...u,children:p})}}(n),createVisualElement:o,Component:t}})(t,n,tu,create_visual_element_createDomVisualElement))},47279:(t,n,r)=>{"use strict";r.d(n,{K:()=>o,k:()=>a});var i=r(41279);let o=i.Z,a=i.Z},58066:(t,n,r)=>{"use strict";r.d(n,{j:()=>i});let i="undefined"!=typeof document},41279:(t,n,r)=>{"use strict";r.d(n,{Z:()=>noop});let noop=t=>t},34349:(t,n,r)=>{"use strict";r.d(n,{h:()=>useConstant});var i=r(9885);function useConstant(t){let n=(0,i.useRef)(null);return null===n.current&&(n.current=t()),n.current}},60381:(t,n,r)=>{"use strict";r.d(n,{L:()=>a});var i=r(9885),o=r(58066);let a=o.j?i.useLayoutEffect:i.useEffect}};
//# sourceMappingURL=818.js.map