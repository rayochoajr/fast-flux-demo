(()=>{var e={};e.id=495,e.ids=[495],e.modules={81036:e=>{function webpackEmptyContext(e){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=()=>[],webpackEmptyContext.resolve=webpackEmptyContext,webpackEmptyContext.id=81036,e.exports=webpackEmptyContext},58097:e=>{"use strict";e.exports=require("@sentry/nextjs")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},32804:(e,t,r)=>{"use strict";r.r(t),r.d(t,{headerHooks:()=>P,originalPathname:()=>A,requestAsyncStorage:()=>T,routeModule:()=>y,serverHooks:()=>f,staticGenerationAsyncStorage:()=>v,staticGenerationBailout:()=>h});var a={};r.r(a),r.d(a,{DELETE:()=>m,GET:()=>l,HEAD:()=>x,OPTIONS:()=>w,PATCH:()=>g,POST:()=>E,PUT:()=>_}),r(97260);var n=r(56128),o=r(50401);r(36869);var s=r(61875),i=r(58097),p=r(54580),u=r(75889),c=r(2454),d=r.n(c);async function GET$1(e){try{if(!process.env.REPLICATE_API_TOKEN)throw Error("REPLICATE_API_TOKEN is not configured");let t=new(d())({auth:process.env.REPLICATE_API_TOKEN}),{searchParams:r}=new URL(e.url),a=r.get("text");if(!a)return new u.Z("Missing text parameter",{status:400});let n=await t.run("black-forest-labs/flux-schnell",{input:{prompt:a,go_fast:!0,num_outputs:1,aspect_ratio:"1:1",output_format:"webp",output_quality:80,megapixels:"0.25",num_inference_steps:2}});if(!n||!n[0])throw Error("No output from Replicate");let o=new Headers;return o.set("Content-Type","image/*"),o.set("Cache-Control","no-store, no-cache, must-revalidate, proxy-revalidate"),o.set("Pragma","no-cache"),o.set("Expires","0"),new u.Z(n[0],{status:200,statusText:"OK",headers:o})}catch(e){return(0,i.captureException)(e),new u.Z(JSON.stringify({error:"Failed to generate image"}),{status:500,headers:{"Content-Type":"application/json"}})}}function wrapHandler(e,t){return"phase-production-build"===process.env.NEXT_PHASE||"function"!=typeof e?e:new Proxy(e,{apply:(e,r,a)=>{let n,o,u;try{let e=p.requestAsyncStorage.getStore();n=(0,s.hd)((0,s.xY)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("sentry-trace")]),()=>void 0),o=(0,s.hd)((0,s.xY)([e,"optionalAccess",e=>e.headers,"access",e=>e.get,"call",e=>e("baggage")]),()=>void 0),u=(0,s.xY)([e,"optionalAccess",e=>e.headers])}catch(e){}return i.wrapRouteHandlerWithSentry(e,{method:t,parameterizedRoute:"/api/generate-image",sentryTraceHeader:n,baggageHeader:o,headers:u}).apply(r,a)}})}let l=wrapHandler(GET$1,"GET"),E=wrapHandler(void 0,"POST"),_=wrapHandler(void 0,"PUT"),g=wrapHandler(void 0,"PATCH"),m=wrapHandler(void 0,"DELETE"),x=wrapHandler(void 0,"HEAD"),w=wrapHandler(void 0,"OPTIONS"),y=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/generate-image/route",pathname:"/api/generate-image",filename:"route",bundlePath:"app/api/generate-image/route"},resolvedPagePath:"/codebuild/output/src2780279085/src/fast-flux-demo/app/api/generate-image/route.ts",nextConfigOutput:"standalone",userland:a}),{requestAsyncStorage:T,staticGenerationAsyncStorage:v,serverHooks:f,headerHooks:P,staticGenerationBailout:h}=y,A="/api/generate-image/route"},36869:(e,t,r)=>{"use strict";var a=r(58097),n="undefined"!=typeof global?global:"undefined"!=typeof self?self:{};n.__sentryRewritesTunnelPath__=void 0,n.SENTRY_RELEASE={id:"9cE2t8EeJLM5SxMI0LDvt"},n.__sentryBasePath=void 0,n.__rewriteFramesDistDir__=".next",a.init({dsn:process.env.NEXT_PUBLIC_SENTRY_DSN,tracesSampleRate:1})}};var t=require("../../../webpack-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[921,184,598,964],()=>__webpack_exec__(32804));module.exports=r})();
//# sourceMappingURL=route.js.map