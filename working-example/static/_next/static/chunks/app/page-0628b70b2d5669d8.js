(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3987:function(e,t,a){Promise.resolve().then(a.bind(a,3356))},3356:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return Home}});var r=a(6705),i=a(955),s=a(6691),n=a.n(s),l=a(5251),o=a(2167),c=a(8143),d=a.n(c),u=a(4931);let usePerfMetrics=()=>{(0,i.useEffect)(()=>{let e={};return new PerformanceObserver(t=>{let a=t.getEntries(),r=a.find(e=>"first-contentful-paint"===e.name);r&&(e.FCP=r.startTime)}).observe({entryTypes:["paint"]}),new PerformanceObserver(t=>{let a=t.getEntries();a.length>0&&(e.LCP=a[a.length-1].startTime)}).observe({entryTypes:["largest-contentful-paint"]}),new PerformanceObserver(t=>{let a=0;t.getEntries().forEach(e=>{e.hadRecentInput||(a+=e.value)}),e.CLS=a}).observe({entryTypes:["layout-shift"]}),()=>{}},[])};let ErrorBoundary=class ErrorBoundary extends i.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){}render(){return this.state.hasError?(0,r.jsxs)("div",{className:"p-6 bg-red-50 dark:bg-red-900/10 rounded-lg",children:[(0,r.jsx)("h2",{className:"text-red-600 dark:text-red-400 font-medium",children:"Something went wrong"}),(0,r.jsx)("button",{onClick:()=>this.setState({hasError:!1}),className:"mt-2 text-sm text-red-500 hover:text-red-600 dark:text-red-400",children:"Try again"})]}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:null}}};let g="Elegant minimalist workspace with soft natural lighting, muted colors",RealTimeToggle=e=>{let{enabled:t,onToggle:a,isGenerating:i}=e;return(0,r.jsxs)(l.E.button,{type:"button",onClick:a,disabled:i,className:"\n        relative p-3 rounded-xl\n        transition-all duration-300\n        ".concat(t?"bg-blue-500/10 text-blue-600 dark:text-blue-400 hover:bg-blue-500/20":"bg-gray-100 text-gray-500 dark:bg-gray-800 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700","\n        disabled:opacity-50 disabled:cursor-not-allowed\n        group text-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30\n      "),whileHover:{scale:1.05},whileTap:{scale:.95},transition:{type:"spring",stiffness:700,damping:30},children:[(0,r.jsx)(l.E.div,{className:"\n          absolute inset-0 rounded-xl\n          ".concat(t?"bg-blue-500/5 dark:bg-blue-400/5":"bg-gray-500/5 dark:bg-gray-400/5","\n        "),initial:!1,animate:t?{scale:1.5,opacity:0}:{scale:1,opacity:0},transition:{duration:.5,repeat:t?1/0:0}}),(0,r.jsx)("span",{className:"relative z-10","aria-label":t?"Real-time mode":"Manual mode",children:t?"⚡":"\uD83C\uDFAF"}),t&&(0,r.jsx)(l.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"absolute -top-2 -right-2 text-xs bg-blue-500 text-white dark:text-blue-100 rounded-full w-4 h-4 flex items-center justify-center",children:"2"})]})},GenerateButton=e=>{let{isGenerating:t,disabled:a,hasError:s}=e,[n,c]=(0,i.useState)(!1),[d]=(0,i.useState)(s);return(0,i.useEffect)(()=>{if(!t&&!d){c(!0);let e=setTimeout(()=>c(!1),1e3);return()=>clearTimeout(e)}},[t,d]),(0,r.jsx)(l.E.button,{type:"submit",disabled:a,className:"\n        relative p-3 rounded-xl transition-all duration-300\n        ".concat(s?"bg-red-500/10 text-red-600":n?"bg-green-500/10 text-green-600":"bg-blue-500/10 text-blue-600 dark:text-blue-400 hover:bg-blue-500/20","\n        disabled:opacity-50 disabled:cursor-not-allowed\n        text-lg focus:outline-none focus:ring-2 focus:ring-blue-500/30\n      "),whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":t?"Generating image":"Generate image",children:(0,r.jsx)(o.M,{mode:"wait",children:t?(0,r.jsxs)(l.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"relative",children:[(0,r.jsx)(l.E.div,{className:"absolute inset-0 flex items-center justify-center",animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},children:"✨"}),(0,r.jsx)("span",{className:"opacity-0",children:"\uD83E\uDE84"})]},"generating"):s?(0,r.jsx)(l.E.span,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:"⚠️"},"error"):n?(0,r.jsx)(l.E.span,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:"✓"},"success"):(0,r.jsx)(l.E.span,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},children:"\uD83E\uDE84"},"idle")})})},m=i.memo(e=>{let{url:t,alt:a,loading:i,error:s,onRetry:o}=e;return(0,r.jsxs)(l.E.div,{variants:{hidden:{opacity:0,scale:.95},visible:{opacity:1,scale:1,transition:{type:"spring",stiffness:300,damping:30}}},initial:"hidden",animate:"visible",className:"relative w-full max-w-4xl aspect-square rounded-3xl overflow-hidden shadow-2xl",children:[t?(0,r.jsx)(n(),{src:t,alt:a,fill:!0,className:"object-cover",priority:!0}):(0,r.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-800 dark:to-gray-900"}),i&&(0,r.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 backdrop-blur-sm bg-black/20 flex items-center justify-center",children:(0,r.jsx)(l.E.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-2 border-white/30 border-t-white rounded-full"})}),s&&(0,r.jsxs)(l.E.div,{initial:{opacity:0},animate:{opacity:1},className:"absolute inset-0 backdrop-blur-sm bg-black/20 flex flex-col items-center justify-center",children:[(0,r.jsxs)("p",{className:"text-white mb-4",children:["⚠️ ",s.message]}),(0,r.jsx)("button",{onClick:o,className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white transition-colors",children:"Try Again"})]})]})});m.displayName="ImageDisplay";let imageReducer=(e,t)=>{switch(t.type){case"START_LOADING":return{...e,loading:!0,error:null,timestamp:Date.now()};case"LOAD_SUCCESS":return{url:t.url,loading:!1,error:null,timestamp:Date.now()};case"LOAD_ERROR":return{...e,loading:!1,error:t.error,timestamp:Date.now()};case"RESET":return{url:null,loading:!1,error:null,timestamp:Date.now()};default:return e}},useImageCache=()=>{let e=(0,i.useRef)(new Map),t=(0,i.useCallback)((t,a)=>{e.current.set(t,{url:a,timestamp:Date.now()});try{localStorage.setItem("imageCache",JSON.stringify(Array.from(e.current.entries())))}catch(e){}},[]),a=(0,i.useCallback)(t=>{let a=e.current.get(t);return a?Date.now()-a.timestamp>864e5?(e.current.delete(t),null):a.url:null},[]);return(0,i.useEffect)(()=>{try{let t=localStorage.getItem("imageCache");t&&(e.current=new Map(JSON.parse(t)))}catch(e){}},[]),{get:a,set:t}},useRequestQueue=()=>{let e=(0,i.useRef)([]),t=(0,i.useRef)(!1),a=(0,i.useCallback)(async()=>{if(!t.current&&0!==e.current.length){t.current=!0;try{let t=e.current[0];await t(),e.current.shift()}catch(e){}finally{t.current=!1,e.current.length>0&&a()}}},[]),r=(0,i.useCallback)(t=>{e.current.push(t),a()},[a]);return{enqueue:r}},historyReducer=(e,t)=>{switch(t.type){case"ADD_ENTRY":return{...e,entries:[t.entry,...e.entries.filter(e=>e.hash!==t.entry.hash)],error:null};case"REMOVE_ENTRY":return{...e,entries:e.entries.filter(e=>e.id!==t.id),selectedId:e.selectedId===t.id?null:e.selectedId};case"SELECT_ENTRY":return{...e,selectedId:t.id,error:null};case"CLEAR_SELECTION":return{...e,selectedId:null};case"SET_ERROR":return{...e,error:t.error,isLoading:!1};case"CLEAR_ERROR":return{...e,error:null};case"START_LOADING":return{...e,isLoading:!0,error:null};case"STOP_LOADING":return{...e,isLoading:!1};default:return e}},HistoryToggle=e=>{let{isVisible:t,onToggle:a,hasNewItems:i}=e;return(0,r.jsxs)(l.E.button,{onClick:a,className:"\n      relative p-3 rounded-xl transition-colors\n      ".concat(t?"bg-blue-500/10 text-blue-600 dark:text-blue-400 hover:bg-blue-500/20":"bg-gray-100/50 text-gray-500 dark:bg-gray-800/50 dark:text-gray-400 hover:bg-gray-200/50 dark:hover:bg-gray-700/50","\n      focus:outline-none focus:ring-2 focus:ring-blue-500/30\n    "),whileHover:{scale:1.05},whileTap:{scale:.95},"aria-label":t?"Close history":"Open history",children:[(0,r.jsx)("span",{className:"text-lg",children:t?"\uD83D\uDCDA":"\uD83D\uDCD6"}),i&&!t&&(0,r.jsx)(l.E.div,{initial:{scale:0},animate:{scale:1},className:"absolute -top-1 -right-1 w-3 h-3 bg-blue-500 rounded-full"})]})},HistoryItem=e=>{let{entry:t,isSelected:a,onSelect:s,onRemove:c,onRegenerate:d}=e,[u,g]=(0,i.useState)(!1);return(0,r.jsx)(l.E.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"\n        relative rounded-xl overflow-hidden\n        ".concat(a?"ring-2 ring-blue-500 dark:ring-blue-400":"hover:ring-1 hover:ring-gray-200 dark:hover:ring-gray-700","\n        bg-white dark:bg-gray-800 shadow-sm hover:shadow-md transition-all\n      "),onHoverStart:()=>g(!0),onHoverEnd:()=>g(!1),children:(0,r.jsxs)(l.E.div,{className:"relative aspect-square",onClick:s,children:[(0,r.jsx)(n(),{src:t.imageUrl,alt:t.prompt,fill:!0,className:"object-cover",sizes:"(max-width: 768px) 100vw, (max-width: 1200px) 50vw, 33vw",priority:a}),(0,r.jsx)(o.M,{children:u&&(0,r.jsxs)(l.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"absolute inset-0 bg-gradient-to-t from-black/60 via-black/0 to-black/0 p-4 flex flex-col justify-end",children:[(0,r.jsx)("p",{className:"text-sm text-white line-clamp-2",children:t.prompt}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),d()},className:"p-2 text-white/80 hover:text-white bg-white/10 hover:bg-white/20 rounded-lg transition-colors","aria-label":"Regenerate image",children:"↺"}),(0,r.jsx)("button",{onClick:e=>{e.stopPropagation(),c()},className:"p-2 text-white/80 hover:text-white bg-white/10 hover:bg-white/20 rounded-lg transition-colors","aria-label":"Remove from history",children:"\xd7"})]})]})}),t.metadata.fromCache&&(0,r.jsx)("div",{className:"absolute top-2 right-2 p-1 bg-blue-500 rounded-md",children:(0,r.jsx)("span",{className:"text-xs text-white",children:"⚡"})})]})})},HistoryPanel=e=>{let{isVisible:t,entries:a,selectedId:s,onClose:n,onSelect:c,onRemove:d,onRegenerate:u,error:g}=e,m=(0,i.useRef)(null),[h,p]=(0,i.useState)({isDragging:!1,startY:0,translateY:0});return(0,r.jsx)(o.M,{children:t&&(0,r.jsxs)(l.E.div,{ref:m,initial:{opacity:0,y:"100%"},animate:{opacity:1,y:h.translateY||0,transition:{type:"spring",damping:30,stiffness:300}},exit:{opacity:0,y:"100%"},className:"fixed bottom-20 inset-x-0 h-[70vh] bg-white/80 dark:bg-gray-900/80 backdrop-blur-2xl shadow-2xl rounded-t-3xl overflow-hidden",onTouchStart:e=>{p({isDragging:!0,startY:e.touches[0].clientY,translateY:0})},onTouchMove:e=>{if(!h.isDragging)return;let t=e.touches[0].clientY-h.startY;t>0&&p(e=>({...e,translateY:t}))},onTouchEnd:()=>{h.translateY>100&&n(),p({isDragging:!1,startY:0,translateY:0})},children:[(0,r.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-12 h-1 bg-gray-300 dark:bg-gray-700 rounded-full my-3"}),(0,r.jsxs)("div",{className:"h-full pt-8 pb-6 px-6 overflow-y-auto custom-scrollbar",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-base font-medium text-gray-900 dark:text-white",children:"History"}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:[a.length," ",1===a.length?"image":"images"," generated"]})]}),(0,r.jsx)("button",{onClick:n,className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-300 rounded-lg transition-colors","aria-label":"Close history",children:"\xd7"})]}),g&&(0,r.jsxs)(l.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"mb-4 p-4 bg-red-500/10 text-red-600 dark:text-red-400 rounded-lg",children:["⚠️ ",g.message]}),(0,r.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:(0,r.jsx)(o.M,{mode:"popLayout",children:a.map(e=>(0,r.jsx)(HistoryItem,{entry:e,isSelected:e.id===s,onSelect:()=>c(e),onRemove:()=>d(e.id),onRegenerate:()=>u(e)},e.id))})}),0===a.length&&(0,r.jsx)(l.E.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No images generated yet"})})]})]})})};function Home(){usePerfMetrics();let[e,t]=(0,i.useReducer)(imageReducer,{url:null,loading:!1,error:null,timestamp:0}),[a,s]=(0,i.useState)(g),[n,o]=(0,i.useState)(!1),c=(0,i.useRef)(null),{get:h,set:p}=useImageCache(),{enqueue:x}=useRequestQueue(),y=(0,i.useMemo)(()=>e=>(0,u.createHash)("sha256").update(e).digest("hex").substring(0,8),[]),b=(0,i.useCallback)(async e=>{if(!e.trim())return;c.current&&c.current.abort(),c.current=new AbortController;let a=y(e),r=h(a),i=Date.now();if(r){t({type:"LOAD_SUCCESS",url:r,prompt:e}),N({type:"ADD_ENTRY",entry:{id:a,prompt:e,imageUrl:r,hash:a,timestamp:Date.now(),metadata:{generationTime:0,fromCache:!0,seed:a}}});return}t({type:"START_LOADING",prompt:e}),N({type:"START_LOADING"});try{var s;let r="/api/generate-image?text=".concat(encodeURIComponent(e),"&seed=").concat(a);if(await new Promise(e=>setTimeout(e,2e3)),null===(s=c.current)||void 0===s?void 0:s.signal.aborted)return;t({type:"LOAD_SUCCESS",url:r,prompt:e}),p(a,r),N({type:"ADD_ENTRY",entry:{id:a,prompt:e,imageUrl:r,hash:a,timestamp:Date.now(),metadata:{generationTime:Date.now()-i,fromCache:!1,seed:a}}})}catch(e){e instanceof Error&&(t({type:"LOAD_ERROR",error:e}),N({type:"SET_ERROR",error:e}))}finally{N({type:"STOP_LOADING"})}},[y,h,p]),f=(0,i.useMemo)(()=>d()(e=>{x(()=>b(e))},2e3),[b,x]),v=(0,i.useCallback)(e=>{let t=e.target.value;s(t),n&&f(t)},[n,f]),E=(0,i.useCallback)(e=>{e.preventDefault(),n||x(()=>b(a))},[n,a,b,x]),w=(0,i.useCallback)(()=>{x(()=>b(a))},[a,b,x]);(0,i.useEffect)(()=>()=>{c.current&&c.current.abort()},[]);let[j,N]=(0,i.useReducer)(historyReducer,{entries:[],selectedId:null,error:null,isLoading:!1}),[k,R]=(0,i.useState)(!1),C=(0,i.useMemo)(()=>!k&&j.entries.some(e=>Date.now()-e.timestamp<5e3),[j.entries,k]);return(0,r.jsx)(ErrorBoundary,{children:(0,r.jsx)("div",{className:"min-h-screen bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-gray-50 via-gray-100 to-gray-200 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,r.jsxs)("main",{className:"relative min-h-[calc(100vh-4rem)]",children:[(0,r.jsx)("div",{className:"absolute inset-0 flex items-center justify-center p-8 pb-24",children:(0,r.jsx)(m,{url:e.url,alt:a,loading:e.loading,error:e.error,onRetry:w})}),(0,r.jsx)("nav",{className:"fixed bottom-0 inset-x-0 z-50",children:(0,r.jsx)(l.E.div,{className:"glass-effect mx-auto px-4 sm:px-6 lg:px-8 pb-safe",initial:{y:100},animate:{y:0},transition:{type:"spring",stiffness:300,damping:30},children:(0,r.jsxs)("form",{onSubmit:E,className:"flex items-center h-16 gap-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(RealTimeToggle,{enabled:n,onToggle:()=>o(!n),isGenerating:e.loading}),(0,r.jsx)(GenerateButton,{isGenerating:e.loading,disabled:e.loading||n,hasError:!!e.error})]}),(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)("input",{type:"text",value:a,onChange:v,placeholder:"Describe your vision...",className:"w-full px-4 py-2 text-base text-gray-900 dark:text-white bg-gray-100/50 dark:bg-gray-800/50 rounded-xl border-0 focus:ring-2 focus:ring-blue-500/30 transition-all duration-300"}),a!==g&&(0,r.jsx)("button",{type:"button",onClick:()=>s(g),className:"absolute right-2 top-1/2 -translate-y-1/2 p-2 text-gray-400 hover:text-gray-600 dark:text-gray-500 dark:hover:text-gray-300",children:"\xd7"})]}),(0,r.jsx)(HistoryToggle,{isVisible:k,onToggle:()=>R(!k),hasNewItems:C})]})})}),(0,r.jsx)(HistoryPanel,{isVisible:k,entries:j.entries,selectedId:j.selectedId,error:j.error,onClose:()=>{R(!1),N({type:"CLEAR_SELECTION"})},onSelect:e=>{N({type:"SELECT_ENTRY",id:e.id}),s(e.prompt),n||x(()=>b(e.prompt))},onRemove:e=>N({type:"REMOVE_ENTRY",id:e}),onRegenerate:e=>{s(e.prompt),x(()=>b(e.prompt))}})]})})})}}},function(e){e.O(0,[218,339,121,119,209,744],function(){return e(e.s=3987)}),_N_E=e.O()}]);
//# sourceMappingURL=page-0628b70b2d5669d8.js.map